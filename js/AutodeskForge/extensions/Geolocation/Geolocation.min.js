/*!
 * LMV v7.105.0
 *
 * Copyright 2025 Autodesk, Inc.
 * All rights reserved.
 *
 * This computer source code and related instructions and comments are the
 * unpublished confidential and proprietary information of Autodesk, Inc.
 * and are protected under Federal copyright and state trade secret law.
 * They may not be disclosed to, copied or used by any third party without
 * the prior written consent of Autodesk, Inc.
 *
 * Autodesk Viewer SDK Usage Limitations:
 *
 * The Autodesk Viewer SDK JavaScript must be delivered from an
 * Autodesk-hosted URL.
 */(()=>{var t={d:(e,i)=>{for(var n in i)t.o(i,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:i[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};(()=>{"use strict";t.r(e),t.d(e,{GeolocationExtension:()=>k,LocalCS:()=>A});var i={};t.r(i),t.d(i,{degToRad:()=>f,geocentric2LL:()=>M,ll2Geocentric:()=>_,radToDeg:()=>C});const n=Autodesk.Viewing;function o(t){n.ToolInterface.call(this),this.names=["pointTool"],this.extension=t,this.viewer=t.viewer,this.handleSingleClick=function(t,e){if(0!==e)return!1;var i=t.canvasX,n=t.canvasY,o=this.viewer.clientToWorld(i,n);return!!o&&(this.extension.pushPoint(o),!0)},this.activate=function(t,e){this.viewer.impl.pauseHighlight(!0),this.viewer.clearSelection()},this.deactivate=function(){this.viewer.impl.pauseHighlight(!1)},this.destroy=function(){this.viewer=null}}const r=Autodesk.Viewing.UI;class s extends r.DockingPanel{constructor(t){super(t.viewer.container,"lmv-points-extension","Points",{}),this.setGlobalManager(t.globalManager),this.title.classList.add("docking-panel-delimiter-shadow"),this.container.classList.add("property-panel"),this.extension=t,this.viewer=t.viewer,this.nonScrollingContentHeight=0}destroy(){this.myTree&&(this.myTree.destroy(),this.myTree=null),this.container&&(this.container.parentElement.removeChild(this.container),this.container=null),this.extension=null,this.viewer=null}pushPoint(t){var e=this.myTree.myRootContainer;this.myTree.createElement_(t,e)}removePoint(t){var e=this.myTree.getElementForNode(t);this.myTree.myRootContainer.removeChild(e)}setVisible(t){super.setVisible(t),t&&this._create()}getContentSize(){return{height:this.scrollContainer.scrollHeight+80+this.nonScrollingContentHeight,width:this.scrollContainer.scrollWidth}}_create(){if(this.myTree)return;this.container.style.top="20px",this.container.style.width="420px",this.container.style.height="480px";let t=this.getDocument().createElement("div");t.className="docking-panel-container-solid-color-a",t.style["font-size"]="12px",t.style.padding="0px 6px",t.style.border="solid 5px green",t.innerHTML='\n<table style="width:100%;">\n    <tr user-data="row-positionLL84" style="color: #2cd86a;">\n        <td>GPS (positionLL84)</td>\n        <td style="border: 1px solid black">_latitude_</td>\n        <td style="border: 1px solid black;">_longitude_</td>\n        <td style="border: 1px solid black;">_height_meters_</td>\n    </tr>\n    <tr user-data="row-refPointLMV">\n        <td>Viewer (refPointLMV)</td>\n        <td style="border: 1px solid black">_x_</td>\n        <td style="border: 1px solid black;">_y_</td>\n        <td style="border: 1px solid black;">_z_</td>\n    </tr>\n    <tr user-data="row-angleToTrueNorth">\n        <td>angleToTrueNorth</td>\n        <td style="border: 1px solid black" colspan="3">_angle_deg_</td>\n    </tr>\n    <tr user-data="row-scaleFactor">\n        <td>scaleFactor</td>\n        <td style="border: 1px solid black" colspan="3">_scale_num_</td>\n    </tr>\n    <tr user-data="row-refPointTransform">\n        <td>refPointTransform</td>\n        <td style="border: 1px solid black" colspan="3">_yes_or_no_</td>\n    </tr>\n    <tr user-data="row-distanceUnit">\n        <td>distanceUnit</td>\n        <td style="border: 1px solid black" colspan="3">_meters_or_inches_or_etc_</td>\n    </tr>\n    <tr user-data="row-globalOffset">\n        <td>globalOffset</td>\n        <td style="border: 1px solid black">_x_</td>\n        <td style="border: 1px solid black;">_y_</td>\n        <td style="border: 1px solid black;">_z_</td>\n    </tr>\n\n</table>\n',this.container.appendChild(t),this._setGeolocationMetadata(t,this.viewer.model),this.nonScrollingContentHeight=t.clientHeight;const e=80+this.nonScrollingContentHeight;this.createScrollContainer({left:!1,heightAdjustment:e,marginTop:0});var i=this._createDelegate();this.myTree=new Autodesk.Viewing.UI.Tree(i,null,this.scrollContainer,{}),this.container.removeChild(this.footer),this.container.appendChild(this.footer),this.resizeToContent()}_createDelegate(){var t=new Autodesk.Viewing.UI.TreeDelegate;return t.setGlobalManager(this.globalManager),t.extension=this.extension,t.viewer=this.viewer,t.getTreeNodeId=function(t){return t.__id},t.getTreeNodeLabel=function(t){return t.__id},t.getTreeNodeClass=function(t){return null},t.isTreeNodeGroup=function(t){return!1},t.shouldCreateTreeNode=function(t){return!0},t.createTreeNode=function(t,e,i,n,o){e.innerHTML='<label style="font-size:22px;">id</label>\n<div style="float:right; margin-top:6px; ">\n    <button user-data="map" style="margin-right:10px;">Map</button>\n    <button user-data="close" style="margin-right:10px;">X</button>\n</div>\n<table style="width:100%;">\n    <tr user-data="lmv" title="Coordinates in LMV space, obtained via viewer.clientToWorld(mouseX, mouseY);">\n        <td style="border: 1px solid black;">LMV</td>\n        <td style="border: 1px solid #F44336;">x</td>\n        <td style="border: 1px solid #4CAF50;">y</td>\n        <td style="border: 1px solid #2196F3;">z</td>\n    </tr>\n    <tr user-data="wgs84" title="Longitude, Latitude, and Height in WGS84.">\n        <td style="border: 1px solid black;">LonLat</td>\n        <td style="border: 1px solid #F44336;">lon</td>\n        <td style="border: 1px solid #4CAF50;">lat</td>\n        <td style="border: 1px solid #2196F3;">height</td>\n    </tr>\n</table>',e.querySelector("label").textContent=t.__id;var r=e.querySelector('tr[user-data="lmv"]'),s=r.querySelectorAll("td");if(a(s[1],t.point.x),a(s[2],t.point.y),a(s[3],t.point.z),r=e.querySelector('tr[user-data="wgs84"]'),this.extension.hasGeolocationData()){var l=this.extension.lmvToLonLat(t.point);a((s=r.querySelectorAll("td"))[1],l.x),a(s[2],l.y),a(s[3],l.z)}else r.style.display="none";this.extension.hasGeolocationData()||(e.querySelector("[user-data=map]").style.display="none")},t.onTreeNodeClick=(t,e,i)=>{if("BUTTON"!==i.target.tagName)this.viewer.restoreState(e.__viewerState);else{let t=i.target.getAttribute("user-data");const o=this.getWindow();switch(t){case"close":return void this.extension.removePoint(e);case"map":{var n=this.extension.lmvToLonLat(e.point);let t=this.extension.getGoogleMapsUrl(n);return console.log(t),void o.open(t)}}}},t}_setGeolocationMetadata(t,e){let i;const n=e.getData().metadata||{},o=n.georeference||{},r=n["custom values"]||{},s=e.getData().globalOffset||{x:0,y:0,z:0},l=e.getDisplayUnit();i=t.querySelector("[user-data=row-globalOffset]"),a(i.children[1],s.x),a(i.children[2],s.y),a(i.children[3],s.z),i=t.querySelector("[user-data=row-positionLL84]"),a(i.children[1],Array.isArray(o.positionLL84)?o.positionLL84[0]:"N/A"),a(i.children[2],Array.isArray(o.positionLL84)?o.positionLL84[1]:"N/A"),a(i.children[3],Array.isArray(o.positionLL84)?o.positionLL84[2]:"N/A"),i=t.querySelector("[user-data=row-refPointLMV]"),a(i.children[1],Array.isArray(o.refPointLMV)?o.refPointLMV[0]:"N/A"),a(i.children[2],Array.isArray(o.refPointLMV)?o.refPointLMV[1]:"N/A"),a(i.children[3],Array.isArray(o.refPointLMV)?o.refPointLMV[2]:"N/A"),i=t.querySelector("[user-data=row-angleToTrueNorth]"),a(i.children[1],void 0!==r.angleToTrueNorth?r.angleToTrueNorth:"N/A"),i=t.querySelector("[user-data=row-scaleFactor]"),a(i.children[1],void 0!==r.scaleFactor?r.scaleFactor:"N/A"),i=t.querySelector("[user-data=row-refPointTransform]"),a(i.children[1],Array.isArray(r.refPointTransform)?"Available":"N/A"),i=t.querySelector("[user-data=row-distanceUnit]"),a(i.children[1],l||"N/A")}}function a(t,e,i){i=i||6,t.textContent="number"==typeof e?e.toFixed(i):e,t.setAttribute("title",e)}const l=Autodesk.Viewing;class d{constructor(t,e,i){this.viewer=t,this.setGlobalManager(this.viewer.globalManager),this.data=e;const n=this.getDocument();this.div=n.createElement("div"),this.div.style.position="absolute",this.div.style.background="rgb(14, 14, 14)",this.div.textContent=e.__id,this.onCameraChange(),i.appendChild(this.div)}hasData(t){return this.data===t}onCameraChange(){var t=this.viewer.worldToClient(this.data.point);this.div.style.left=t.x+"px",this.div.style.top=t.y+"px"}destroy(){this.div&&(this.div.parentElement.removeChild(this.div),this.div=null),this.viewer=null,this.data=null}}l.GlobalManagerMixin.call(d.prototype);const h=Autodesk.Viewing;class c{constructor(t){this.extension=t,this.viewer=t.viewer,this.setGlobalManager(this.viewer.globalManager),this._points=[],this.onCameraChange=this.onCameraChange.bind(this)}pushPoint(t){if(!this.divContainer){const t=this.getDocument();this.divContainer=t.createElement("div"),this.divContainer.style.position="absolute",this.divContainer.style.top="0",this.divContainer.style.left="0",this.divContainer.style.width="100%",this.divContainer.style.height="100%",this.divContainer.style["pointer-events"]="none",this.viewer.container.appendChild(this.divContainer),this.viewer.addEventListener(h.CAMERA_CHANGE_EVENT,this.onCameraChange)}var e=new d(this.viewer,t,this.divContainer);this._points.push(e)}removePoint(t){for(var e=-1,i=0;i<this._points.length;++i)if(this._points[i].hasData(t)){e=i;break}-1!==e&&(this._points[e].destroy(),this._points.splice(e,1))}destroy(){this._points&&(this._points.forEach((t=>{t.destroy()})),this._points=null),this.divContainer&&(this.divContainer.parentElement.removeChild(this.divContainer),this.divContainer=null),this.extension=null,this.viewer.removeEventListener(h.CAMERA_CHANGE_EVENT,this.onCameraChange),this.viewer=null}onCameraChange(t){this._points.forEach((e=>{e.onCameraChange(t)}))}}h.GlobalManagerMixin.call(c.prototype);class u{constructor(t){this.extension=t,this.panel=new s(t),this.canvas=new c(t)}pushPoint(t){t&&(this.panel.setVisible(!0),this.panel.pushPoint(t),this.canvas.pushPoint(t))}removePoint(t){t&&(this.panel.removePoint(t),this.canvas.removePoint(t))}activate(){this.panel.setVisible(!0)}deactivate(){this.panel.setVisible(!1)}destroy(){this.extension=null,this.panel&&(this.panel.destroy(),this.panel=null),this.canvas&&(this.canvas.destroy(),this.canvas=null)}}const v=6378137,g=1/298.257223563,p=v*(1-g),m=(2-g)*g;class y{static a(){return v}static MajorRadius(){return v}static f(){return g}static InverseFlattening(){return g}static b(){return p}static MinorRadius(){return p}static e2(){return m}static EccentricitySquared(){return m}}const w=Math.PI,b=w/180,x=180/w,L=Autodesk.Viewing.Private;function f(t){return t*b}function C(t){return t*x}function _(t){const e=f(t.x),i=f(t.y),n=t.z,o=Math.sin(i),r=Math.cos(i),s=Math.sin(e),a=Math.cos(e),l=y.a()/Math.sqrt(1-y.e2()*(o*o)),d=(l+n)*r;let h=d*a,c=d*s,u=((1-y.e2())*l+n)*o;return new L.LmvVector3(h,c,u)}function M(t){const e=t.x,i=t.y,n=t.z,o=y.b(),r=y.e2()/(1-y.e2()),s=Math.sqrt(e*e+i*i),a=Math.atan2(n*y.a(),s*o);let l=Math.sin(a),d=Math.cos(a);l*=l*l,d*=d*d;const h=Math.atan2(n+r*o*l,s-y.e2()*y.a()*d),c=Math.atan2(i,e);let u=Math.sin(h);u*=u;const v=y.a()/Math.sqrt(1-y.e2()*u),g=s/Math.cos(h)-v;let p=C(c),m=C(h),w=g;return new L.LmvVector3(p,m,w)}const T=Autodesk.Viewing.Private;class A{constructor(t,e,i,n){this.m_originLL84=t.clone();let o=_(t);var r=new T.LmvMatrix4(!0);r.elements[0]=r.elements[5]=r.elements[10]=i||1;var s=new T.LmvMatrix4(!0);s.elements[12]=o.x,s.elements[13]=o.y,s.elements[14]=o.z;var a=A.createEnu2Ecef({x:t.x,y:t.y});e||(e=new T.LmvMatrix4(!0)),n||(n=new T.LmvMatrix4(!0));let l=new T.LmvMatrix4(!0);l.copy(n).invert(),this.m_model2ecef=s.multiply(a).multiply(r).multiply(e).multiply(l),this.m_ecef2model=new T.LmvMatrix4(!0),this.m_ecef2model.copy(this.m_model2ecef).invert()}getLL84(){return this.m_originLL84}LL842LmvPoint(t){var e=_(t);return e=this.m_ecef2model.transformPoint(e)}lmv2LL84Point(t){return M(this.m_model2ecef.transformPoint(t.clone()))}static createEnu2Ecef(t){const e=f(t.x),i=f(t.y),n=Math.sin(e),o=Math.cos(e),r=Math.sin(i),s=Math.cos(i);var a=new T.LmvMatrix4(!0);return a.set(-n,-r*o,s*o,0,o,-r*n,s*n,0,0,s,r,0,0,0,0,1),a}static createFromModel(t){const e=(t.getData().metadata||{}).georeference||{};if(!Array.isArray(e.positionLL84))return null;const i=e.positionLL84,n=new T.LmvVector3(i[0],i[1],i[2]);return new A(n,t.getData().refPointTransform,t.getUnitScale(),t.getData().placementWithOffset)}}const P=Autodesk.Viewing,S=Autodesk.Viewing.Private;class k extends P.Extension{constructor(t,e){super(t,e),this.nextPointId=0}static getGlobeMath(){return i}load(){return this.ui=new u(this),this.tool=new o(this),this.viewer.toolController.registerTool(this.tool),!0}unload(){return this.deactivate(),this.tool&&(this.viewer.toolController.deregisterTool(this.tool),this.tool.destroy(),this.tool=null),this.ui&&(this.ui.destroy(),this.ui=null),this.viewer=null,!0}activate(){return!!this.viewer.model&&(this.isActive()||(this.ui.activate(),this.viewer.toolController.activateTool(this.tool.getName()),this.viewer.model.is3d()&&this.viewer.getExtension("Autodesk.ViewCubeUi",(function(t){t.showTriad(!0)}))),!0)}deactivate(){return!this.isActive()||(this.ui.deactivate(),this.viewer.toolController.deactivateTool(this.tool.getName()),this.viewer.model&&this.viewer.model.is3d()&&this.viewer.getExtension("Autodesk.ViewCubeUi",(function(t){t.showTriad(!1)})),!0)}isActive(){return this.viewer.toolController.isToolActivated(this.tool.getName())}pushPoint(t){t.__id=this.nextPointId++,t.__viewerState=this.viewer.getState({viewport:!0}),this.ui.pushPoint(t)}removePoint(t){this.ui.removePoint(t)}getLocalCS(){return this._localCS||(this._localCS=A.createFromModel(this.viewer.model)),this._localCS}hasGeolocationData(){return!!this.getLocalCS()}lmvToLonLat(t){var e=new S.LmvVector3(t.x,t.y,t.z);return this.getLocalCS().lmv2LL84Point(e)}lonLatToLmv(t){var e=new S.LmvVector3(t.x,t.y,t.z||0);return this.getLocalCS().LL842LmvPoint(e)}getGoogleMapsUrl(t){var e=this.getLocalCS();if(!t&&!e)return void console.warn("Model doesn't contain geolocation data.");return function(t){if(!t)return null;const e=t.x;return`https://www.google.com/maps/search/?api=1&query=${t.y},${e}`}(t||e.getLL84())}getCurrentPositionLmv(){return this.hasGeolocationData()?new Promise(((t,e)=>{"geolocation"in navigator?navigator.geolocation.getCurrentPosition((e=>{var i=this.lonLatToLmv({x:e.coords.longitude,y:e.coords.latitude,z:0});t(i)})):e("geolocation API not available on this device.")})):Promise.reject("Model doesn't contain geolocation data.")}}P.theExtensionManager.registerExtension("Autodesk.Geolocation",k)})(),Autodesk.Extensions.Geolocation=e})();
//# sourceMappingURL=Geolocation.min.js.map
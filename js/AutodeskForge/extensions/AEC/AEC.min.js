/*!
 * LMV v7.105.0
 *
 * Copyright 2025 Autodesk, Inc.
 * All rights reserved.
 *
 * This computer source code and related instructions and comments are the
 * unpublished confidential and proprietary information of Autodesk, Inc.
 * and are protected under Federal copyright and state trade secret law.
 * They may not be disclosed to, copied or used by any third party without
 * the prior written consent of Autodesk, Inc.
 *
 * Autodesk Viewer SDK Usage Limitations:
 *
 * The Autodesk Viewer SDK JavaScript must be delivered from an
 * Autodesk-hosted URL.
 */(()=>{var __webpack_modules__={9578:function(module,exports){var e,t;e="undefined"!=typeof self?self:this,t=()=>(()=>{var __webpack_modules__={1972:function(e){var t;"undefined"!=typeof self&&self,t=function(){return function(e){var t={};function i(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=e,i.c=t,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=5)}([function(e,t,i){"use strict";t.b=1e-12,t.a=1e-6},function(e,t,i){"use strict";var r=i(0),o={createFloat32:function(){var e=new Float32Array(3);return e[0]=0,e[1]=0,e[2]=0,e},createFloat64:function(){var e=new Float64Array(3);return e[0]=0,e[1]=0,e[2]=0,e},createNumber:function(){return[0,0,0]},clone:function(e){var t=new e.constructor(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},createFloat32FromValues:function(e,t,i){var r=new Float32Array(3);return r[0]=e,r[1]=t,r[2]=i,r}};o.asFloat32=o.createFloat32FromValues,o.createFloat64FromValues=function(e,t,i){var r=new Float64Array(3);return r[0]=e,r[1]=t,r[2]=i,r},o.asFloat64=o.createFloat64FromValues,o.createNumberFromValues=function(e,t,i){return[e,t,i]},o.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},o.set=function(e,t,i,r){return e[0]=t,e[1]=i,e[2]=r,e},o.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e},o.subtract=function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e},o.sub=o.subtract,o.multiply=function(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e[2]=t[2]*i[2],e},o.mul=o.multiply,o.divide=function(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e[2]=t[2]/i[2],e},o.div=o.divide,o.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e},o.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e},o.min=function(e,t,i){return e[0]=Math.min(t[0],i[0]),e[1]=Math.min(t[1],i[1]),e[2]=Math.min(t[2],i[2]),e},o.max=function(e,t,i){return e[0]=Math.max(t[0],i[0]),e[1]=Math.max(t[1],i[1]),e[2]=Math.max(t[2],i[2]),e},o.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e},o.scale=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e},o.scaleAndAdd=function(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e[2]=t[2]+i[2]*r,e},o.distance=function(e,t){var i=t[0]-e[0],r=t[1]-e[1],o=t[2]-e[2];return Math.sqrt(i*i+r*r+o*o)},o.dist=o.distance,o.squaredDistance=function(e,t){var i=t[0]-e[0],r=t[1]-e[1],o=t[2]-e[2];return i*i+r*r+o*o},o.sqrDist=o.squaredDistance,o.length=function(e){var t=e[0],i=e[1],r=e[2];return Math.sqrt(t*t+i*i+r*r)},o.len=o.length,o.squaredLength=function(e){var t=e[0],i=e[1],r=e[2];return t*t+i*i+r*r},o.sqrLen=o.squaredLength,o.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},o.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e},o.normalize=function(e,t){var i=t[0],r=t[1],o=t[2],n=i*i+r*r+o*o;return n>0&&(n=1/Math.sqrt(n),e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n),e},o.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},o.cross=function(e,t,i){var r=t[0],o=t[1],n=t[2],s=i[0],a=i[1],l=i[2];return e[0]=o*l-n*a,e[1]=n*s-r*l,e[2]=r*a-o*s,e},o.lerp=function(e,t,i,r){var o=t[0],n=t[1],s=t[2];return e[0]=o+r*(i[0]-o),e[1]=n+r*(i[1]-n),e[2]=s+r*(i[2]-s),e},o.hermite=function(e,t,i,r,o,n){var s=n*n,a=s*(2*n-3)+1,l=s*(n-2)+n,c=s*(n-1),u=s*(3-2*n);return e[0]=t[0]*a+i[0]*l+r[0]*c+o[0]*u,e[1]=t[1]*a+i[1]*l+r[1]*c+o[1]*u,e[2]=t[2]*a+i[2]*l+r[2]*c+o[2]*u,e},o.bezier=function(e,t,i,r,o,n){var s=1-n,a=s*s,l=n*n,c=a*s,u=3*n*a,h=3*l*s,d=l*n;return e[0]=t[0]*c+i[0]*u+r[0]*h+o[0]*d,e[1]=t[1]*c+i[1]*u+r[1]*h+o[1]*d,e[2]=t[2]*c+i[2]*u+r[2]*h+o[2]*d,e},o.random=function(e,t){t=t||1;var i=2*Math.random()*Math.PI,r=2*Math.random()-1,o=Math.sqrt(1-r*r)*t;return e[0]=Math.cos(i)*o,e[1]=Math.sin(i)*o,e[2]=r*t,e},o.transformMatrix44=function(e,t,i){var r=t[0],o=t[1],n=t[2];return e[0]=i[0]*r+i[4]*o+i[8]*n+i[12],e[1]=i[1]*r+i[5]*o+i[9]*n+i[13],e[2]=i[2]*r+i[6]*o+i[10]*n+i[14],e},o.transformAsDirectionMatrix44=function(e,t,i){var r=t[0],o=t[1],n=t[2];return e[0]=i[0]*r+i[4]*o+i[8]*n,e[1]=i[1]*r+i[5]*o+i[9]*n,e[2]=i[2]*r+i[6]*o+i[10]*n,e},o.transformMatrix33=function(e,t,i){var r=t[0],o=t[1],n=t[2];return e[0]=r*i[0]+o*i[3]+n*i[6],e[1]=r*i[1]+o*i[4]+n*i[7],e[2]=r*i[2]+o*i[5]+n*i[8],e},o.transformQuat=function(e,t,i){var r=t[0],o=t[1],n=t[2],s=i[0],a=i[1],l=i[2],c=i[3],u=c*r+a*n-l*o,h=c*o+l*r-s*n,d=c*n+s*o-a*r,p=-s*r-a*o-l*n;return e[0]=u*c+p*-s+h*-l-d*-a,e[1]=h*c+p*-a+d*-s-u*-l,e[2]=d*c+p*-l+u*-a-h*-s,e},o.setFromMatrixScale=function(e,t){var i=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]),r=Math.sqrt(t[4]*t[4]+t[5]*t[5]+t[6]*t[6]),o=Math.sqrt(t[8]*t[8]+t[9]*t[9]+t[10]*t[10]);return e[0]=i,e[1]=r,e[2]=o,e},o.rotateX=function(e,t,i,r){var o=[],n=[];return o[0]=t[0]-i[0],o[1]=t[1]-i[1],o[2]=t[2]-i[2],n[0]=o[0],n[1]=o[1]*Math.cos(r)-o[2]*Math.sin(r),n[2]=o[1]*Math.sin(r)+o[2]*Math.cos(r),e[0]=n[0]+i[0],e[1]=n[1]+i[1],e[2]=n[2]+i[2],e},o.rotateY=function(e,t,i,r){var o=[],n=[];return o[0]=t[0]-i[0],o[1]=t[1]-i[1],o[2]=t[2]-i[2],n[0]=o[2]*Math.sin(r)+o[0]*Math.cos(r),n[1]=o[1],n[2]=o[2]*Math.cos(r)-o[0]*Math.sin(r),e[0]=n[0]+i[0],e[1]=n[1]+i[1],e[2]=n[2]+i[2],e},o.rotateZ=function(e,t,i,r){var o=[],n=[];return o[0]=t[0]-i[0],o[1]=t[1]-i[1],o[2]=t[2]-i[2],n[0]=o[0]*Math.cos(r)-o[1]*Math.sin(r),n[1]=o[0]*Math.sin(r)+o[1]*Math.cos(r),n[2]=o[2],e[0]=n[0]+i[0],e[1]=n[1]+i[1],e[2]=n[2]+i[2],e},o.angle=function(e,t){var i=o.clone(e),r=o.clone(t);o.normalize(i,i),o.normalize(r,r);var n=o.dot(i,r),s=o.length(o.cross(i,i,r));return Math.atan2(s,n)},o.isParallel=function(e,t,i,n){n=n||r.b,i=i||0;var s=o.createFloat64();return o.cross(s,e,t),!(o.squaredLength(s)>n*n*o.squaredLength(e)*o.squaredLength(t))&&(i>0?o.dot(e,t)>0:!(i<0)||o.dot(e,t)<0)},o.isOrthogonal=function(e,t,i){i=i||r.b;var n=o.dot(e,t);return n*n<=i*i*o.squaredLength(e)*o.squaredLength(t)},o.computeOrthogonal=function(e,t){return t[0]*t[0]>t[2]*t[2]?o.set(e,t[1],-t[0],0):o.set(e,0,t[2],-t[1]),e},o.setEulerFromRotationMatrix=function(e,t,i){var o=1-r.b;function n(e){return Math.min(Math.max(e,-1),1)}var s=t[0],a=t[4],l=t[8],c=t[1],u=t[5],h=t[9],d=t[2],p=t[6],g=t[10];return void 0===i||"XYZ"===i?(e[1]=Math.asin(n(l)),Math.abs(l)<o?(e[0]=Math.atan2(-h,g),e[2]=Math.atan2(-a,s)):(e[0]=Math.atan2(p,u),e[2]=0)):"YXZ"===i?(e[0]=Math.asin(-n(h)),Math.abs(h)<o?(e[1]=Math.atan2(l,g),e[2]=Math.atan2(c,u)):(e[1]=Math.atan2(-d,s),e[2]=0)):"ZXY"===i?(e[0]=Math.asin(n(p)),Math.abs(p)<o?(e[1]=Math.atan2(-d,g),e[2]=Math.atan2(-a,u)):(e[1]=0,e[2]=Math.atan2(c,s))):"ZYX"===i?(e[1]=Math.asin(-n(d)),Math.abs(d)<o?(e[0]=Math.atan2(p,g),e[2]=Math.atan2(c,s)):(e[0]=0,e[2]=Math.atan2(-a,u))):"YZX"===i?(e[2]=Math.asin(n(c)),Math.abs(c)<o?(e[0]=Math.atan2(-h,u),e[1]=Math.atan2(-d,s)):(e[0]=0,e[1]=Math.atan2(l,g))):"XZY"===i&&(e[2]=Math.asin(-n(a)),Math.abs(a)<o?(e[0]=Math.atan2(p,u),e[1]=Math.atan2(l,s)):(e[0]=Math.atan2(-h,g),e[1]=0)),e},o.toString=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+"]"},o.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},o.equals=function(e,t,i){return i=i||r.b,Math.abs(e[0]-t[0])<=i&&Math.abs(e[1]-t[1])<=i&&Math.abs(e[2]-t[2])<=i},t.a=o},function(e,t,i){"use strict";var r=i(0),o={createFloat32:function(){var e=new Float32Array(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e},createFloat64:function(){var e=new Float64Array(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e},createNumber:function(){return[0,0,0,0]},clone:function(e){var t=new e.constructor(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},createFloat32FromValues:function(e,t,i,r){var o=new Float32Array(4);return o[0]=e,o[1]=t,o[2]=i,o[3]=r,o}};o.asFloat32=o.createFloat32FromValues,o.createFloat64FromValues=function(e,t,i,r){var o=new Float64Array(4);return o[0]=e,o[1]=t,o[2]=i,o[3]=r,o},o.asFloat64=o.createFloat64FromValues,o.createNumberFromValues=function(e,t,i,r){return[e,t,i,r]},o.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},o.set=function(e,t,i,r,o){return e[0]=t,e[1]=i,e[2]=r,e[3]=o,e},o.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e},o.subtract=function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e},o.sub=o.subtract,o.multiply=function(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e[2]=t[2]*i[2],e[3]=t[3]*i[3],e},o.mul=o.multiply,o.divide=function(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e[2]=t[2]/i[2],e[3]=t[3]/i[3],e},o.div=o.divide,o.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e},o.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e},o.min=function(e,t,i){return e[0]=Math.min(t[0],i[0]),e[1]=Math.min(t[1],i[1]),e[2]=Math.min(t[2],i[2]),e[3]=Math.min(t[3],i[3]),e},o.max=function(e,t,i){return e[0]=Math.max(t[0],i[0]),e[1]=Math.max(t[1],i[1]),e[2]=Math.max(t[2],i[2]),e[3]=Math.max(t[3],i[3]),e},o.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e},o.scale=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e},o.scaleAndAdd=function(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e[2]=t[2]+i[2]*r,e[3]=t[3]+i[3]*r,e},o.distance=function(e,t){var i=t[0]-e[0],r=t[1]-e[1],o=t[2]-e[2],n=t[3]-e[3];return Math.sqrt(i*i+r*r+o*o+n*n)},o.dist=o.distance,o.squaredDistance=function(e,t){var i=t[0]-e[0],r=t[1]-e[1],o=t[2]-e[2],n=t[3]-e[3];return i*i+r*r+o*o+n*n},o.sqrDist=o.squaredDistance,o.length=function(e){var t=e[0],i=e[1],r=e[2],o=e[3];return Math.sqrt(t*t+i*i+r*r+o*o)},o.len=o.length,o.squaredLength=function(e){var t=e[0],i=e[1],r=e[2],o=e[3];return t*t+i*i+r*r+o*o},o.sqrLen=o.squaredLength,o.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},o.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e},o.normalize=function(e,t){var i=t[0],r=t[1],o=t[2],n=t[3],s=i*i+r*r+o*o+n*n;return s>0&&(s=1/Math.sqrt(s),e[0]=i*s,e[1]=r*s,e[2]=o*s,e[3]=n*s),e},o.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},o.lerp=function(e,t,i,r){var o=t[0],n=t[1],s=t[2],a=t[3];return e[0]=o+r*(i[0]-o),e[1]=n+r*(i[1]-n),e[2]=s+r*(i[2]-s),e[3]=a+r*(i[3]-a),e},o.random=function(e,t){return t=t||1,e[0]=Math.random(),e[1]=Math.random(),e[2]=Math.random(),e[3]=Math.random(),o.normalize(e,e),o.scale(e,e,t),e},o.transformMatrix44=function(e,t,i){var r=t[0],o=t[1],n=t[2],s=t[3];return e[0]=i[0]*r+i[4]*o+i[8]*n+i[12]*s,e[1]=i[1]*r+i[5]*o+i[9]*n+i[13]*s,e[2]=i[2]*r+i[6]*o+i[10]*n+i[14]*s,e[3]=i[3]*r+i[7]*o+i[11]*n+i[15]*s,e},o.transformQuat=function(e,t,i){var r=t[0],o=t[1],n=t[2],s=i[0],a=i[1],l=i[2],c=i[3],u=c*r+a*n-l*o,h=c*o+l*r-s*n,d=c*n+s*o-a*r,p=-s*r-a*o-l*n;return e[0]=u*c+p*-s+h*-l-d*-a,e[1]=h*c+p*-a+d*-s-u*-l,e[2]=d*c+p*-l+u*-a-h*-s,e[3]=t[3],e},o.toString=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+"]"},o.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},o.equals=function(e,t,i){return i=i||r.b,Math.abs(e[0]-t[0])<=i&&Math.abs(e[1]-t[1])<=i&&Math.abs(e[2]-t[2])<=i&&Math.abs(e[2]-t[2])<=i},t.a=o},function(e,t,i){"use strict";var r=i(0),o={createFloat32:function(){var e=new Float32Array(9);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},createFloat64:function(){var e=new Float64Array(9);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},createNumber:function(){return[1,0,0,0,1,0,0,0,1]},fromMatrix44:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},clone:function(e){var t=new e.constructor(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},createFloat32FromValues:function(e,t,i,r,o,n,s,a,l){var c=new Float32Array(9);return c[0]=e,c[1]=t,c[2]=i,c[3]=r,c[4]=o,c[5]=n,c[6]=s,c[7]=a,c[8]=l,c}};o.asFloat32=o.createFloat32FromValues,o.createFloat64FromValues=function(e,t,i,r,o,n,s,a,l){var c=new Float64Array(9);return c[0]=e,c[1]=t,c[2]=i,c[3]=r,c[4]=o,c[5]=n,c[6]=s,c[7]=a,c[8]=l,c},o.asFloat64=o.createFloat64FromValues,o.createNumberFromValues=function(e,t,i,r,o,n,s,a,l){return[e,t,i,r,o,n,s,a,l]},o.set=function(e,t,i,r,o,n,s,a,l,c){return e[0]=t,e[1]=i,e[2]=r,e[3]=o,e[4]=n,e[5]=s,e[6]=a,e[7]=l,e[8]=c,e},o.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},o.transpose=function(e,t){if(e===t){var i=t[1],r=t[2],o=t[5];e[1]=t[3],e[2]=t[6],e[3]=i,e[5]=t[7],e[6]=r,e[7]=o}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e},o.invert=function(e,t){var i=t[0],r=t[1],o=t[2],n=t[3],s=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=u*s-a*c,d=-u*n+a*l,p=c*n-s*l,g=i*h+r*d+o*p;return g?(g=1/g,e[0]=h*g,e[1]=(-u*r+o*c)*g,e[2]=(a*r-o*s)*g,e[3]=d*g,e[4]=(u*i-o*l)*g,e[5]=(-a*i+o*n)*g,e[6]=p*g,e[7]=(-c*i+r*l)*g,e[8]=(s*i-r*n)*g,e):null},o.determinant=function(e){var t=e[0],i=e[1],r=e[2],o=e[3],n=e[4],s=e[5],a=e[6],l=e[7],c=e[8];return t*(c*n-s*l)+i*(-c*o+s*a)+r*(l*o-n*a)},o.multiply=function(e,t,i){var r=t[0],o=t[1],n=t[2],s=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=i[0],p=i[1],g=i[2],f=i[3],v=i[4],m=i[5],y=i[6],_=i[7],E=i[8];return e[0]=d*r+p*s+g*c,e[1]=d*o+p*a+g*u,e[2]=d*n+p*l+g*h,e[3]=f*r+v*s+m*c,e[4]=f*o+v*a+m*u,e[5]=f*n+v*l+m*h,e[6]=y*r+_*s+E*c,e[7]=y*o+_*a+E*u,e[8]=y*n+_*l+E*h,e},o.mul=o.multiply,o.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e},o.fromRotation=function(e,t){var i=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=i,e[2]=0,e[3]=-i,e[4]=r,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},o.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},o.fromQuat=function(e,t){var i=t[0],r=t[1],o=t[2],n=t[3],s=i+i,a=r+r,l=o+o,c=i*s,u=r*s,h=r*a,d=o*s,p=o*a,g=o*l,f=n*s,v=n*a,m=n*l;return e[0]=1-h-g,e[3]=u-m,e[6]=d+v,e[1]=u+m,e[4]=1-c-g,e[7]=p-f,e[2]=d-v,e[5]=p+f,e[8]=1-c-h,e},o.normalFromMatrix44=function(e,t){var i=t[0],r=t[1],o=t[2],n=t[3],s=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],p=t[11],g=t[12],f=t[13],v=t[14],m=t[15],y=i*a-r*s,_=i*l-o*s,E=i*c-n*s,A=r*l-o*a,x=r*c-n*a,C=o*c-n*l,w=u*f-h*g,b=u*v-d*g,M=u*m-p*g,T=h*v-d*f,V=h*m-p*f,S=d*m-p*v,L=y*S-_*V+E*T+A*M-x*b+C*w;return L?(L=1/L,e[0]=(a*S-l*V+c*T)*L,e[1]=(l*M-s*S-c*b)*L,e[2]=(s*V-a*M+c*w)*L,e[3]=(o*V-r*S-n*T)*L,e[4]=(i*S-o*M+n*b)*L,e[5]=(r*M-i*V-n*w)*L,e[6]=(f*C-v*x+m*A)*L,e[7]=(v*E-g*C-m*_)*L,e[8]=(g*x-f*E+m*y)*L,e):null},o.toString=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+"]"},o.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e[4]=t[4]+i[4],e[5]=t[5]+i[5],e[6]=t[6]+i[6],e[7]=t[7]+i[7],e[8]=t[8]+i[8],e},o.subtract=function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e[4]=t[4]-i[4],e[5]=t[5]-i[5],e[6]=t[6]-i[6],e[7]=t[7]-i[7],e[8]=t[8]-i[8],e},o.sub=o.subtract,o.multiplyScalar=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*i,e},o.multiplyScalarAndAdd=function(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e[2]=t[2]+i[2]*r,e[3]=t[3]+i[3]*r,e[4]=t[4]+i[4]*r,e[5]=t[5]+i[5]*r,e[6]=t[6]+i[6]*r,e[7]=t[7]+i[7]*r,e[8]=t[8]+i[8]*r,e},o.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]},o.equals=function(e,t,i){return i=i||r.b,Math.abs(e[0]-t[0])<=i&&Math.abs(e[1]-t[1])<=i&&Math.abs(e[2]-t[2])<=i&&Math.abs(e[3]-t[3])<=i&&Math.abs(e[4]-t[4])<=i&&Math.abs(e[5]-t[5])<=i&&Math.abs(e[6]-t[6])<=i&&Math.abs(e[7]-t[7])<=i&&Math.abs(e[8]-t[8])<=i},t.a=o},function(e,t,i){"use strict";var r=i(0),o={createFloat32:function(){var e=new Float32Array(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},createFloat64:function(){var e=new Float64Array(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},createNumber:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},clone:function(e){var t=new e.constructor(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},createFloat32FromValues:function(e,t,i,r,o,n,s,a,l,c,u,h,d,p,g,f){var v=new Float32Array(16);return v[0]=e,v[1]=t,v[2]=i,v[3]=r,v[4]=o,v[5]=n,v[6]=s,v[7]=a,v[8]=l,v[9]=c,v[10]=u,v[11]=h,v[12]=d,v[13]=p,v[14]=g,v[15]=f,v}};o.asFloat32=o.createFloat32FromValues,o.createFloat64FromValues=function(e,t,i,r,o,n,s,a,l,c,u,h,d,p,g,f){var v=new Float64Array(16);return v[0]=e,v[1]=t,v[2]=i,v[3]=r,v[4]=o,v[5]=n,v[6]=s,v[7]=a,v[8]=l,v[9]=c,v[10]=u,v[11]=h,v[12]=d,v[13]=p,v[14]=g,v[15]=f,v},o.asFloat64=o.createFloat64FromValues,o.createNumberFromValues=function(e,t,i,r,o,n,s,a,l,c,u,h,d,p,g,f){return[e,t,i,r,o,n,s,a,l,c,u,h,d,p,g,f]},o.set=function(e,t,i,r,o,n,s,a,l,c,u,h,d,p,g,f,v){return e[0]=t,e[1]=i,e[2]=r,e[3]=o,e[4]=n,e[5]=s,e[6]=a,e[7]=l,e[8]=c,e[9]=u,e[10]=h,e[11]=d,e[12]=p,e[13]=g,e[14]=f,e[15]=v,e},o.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},o.transpose=function(e,t){if(e===t){var i=t[1],r=t[2],o=t[3],n=t[6],s=t[7],a=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=i,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=n,e[11]=t[14],e[12]=o,e[13]=s,e[14]=a}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e},o.invert=function(e,t){var i=t[0],r=t[1],o=t[2],n=t[3],s=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],p=t[11],g=t[12],f=t[13],v=t[14],m=t[15],y=i*a-r*s,_=i*l-o*s,E=i*c-n*s,A=r*l-o*a,x=r*c-n*a,C=o*c-n*l,w=u*f-h*g,b=u*v-d*g,M=u*m-p*g,T=h*v-d*f,V=h*m-p*f,S=d*m-p*v,L=y*S-_*V+E*T+A*M-x*b+C*w;return L?(L=1/L,e[0]=(a*S-l*V+c*T)*L,e[1]=(o*V-r*S-n*T)*L,e[2]=(f*C-v*x+m*A)*L,e[3]=(d*x-h*C-p*A)*L,e[4]=(l*M-s*S-c*b)*L,e[5]=(i*S-o*M+n*b)*L,e[6]=(v*E-g*C-m*_)*L,e[7]=(u*C-d*E+p*_)*L,e[8]=(s*V-a*M+c*w)*L,e[9]=(r*M-i*V-n*w)*L,e[10]=(g*x-f*E+m*y)*L,e[11]=(h*E-u*x-p*y)*L,e[12]=(a*b-s*T-l*w)*L,e[13]=(i*T-r*b+o*w)*L,e[14]=(f*_-g*A-v*y)*L,e[15]=(u*A-h*_+d*y)*L,e):null},o.determinant=function(e){var t=e[0],i=e[1],r=e[2],o=e[3],n=e[4],s=e[5],a=e[6],l=e[7],c=e[8],u=e[9],h=e[10],d=e[11],p=e[12],g=e[13],f=e[14],v=e[15];return(t*s-i*n)*(h*v-d*f)-(t*a-r*n)*(u*v-d*g)+(t*l-o*n)*(u*f-h*g)+(i*a-r*s)*(c*v-d*p)-(i*l-o*s)*(c*f-h*p)+(r*l-o*a)*(c*g-u*p)},o.multiply=function(e,t,i){var r=t[0],o=t[1],n=t[2],s=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=t[9],p=t[10],g=t[11],f=t[12],v=t[13],m=t[14],y=t[15],_=i[0],E=i[1],A=i[2],x=i[3];return e[0]=_*r+E*a+A*h+x*f,e[1]=_*o+E*l+A*d+x*v,e[2]=_*n+E*c+A*p+x*m,e[3]=_*s+E*u+A*g+x*y,_=i[4],E=i[5],A=i[6],x=i[7],e[4]=_*r+E*a+A*h+x*f,e[5]=_*o+E*l+A*d+x*v,e[6]=_*n+E*c+A*p+x*m,e[7]=_*s+E*u+A*g+x*y,_=i[8],E=i[9],A=i[10],x=i[11],e[8]=_*r+E*a+A*h+x*f,e[9]=_*o+E*l+A*d+x*v,e[10]=_*n+E*c+A*p+x*m,e[11]=_*s+E*u+A*g+x*y,_=i[12],E=i[13],A=i[14],x=i[15],e[12]=_*r+E*a+A*h+x*f,e[13]=_*o+E*l+A*d+x*v,e[14]=_*n+E*c+A*p+x*m,e[15]=_*s+E*u+A*g+x*y,e},o.mul=o.multiply,o.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e},o.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},o.fromRotation=function(e,t,i){var o,n,s,a=i[0],l=i[1],c=i[2],u=Math.sqrt(a*a+l*l+c*c);return Math.abs(u)<r.b?null:(a*=u=1/u,l*=u,c*=u,o=Math.sin(t),s=1-(n=Math.cos(t)),e[0]=a*a*s+n,e[1]=l*a*s+c*o,e[2]=c*a*s-l*o,e[3]=0,e[4]=a*l*s-c*o,e[5]=l*l*s+n,e[6]=c*l*s+a*o,e[7]=0,e[8]=a*c*s+l*o,e[9]=l*c*s-a*o,e[10]=c*c*s+n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)},o.fromXRotation=function(e,t){var i=Math.sin(t),r=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=i,e[7]=0,e[8]=0,e[9]=-i,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},o.fromYRotation=function(e,t){var i=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=0,e[2]=-i,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=i,e[9]=0,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},o.fromZRotation=function(e,t){var i=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=i,e[2]=0,e[3]=0,e[4]=-i,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},o.fromRotationTranslation=function(e,t,i){var r=t[0],o=t[1],n=t[2],s=t[3],a=r+r,l=o+o,c=n+n,u=r*a,h=r*l,d=r*c,p=o*l,g=o*c,f=n*c,v=s*a,m=s*l,y=s*c;return e[0]=1-(p+f),e[1]=h+y,e[2]=d-m,e[3]=0,e[4]=h-y,e[5]=1-(u+f),e[6]=g+v,e[7]=0,e[8]=d+m,e[9]=g-v,e[10]=1-(u+p),e[11]=0,e[12]=i[0],e[13]=i[1],e[14]=i[2],e[15]=1,e},o.getTranslation=function(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e},o.extractRotation=function(e,t){var i=1/Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]),r=1/Math.sqrt(t[4]*t[4]+t[5]*t[5]+t[6]*t[6]),o=1/Math.sqrt(t[8]*t[8]+t[9]*t[9]+t[10]*t[10]);return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=0,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=0,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},o.getRotation=function(e,t){var i=t[0]+t[5]+t[10],r=0;return i>0?(r=2*Math.sqrt(i+1),e[3]=.25*r,e[0]=(t[6]-t[9])/r,e[1]=(t[8]-t[2])/r,e[2]=(t[1]-t[4])/r):t[0]>t[5]&&t[0]>t[10]?(r=2*Math.sqrt(1+t[0]-t[5]-t[10]),e[3]=(t[6]-t[9])/r,e[0]=.25*r,e[1]=(t[1]+t[4])/r,e[2]=(t[8]+t[2])/r):t[5]>t[10]?(r=2*Math.sqrt(1+t[5]-t[0]-t[10]),e[3]=(t[8]-t[2])/r,e[0]=(t[1]+t[4])/r,e[1]=.25*r,e[2]=(t[6]+t[9])/r):(r=2*Math.sqrt(1+t[10]-t[0]-t[5]),e[3]=(t[1]-t[4])/r,e[0]=(t[8]+t[2])/r,e[1]=(t[6]+t[9])/r,e[2]=.25*r),e},o.fromRotationTranslationScale=function(e,t,i,r){var o=t[0],n=t[1],s=t[2],a=t[3],l=o+o,c=n+n,u=s+s,h=o*l,d=o*c,p=o*u,g=n*c,f=n*u,v=s*u,m=a*l,y=a*c,_=a*u,E=r[0],A=r[1],x=r[2];return e[0]=(1-(g+v))*E,e[1]=(d+_)*E,e[2]=(p-y)*E,e[3]=0,e[4]=(d-_)*A,e[5]=(1-(h+v))*A,e[6]=(f+m)*A,e[7]=0,e[8]=(p+y)*x,e[9]=(f-m)*x,e[10]=(1-(h+g))*x,e[11]=0,e[12]=i[0],e[13]=i[1],e[14]=i[2],e[15]=1,e},o.fromRotationTranslationScaleOrigin=function(e,t,i,r,o){var n=t[0],s=t[1],a=t[2],l=t[3],c=n+n,u=s+s,h=a+a,d=n*c,p=n*u,g=n*h,f=s*u,v=s*h,m=a*h,y=l*c,_=l*u,E=l*h,A=r[0],x=r[1],C=r[2],w=o[0],b=o[1],M=o[2];return e[0]=(1-(f+m))*A,e[1]=(p+E)*A,e[2]=(g-_)*A,e[3]=0,e[4]=(p-E)*x,e[5]=(1-(d+m))*x,e[6]=(v+y)*x,e[7]=0,e[8]=(g+_)*C,e[9]=(v-y)*C,e[10]=(1-(d+f))*C,e[11]=0,e[12]=i[0]+w-(e[0]*w+e[4]*b+e[8]*M),e[13]=i[1]+b-(e[1]*w+e[5]*b+e[9]*M),e[14]=i[2]+M-(e[2]*w+e[6]*b+e[10]*M),e[15]=1,e},o.fromQuat=function(e,t){var i=t[0],r=t[1],o=t[2],n=t[3],s=i+i,a=r+r,l=o+o,c=i*s,u=r*s,h=r*a,d=o*s,p=o*a,g=o*l,f=n*s,v=n*a,m=n*l;return e[0]=1-h-g,e[1]=u+m,e[2]=d-v,e[3]=0,e[4]=u-m,e[5]=1-c-g,e[6]=p+f,e[7]=0,e[8]=d+v,e[9]=p-f,e[10]=1-c-h,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},o.setRotationFromEuler=function(e,t,i){var r=t[0],o=t[1],n=t[2],s=Math.cos(r),a=Math.sin(r),l=Math.cos(o),c=Math.sin(o),u=Math.cos(n),h=Math.sin(n);if(void 0===i||"XYZ"===i){var d=s*u,p=s*h,g=a*u,f=a*h;e[0]=l*u,e[4]=-l*h,e[8]=c,e[1]=p+g*c,e[5]=d-f*c,e[9]=-a*l,e[2]=f-d*c,e[6]=g+p*c,e[10]=s*l}else if("YXZ"===i){var v=l*u,m=l*h,y=c*u,_=c*h;e[0]=v+_*a,e[4]=y*a-m,e[8]=s*c,e[1]=s*h,e[5]=s*u,e[9]=-a,e[2]=m*a-y,e[6]=_+v*a,e[10]=s*l}else if("ZXY"===i)v=l*u,m=l*h,y=c*u,_=c*h,e[0]=v-_*a,e[4]=-s*h,e[8]=y+m*a,e[1]=m+y*a,e[5]=s*u,e[9]=_-v*a,e[2]=-s*c,e[6]=a,e[10]=s*l;else if("ZYX"===i)d=s*u,p=s*h,g=a*u,f=a*h,e[0]=l*u,e[4]=g*c-p,e[8]=d*c+f,e[1]=l*h,e[5]=f*c+d,e[9]=p*c-g,e[2]=-c,e[6]=a*l,e[10]=s*l;else if("YZX"===i){var E=s*l,A=s*c,x=a*l,C=a*c;e[0]=l*u,e[4]=C-E*h,e[8]=x*h+A,e[1]=h,e[5]=s*u,e[9]=-a*u,e[2]=-c*u,e[6]=A*h+x,e[10]=E-C*h}else"XZY"===i&&(E=s*l,A=s*c,x=a*l,C=a*c,e[0]=l*u,e[4]=-h,e[8]=c*u,e[1]=E*h+C,e[5]=s*u,e[9]=A*h-x,e[2]=x*h-A,e[6]=a*u,e[10]=C*h+E);return e},o.toString=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+"]"},o.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e[4]=t[4]+i[4],e[5]=t[5]+i[5],e[6]=t[6]+i[6],e[7]=t[7]+i[7],e[8]=t[8]+i[8],e[9]=t[9]+i[9],e[10]=t[10]+i[10],e[11]=t[11]+i[11],e[12]=t[12]+i[12],e[13]=t[13]+i[13],e[14]=t[14]+i[14],e[15]=t[15]+i[15],e},o.subtract=function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e[4]=t[4]-i[4],e[5]=t[5]-i[5],e[6]=t[6]-i[6],e[7]=t[7]-i[7],e[8]=t[8]-i[8],e[9]=t[9]-i[9],e[10]=t[10]-i[10],e[11]=t[11]-i[11],e[12]=t[12]-i[12],e[13]=t[13]-i[13],e[14]=t[14]-i[14],e[15]=t[15]-i[15],e},o.sub=o.subtract,o.multiplyScalar=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*i,e[9]=t[9]*i,e[10]=t[10]*i,e[11]=t[11]*i,e[12]=t[12]*i,e[13]=t[13]*i,e[14]=t[14]*i,e[15]=t[15]*i,e},o.multiplyScalarAndAdd=function(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e[2]=t[2]+i[2]*r,e[3]=t[3]+i[3]*r,e[4]=t[4]+i[4]*r,e[5]=t[5]+i[5]*r,e[6]=t[6]+i[6]*r,e[7]=t[7]+i[7]*r,e[8]=t[8]+i[8]*r,e[9]=t[9]+i[9]*r,e[10]=t[10]+i[10]*r,e[11]=t[11]+i[11]*r,e[12]=t[12]+i[12]*r,e[13]=t[13]+i[13]*r,e[14]=t[14]+i[14]*r,e[15]=t[15]+i[15]*r,e},o.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]},o.equals=function(e,t,i){return i=i||r.b,Math.abs(e[0]-t[0])<=i&&Math.abs(e[1]-t[1])<=i&&Math.abs(e[2]-t[2])<=i&&Math.abs(e[3]-t[3])<=i&&Math.abs(e[4]-t[4])<=i&&Math.abs(e[5]-t[5])<=i&&Math.abs(e[6]-t[6])<=i&&Math.abs(e[7]-t[7])<=i&&Math.abs(e[8]-t[8])<=i&&Math.abs(e[9]-t[9])<=i&&Math.abs(e[10]-t[10])<=i&&Math.abs(e[11]-t[11])<=i&&Math.abs(e[12]-t[12])<=i&&Math.abs(e[13]-t[13])<=i&&Math.abs(e[14]-t[14])<=i&&Math.abs(e[15]-t[15])<=i},t.a=o},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(6),o=i(1),n=i(2),s=i(7),a=i(3),l=i(4),c=i(8),u=i(9),h=i(0);i.d(t,"Vector2",(function(){return r.a})),i.d(t,"Vector3",(function(){return o.a})),i.d(t,"Vector4",(function(){return n.a})),i.d(t,"Matrix22",(function(){return s.a})),i.d(t,"Matrix33",(function(){return a.a})),i.d(t,"Matrix44",(function(){return l.a})),i.d(t,"Quat",(function(){return c.a})),i.d(t,"ProjectionUtils",(function(){return u.a})),i.d(t,"FLOAT64_TOLERANCE",(function(){return h.b})),i.d(t,"FLOAT32_TOLERANCE",(function(){return h.a})),t.default={Vector2:r.a,Vector3:o.a,Vector4:n.a,Matrix22:s.a,Matrix33:a.a,Matrix44:l.a,Quat:c.a,ProjectionUtils:u.a,FLOAT64_TOLERANCE:h.b,FLOAT32_TOLERANCE:h.a}},function(e,t,i){"use strict";var r=i(0),o={createFloat32:function(){var e=new Float32Array(2);return e[0]=0,e[1]=0,e},createFloat64:function(){var e=new Float64Array(2);return e[0]=0,e[1]=0,e},createNumber:function(){return[0,0]},clone:function(e){var t=new e.constructor(2);return t[0]=e[0],t[1]=e[1],t},createFloat32FromValues:function(e,t){var i=new Float32Array(2);return i[0]=e,i[1]=t,i}};o.asFloat32=o.createFloat32FromValues,o.createFloat64FromValues=function(e,t){var i=new Float64Array(2);return i[0]=e,i[1]=t,i},o.asFloat64=o.createFloat64FromValues,o.createNumberFromValues=function(e,t){return[e,t]},o.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e},o.set=function(e,t,i){return e[0]=t,e[1]=i,e},o.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e},o.subtract=function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e},o.sub=o.subtract,o.multiply=function(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e},o.mul=o.multiply,o.divide=function(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e},o.div=o.divide,o.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e},o.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e},o.min=function(e,t,i){return e[0]=Math.min(t[0],i[0]),e[1]=Math.min(t[1],i[1]),e},o.max=function(e,t,i){return e[0]=Math.max(t[0],i[0]),e[1]=Math.max(t[1],i[1]),e},o.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e},o.scale=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e},o.scaleAndAdd=function(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e},o.distance=function(e,t){var i=t[0]-e[0],r=t[1]-e[1];return Math.sqrt(i*i+r*r)},o.dist=o.distance,o.squaredDistance=function(e,t){var i=t[0]-e[0],r=t[1]-e[1];return i*i+r*r},o.sqrDist=o.squaredDistance,o.length=function(e){var t=e[0],i=e[1];return Math.sqrt(t*t+i*i)},o.len=o.length,o.squaredLength=function(e){var t=e[0],i=e[1];return t*t+i*i},o.sqrLen=o.squaredLength,o.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e},o.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e},o.normalize=function(e,t){var i=t[0],r=t[1],o=i*i+r*r;return o>0&&(o=1/Math.sqrt(o),e[0]=t[0]*o,e[1]=t[1]*o),e},o.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]},o.cross=function(e,t,i){var r=t[0]*i[1]-t[1]*i[0];return e[0]=e[1]=0,e[2]=r,e},o.lerp=function(e,t,i,r){var o=t[0],n=t[1];return e[0]=o+r*(i[0]-o),e[1]=n+r*(i[1]-n),e},o.random=function(e,t){t=t||1;var i=2*Math.random()*Math.PI;return e[0]=Math.cos(i)*t,e[1]=Math.sin(i)*t,e},o.transformMatrix22=function(e,t,i){var r=t[0],o=t[1];return e[0]=i[0]*r+i[2]*o,e[1]=i[1]*r+i[3]*o,e},o.transformMatrix33=function(e,t,i){var r=t[0],o=t[1];return e[0]=i[0]*r+i[3]*o+i[6],e[1]=i[1]*r+i[4]*o+i[7],e},o.transformMatrix44=function(e,t,i){var r=t[0],o=t[1];return e[0]=i[0]*r+i[4]*o+i[12],e[1]=i[1]*r+i[5]*o+i[13],e},o.angle=function(e,t){var i=o.clone(e),r=o.clone(t);o.normalize(i,i),o.normalize(r,r);var n=o.dot(i,r),s=Math.abs(i[0]*r[1]-i[1]*r[0]);return Math.atan2(s,n)},o.isParallel=function(e,t,i,n){n=n||r.b,i=i||0;var s=e[0]*t[1]-e[1]*t[0];return!(s*s>n*n*o.squaredLength(e)*o.squaredLength(t))&&(i>0?o.dot(e,t)>0:!(i<0)||o.dot(e,t)<0)},o.isOrthogonal=function(e,t,i){i=i||r.b;var n=o.dot(e,t);return n*n<=i*i*o.squaredLength(e)*o.squaredLength(t)},o.toString=function(e){return"["+e[0]+", "+e[1]+"]"},o.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]},o.equals=function(e,t,i){return i=i||r.b,Math.abs(e[0]-t[0])<=i&&Math.abs(e[1]-t[1])<=i},t.a=o},function(e,t,i){"use strict";var r=i(0),o={createFloat32:function(){var e=new Float32Array(4);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},createFloat64:function(){var e=new Float64Array(4);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},createNumber:function(){return[1,0,0,1]},clone:function(e){var t=new e.constructor(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},createFloat32FromValues:function(e,t,i,r){var o=new Float32Array(4);return o[0]=e,o[1]=t,o[2]=i,o[3]=r,o}};o.asFloat32=o.createFloat32FromValues,o.createFloat64FromValues=function(e,t,i,r){var o=new Float64Array(4);return o[0]=e,o[1]=t,o[2]=i,o[3]=r,o},o.asFloat64=o.createFloat64FromValues,o.createNumberFromValues=function(e,t,i,r){return[e,t,i,r]},o.set=function(e,t,i,r,o){return e[0]=t,e[1]=i,e[2]=r,e[3]=o,e},o.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},o.transpose=function(e,t){if(e===t){var i=t[1];e[1]=t[2],e[2]=i}else e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3];return e},o.invert=function(e,t){var i=t[0],r=t[1],o=t[2],n=t[3],s=i*n-o*r;return s?(s=1/s,e[0]=n*s,e[1]=-r*s,e[2]=-o*s,e[3]=i*s,e):null},o.determinant=function(e){return e[0]*e[3]-e[2]*e[1]},o.multiply=function(e,t,i){var r=t[0],o=t[1],n=t[2],s=t[3],a=i[0],l=i[1],c=i[2],u=i[3];return e[0]=r*a+n*l,e[1]=o*a+s*l,e[2]=r*c+n*u,e[3]=o*c+s*u,e},o.mul=o.multiply,o.scale=function(e,t,i){var r=t[0],o=t[1],n=t[2],s=t[3],a=i[0],l=i[1];return e[0]=r*a,e[1]=o*a,e[2]=n*l,e[3]=s*l,e},o.toString=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+"]"},o.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e},o.subtract=function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e},o.sub=o.subtract,o.multiplyScalar=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e},o.multiplyScalarAndAdd=function(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e[2]=t[2]+i[2]*r,e[3]=t[3]+i[3]*r,e},o.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},o.equals=function(e,t,i){return i=i||r.b,Math.abs(e[0]-t[0])<=i&&Math.abs(e[1]-t[1])<=i&&Math.abs(e[2]-t[2])<=i&&Math.abs(e[3]-t[3])<=i},t.a=o},function(e,t,i){"use strict";var r,o,n,s,a,l,c=i(0),u=i(1),h=i(2),d=i(3),p={createFloat32:function(){var e=new Float32Array(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},createFloat64:function(){var e=new Float64Array(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},createNumber:function(){return[0,0,0,1]}};p.rotationTo=(r=u.a.createFloat64(),o=u.a.createFloat64FromValues(1,0,0),n=u.a.createFloat64FromValues(0,1,0),function(e,t,i){var s=u.a.dot(t,i);return s<-1+c.b?(u.a.cross(r,o,t),u.a.length(r)<c.b&&u.a.cross(r,n,t),u.a.normalize(r,r),p.setAxisAngle(e,r,Math.PI),e):s>1-c.b?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(u.a.cross(r,t,i),e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=1+s,p.normalize(e,e))}),p.setAxes=(s=d.a.createFloat64(),function(e,t,i,r){return s[0]=i[0],s[3]=i[1],s[6]=i[2],s[1]=r[0],s[4]=r[1],s[7]=r[2],s[2]=-t[0],s[5]=-t[1],s[8]=-t[2],p.normalize(e,p.fromMatrix33(e,s))}),p.clone=h.a.clone,p.createFloat32FromValues=h.a.createFloat32FromValues,p.createFloat64FromValues=h.a.createFloat64FromValues,p.createNumberFromValues=h.a.createNumberFromValues,p.asFloat32=h.a.createFloat32FromValues,p.asFloat64=h.a.createFloat64FromValues,p.copy=h.a.copy,p.set=h.a.set,p.identity=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},p.setAxisAngle=function(e,t,i){i*=.5;var r=Math.sin(i);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(i),e},p.getAxisAngle=function(e,t){var i=2*Math.acos(t[3]),r=Math.sin(i/2);return 0!==r?(e[0]=t[0]/r,e[1]=t[1]/r,e[2]=t[2]/r):(e[0]=1,e[1]=0,e[2]=0),i},p.add=h.a.add,p.multiply=function(e,t,i){var r=t[0],o=t[1],n=t[2],s=t[3],a=i[0],l=i[1],c=i[2],u=i[3];return e[0]=r*u+s*a+o*c-n*l,e[1]=o*u+s*l+n*a-r*c,e[2]=n*u+s*c+r*l-o*a,e[3]=s*u-r*a-o*l-n*c,e},p.mul=p.multiply,p.scale=h.a.scale,p.rotateX=function(e,t,i){i*=.5;var r=t[0],o=t[1],n=t[2],s=t[3],a=Math.sin(i),l=Math.cos(i);return e[0]=r*l+s*a,e[1]=o*l+n*a,e[2]=n*l-o*a,e[3]=s*l-r*a,e},p.rotateY=function(e,t,i){i*=.5;var r=t[0],o=t[1],n=t[2],s=t[3],a=Math.sin(i),l=Math.cos(i);return e[0]=r*l-n*a,e[1]=o*l+s*a,e[2]=n*l+r*a,e[3]=s*l-o*a,e},p.rotateZ=function(e,t,i){i*=.5;var r=t[0],o=t[1],n=t[2],s=t[3],a=Math.sin(i),l=Math.cos(i);return e[0]=r*l+o*a,e[1]=o*l-r*a,e[2]=n*l+s*a,e[3]=s*l-n*a,e},p.calculateW=function(e,t){var i=t[0],r=t[1],o=t[2];return e[0]=i,e[1]=r,e[2]=o,e[3]=Math.sqrt(Math.abs(1-i*i-r*r-o*o)),e},p.dot=h.a.dot,p.lerp=h.a.lerp,p.slerp=function(e,t,i,r){var o,n,s,a,l,u=t[0],h=t[1],d=t[2],p=t[3],g=i[0],f=i[1],v=i[2],m=i[3];return(n=u*g+h*f+d*v+p*m)<0&&(n=-n,g=-g,f=-f,v=-v,m=-m),1-n>c.b?(o=Math.acos(n),s=Math.sin(o),a=Math.sin((1-r)*o)/s,l=Math.sin(r*o)/s):(a=1-r,l=r),e[0]=a*u+l*g,e[1]=a*h+l*f,e[2]=a*d+l*v,e[3]=a*p+l*m,e},p.sqlerp=(a=p.createFloat64(),l=p.createFloat64(),function(e,t,i,r,o,n){return p.slerp(a,t,o,n),p.slerp(l,i,r,n),p.slerp(e,a,l,2*n*(1-n)),e}),p.invert=function(e,t){var i=t[0],r=t[1],o=t[2],n=t[3],s=i*i+r*r+o*o+n*n,a=s?1/s:0;return e[0]=-i*a,e[1]=-r*a,e[2]=-o*a,e[3]=n*a,e},p.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e},p.length=h.a.length,p.len=p.length,p.squaredLength=h.a.squaredLength,p.sqrLen=p.squaredLength,p.normalize=h.a.normalize,p.fromMatrix33=function(e,t){var i,r=t[0]+t[4]+t[8];if(r>0)i=Math.sqrt(r+1),e[3]=.5*i,i=.5/i,e[0]=(t[5]-t[7])*i,e[1]=(t[6]-t[2])*i,e[2]=(t[1]-t[3])*i;else{var o=0;t[4]>t[0]&&(o=1),t[8]>t[3*o+o]&&(o=2);var n=(o+1)%3,s=(o+2)%3;i=Math.sqrt(t[3*o+o]-t[3*n+n]-t[3*s+s]+1),e[o]=.5*i,i=.5/i,e[3]=(t[3*n+s]-t[3*s+n])*i,e[n]=(t[3*n+o]+t[3*o+n])*i,e[s]=(t[3*s+o]+t[3*o+s])*i}return e},p.toString=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+"]"},p.exactEquals=h.a.exactEquals,p.equals=h.a.equals,t.a=p},function(e,t,i){"use strict";var r=i(0),o=i(4),n={frustum:function(e,t,i,r,o,n,s){var a=1/(i-t),l=1/(o-r),c=1/(n-s);return e[0]=2*n*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*n*l,e[6]=0,e[7]=0,e[8]=(i+t)*a,e[9]=(o+r)*l,e[10]=(s+n)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=s*n*2*c,e[15]=0,e},perspective:function(e,t,i,r,o){var n=1/Math.tan(t/2),s=1/(r-o);return e[0]=n/i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(o+r)*s,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*o*r*s,e[15]=0,e},ortho:function(e,t,i,r,o,n,s){var a=1/(t-i),l=1/(r-o),c=1/(n-s);return e[0]=-2*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+i)*a,e[13]=(o+r)*l,e[14]=(s+n)*c,e[15]=1,e},lookAt:function(e,t,i,n){var s,a,l,c,u,h,d,p,g,f,v=t[0],m=t[1],y=t[2],_=n[0],E=n[1],A=n[2],x=i[0],C=i[1],w=i[2];return Math.abs(v-x)<r.b&&Math.abs(m-C)<r.b&&Math.abs(y-w)<r.b?o.a.identity(e):(d=v-x,p=m-C,g=y-w,s=E*(g*=f=1/Math.sqrt(d*d+p*p+g*g))-A*(p*=f),a=A*(d*=f)-_*g,l=_*p-E*d,(f=Math.sqrt(s*s+a*a+l*l))?(s*=f=1/f,a*=f,l*=f):(s=0,a=0,l=0),c=p*l-g*a,u=g*s-d*l,h=d*a-p*s,(f=Math.sqrt(c*c+u*u+h*h))?(c*=f=1/f,u*=f,h*=f):(c=0,u=0,h=0),e[0]=s,e[1]=c,e[2]=d,e[3]=0,e[4]=a,e[5]=u,e[6]=p,e[7]=0,e[8]=l,e[9]=h,e[10]=g,e[11]=0,e[12]=-(s*v+a*m+l*y),e[13]=-(c*v+u*m+h*y),e[14]=-(d*v+p*m+g*y),e[15]=1,e)},transformProjectionMatrix:function(e,t,i){var r=t[0],o=t[1],n=t[2],s=i[3]*r+i[7]*o+i[11]*n+i[15];return s=s||1,e[0]=(i[0]*r+i[4]*o+i[8]*n+i[12])/s,e[1]=(i[1]*r+i[5]*o+i[9]*n+i[13])/s,e[2]=(i[2]*r+i[6]*o+i[10]*n+i[14])/s,e}};t.a=n}])},e.exports=t()},5320:e=>{"use strict";e.exports=function(e,t){for(var i=new Array(arguments.length-1),r=0,o=2,n=!0;o<arguments.length;)i[r++]=arguments[o++];return new Promise((function(o,s){i[r]=function(e){if(n)if(n=!1,e)s(e);else{for(var t=new Array(arguments.length-1),i=0;i<t.length;)t[i++]=arguments[i];o.apply(null,t)}};try{e.apply(t||null,i)}catch(e){n&&(n=!1,s(e))}}))}},752:(e,t)=>{"use strict";var i=t;i.length=function(e){var t=e.length;if(!t)return 0;for(var i=0;--t%4>1&&"="===e.charAt(t);)++i;return Math.ceil(3*e.length)/4-i};for(var r=new Array(64),o=new Array(123),n=0;n<64;)o[r[n]=n<26?n+65:n<52?n+71:n<62?n-4:n-59|43]=n++;i.encode=function(e,t,i){for(var o,n=null,s=[],a=0,l=0;t<i;){var c=e[t++];switch(l){case 0:s[a++]=r[c>>2],o=(3&c)<<4,l=1;break;case 1:s[a++]=r[o|c>>4],o=(15&c)<<2,l=2;break;case 2:s[a++]=r[o|c>>6],s[a++]=r[63&c],l=0}a>8191&&((n||(n=[])).push(String.fromCharCode.apply(String,s)),a=0)}return l&&(s[a++]=r[o],s[a++]=61,1===l&&(s[a++]=61)),n?(a&&n.push(String.fromCharCode.apply(String,s.slice(0,a))),n.join("")):String.fromCharCode.apply(String,s.slice(0,a))};var s="invalid encoding";i.decode=function(e,t,i){for(var r,n=i,a=0,l=0;l<e.length;){var c=e.charCodeAt(l++);if(61===c&&a>1)break;if(void 0===(c=o[c]))throw Error(s);switch(a){case 0:r=c,a=1;break;case 1:t[i++]=r<<2|(48&c)>>4,r=c,a=2;break;case 2:t[i++]=(15&r)<<4|(60&c)>>2,r=c,a=3;break;case 3:t[i++]=(3&r)<<6|c,a=0}}if(1===a)throw Error(s);return i-n},i.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},4824:e=>{"use strict";function t(e,i){"string"==typeof e&&(i=e,e=void 0);var r=[];function o(e){if("string"!=typeof e){var i=n();if(t.verbose&&console.log("codegen: "+i),i="return "+i,e){for(var s=Object.keys(e),a=new Array(s.length+1),l=new Array(s.length),c=0;c<s.length;)a[c]=s[c],l[c]=e[s[c++]];return a[c]=i,Function.apply(null,a).apply(null,l)}return Function(i)()}for(var u=new Array(arguments.length-1),h=0;h<u.length;)u[h]=arguments[++h];if(h=0,e=e.replace(/%([%dfijs])/g,(function(e,t){var i=u[h++];switch(t){case"d":case"f":return String(Number(i));case"i":return String(Math.floor(i));case"j":return JSON.stringify(i);case"s":return String(i)}return"%"})),h!==u.length)throw Error("parameter count mismatch");return r.push(e),o}function n(t){return"function "+(t||i||"")+"("+(e&&e.join(",")||"")+"){\n  "+r.join("\n  ")+"\n}"}return o.toString=n,o}e.exports=t,t.verbose=!1},3947:e=>{"use strict";function t(){this._listeners={}}e.exports=t,t.prototype.on=function(e,t,i){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:i||this}),this},t.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var i=this._listeners[e],r=0;r<i.length;)i[r].fn===t?i.splice(r,1):++r;return this},t.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var i=[],r=1;r<arguments.length;)i.push(arguments[r++]);for(r=0;r<t.length;)t[r].fn.apply(t[r++].ctx,i)}return this}},1560:(e,t,i)=>{"use strict";e.exports=n;var r=i(5320),o=i(1528)("fs");function n(e,t,i){return"function"==typeof t?(i=t,t={}):t||(t={}),i?!t.xhr&&o&&o.readFile?o.readFile(e,(function(r,o){return r&&"undefined"!=typeof XMLHttpRequest?n.xhr(e,t,i):r?i(r):i(null,t.binary?o:o.toString("utf8"))})):n.xhr(e,t,i):r(n,this,e,t)}n.xhr=function(e,t,i){var r=new XMLHttpRequest;r.onreadystatechange=function(){if(4===r.readyState){if(0!==r.status&&200!==r.status)return i(Error("status "+r.status));if(t.binary){var e=r.response;if(!e){e=[];for(var o=0;o<r.responseText.length;++o)e.push(255&r.responseText.charCodeAt(o))}return i(null,"undefined"!=typeof Uint8Array?new Uint8Array(e):e)}return i(null,r.responseText)}},t.binary&&("overrideMimeType"in r&&r.overrideMimeType("text/plain; charset=x-user-defined"),r.responseType="arraybuffer"),r.open("GET",e),r.send()}},3732:e=>{"use strict";function t(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),i=new Uint8Array(t.buffer),r=128===i[3];function o(e,r,o){t[0]=e,r[o]=i[0],r[o+1]=i[1],r[o+2]=i[2],r[o+3]=i[3]}function n(e,r,o){t[0]=e,r[o]=i[3],r[o+1]=i[2],r[o+2]=i[1],r[o+3]=i[0]}function s(e,r){return i[0]=e[r],i[1]=e[r+1],i[2]=e[r+2],i[3]=e[r+3],t[0]}function a(e,r){return i[3]=e[r],i[2]=e[r+1],i[1]=e[r+2],i[0]=e[r+3],t[0]}e.writeFloatLE=r?o:n,e.writeFloatBE=r?n:o,e.readFloatLE=r?s:a,e.readFloatBE=r?a:s}():function(){function t(e,t,i,r){var o=t<0?1:0;if(o&&(t=-t),0===t)e(1/t>0?0:2147483648,i,r);else if(isNaN(t))e(2143289344,i,r);else if(t>34028234663852886e22)e((o<<31|2139095040)>>>0,i,r);else if(t<11754943508222875e-54)e((o<<31|Math.round(t/1401298464324817e-60))>>>0,i,r);else{var n=Math.floor(Math.log(t)/Math.LN2);e((o<<31|n+127<<23|8388607&Math.round(t*Math.pow(2,-n)*8388608))>>>0,i,r)}}function s(e,t,i){var r=e(t,i),o=2*(r>>31)+1,n=r>>>23&255,s=8388607&r;return 255===n?s?NaN:o*(1/0):0===n?1401298464324817e-60*o*s:o*Math.pow(2,n-150)*(s+8388608)}e.writeFloatLE=t.bind(null,i),e.writeFloatBE=t.bind(null,r),e.readFloatLE=s.bind(null,o),e.readFloatBE=s.bind(null,n)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),i=new Uint8Array(t.buffer),r=128===i[7];function o(e,r,o){t[0]=e,r[o]=i[0],r[o+1]=i[1],r[o+2]=i[2],r[o+3]=i[3],r[o+4]=i[4],r[o+5]=i[5],r[o+6]=i[6],r[o+7]=i[7]}function n(e,r,o){t[0]=e,r[o]=i[7],r[o+1]=i[6],r[o+2]=i[5],r[o+3]=i[4],r[o+4]=i[3],r[o+5]=i[2],r[o+6]=i[1],r[o+7]=i[0]}function s(e,r){return i[0]=e[r],i[1]=e[r+1],i[2]=e[r+2],i[3]=e[r+3],i[4]=e[r+4],i[5]=e[r+5],i[6]=e[r+6],i[7]=e[r+7],t[0]}function a(e,r){return i[7]=e[r],i[6]=e[r+1],i[5]=e[r+2],i[4]=e[r+3],i[3]=e[r+4],i[2]=e[r+5],i[1]=e[r+6],i[0]=e[r+7],t[0]}e.writeDoubleLE=r?o:n,e.writeDoubleBE=r?n:o,e.readDoubleLE=r?s:a,e.readDoubleBE=r?a:s}():function(){function t(e,t,i,r,o,n){var s=r<0?1:0;if(s&&(r=-r),0===r)e(0,o,n+t),e(1/r>0?0:2147483648,o,n+i);else if(isNaN(r))e(0,o,n+t),e(2146959360,o,n+i);else if(r>17976931348623157e292)e(0,o,n+t),e((s<<31|2146435072)>>>0,o,n+i);else{var a;if(r<22250738585072014e-324)e((a=r/5e-324)>>>0,o,n+t),e((s<<31|a/4294967296)>>>0,o,n+i);else{var l=Math.floor(Math.log(r)/Math.LN2);1024===l&&(l=1023),e(4503599627370496*(a=r*Math.pow(2,-l))>>>0,o,n+t),e((s<<31|l+1023<<20|1048576*a&1048575)>>>0,o,n+i)}}}function s(e,t,i,r,o){var n=e(r,o+t),s=e(r,o+i),a=2*(s>>31)+1,l=s>>>20&2047,c=4294967296*(1048575&s)+n;return 2047===l?c?NaN:a*(1/0):0===l?5e-324*a*c:a*Math.pow(2,l-1075)*(c+4503599627370496)}e.writeDoubleLE=t.bind(null,i,0,4),e.writeDoubleBE=t.bind(null,r,4,0),e.readDoubleLE=s.bind(null,o,0,4),e.readDoubleBE=s.bind(null,n,4,0)}(),e}function i(e,t,i){t[i]=255&e,t[i+1]=e>>>8&255,t[i+2]=e>>>16&255,t[i+3]=e>>>24}function r(e,t,i){t[i]=e>>>24,t[i+1]=e>>>16&255,t[i+2]=e>>>8&255,t[i+3]=255&e}function o(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function n(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}e.exports=t(t)},1528:module=>{"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},7256:(e,t)=>{"use strict";var i=t,r=i.isAbsolute=function(e){return/^(?:\/|\w+:)/.test(e)},o=i.normalize=function(e){var t=(e=e.replace(/\\/g,"/").replace(/\/{2,}/g,"/")).split("/"),i=r(e),o="";i&&(o=t.shift()+"/");for(var n=0;n<t.length;)".."===t[n]?n>0&&".."!==t[n-1]?t.splice(--n,2):i?t.splice(n,1):++n:"."===t[n]?t.splice(n,1):++n;return o+t.join("/")};i.resolve=function(e,t,i){return i||(t=o(t)),r(t)?t:(i||(e=o(e)),(e=e.replace(/(?:\/|^)[^/]+$/,"")).length?o(e+"/"+t):t)}},6264:e=>{"use strict";e.exports=function(e,t,i){var r=i||8192,o=r>>>1,n=null,s=r;return function(i){if(i<1||i>o)return e(i);s+i>r&&(n=e(r),s=0);var a=t.call(n,s,s+=i);return 7&s&&(s=1+(7|s)),a}}},1888:(e,t)=>{"use strict";var i=t;i.length=function(e){for(var t=0,i=0,r=0;r<e.length;++r)(i=e.charCodeAt(r))<128?t+=1:i<2048?t+=2:55296==(64512&i)&&56320==(64512&e.charCodeAt(r+1))?(++r,t+=4):t+=3;return t},i.read=function(e,t,i){if(i-t<1)return"";for(var r,o=null,n=[],s=0;t<i;)(r=e[t++])<128?n[s++]=r:r>191&&r<224?n[s++]=(31&r)<<6|63&e[t++]:r>239&&r<365?(r=((7&r)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,n[s++]=55296+(r>>10),n[s++]=56320+(1023&r)):n[s++]=(15&r)<<12|(63&e[t++])<<6|63&e[t++],s>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,n)),s=0);return o?(s&&o.push(String.fromCharCode.apply(String,n.slice(0,s))),o.join("")):String.fromCharCode.apply(String,n.slice(0,s))},i.write=function(e,t,i){for(var r,o,n=i,s=0;s<e.length;++s)(r=e.charCodeAt(s))<128?t[i++]=r:r<2048?(t[i++]=r>>6|192,t[i++]=63&r|128):55296==(64512&r)&&56320==(64512&(o=e.charCodeAt(s+1)))?(r=65536+((1023&r)<<10)+(1023&o),++s,t[i++]=r>>18|240,t[i++]=r>>12&63|128,t[i++]=r>>6&63|128,t[i++]=63&r|128):(t[i++]=r>>12|224,t[i++]=r>>6&63|128,t[i++]=63&r|128);return i-n}},9140:(e,t,i)=>{"use strict";var r,o,n;if(Object.defineProperty(t,"__esModule",{value:!0}),void 0===s)var s={},a={exports:{}};n=function(){return function e(t,i,r){function o(s,a){if(!i[s]){if(!t[s]){if(n)return n(s,!0);throw new Error("Cannot find module '"+s+"'")}var l=i[s]={exports:{}};t[s][0].call(l.exports,(function(e){return o(t[s][1][e]||e)}),l,l.exports,e,t,i,r)}return i[s].exports}for(var n=void 0,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(e,t,i){t.exports={version:"1.3.5"}},{}],2:[function(e,t,i){var r=function(e,t){this.head_=e,this.tail_=t,this.search_node_=e};r.prototype.head=function(){return this.head_},r.prototype.setHead=function(e){this.head_=e},r.prototype.tail=function(){return this.tail_},r.prototype.setTail=function(e){this.tail_=e},r.prototype.search=function(){return this.search_node_},r.prototype.setSearch=function(e){this.search_node_=e},r.prototype.findSearchNode=function(){return this.search_node_},r.prototype.locateNode=function(e){var t=this.search_node_;if(e<t.value){for(;t=t.prev;)if(e>=t.value)return this.search_node_=t,t}else for(;t=t.next;)if(e<t.value)return this.search_node_=t.prev,t.prev;return null},r.prototype.locatePoint=function(e){var t=e.x,i=this.findSearchNode(t),r=i.point.x;if(t===r){if(e!==i.point)if(e===i.prev.point)i=i.prev;else{if(e!==i.next.point)throw new Error("poly2tri Invalid AdvancingFront.locatePoint() call");i=i.next}}else if(t<r)for(;(i=i.prev)&&e!==i.point;);else for(;(i=i.next)&&e!==i.point;);return i&&(this.search_node_=i),i},t.exports=r,t.exports.Node=function(e,t){this.point=e,this.triangle=t||null,this.next=null,this.prev=null,this.value=e.x}},{}],3:[function(e,t,i){t.exports=function(e,t){if(!e)throw new Error(t||"Assert Failed")}},{}],4:[function(e,t,i){var r=e("./xy"),o=function(e,t){this.x=+e||0,this.y=+t||0,this._p2t_edge_list=null};o.prototype.toString=function(){return r.toStringBase(this)},o.prototype.toJSON=function(){return{x:this.x,y:this.y}},o.prototype.clone=function(){return new o(this.x,this.y)},o.prototype.set_zero=function(){return this.x=0,this.y=0,this},o.prototype.set=function(e,t){return this.x=+e||0,this.y=+t||0,this},o.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},o.prototype.add=function(e){return this.x+=e.x,this.y+=e.y,this},o.prototype.sub=function(e){return this.x-=e.x,this.y-=e.y,this},o.prototype.mul=function(e){return this.x*=e,this.y*=e,this},o.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},o.prototype.normalize=function(){var e=this.length();return this.x/=e,this.y/=e,e},o.prototype.equals=function(e){return this.x===e.x&&this.y===e.y},o.negate=function(e){return new o(-e.x,-e.y)},o.add=function(e,t){return new o(e.x+t.x,e.y+t.y)},o.sub=function(e,t){return new o(e.x-t.x,e.y-t.y)},o.mul=function(e,t){return new o(e*t.x,e*t.y)},o.cross=function(e,t){return"number"==typeof e?"number"==typeof t?e*t:new o(-e*t.y,e*t.x):"number"==typeof t?new o(t*e.y,-t*e.x):e.x*t.y-e.y*t.x},o.toString=r.toString,o.compare=r.compare,o.cmp=r.compare,o.equals=r.equals,o.dot=function(e,t){return e.x*t.x+e.y*t.y},t.exports=o},{"./xy":11}],5:[function(e,t,i){var r=e("./xy"),o=function(e,t){this.name="PointError",this.points=t=t||[],this.message=e||"Invalid Points!";for(var i=0;i<t.length;i++)this.message+=" "+r.toString(t[i])};(o.prototype=new Error).constructor=o,t.exports=o},{"./xy":11}],6:[function(e,t,i){(function(t){var r=t.poly2tri;i.noConflict=function(){return t.poly2tri=r,i},i.VERSION=e("../dist/version.json").version,i.PointError=e("./pointerror"),i.Point=e("./point"),i.Triangle=e("./triangle"),i.SweepContext=e("./sweepcontext");var o=e("./sweep");i.triangulate=o.triangulate,i.sweep={Triangulate:o.triangulate}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../dist/version.json":1,"./point":4,"./pointerror":5,"./sweep":7,"./sweepcontext":8,"./triangle":9}],7:[function(e,t,i){var r=e("./assert"),o=e("./pointerror"),n=e("./triangle"),s=e("./advancingfront").Node,a=e("./utils"),l=a.EPSILON,c=a.Orientation,u=a.orient2d,h=a.inScanArea,d=a.isAngleObtuse;function p(e,t){var i=e.locateNode(t),o=function(e,t,i){var r=new n(t,i.point,i.next.point);r.markNeighbor(i.triangle),e.addToMap(r);var o=new s(t);return o.next=i.next,o.prev=i,i.next.prev=o,i.next=o,y(e,r)||e.mapTriangleToNodes(r),o}(e,t,i);return t.x<=i.point.x+l&&m(e,i),function(e,t){for(var i=t.next;i.next&&!d(i.point,i.next.point,i.prev.point);)m(e,i),i=i.next;for(i=t.prev;i.prev&&!d(i.point,i.next.point,i.prev.point);)m(e,i),i=i.prev;t.next&&t.next.next&&function(e){var t=e.point.x-e.next.next.point.x,i=e.point.y-e.next.next.point.y;return r(i>=0,"unordered y"),t>=0||Math.abs(t)<i}(t)&&function(e,t){for(u(t.point,t.next.point,t.next.next.point)===c.CCW?e.basin.left_node=t.next.next:e.basin.left_node=t.next,e.basin.bottom_node=e.basin.left_node;e.basin.bottom_node.next&&e.basin.bottom_node.point.y>=e.basin.bottom_node.next.point.y;)e.basin.bottom_node=e.basin.bottom_node.next;if(e.basin.bottom_node!==e.basin.left_node){for(e.basin.right_node=e.basin.bottom_node;e.basin.right_node.next&&e.basin.right_node.point.y<e.basin.right_node.next.point.y;)e.basin.right_node=e.basin.right_node.next;e.basin.right_node!==e.basin.bottom_node&&(e.basin.width=e.basin.right_node.point.x-e.basin.left_node.point.x,e.basin.left_highest=e.basin.left_node.point.y>e.basin.right_node.point.y,A(e,e.basin.bottom_node))}}(e,t)}(e,o),o}function g(e,t,i){e.edge_event.constrained_edge=t,e.edge_event.right=t.p.x>t.q.x,v(i.triangle,t.p,t.q)||(function(e,t,i){e.edge_event.right?function(e,t,i){for(;i.next.point.x<t.p.x;)u(t.q,i.next.point,t.p)===c.CCW?x(e,t,i):i=i.next}(e,t,i):function(e,t,i){for(;i.prev.point.x>t.p.x;)u(t.q,i.prev.point,t.p)===c.CW?b(e,t,i):i=i.prev}(e,t,i)}(e,t,i),f(e,t.p,t.q,i.triangle,t.q))}function f(e,t,i,r,n){if(!v(r,t,i)){var s=r.pointCCW(n),a=u(i,s,t);if(a===c.COLLINEAR)throw new o("poly2tri EdgeEvent: Collinear not supported!",[i,s,t]);var l=r.pointCW(n),h=u(i,l,t);if(h===c.COLLINEAR)throw new o("poly2tri EdgeEvent: Collinear not supported!",[i,l,t]);a===h?f(e,t,i,r=a===c.CW?r.neighborCCW(n):r.neighborCW(n),n):V(e,t,i,r,n)}}function v(e,t,i){var r=e.edgeIndex(t,i);if(-1!==r){e.markConstrainedEdgeByIndex(r);var o=e.getNeighbor(r);return o&&o.markConstrainedEdgeByPoints(t,i),!0}return!1}function m(e,t){var i=new n(t.prev.point,t.point,t.next.point);i.markNeighbor(t.prev.triangle),i.markNeighbor(t.triangle),e.addToMap(i),t.prev.next=t.next,t.next.prev=t.prev,y(e,i)||e.mapTriangleToNodes(i)}function y(e,t){for(var i=0;i<3;++i)if(!t.delaunay_edge[i]){var r=t.getNeighbor(i);if(r){var o=t.getPoint(i),n=r.oppositePoint(t,o),s=r.index(n);if(r.constrained_edge[s]||r.delaunay_edge[s]){t.constrained_edge[i]=r.constrained_edge[s];continue}if(_(o,t.pointCCW(o),t.pointCW(o),n)){t.delaunay_edge[i]=!0,r.delaunay_edge[s]=!0,E(t,o,r,n);var a=!y(e,t);return a&&e.mapTriangleToNodes(t),(a=!y(e,r))&&e.mapTriangleToNodes(r),t.delaunay_edge[i]=!1,r.delaunay_edge[s]=!1,!0}}}return!1}function _(e,t,i,r){var o=e.x-r.x,n=e.y-r.y,s=t.x-r.x,a=t.y-r.y,l=o*a-s*n;if(l<=0)return!1;var c=i.x-r.x,u=i.y-r.y,h=c*n-o*u;return!(h<=0)&&(o*o+n*n)*(s*u-c*a)+(s*s+a*a)*h+(c*c+u*u)*l>0}function E(e,t,i,r){var o,n,s,a,l,c,u,h,d,p,g,f;o=e.neighborCCW(t),n=e.neighborCW(t),s=i.neighborCCW(r),a=i.neighborCW(r),l=e.getConstrainedEdgeCCW(t),c=e.getConstrainedEdgeCW(t),u=i.getConstrainedEdgeCCW(r),h=i.getConstrainedEdgeCW(r),d=e.getDelaunayEdgeCCW(t),p=e.getDelaunayEdgeCW(t),g=i.getDelaunayEdgeCCW(r),f=i.getDelaunayEdgeCW(r),e.legalize(t,r),i.legalize(r,t),i.setDelaunayEdgeCCW(t,d),e.setDelaunayEdgeCW(t,p),e.setDelaunayEdgeCCW(r,g),i.setDelaunayEdgeCW(r,f),i.setConstrainedEdgeCCW(t,l),e.setConstrainedEdgeCW(t,c),e.setConstrainedEdgeCCW(r,u),i.setConstrainedEdgeCW(r,h),e.clearNeighbors(),i.clearNeighbors(),o&&i.markNeighbor(o),n&&e.markNeighbor(n),s&&e.markNeighbor(s),a&&i.markNeighbor(a),e.markNeighbor(i)}function A(e,t){if(!function(e,t){var i;return i=e.basin.left_highest?e.basin.left_node.point.y-t.point.y:e.basin.right_node.point.y-t.point.y,e.basin.width>i}(e,t)&&(m(e,t),t.prev!==e.basin.left_node||t.next!==e.basin.right_node)){if(t.prev===e.basin.left_node){if(u(t.point,t.next.point,t.next.next.point)===c.CW)return;t=t.next}else if(t.next===e.basin.right_node){if(u(t.point,t.prev.point,t.prev.prev.point)===c.CCW)return;t=t.prev}else t=t.prev.point.y<t.next.point.y?t.prev:t.next;A(e,t)}}function x(e,t,i){i.point.x<t.p.x&&(u(i.point,i.next.point,i.next.next.point)===c.CCW?C(e,t,i):(w(e,t,i),x(e,t,i)))}function C(e,t,i){m(e,i.next),i.next.point!==t.p&&u(t.q,i.next.point,t.p)===c.CCW&&u(i.point,i.next.point,i.next.next.point)===c.CCW&&C(e,t,i)}function w(e,t,i){u(i.next.point,i.next.next.point,i.next.next.next.point)===c.CCW?C(e,t,i.next):u(t.q,i.next.next.point,t.p)===c.CCW&&w(e,t,i.next)}function b(e,t,i){i.point.x>t.p.x&&(u(i.point,i.prev.point,i.prev.prev.point)===c.CW?T(e,t,i):(M(e,t,i),b(e,t,i)))}function M(e,t,i){u(i.prev.point,i.prev.prev.point,i.prev.prev.prev.point)===c.CW?T(e,t,i.prev):u(t.q,i.prev.prev.point,t.p)===c.CW&&M(e,t,i.prev)}function T(e,t,i){m(e,i.prev),i.prev.point!==t.p&&u(t.q,i.prev.point,t.p)===c.CW&&u(i.point,i.prev.point,i.prev.prev.point)===c.CW&&T(e,t,i)}function V(e,t,i,n,s){var a=n.neighborAcross(s);r(a,"FLIP failed due to missing triangle!");var l=a.oppositePoint(n,s);if(n.getConstrainedEdgeAcross(s)){var d=n.index(s);throw new o("poly2tri Intersecting Constraints",[s,l,n.getPoint((d+1)%3),n.getPoint((d+2)%3)])}h(s,n.pointCCW(s),n.pointCW(s),l)?(E(n,s,a,l),e.mapTriangleToNodes(n),e.mapTriangleToNodes(a),s===i&&l===t?i===e.edge_event.constrained_edge.q&&t===e.edge_event.constrained_edge.p&&(n.markConstrainedEdgeByPoints(t,i),a.markConstrainedEdgeByPoints(t,i),y(e,n),y(e,a)):(n=function(e,t,i,r,o,n){var s;return t===c.CCW?(s=r.edgeIndex(o,n),r.delaunay_edge[s]=!0,y(e,r),r.clearDelaunayEdges(),i):(s=i.edgeIndex(o,n),i.delaunay_edge[s]=!0,y(e,i),i.clearDelaunayEdges(),r)}(e,u(i,l,t),n,a,s,l),V(e,t,i,n,s))):(L(e,t,i,n,a,S(t,i,a,l)),f(e,t,i,n,s))}function S(e,t,i,r){var n=u(t,r,e);if(n===c.CW)return i.pointCCW(r);if(n===c.CCW)return i.pointCW(r);throw new o("poly2tri [Unsupported] nextFlipPoint: opposing point on constrained edge!",[t,r,e])}function L(e,t,i,o,n,s){var a=n.neighborAcross(s);r(a,"FLIP failed due to missing triangle");var l=a.oppositePoint(n,s);h(i,o.pointCCW(i),o.pointCW(i),l)?V(e,i,l,a,l):L(e,t,i,o,a,S(t,i,a,l))}i.triangulate=function(e){e.initTriangulation(),e.createAdvancingFront(),function(e){var t,i=e.pointCount();for(t=1;t<i;++t)for(var r=e.getPoint(t),o=p(e,r),n=r._p2t_edge_list,s=0;n&&s<n.length;++s)g(e,n[s],o)}(e),function(e){for(var t=e.front().head().next.triangle,i=e.front().head().next.point;!t.getConstrainedEdgeCW(i);)t=t.neighborCCW(i);e.meshClean(t)}(e)}},{"./advancingfront":2,"./assert":3,"./pointerror":5,"./triangle":9,"./utils":10}],8:[function(e,t,i){var r=e("./pointerror"),o=e("./point"),n=e("./triangle"),s=e("./sweep"),a=e("./advancingfront"),l=a.Node,c=function(e,t){if(this.p=e,this.q=t,e.y>t.y)this.q=e,this.p=t;else if(e.y===t.y)if(e.x>t.x)this.q=e,this.p=t;else if(e.x===t.x)throw new r("poly2tri Invalid Edge constructor: repeated points!",[e]);this.q._p2t_edge_list||(this.q._p2t_edge_list=[]),this.q._p2t_edge_list.push(this)},u=function(){this.left_node=null,this.bottom_node=null,this.right_node=null,this.width=0,this.left_highest=!1};u.prototype.clear=function(){this.left_node=null,this.bottom_node=null,this.right_node=null,this.width=0,this.left_highest=!1};var h=function(){this.constrained_edge=null,this.right=!1},d=function(e,t){t=t||{},this.triangles_=[],this.map_=[],this.points_=t.cloneArrays?e.slice(0):e,this.edge_list=[],this.pmin_=this.pmax_=null,this.front_=null,this.head_=null,this.tail_=null,this.af_head_=null,this.af_middle_=null,this.af_tail_=null,this.basin=new u,this.edge_event=new h,this.initEdges(this.points_)};d.prototype.addHole=function(e){this.initEdges(e);var t,i=e.length;for(t=0;t<i;t++)this.points_.push(e[t]);return this},d.prototype.AddHole=d.prototype.addHole,d.prototype.addHoles=function(e){var t,i=e.length;for(t=0;t<i;t++)this.initEdges(e[t]);return this.points_=this.points_.concat.apply(this.points_,e),this},d.prototype.addPoint=function(e){return this.points_.push(e),this},d.prototype.AddPoint=d.prototype.addPoint,d.prototype.addPoints=function(e){return this.points_=this.points_.concat(e),this},d.prototype.triangulate=function(){return s.triangulate(this),this},d.prototype.getBoundingBox=function(){return{min:this.pmin_,max:this.pmax_}},d.prototype.getTriangles=function(){return this.triangles_},d.prototype.GetTriangles=d.prototype.getTriangles,d.prototype.front=function(){return this.front_},d.prototype.pointCount=function(){return this.points_.length},d.prototype.head=function(){return this.head_},d.prototype.setHead=function(e){this.head_=e},d.prototype.tail=function(){return this.tail_},d.prototype.setTail=function(e){this.tail_=e},d.prototype.getMap=function(){return this.map_},d.prototype.initTriangulation=function(){var e,t=this.points_[0].x,i=this.points_[0].x,r=this.points_[0].y,n=this.points_[0].y,s=this.points_.length;for(e=1;e<s;e++){var a=this.points_[e];a.x>t&&(t=a.x),a.x<i&&(i=a.x),a.y>r&&(r=a.y),a.y<n&&(n=a.y)}this.pmin_=new o(i,n),this.pmax_=new o(t,r);var l=.3*(t-i),c=.3*(r-n);this.head_=new o(t+l,n-c),this.tail_=new o(i-l,n-c),this.points_.sort(o.compare)},d.prototype.initEdges=function(e,t){var i,r=e.length,o=t?e.length-1:e.length;for(i=0;i<o;++i)this.edge_list.push(new c(e[i],e[(i+1)%r]))},d.prototype.getPoint=function(e){return this.points_[e]},d.prototype.addToMap=function(e){this.map_.push(e)},d.prototype.locateNode=function(e){return this.front_.locateNode(e.x)},d.prototype.createAdvancingFront=function(){var e,t,i,r=new n(this.points_[0],this.tail_,this.head_);this.map_.push(r),e=new l(r.getPoint(1),r),t=new l(r.getPoint(0),r),i=new l(r.getPoint(2)),this.front_=new a(e,i),e.next=t,t.next=i,t.prev=e,i.prev=t},d.prototype.removeNode=function(e){},d.prototype.mapTriangleToNodes=function(e){for(var t=0;t<3;++t)if(!e.getNeighbor(t)){var i=this.front_.locatePoint(e.pointCW(e.getPoint(t)));i&&(i.triangle=e)}},d.prototype.removeFromMap=function(e){var t,i=this.map_,r=i.length;for(t=0;t<r;t++)if(i[t]===e){i.splice(t,1);break}},d.prototype.meshClean=function(e){for(var t,i,r=[e];t=r.pop();)if(!t.isInterior())for(t.setInterior(!0),this.triangles_.push(t),i=0;i<3;i++)t.constrained_edge[i]||r.push(t.getNeighbor(i))},t.exports=d},{"./advancingfront":2,"./point":4,"./pointerror":5,"./sweep":7,"./triangle":9}],9:[function(e,t,i){var r=function(e,t,i){this.points_=[e,t,i],this.neighbors_=[null,null,null],this.interior_=!1,this.constrained_edge=[!1,!1,!1],this.delaunay_edge=[!1,!1,!1]},o=e("./xy").toString;r.prototype.toString=function(){return"["+o(this.points_[0])+o(this.points_[1])+o(this.points_[2])+"]"},r.prototype.getPoint=function(e){return this.points_[e]},r.prototype.GetPoint=r.prototype.getPoint,r.prototype.getPoints=function(){return this.points_},r.prototype.getNeighbor=function(e){return this.neighbors_[e]},r.prototype.containsPoint=function(e){var t=this.points_;return e===t[0]||e===t[1]||e===t[2]},r.prototype.containsEdge=function(e){return this.containsPoint(e.p)&&this.containsPoint(e.q)},r.prototype.containsPoints=function(e,t){return this.containsPoint(e)&&this.containsPoint(t)},r.prototype.isInterior=function(){return this.interior_},r.prototype.setInterior=function(e){return this.interior_=e,this},r.prototype.markNeighborPointers=function(e,t,i){var r=this.points_;if(e===r[2]&&t===r[1]||e===r[1]&&t===r[2])this.neighbors_[0]=i;else if(e===r[0]&&t===r[2]||e===r[2]&&t===r[0])this.neighbors_[1]=i;else{if(!(e===r[0]&&t===r[1]||e===r[1]&&t===r[0]))throw new Error("poly2tri Invalid Triangle.markNeighborPointers() call");this.neighbors_[2]=i}},r.prototype.markNeighbor=function(e){var t=this.points_;e.containsPoints(t[1],t[2])?(this.neighbors_[0]=e,e.markNeighborPointers(t[1],t[2],this)):e.containsPoints(t[0],t[2])?(this.neighbors_[1]=e,e.markNeighborPointers(t[0],t[2],this)):e.containsPoints(t[0],t[1])&&(this.neighbors_[2]=e,e.markNeighborPointers(t[0],t[1],this))},r.prototype.clearNeighbors=function(){this.neighbors_[0]=null,this.neighbors_[1]=null,this.neighbors_[2]=null},r.prototype.clearDelaunayEdges=function(){this.delaunay_edge[0]=!1,this.delaunay_edge[1]=!1,this.delaunay_edge[2]=!1},r.prototype.pointCW=function(e){var t=this.points_;return e===t[0]?t[2]:e===t[1]?t[0]:e===t[2]?t[1]:null},r.prototype.pointCCW=function(e){var t=this.points_;return e===t[0]?t[1]:e===t[1]?t[2]:e===t[2]?t[0]:null},r.prototype.neighborCW=function(e){return e===this.points_[0]?this.neighbors_[1]:e===this.points_[1]?this.neighbors_[2]:this.neighbors_[0]},r.prototype.neighborCCW=function(e){return e===this.points_[0]?this.neighbors_[2]:e===this.points_[1]?this.neighbors_[0]:this.neighbors_[1]},r.prototype.getConstrainedEdgeCW=function(e){return e===this.points_[0]?this.constrained_edge[1]:e===this.points_[1]?this.constrained_edge[2]:this.constrained_edge[0]},r.prototype.getConstrainedEdgeCCW=function(e){return e===this.points_[0]?this.constrained_edge[2]:e===this.points_[1]?this.constrained_edge[0]:this.constrained_edge[1]},r.prototype.getConstrainedEdgeAcross=function(e){return e===this.points_[0]?this.constrained_edge[0]:e===this.points_[1]?this.constrained_edge[1]:this.constrained_edge[2]},r.prototype.setConstrainedEdgeCW=function(e,t){e===this.points_[0]?this.constrained_edge[1]=t:e===this.points_[1]?this.constrained_edge[2]=t:this.constrained_edge[0]=t},r.prototype.setConstrainedEdgeCCW=function(e,t){e===this.points_[0]?this.constrained_edge[2]=t:e===this.points_[1]?this.constrained_edge[0]=t:this.constrained_edge[1]=t},r.prototype.getDelaunayEdgeCW=function(e){return e===this.points_[0]?this.delaunay_edge[1]:e===this.points_[1]?this.delaunay_edge[2]:this.delaunay_edge[0]},r.prototype.getDelaunayEdgeCCW=function(e){return e===this.points_[0]?this.delaunay_edge[2]:e===this.points_[1]?this.delaunay_edge[0]:this.delaunay_edge[1]},r.prototype.setDelaunayEdgeCW=function(e,t){e===this.points_[0]?this.delaunay_edge[1]=t:e===this.points_[1]?this.delaunay_edge[2]=t:this.delaunay_edge[0]=t},r.prototype.setDelaunayEdgeCCW=function(e,t){e===this.points_[0]?this.delaunay_edge[2]=t:e===this.points_[1]?this.delaunay_edge[0]=t:this.delaunay_edge[1]=t},r.prototype.neighborAcross=function(e){return e===this.points_[0]?this.neighbors_[0]:e===this.points_[1]?this.neighbors_[1]:this.neighbors_[2]},r.prototype.oppositePoint=function(e,t){var i=e.pointCW(t);return this.pointCW(i)},r.prototype.legalize=function(e,t){var i=this.points_;if(e===i[0])i[1]=i[0],i[0]=i[2],i[2]=t;else if(e===i[1])i[2]=i[1],i[1]=i[0],i[0]=t;else{if(e!==i[2])throw new Error("poly2tri Invalid Triangle.legalize() call");i[0]=i[2],i[2]=i[1],i[1]=t}},r.prototype.index=function(e){var t=this.points_;if(e===t[0])return 0;if(e===t[1])return 1;if(e===t[2])return 2;throw new Error("poly2tri Invalid Triangle.index() call")},r.prototype.edgeIndex=function(e,t){var i=this.points_;if(e===i[0]){if(t===i[1])return 2;if(t===i[2])return 1}else if(e===i[1]){if(t===i[2])return 0;if(t===i[0])return 2}else if(e===i[2]){if(t===i[0])return 1;if(t===i[1])return 0}return-1},r.prototype.markConstrainedEdgeByIndex=function(e){this.constrained_edge[e]=!0},r.prototype.markConstrainedEdgeByEdge=function(e){this.markConstrainedEdgeByPoints(e.p,e.q)},r.prototype.markConstrainedEdgeByPoints=function(e,t){var i=this.points_;t===i[0]&&e===i[1]||t===i[1]&&e===i[0]?this.constrained_edge[2]=!0:t===i[0]&&e===i[2]||t===i[2]&&e===i[0]?this.constrained_edge[1]=!0:(t===i[1]&&e===i[2]||t===i[2]&&e===i[1])&&(this.constrained_edge[0]=!0)},t.exports=r},{"./xy":11}],10:[function(e,t,i){var r=1e-16;i.EPSILON=r;var o={CW:1,CCW:-1,COLLINEAR:0};i.Orientation=o,i.orient2d=function(e,t,i){var n=(e.x-i.x)*(t.y-i.y)-(e.y-i.y)*(t.x-i.x);return n>-1e-16&&n<r?o.COLLINEAR:n>0?o.CCW:o.CW},i.inScanArea=function(e,t,i,o){return!((e.x-t.x)*(o.y-t.y)-(o.x-t.x)*(e.y-t.y)>=-1e-16||(e.x-i.x)*(o.y-i.y)-(o.x-i.x)*(e.y-i.y)<=r)},i.isAngleObtuse=function(e,t,i){var r=t.x-e.x,o=t.y-e.y;return r*(i.x-e.x)+o*(i.y-e.y)<0}},{}],11:[function(e,t,i){function r(e){return"("+e.x+";"+e.y+")"}t.exports={toString:function(e){var t=e.toString();return"[object Object]"===t?r(e):t},toStringBase:r,compare:function(e,t){return e.y===t.y?e.x-t.x:e.y-t.y},equals:function(e,t){return e.x===t.x&&e.y===t.y}}},{}]},{},[6])(6)},"object"==typeof s?a.exports=n():void 0===(o="function"==typeof(r=n)?r.call(t,i,t,e):r)||(e.exports=o);var l=a.exports;t.poly2tri=l},5856:(e,t)=>{"use strict";function i(e,t,i,r,o,n){o[0]=n.b=r[0],o[1]=n.a=-t*n.b+r[1];for(var s=2;s<e;s++)o[s]=-(t*n.a+i*n.b)+r[s],n.b=n.a,n.a=o[s]}function r(e,t,r,o,n,s,a,l,c){var u=new Object,h=3;return u.b=u.a=0,i(t,a,l,s,c,u),n.c=u.a,n.d=u.b,Math.abs(n.c)<=100*e*Math.abs(s[t-1])&&Math.abs(n.d)<=100*e*Math.abs(s[t-2])||(n.h=l*o,Math.abs(n.d)>=Math.abs(n.c)?(h=2,n.e=r/n.d,n.f=n.c/n.d,n.g=a*o,n.a3=n.e*(n.g+r)+n.h*(o/n.d),n.a1=-r+n.f*o,n.a7=n.h+(n.f+a)*r):(h=1,n.e=r/n.c,n.f=n.d/n.c,n.g=n.e*a,n.a3=n.e*r+(n.g+n.h/n.c)*o,n.a1=-r*(n.d/n.c)+o,n.a7=n.g*n.d+n.h*n.f+r)),h}function o(e,t,i,r,o,n,s,a,l){var c;if(3!=i)if(c=1==i?o:r,Math.abs(n.a1)>10*e*Math.abs(c))for(n.a7/=n.a1,n.a3/=n.a1,s[0]=l[0],s[1]=-l[0]*n.a7+l[1],u=2;u<t;u++)s[u]=-l[u-1]*n.a7+a[u-2]*n.a3+l[u];else for(s[0]=0,s[1]=-l[0]*n.a7,u=2;u<t;u++)s[u]=-l[u-1]*n.a7+a[u-2]*n.a3;else{s[1]=s[0]=0;for(var u=2;u<t;u++)s[u]=a[u-2]}}function n(e,t,i,r,o,n,s,a,l,c,u,h,d,p,g,f,v){var m,y,_,E,A,x,C,w;t.b=t.a=0,3!=e&&(2!=e?(m=i+d*s+h*c,y=a+(d+p*c)*l):(m=(i+u)*c+h,y=(c+d)*a+p*l),0!=(w=-(C=-((A=(_=-g[f-1]/v[f])*n)+(x=_*_*o))+p*(E=-(g[f-2]+_*v[f-1])/v[f])*r)+y+_*m)&&(t.a=-(d*(x+A)+p*(_*r+E*n))/w+d,t.b=p*(1+C/w)))}function s(e,t,i,r){var o,n,s;r.sr=r.si=r.lr=r.li=0,0!=e?0!=i?(o=t/2,Math.abs(o)<Math.abs(i)?(s=-(s=i>=0?e:-e)+o*(o/Math.abs(i)),n=Math.sqrt(Math.abs(s))*Math.sqrt(Math.abs(i))):(s=-e/o*(i/o)+1,n=Math.sqrt(Math.abs(s))*Math.abs(o)),s>=0?(n=o>=0?-n:n,r.lr=(-o+n)/e,r.sr=0!=r.lr?i/r.lr/e:r.sr):(r.lr=r.sr=-o/e,r.si=Math.abs(n/e),r.li=-r.si)):r.lr=-t/e:r.sr=0!=t?-i/t:r.sr}function a(e,t,a,l,c,u,h,d,p,g,f,v){var m,y,_,E,A,x,C,w,b,M,T,V=new Object,S=0,L=0;a.NZ=0,x=l,w=c;do{if(V.li=V.lr=V.si=V.sr=0,s(1,x,w,V),a.szr=V.sr,a.szi=V.si,a.lzr=V.lr,a.lzi=V.li,Math.abs(Math.abs(a.szr)-Math.abs(a.lzr))>.01*Math.abs(a.lzr))break;for(i(h,x,w,p,u,d),y=Math.abs(-a.szr*d.b+d.a)+Math.abs(a.szi*d.b),M=Math.sqrt(Math.abs(w)),m=2*Math.abs(u[0]),A=-a.szr*d.b,T=1;T<t;T++)m=m*M+Math.abs(u[T]);if(y<=20*(m=(9*(m=m*M+Math.abs(A+d.a))+2*Math.abs(A)-7*(Math.abs(d.a+A)+M*Math.abs(d.b)))*e)){a.NZ=2;break}if(++S>20)break;if(S>=2&&E<=.01&&y>=_&&!L){for(i(h,x-=x*(E=E<e?Math.sqrt(e):Math.sqrt(E)),w+=w*E,p,u,d),T=0;T<5;T++)o(e,t,r(e,t,d.a,d.b,f,v,x,w,g),d.a,d.b,f,v,g,u);L=1,S=0}_=y,o(e,t,r(e,t,d.a,d.b,f,v,x,w,g),d.a,d.b,f,v,g,u),n(r(e,t,d.a,d.b,f,v,x,w,g),d,d.a,f.a1,f.a3,f.a7,d.b,f.c,f.d,f.f,f.g,f.h,x,w,v,t,p),C=d.a,0!=(b=d.b)&&(E=Math.abs((-w+b)/b),x=C,w=b)}while(0!=b)}function l(e,t,i,r,o,n,s,a,l){var c,u,h,d,p,g,f,v,m,y,_,E=r-1;for(t.NZ=_=m=0,f=i.a;;){for(s[0]=g=o[0],y=1;y<n;y++)s[y]=g=g*f+o[y];for(h=Math.abs(g),d=Math.abs(f),c=.5*Math.abs(s[0]),y=1;y<n;y++)c=c*d+Math.abs(s[y]);if(h<=20*e*(2*c-h)){t.NZ=1,t.szr=f,t.szi=0;break}if(++_>10)break;if(_>=2&&Math.abs(v)<=.001*Math.abs(-v+f)&&h>p){m=1,t.a=f;break}for(p=h,l[0]=u=a[0],y=1;y<r;y++)l[y]=u=u*f+a[y];if(Math.abs(u)>10*Math.abs(a[E])*e)for(v=-g/u,a[0]=s[0],y=1;y<r;y++)a[y]=v*l[y-1]+s[y];else for(a[0]=0,y=1;y<r;y++)a[y]=l[y-1];for(u=a[0],y=1;y<r;y++)u=u*f+a[y];f+=v=Math.abs(u)>10*Math.abs(a[E])*e?-g/u:0}return m}function c(e,t,s,c,u,h,d,p,g,f,v){var m,y,_,E,A,x,C,w,b,M,T,V,S,L,R,P,D,O,I,N,k,B,F,z,j,U,G,W,Y=new Object,H=new Object,q=new Array(t),K=new Array(t);for(v.NZ=0,E=_=.25,R=-2*c,A=c,w=D=u,H.h=H.g=H.f=H.e=H.d=H.c=H.a7=H.a3=H.a1=Y.b=Y.a=0,i(g,R,D,p,f,Y),U=r(e,d,m=Y.a,y=Y.b,H,h,R,D,q),F=0;F<s;F++){if(o(e,d,U,m,y,H,h,q,f),n(U=r(e,d,m,y,H,h,R,D,q),Y,m,H.a1,H.a3,H.a7,y,H.c,H.d,H.f,H.g,H.h,R,D,h,d,p),P=Y.a,I=O=Y.b,M=0!=h[d-1]?-p[d]/h[d-1]:0,T=S=1,0!=F&&3!=U&&(G=(L=(S=0!=I?Math.abs((I-w)/I):S)<C?S*C:1)<E?1:0,(z=(V=(T=0!=M?Math.abs((M-A)/M):T)<x?T*x:1)<_?1:0)||G)){for(k=0;k<d;k++)K[k]=h[k];b=M,j=W=0,N=1;do{if(B=1,N&&0==(N=0)&&z&&(!G||V<L));else{if(a(e,d,v,P,O,f,g,Y,p,q,H,h),m=Y.a,y=Y.b,v.NZ>0)return;if(W=1,E*=.25,j||!z)B=0;else for(k=0;k<d;k++)h[k]=K[k]}if(0!=B){if(Y.a=b,B=l(e,v,Y,d,p,g,f,h,q),b=Y.a,v.NZ>0)return;if(j=1,_*=.25,0!=B){P=-(b+b),O=b*b;continue}}for(k=0;k<d;k++)h[k]=K[k]}while(G&&!W);i(g,R,D,p,f,Y),U=r(e,d,m=Y.a,y=Y.b,H,h,R,D,q)}w=I,A=M,C=S,x=T}}Object.defineProperty(t,"__esModule",{value:!0}),t.getRealPolynomialRoots=function(e){var t={Degree:e.length-1},i=new Array(e.length),r=new Array(e.length);!function(e,t,i,r){var o,n,a,l,u,h,d,p,g,f,v,m,y,_,E,A,x,C,w,b,M,T,V=e.Degree,S=.017453292519943295,L=117549435082229e-52,R=340282346638529e24,P=Math.LN2,D=e.Degree+1,O=new Array(D),I=new Array(D),N=new Array(D),k=new Array(D),B=new Object,F=new Object;m=1;do{n=m,y=1+(m/=2)}while(y>1);var z=L/n,j=Math.cos(94*S),U=Math.sin(94*S),G=Math.sqrt(.5),W=-G;for(F.NZ=x=0,F.szr=F.szi=F.lzr=F.lzi=0;0==t[V];)i[x]=r[x]=0,V--,x++;for(M=V+1;V>=1;){if(V<=2){V<2?(i[e.Degree-1]=-t[1]/t[0],r[e.Degree-1]=0):(B.li=B.lr=B.si=B.sr=0,s(t[0],t[1],t[2],B),i[e.Degree-2]=B.sr,r[e.Degree-2]=B.si,i[e.Degree-1]=B.lr,r[e.Degree-1]=B.li);break}for(d=0,p=R,Y=0;Y<M;Y++)(f=Math.abs(t[Y]))>d&&(d=f),0!=f&&f<p&&(p=f);if(((g=z/p)<=1&&d>=10||g>1&&R/g>=d)&&(g=0==g?L:g,w=Math.floor(Math.log(g)/P+.5),1!=(u=Math.pow(2,w))))for(Y=0;Y<M;Y++)t[Y]*=u;for(var Y=0;Y<M;Y++)I[Y]=Math.abs(t[Y]);I[V]=-I[V],b=V-1,f=Math.exp((Math.log(-I[V])-Math.log(I[0]))/V),0!=I[b]&&(f=(v=-I[V]/I[b])<f?v:f),v=f;do{for(v=.1*(f=v),h=I[0],Y=1;Y<M;Y++)h=h*v+I[Y]}while(h>0);for(l=f;Math.abs(l/f)>.005;){for(a=h=I[0],Y=1;Y<V;Y++)a=f*a+(h=f*h+I[Y]);f-=l=(h=f*h+I[V])/a}for(o=f,Y=1;Y<V;Y++)O[Y]=(V-Y)*t[Y]/V;for(O[0]=t[0],m=t[V],y=t[b],T=0==O[b]?1:0,C=0;C<5;C++)if(_=O[b],T){for(Y=0;Y<b;Y++)O[x=b-Y]=O[x-1];O[0]=0,T=0==O[b]?1:0}else{for(E=-m/_,Y=0;Y<b;Y++)O[x=b-Y]=E*O[x-1]+t[x];O[0]=t[0],T=Math.abs(O[b])<=Math.abs(y)*n*10?1:0}for(Y=0;Y<V;Y++)k[Y]=O[Y];for(C=1;C<=20;C++){if(A=-U*W+j*G,W=U*G+j*W,c(n,D,20*C,o*(G=A),o,O,V,t,M,N,F),0!=F.NZ){for(i[x=e.Degree-V]=F.szr,r[x]=F.szi,V=(M-=F.NZ)-1,Y=0;Y<M;Y++)t[Y]=N[Y];1!=F.NZ&&(i[x+1]=F.lzr,r[x+1]=F.lzi);break}for(Y=0;Y<V;Y++)O[Y]=k[Y]}if(C>20){e.Degree-=V;break}}}(t,e,i,r);for(var o=[],n=e.length-t.Degree-1;n<e.length;n++)Math.abs(r[n])<1e-8&&o.push(i[n]);return o}},2536:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TopologyCloner=void 0;var r=i(6940),o=i(7580),n=i(672),s=i(4524),a=i(6776),l=i(6508),c=i(5837),u=i(9984),h=i(2208),d=function(){this._edgeMap={},this._vertexMap={},this._coedgeMap={},this._progenitorMap=new h.ProgenitorMap};d.prototype.cloneVertex=function(e){var t=this._vertexMap[e.getGuid()];return t||(t=new r.Vertex(e.getPoint().clone()),this._vertexMap[e.getGuid()]=t,t.setPrecision(e.getPrecision()),this._progenitorMap.addEntry(t,[e])),t},d.prototype.cloneEdge=function(e){var t=this._edgeMap[e.getGuid()];return t||(t=new o.Edge(e.getCurve().clone()),this._edgeMap[e.getGuid()]=t,t.setReversed(e.isReversed()),t.setRange(e.getRange()),t.setStartVertex(this.cloneVertex(e.getStartVertex())),t.setEndVertex(this.cloneVertex(e.getEndVertex())),t.setPrecision(e.getPrecision()),this._progenitorMap.addEntry(t,[e])),t},d.prototype.cloneCoedge=function(e){var t,i,r=new n.Coedge;this._coedgeMap[e.getGuid()]=r,r.setReversed(e.isReversed()),r.setEdge(this.cloneEdge(e.getEdge())),r.getEdge().setCoedge(r);for(var o=e.getPartner();o;){var s=this._coedgeMap[o.getGuid()];s&&(t||(t=s),i=s,e.getEdge().getCoedge()===o&&r.getEdge().setCoedge(s)),(o=o.getPartner())===e&&(o=void 0)}return t&&i&&(r.setPartner(t),i.setPartner(r)),this._progenitorMap.addEntry(r,[e]),r},d.prototype.cloneLoop=function(e){for(var t=new s.Loop,i=e.getCoedges(),r=new Array(i.length),o=0;o<i.length;++o)r[o]=this.cloneCoedge(i[o]);return t.addCoedges(r),this._progenitorMap.addEntry(t,[e]),t},d.prototype.cloneFace=function(e){for(var t=new a.Face,i=e.getLoops(),r=new Array(i.length),o=0;o<i.length;++o)r[o]=this.cloneLoop(i[o]);return t.addLoops(r),t.setSurface(e.getSurface().clone()),t.setReversed(e.isReversed()),this._progenitorMap.addEntry(t,[e]),t},d.prototype.cloneFaces=function(e){for(var t=new Array(e.length),i=0;i<e.length;++i)t[i]=this.cloneFace(e[i]);return t},d.prototype.cloneShell=function(e){var t=new l.Shell;return t.addFaces(this.cloneFaces(e.getFaces())),this._progenitorMap.addEntry(t,[e]),t},d.prototype.cloneLump=function(e){for(var t=new c.Lump,i=e.getShells(),r=0;r<i.length;++r)t.addShell(this.cloneShell(i[r]));return this._progenitorMap.addEntry(t,[e]),t},d.prototype.cloneBody=function(e){for(var t=new u.Body,i=e.getLumps(),r=0;r<i.length;++r)t.addLump(this.cloneLump(i[r]));return this._progenitorMap.addEntry(t,[e]),t},d.prototype.getProgenitorMap=function(){return this._progenitorMap},t.TopologyCloner=d},64:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createShellsFromFaces=t.createWiresFromEdges=t.createEdgesFromCurves=t.createEdgeFromCurve=t.createLoopFromPolyline=t.createFaceFromPolyline=t.makeConeOrCylinderVParamLoop=t.createCoedgeOnEdge=t.createLineEdge=t.createLineEdgeBetweenVertices=void 0;var r=i(1972),o=i(2468),n=i(4728),s=i(3565),a=i(1096),l=i(8292),c=i(672),u=i(6940),h=i(6508),d=i(7580),p=i(4524),g=i(6776),f=i(7575),v=i(5896),m=i(7616),y=function(e,t){var i=e.getPosition(),o=t.getPosition(),n=new a.Line;n.setFromEndpoints(i,o);var s=new d.Edge(n);return s.setRange([0,r.Vector3.distance(i,o)]),s.setStartVertex(e),s.setEndVertex(t),s},_=function(e){var t=new c.Coedge;t.setEdge(e);var i=e.getCoedge();return i?(n.ConsoleUtils.assert(!i.getPartner()),i.setPartner(t),t.setPartner(i),t.setReversed(!i.isReversed())):e.setCoedge(t),t},E=function(e){for(var t=e.length,i=new Array(t),r=0;r<t;++r)i[r]=new u.Vertex(new s.Point(e[r]));var o=new Array(t);for(r=0;r<t;++r){var n=(r+1)%t,a=y(i[r],i[n]);o[r]=_(a)}var l=new p.Loop;return l.addCoedges(o),l},A=function(e){var t=new d.Edge(e),i=e.getRange();i[0]!==-1/0&&i[1]!==1/0?(t.sett0(i[0]),t.sett1(i[1])):(t.sett0(0),t.sett1(1));var r=t.evaluatePosition(t.t0());if(t.setStartVertex(new u.Vertex(new s.Point(r))),e.isClosed())t.setEndVertex(t.getStartVertex());else{var o=t.evaluatePosition(t.t1());t.setEndVertex(new u.Vertex(new s.Point(o)))}return t};t.createLineEdgeBetweenVertices=y,t.createLineEdge=function(e,t){var i=new u.Vertex(new s.Point(e)),r=new u.Vertex(new s.Point(t));return y(i,r)},t.createCoedgeOnEdge=_,t.makeConeOrCylinderVParamLoop=function(e,t){n.ConsoleUtils.assert(e.getGeometryType()===o.GEOMETRY_TYPES.CYLINDER||e.getGeometryType()===o.GEOMETRY_TYPES.CONE||e.getGeometryType()===o.GEOMETRY_TYPES.ELLIPTICAL_CYLINDER||e.getGeometryType()===o.GEOMETRY_TYPES.ELLIPTICAL_CONE),n.ConsoleUtils.assert(e.isPeriodicV());var i,r=new d.Edge,a=e.vParamLine(t);a.getGeometryType()===o.GEOMETRY_TYPES.POINT?i=a:(i=new s.Point(a.evaluatePosition(a.getRange()[0])),r.setCurve(a),r.setRange(a.getRange()));var l=new u.Vertex(i);r.setStartVertex(l),r.setEndVertex(l);var c=new p.Loop;return c.addCoedge(_(r)),c},t.createFaceFromPolyline=function(e){var t=E(e),i=(0,v.definePlaneThroughPoints)(e),r=new l.Plane;r.set(i.origin,i.normal,i.uAxis),r.limitRangeU(i.uRange),r.limitRangeV(i.vRange);var o=new g.Face(r);return o.addLoop(t),o},t.createLoopFromPolyline=E,t.createEdgeFromCurve=A,t.createEdgesFromCurves=function(e){for(var t=[],i=0;i<e.length;++i)t.push(A(e[i]));return(0,m.mergeCoincidentVertices)(t),t},t.createWiresFromEdges=function(e){for(var t=(0,m.findConnectedEdges)(e),i=[],r=0;r<t.length;++r){var o=new f.Wire;o.addEdges(t[r]),i.push(o)}return i},t.createShellsFromFaces=function(e){for(var t=(0,m.findConnectedFaces)(e),i=new Array(t.length),r=0;r<t.length;++r){var o=new h.Shell;o.addFaces(t[r]),i[r]=o}return i}},7620:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPolyhedron=void 0;var r=i(9984),o=i(5837),n=i(6776),s=i(4524),a=i(6940),l=i(8292),c=i(3565),u=i(64),h=i(5896),d=i(4728),p=i(6120);function g(e,t){var i,r=e.getCommonEdges(t);d.ConsoleUtils.assert(r.length<=1),i=0===r.length?(0,u.createLineEdgeBetweenVertices)(e,t):r[0];var o=(0,u.createCoedgeOnEdge)(i);return d.ConsoleUtils.assert(o.getStartVertex()===e),d.ConsoleUtils.assert(o.getEndVertex()===t),o}function f(e,t){var i,r=[];for(i=0;i<t.length;++i)r[i]=e[t[i]];var o=(0,h.definePlaneThroughPoints)(r);if(o){var n=new l.Plane;return n.set(o.origin,o.normal,o.uAxis),n.limitRangeU(o.uRange),n.limitRangeV(o.vRange),n}p.DebugUtils.warn("Face is degenerate")}t.createPolyhedron=function(e,t){var i,l=[];for(i=0;i<e.length;++i){var h=new a.Vertex(new c.Point(e[i]));l.push(h)}var p=[];for(i=0;i<t.length;++i){var v=t[i];d.ConsoleUtils.assert(v.length>=3);for(var m=new s.Loop,y=[],_=0;_<v.length;++_){var E=v[_],A=v[(_+1)%v.length];d.ConsoleUtils.assert(E>=0&&E<e.length),d.ConsoleUtils.assert(A>=0&&A<e.length);var x=g(l[E],l[A]);y.push(x)}m.addCoedges(y);var C=f(e,v),w=new n.Face(C);w.addLoop(m),p.push(w)}var b=(0,u.createShellsFromFaces)(p),M=[];for(i=0;i<b.length;++i)M[i]=new o.Lump,M[i].addShell(b[i]);var T=new r.Body;return T.addLumps(M),T}},2472:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.extrudeFace=void 0;var r=i(1972),o=i(2468),n=i(4728),s=i(8292),a=i(3440),l=i(8360),c=i(92),u=i(4524),h=i(6776),d=i(6508),p=i(5837),g=i(9984),f=i(2536),v=i(7616),m=i(64);function y(e,t,i){var n=r.Vector3.length(i),s=r.Vector3.dot(e.getAxisDir(),i)>0?[0,n]:[-n,0];e.limitRangeU(s),t[1]-t[0]<2*Math.PI-o.PARAMETER_SPACE_TOLERANCE&&e.limitRangeV(t)}var _=function(e,t){var i=e.getEdge().getCurve(),n=e.getRange(),u=!0;e.isReversed()!==e.getEdge().isReversed()&&(n=[-n[1],-n[0]],u=!1);var h,d=u?e.t0():e.t1(),p=e.evaluateDt(d);if(r.Vector3.cross(p,p,t),r.Vector3.normalize(p,p),r.Vector3.negate(p,p),i.getGeometryType()===o.GEOMETRY_TYPES.LINE)h=function(e,t,i){var o=new s.Plane,n=e.evaluateDt(0),a=r.Vector3.createFloat64();r.Vector3.normalize(a,i);var l=r.Vector3.createFloat64();r.Vector3.cross(l,a,n),o.set(e.evaluatePosition(0),l,a);var c=r.Vector3.length(i),u=r.Vector3.dot(a,i)>0?[0,c]:[-c,0];return o.limitRangeV(t),o.limitRangeU(u),o}(i,n,t);else if(i.getGeometryType()===o.GEOMETRY_TYPES.CIRCLE)h=function(e,t,i){var o=e.evaluatePosition(0);r.Vector3.subtract(o,o,e.getCenter());var n=r.Vector3.createFloat64();r.Vector3.negate(n,e.getNormal());var s=new a.Cylinder;return s.set(e.getCenter(),e.getRadius(),n,o,1),y(s,t,i),s}(i,n,t);else if(i.getGeometryType()===o.GEOMETRY_TYPES.ELLIPSE)h=function(e,t,i){var o=e.evaluatePosition(0);r.Vector3.subtract(o,o,e.getCenter());var n=r.Vector3.createFloat64();r.Vector3.negate(n,e.getNormal());var s=new l.EllipticalCylinder;return s.set(e.getCenter(),o,e.getMinorRadius()/e.getMajorRadius(),n,1),y(s,t,i),s}(i,n,t);else{if(i.getGeometryType()!==o.GEOMETRY_TYPES.BCURVE)throw new Error("createSideFaceRuledSurface: Curve type not supported.");h=function(e,t,i){for(var r=new c.BSurface,o=e.getDegree(),n=e.getKnotVector().slice(0),s=e.getControlPoints().slice(0),a=(s=s.concat(s)).length/2;a<s.length;a+=3)s[a]+=i[0],s[a+1]+=i[1],s[a+2]+=i[2];var l=void 0;return e.isRational()&&(l=(l=e.getWeights().slice(0)).concat(l)),r.set(1,o,[0,0,1,1],n,s,l),r.limitRangeU([0,1]),r.limitRangeV(t),r}(i,n,t)}var g=h.evaluateNormal(0,n[0]);return{surface:h,isReversed:r.Vector3.dot(g,p)<0}};t.extrudeFace=function(e,t){n.ConsoleUtils.assert(e.getSurfaceType()===o.GEOMETRY_TYPES.PLANE);var i=e.evaluateNormal(0,0);r.Vector3.scale(i,i,t);var s=(new f.TopologyCloner).cloneFace(e),a=r.Matrix44.fromTranslation(r.Matrix44.createFloat64(),i);(0,v.transformTopology)(s,a),t>0?(0,v.reverseFace)(e):(0,v.reverseFace)(s);var l=function(e,t,i){for(var r=[],o=e.getLoops(),n=t.getLoops(),s=0;s<o.length;++s)for(var a=o[s].getCoedges(),l=n[s].getCoedges(),c=new Array(a.length),d=0;d<a.length;++d){var p=new Array(4),g=a[d],f=l[a.length-1-d],v=g.getStartVertex(),y=g.getEndVertex(),E=f.getStartVertex(),A=f.getEndVertex();p[0]=(0,m.createCoedgeOnEdge)(g.getEdge()),0===d&&(c[d]=(0,m.createLineEdgeBetweenVertices)(v,A)),p[1]=(0,m.createCoedgeOnEdge)(c[d]),p[2]=(0,m.createCoedgeOnEdge)(f.getEdge()),d!==a.length-1&&(c[d+1]=(0,m.createLineEdgeBetweenVertices)(E,y)),p[3]=(0,m.createCoedgeOnEdge)(c[(d+1)%a.length]);var x=new u.Loop;x.addCoedges(p);var C=_(g,i),w=new h.Face(C.surface);w.setReversed(C.isReversed),w.addLoop(x),r.push(w)}return r}(e,s,i),c=e.getShell();c||(c=new d.Shell).addFace(e),n.ConsoleUtils.assert(1===c.getFaces().length),c.addFaces(l),c.addFace(s);var y=c.getLump();y||(y=new p.Lump).addShell(c);var E=y.getBody();return E||(E=new g.Body).addLump(y),E}},268:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Path2D=void 0;var r=i(1972),o=i(2468),n=i(6500),s=i(7575),a=i(8796),l=i(5512),c=i(8972),u=i(1096),h=i(64),d=i(8080),p=i(4728),g=i(6120),f={assert:function(e,t){if(!e)throw{message:t||"assertion failed"}},assert_arg:function(e,t,i,r){var o="Invalid argument '"+t+"': "+i+"\nUsage: "+r;this.assert(e,o)},assert_number:function(e,t,i){this.assert_arg("number"==typeof e,t,"should be a number",i)},assert_boolean:function(e,t,i){this.assert_arg("boolean"==typeof e,t,"should be a boolean",i)},assert_string:function(e,t,i){this.assert_arg("string"==typeof e,t,"should be a string",i)}},v=function(){this._wireBody=new n.WireBody,this._curves=[],this._xy=[0,0],this._mergeBCurves=!0,this._healPath=!1,this._tangentTol=o.KERNEL_ANGULAR_TOLERANCE};function m(e,t,i){var o=3*(t-1),n=[e[o],e[o+1],e[o+2]],s=3*i,a=[e[s],e[s+1],e[s+2]],l=r.Vector3.sub([0,0,0],a,n);r.Vector3.scale(l,l,-.1);for(var c=1;c<=i-t;++c){var u=r.Vector3.scaleAndAdd([0,0,0],a,l,c);e[s-3*c]=u[0],e[s-3*c+1]=u[1],e[s-3*c+2]=u[2]}}function y(e,t,i){var o=3*t,n=[e[o],e[o+1],e[o+2]],s=3*(i+1),a=[e[s],e[s+1],e[s+2]],l=r.Vector3.sub([0,0,0],a,n);r.Vector3.scale(l,l,.1);for(var c=1;c<=i-t;++c){var u=r.Vector3.scaleAndAdd([0,0,0],n,l,c);e[o+3*c]=u[0],e[o+3*c+1]=u[1],e[o+3*c+2]=u[2]}}function _(e,t){for(var i,o,n,s=[],a=e.getControlPoints(),l=[a[0],a[1],a[2]],c=a.length/3,u=1;u<c;++u){i=[a[3*u],a[3*u+1],a[3*u+2]];var h=u===c-1;r.Vector3.squaredDistance(l,i)<t?(void 0===o&&(o=u-1),n=u):h=!0,h&&void 0!==o&&void 0!==n&&(s.push([o,n]),h=!1,o=void 0,n=void 0),l=i}return s}function E(e,t){var i=_(e,t);if(1===i.length&&i[0][1]-i[0][0]==1){var r=i[0];0===r[0]?e.addControlPointOnCurve(e.evaluatePosition(.1)):r[1]===e.getNumControlPoints()-1?e.addControlPointOnCurve(e.evaluatePosition(.9)):(e.addControlPointOnCurve(e.evaluatePosition(.45)),e.addControlPointOnCurve(e.evaluatePosition(.55)))}return i.length>0}function A(e,t){for(var i=_(e,t),r=0;r<i.length;++r){var o=i[r],n=e.getControlPoints().slice();o[0]>0?m(n,o[0],o[1]):o[1]<n.length/3-1?y(n,o[0],o[1]):g.DebugUtils.warn("Degenerate BCurve!"),e.setControlPoints(n)}}function x(e,t){var i=e.getControlPoints(),o=[i[0],i[1],i[2]],n=[i[3],i[4],i[5]],s=r.Vector3.distance(o,n);i[3]=o[0]+t[0]*s,i[4]=o[1]+t[1]*s,i[5]=o[2]+t[2]*s,e.setControlPoints(i)}function C(e,t){var i=e.getControlPoints(),o=e.getControlPoints().length,n=[i[o-6],i[o-5],i[o-4]],s=[i[o-3],i[o-2],i[o-1]],a=r.Vector3.distance(n,s);i[o-6]=s[0]-t[0]*a,i[o-5]=s[1]-t[1]*a,i[o-4]=s[2]-t[2]*a,e.setControlPoints(i)}function w(e){var t=new a.BCurve,i=e.getRange(),o=e.evaluatePosition(i[0]),n=e.evaluatePosition(i[1]),s=r.Vector3.lerp([0,0,0],o,n,1/3),l=r.Vector3.lerp([0,0,0],o,n,2/3),c=[o[0],o[1],0,s[0],s[1],0,l[0],l[1],0,n[0],n[1],0];return t.set(c,[1,1,1,1],3,[0,0,0,0,1,1,1,1]),t}function b(e,t){for(var i,o=e.getRange(),n=e.evaluatePosition(o[0]),s=e.evaluatePosition(o[1]),a=r.Vector3.distance(n,s),l=0,c=t.getControlPoints(),u=[c[0],c[1],c[2]],h=c.length/3,d=1;d<h;++d)i=[c[3*d],c[3*d+1],c[3*d+2]],l+=r.Vector3.distance(u,i),u=i;return a<l}function M(e,t){var i=e.getControlPoints().concat(t.getControlPoints().slice(3)),o=e.getWeights().concat(t.getWeights().slice(1)),n=e.getKnotVector().slice(0,-1),s=e.evaluateDt(e.getRange()[1]),a=t.evaluateDt(t.getRange()[0]),l=Math.sqrt(r.Vector3.squaredLength(a)/r.Vector3.squaredLength(s)),c=n[n.length-1]-t.getKnotVector()[0]*l,u=t.getKnotVector().slice(t.getDegree()+1);return u=u.map((function(e){return e*l+c})),n=n.concat(u),e.set(i,o,3,n),e}function T(e,t,i,n,s){var a=r.Vector2.subtract([],s,e),c=r.Vector2.length(a);if(!(c<o.KERNEL_TOLERANCE)){c>2*t&&(t=c/2);var u=r.Vector2.scaleAndAdd([],e,a,.5);if(c<2*t-r.FLOAT64_TOLERANCE){var h=Math.sqrt(t*t-c*c/4);!0===n!=(!1===i)&&(h=-h);var d=r.Vector2.normalize([],[-a[1],a[0]]);r.Vector2.scaleAndAdd(u,u,d,h)}var p=[0,0,n?1:-1],g=new l.Circle;g.set([u[0],u[1],0],p,[t,0,0]);var f=g.closestToPointParam([e[0],e[1],0]),v=g.closestToPointParam([s[0],s[1],0]);return v<=f&&(v+=2*Math.PI),g.limitRange([f,v]),g}}function V(e,t){var i=e.slice(1);i=i.replace(/([^e])-/g,"$1 -");for(var r=0;r<2;++r)i=i.replace(/\.[0-9]*\./g,(function(e){return e.slice(0,-1)+" ."}));for(var o=i.split(/[,\s]/),n=[],s=0;s<o.length;++s)if(o[s].length>0){var a=Number(o[s]);t(!isNaN(a),"could not parse command"),n.push(a)}return n}v.prototype.numWires=function(){var e=this._wireBody.getWires().length;return this._curves.length>0&&(e+=1),e},v.prototype.numClosed=function(){for(var e=0,t=0;t<this._wireBody.getWires().length;++t)this._wireBody.getWires()[t].isClosed()&&(e+=1);return this._areCurvesClosed()&&(e+=1),e},v.prototype._fixCoincidentControlPoints=function(){for(var e=o.KERNEL_TOLERANCE*o.KERNEL_TOLERANCE,t=0;t<this._curves.length;++t){var i=this._curves[t];i.getGeometryType()===o.GEOMETRY_TYPES.BCURVE&&3===i.getDegree()&&4===i.getNumControlPoints()&&!1===i.isRational()&&E(i,e)&&A(i,e)}},v.prototype._snapBCurvesTangent=function(){for(var e=0;e<this._curves.length;++e){var t=(e+1)%this._curves.length;if(0===t&&!this._areCurvesClosed())break;var i=this._curves[e],n=this._curves[t],s=i.evaluateDt(i.getRange()[1]),a=n.evaluateDt(n.getRange()[0]);r.Vector3.isParallel(s,a,1,this._tangentTol)&&(i.getGeometryType()!==o.GEOMETRY_TYPES.BCURVE&&n.getGeometryType()===o.GEOMETRY_TYPES.BCURVE?(r.Vector3.normalize(s,s),x(n,s)):i.getGeometryType()===o.GEOMETRY_TYPES.BCURVE&&n.getGeometryType()!==o.GEOMETRY_TYPES.BCURVE&&(r.Vector3.normalize(a,a),C(i,a)))}},v.prototype._areCurvesClosed=function(){if(0===this._curves.length)return!1;var e=this._curves[this._curves.length-1],t=this._curves[0];return r.Vector3.squaredDistance(e.evaluatePosition(e.getRange()[1]),t.evaluatePosition(t.getRange()[0]))<o.KERNEL_TOLERANCE*o.KERNEL_TOLERANCE},v.prototype._mergeShortLinesWithBCurves=function(){for(var e=!1,t=0;t<this._curves.length;++t){var i=(t+1)%this._curves.length;if(0===i&&!this._areCurvesClosed())break;var n=this._curves[t],s=this._curves[i],a=n.evaluateDt(n.getRange()[1]),l=s.evaluateDt(s.getRange()[0]);r.Vector3.isParallel(a,l,1,o.KERNEL_ANGULAR_TOLERANCE)&&(n.getGeometryType()===o.GEOMETRY_TYPES.LINE&&s.getGeometryType()===o.GEOMETRY_TYPES.BCURVE&&b(n,s)?(this._curves.splice(t,1,M(w(n),s)),this._curves.splice(i,1),t-=1,e=!0):n.getGeometryType()===o.GEOMETRY_TYPES.BCURVE&&s.getGeometryType()===o.GEOMETRY_TYPES.LINE&&b(s,n)&&(this._curves.splice(t,1,M(n,w(s))),this._curves.splice(i,1),t-=1,e=!0))}return e},v.prototype._mergeAdjacentBCurves=function(){for(var e=0;e<this._curves.length;++e){var t=(e+1)%this._curves.length;if(0===t&&!this._areCurvesClosed())break;var i=this._curves[e],n=this._curves[t],s=i.evaluateDt(i.getRange()[1]),a=n.evaluateDt(n.getRange()[0]);r.Vector3.isParallel(s,a,1,this._tangentTol)&&i.getGeometryType()===o.GEOMETRY_TYPES.BCURVE&&n.getGeometryType()===o.GEOMETRY_TYPES.BCURVE&&(r.Vector3.squaredLength(s)<r.Vector3.squaredLength(a)?(r.Vector3.normalize(s,s),x(n,s)):(r.Vector3.normalize(a,a),C(i,a)),i!==n&&(M(i,n),this._curves.splice(t,1),e-=1))}},v.prototype.setMergeBCurves=function(e){this._mergeBCurves=e},v.prototype.setHealForASM=function(e,t){this._healPath=e,this._tangentTol=void 0!==t?t:.01745240643728351},v.prototype._addWire=function(){if(0!==this._curves.length){this._healPath&&(this._fixCoincidentControlPoints(),this._snapBCurvesTangent()),(this._mergeBCurves||this._healPath)&&this._mergeAdjacentBCurves(),this._healPath&&this._mergeShortLinesWithBCurves()&&this._mergeAdjacentBCurves();var e=(0,h.createWiresFromEdges)((0,h.createEdgesFromCurves)(this._curves));p.ConsoleUtils.assert(1===e.length),this._wireBody.addWire(e[0]),this._curves=[]}},v.prototype._discardIfOpen=function(){if(0!==this._curves.length){var e=this._curves[0].evaluatePosition(this._curves[0].getRange()[0]),t=[this._xy[0],this._xy[1],0];r.Vector3.squaredDistance(e,t)>=o.KERNEL_TOLERANCE*o.KERNEL_TOLERANCE&&(this._curves=[])}},v.prototype.moveTo=function(e,t){var i="Path2D.moveTo(x, y)";return f.assert_number(e,"x",i),f.assert_number(t,"y",i),this._addWire(),this._xy[0]=e,this._xy[1]=t,this},v.prototype.lineTo=function(e,t){var i="Path2D.lineTo(x, y)";f.assert_number(e,"x",i),f.assert_number(t,"y",i);var r=e-this._xy[0],n=t-this._xy[1];if(r*r+n*n>o.KERNEL_TOLERANCE*o.KERNEL_TOLERANCE){var s=new u.Line;s.set([this._xy[0],this._xy[1],0],[r,n,0]),s.limitRange([0,1]),this._curves.push(s)}return this._xy[0]=e,this._xy[1]=t,this},v.prototype.quadraticCurveTo=function(e,t,i,r){var o="Path2D.quadraticCurveTo(cpx, cpy, x, y)";f.assert_number(e,"cpx",o),f.assert_number(t,"cpy",o),f.assert_number(i,"x",o),f.assert_number(r,"y",o);var n=new a.BCurve,s=1/3*this._xy[0]+2/3*e,l=1/3*this._xy[1]+2/3*t,c=1/3*i+2/3*e,u=1/3*r+2/3*t,h=[this._xy[0],this._xy[1],0,s,l,0,c,u,0,i,r,0];return n.set(h,[1,1,1,1],3,[0,0,0,0,1,1,1,1]),this._curves.push(n),this._xy[0]=i,this._xy[1]=r,this},v.prototype.bezierCurveTo=function(e,t,i,r,o,n){var s="Path2D.bezierCurveTo(cp1x, cp1y, cp2x, cp2y, x, y)";f.assert_number(e,"cp1x",s),f.assert_number(t,"cp1y",s),f.assert_number(i,"cp2x",s),f.assert_number(r,"cp2y",s),f.assert_number(o,"x",s),f.assert_number(n,"y",s);var l=new a.BCurve,c=[this._xy[0],this._xy[1],0,e,t,0,i,r,0,o,n,0];return l.set(c,[1,1,1,1],3,[0,0,0,0,1,1,1,1]),this._curves.push(l),this._xy[0]=o,this._xy[1]=n,this},v.prototype.circleArcTo=function(e,t,i,r,o){var n="Path2D.circleArcTo(radius, longest, anticlockwise, x, y)";f.assert_number(e,"radius",n),f.assert_arg(e>0,"radius","must be positive",n),f.assert_boolean(t,"longest",n),f.assert_boolean(i,"anticlockwise",n),f.assert_number(r,"x",n),f.assert_number(o,"y",n);var s=T(this._xy,e,t,i,[r,o]);return s&&(this._curves.push(s),this._xy[0]=r,this._xy[1]=o),this},v.prototype.ellipseArcTo=function(e,t,i,o,n,s,a){var l="Path2D.ellipseArcTo(xRadius, yRadius, rotation, longest, anticlockwise, x, y)";if(f.assert_number(e,"xRadius",l),f.assert_arg(e>0,"xRadius","must be positive",l),f.assert_number(t,"yRadius",l),f.assert_arg(t>0,"yRadius","must be positive",l),f.assert_number(i,"rotation",l),f.assert_boolean(o,"longest",l),f.assert_boolean(n,"anticlockwise",l),f.assert_number(s,"x",l),f.assert_number(a,"y",l),e<t){var u=e;e=t,t=u,i+=Math.PI/2}var h=Math.cos(i),d=Math.sin(i),p=e/t,g=r.Matrix22.multiply([],[1,0,0,p],[h,-d,d,h]),v=T(r.Vector2.transformMatrix22([],this._xy,g),e,o,n,r.Vector2.transformMatrix22([],[s,a],g));if(v){var m=[v.getCenter()[0],v.getCenter()[1]];r.Matrix22.invert(g,g),r.Vector2.transformMatrix22(m,m,g),m[2]=0;var y=v.getRadius(),_=[y*h,y*d,0],E=new c.Ellipse;E.set(m,v.getNormal(),_,1/p),E.limitRange(v.getRange()),this._curves.push(E),this._xy[0]=s,this._xy[1]=a}return this},v.prototype.closePath=function(){if(this._curves.length>0){var e=this._curves[0],t=e.evaluatePosition(e.getRange()[0]);this.lineTo(t[0],t[1]),this._addWire()}return this},v.prototype.addCircle=function(e,t,i){var r="Path2D.addCircle(x, y, radius)";f.assert_number(e,"x",r),f.assert_number(t,"y",r),f.assert_number(i,"radius",r),f.assert_arg(i>0,"radius","must be positive",r),this._addWire();var o=new l.Circle;return o.set([e,t,0],[0,0,1],[i,0,0]),this._curves.push(o),this._addWire(),this},v.prototype.addEllipse=function(e,t,i,r,o){o=void 0===o?0:o;var n="Path2D.addEllipse(x, y, xRadius, yRadius, rotation)";if(f.assert_number(e,"x",n),f.assert_number(t,"y",n),f.assert_number(i,"xRadius",n),f.assert_arg(i>0,"xRadius","must be positive",n),f.assert_number(r,"yRadius",n),f.assert_arg(r>0,"yRadius","must be positive",n),f.assert_number(o,"rotation",n),this._addWire(),i<r){var s=i;i=r,r=s,o+=Math.PI/2}var a=new c.Ellipse,l=Math.cos(o),u=Math.sin(o),h=r/i;return a.set([e,t,0],[0,0,1],[i*l,i*u,0],h),this._curves.push(a),this._addWire(),this},v.prototype.addSVGPath=function(e,t){t=void 0!==t&&t;var i="Path2D.addSVGPath(pathString, [includeOpen])";f.assert_string(e,"pathString",i),f.assert_boolean(t,"includeOpen",i),this._addWire(),this._xy[0]=0,this._xy[1]=0;var r=function(e){for(var t=[];e.length>0;){var i=e.slice(1).search(/[MmZzLlHhVvCcSsQqTtAa]/)+1;i<=0&&(i=e.length);var r=e.slice(0,i).trim();r.length>0&&t.push(r),e=e.slice(i).trim()}return t}(e);f.assert_arg(r.length>0,"pathString","cannot be empty string",i);for(var n=[this._xy[0],this._xy[1]],s=[this._xy[0],this._xy[1]],a=0;a<r.length;++a){var l,c,u,h,d,p,g,v=function(e,t){f.assert_arg(e,"pathString",t+' "'+r[a]+'"',i)},m=r[a].charAt(0).toUpperCase(),y=m!==r[a].charAt(0),_=V(r[a],v),E=y?this._xy:[0,0];switch(m){case"M":for(v(_.length>=2,"insufficient arguments in command"),v(_.length%2==0,"command requires pairs of x,y arguments"),t||this._discardIfOpen(),this.moveTo(_[0]+E[0],_[1]+E[1]),g=2;g<_.length;g+=2)this.lineTo(_[g]+E[0],_[g+1]+E[1]);break;case"Z":v(0===_.length,"command should not have arguments"),this.closePath();break;case"L":for(v(_.length>=2,"insufficient arguments in command"),v(_.length%2==0,"command requires pairs of x,y arguments"),g=0;g<_.length;g+=2)this.lineTo(_[g]+E[0],_[g+1]+E[1]);break;case"H":for(v(_.length>=1,"insufficient arguments in command"),g=0;g<_.length;g+=1)this.lineTo(_[g]+E[0],this._xy[1]);break;case"V":for(v(_.length>=1,"insufficient arguments in command"),g=0;g<_.length;g+=1)this.lineTo(this._xy[0],_[g]+E[1]);break;case"C":for(v(_.length>=6,"insufficient arguments in command"),v(_.length%6==0,"command requires sets of 6 arguments"),g=0;g<_.length;g+=6)l=_[g]+E[0],c=_[g+1]+E[1],u=_[g+2]+E[0],h=_[g+3]+E[1],d=_[g+4]+E[0],p=_[g+5]+E[1],this.bezierCurveTo(l,c,u,h,d,p),s[0]=u,s[1]=h;break;case"S":for(v(_.length>=4,"insufficient arguments in command"),v(_.length%4==0,"command requires sets of 4 arguments"),g=0;g<_.length;g+=4)l=2*this._xy[0]-s[0],c=2*this._xy[1]-s[1],u=_[g]+E[0],h=_[g+1]+E[1],d=_[g+2]+E[0],p=_[g+3]+E[1],this.bezierCurveTo(l,c,u,h,d,p),s[0]=u,s[1]=h;break;case"Q":for(v(_.length>=4,"insufficient arguments in command"),v(_.length%4==0,"command requires sets of 4 arguments"),g=0;g<_.length;g+=4)l=_[g]+E[0],c=_[g+1]+E[1],u=_[g+2]+E[0],h=_[g+3]+E[1],this.quadraticCurveTo(l,c,u,h),n[0]=l,n[1]=c;break;case"T":for(v(_.length>=2,"insufficient arguments in command"),v(_.length%2==0,"command requires pairs of arguments"),g=0;g<_.length;g+=2)l=2*this._xy[0]-n[0],c=2*this._xy[1]-n[1],u=_[g]+E[0],h=_[g+1]+E[1],this.quadraticCurveTo(l,c,u,h),n[0]=l,n[1]=c;break;case"A":for(v(_.length>=7,"insufficient arguments in command"),v(_.length%7==0,"command requires sets of 7 arguments"),g=0;g<_.length;g+=7){var A=Math.abs(_[g]),x=Math.abs(_[g+1]),C=_[g+2]*Math.PI/180,w=0!==_[g+3],b=0!==_[g+4],M=_[g+5]+E[0],T=_[g+6]+E[1];A<o.KERNEL_TOLERANCE||x<o.KERNEL_TOLERANCE?this.lineTo(M,T):this.ellipseArcTo(A,x,C,w,b,M,T)}break;default:v(!1,"unrecognised command")}"Q"!==m&&"T"!==m&&(n=[this._xy[0],this._xy[1]]),"C"!==m&&"S"!==m&&(s=[this._xy[0],this._xy[1]])}return t||this._discardIfOpen(),this._addWire(),this},v.prototype.getWireBody=function(){return this._addWire(),this._wireBody},v.prototype.computeRegionizedWireBody=function(){this.getWireBody();for(var e=new n.WireBody,t=(0,d.mergeSketchRegions)(this._wireBody.getWires()),i=0;i<t.length;++i)for(var r=t[i].getLoops(),o=0;o<r.length;++o){var a=r[o],l=new s.Wire;l.addEdges(Array.from(a.collectEdges())),e.addWire(l)}return e},v.prototype.reset=function(){this._wireBody=new n.WireBody,this._curves=[],this._xy=[0,0]},t.Path2D=v},2208:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProgenitorMap=void 0;var r=i(2468),o=i(4728),n=function(){this._newToOldMap=new Map,this._oldToNewMap=new Map,this._labelMap=new Map};n.prototype.addEntry=function(e,t,i){t=Array.from(new Set(t)),o.ConsoleUtils.assert(!this._newToOldMap.has(e)),this._newToOldMap.set(e,t),i&&this._labelMap.set(e,i);for(var r=0;r<t.length;r++){var n=t[r],s=this._oldToNewMap.get(n);s?s.indexOf(e)<0&&s.push(e):this._oldToNewMap.set(n,[e])}},n.prototype.hasEntry=function(e){return this._newToOldMap.has(e)},n.prototype.removeEntry=function(e){var t=this._newToOldMap.get(e);if(t){this._newToOldMap.delete(e),this._labelMap.delete(e);for(var i=0;i<t.length;i++){var r=this._oldToNewMap.get(t[i]),n=r.indexOf(e);o.ConsoleUtils.assert(n>=0),r.splice(n,1),0===r.length&&this._oldToNewMap.delete(t[i])}}},n.prototype.size=function(){return this._newToOldMap.size},n.prototype.getProgenitors=function(e){return this._newToOldMap.get(e)},n.prototype.getDescendants=function(e){return this._oldToNewMap.get(e)||[]},n.prototype.getLabel=function(e){return this._labelMap.get(e)||""},n.prototype.getAllNewTopology=function(){return Array.from(this._newToOldMap.keys())},n.prototype.getAllOldTopology=function(){return Array.from(this._oldToNewMap.keys())},n.prototype.clear=function(){this._newToOldMap.clear(),this._oldToNewMap.clear(),this._labelMap.clear()},n.prototype.mergeMaps=function(e){var t=new n,i=new Set(this._newToOldMap.keys());return e._newToOldMap.keys().forEach((function(e){i.add(e)})),i.forEach((function(i){var r=this.getProgenitors(i)||[],o=e.getProgenitors(i)||[],n=this.getLabel(i)||e.getLabel(i);t.addEntry(i,r.concat(o),n)})),t},n.prototype.collapseMaps=function(e,t){var i=!1,r=!1;t&&(void 0!==t.keepIntermediates&&(i=t.keepIntermediates),void 0!==t.keepAllDescendants&&(r=t.keepAllDescendants));var o=new n,s=void 0;return r&&(s=new Set(e._newToOldMap.keys())),this._newToOldMap.forEach((function(t,n){for(var a=new Set,l=0;l<t.length;l++){var c=t[l],u=e.getProgenitors(c);u&&u.length>0?(u.forEach((function(e){a.add(e)})),i&&a.add(c)):a.add(c),r&&s.delete(c)}o.addEntry(n,Array.from(a))})),r&&s.forEach((function(t){var i=e.getProgenitors(t);o.hasEntry(t)&&(i=i.concat(o.getProgenitors(t)),o.removeEntry(t)),o.addEntry(t,i)})),o},n.prototype.toString=function(){for(var e="ProgenitorMap:\n",t=this.getAllNewTopology(),i=0;i<t.length;i++){var o=t[i];e+=r.TOPOLOGY_TYPES.toString(o.getTopologyType())+":"+o.getGuid();var n=this.getLabel(o);n&&(e+=" '"+n+"'"),e+=" -> [ ";for(var s=this.getProgenitors(o),a=0;a<s.length;a++)a>0&&(e+=", "),e+=r.TOPOLOGY_TYPES.toString(s[a].getTopologyType())+":"+s[a].getGuid();e+=" ]\n"}return e},t.ProgenitorMap=n},3332:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createBlock=void 0;var r=i(64),o=i(2472),n=i(2468),s=i(4728);t.createBlock=function(e,t){var i=[Math.min(e[0],t[0]),Math.min(e[1],t[1]),Math.min(e[2],t[2])],a=[Math.max(e[0],t[0]),Math.max(e[1],t[1]),Math.max(e[2],t[2])];s.ConsoleUtils.assert(a[0]-i[0]>n.KERNEL_TOLERANCE,"block is degenerate in x axis"),s.ConsoleUtils.assert(a[1]-i[1]>n.KERNEL_TOLERANCE,"block is degenerate in y axis"),s.ConsoleUtils.assert(a[2]-i[2]>n.KERNEL_TOLERANCE,"block is degenerate in z axis");var l=[[i[0],i[1],i[2]],[a[0],i[1],i[2]],[a[0],a[1],i[2]],[i[0],a[1],i[2]]],c=(0,r.createFaceFromPolyline)(l),u=a[2]-i[2];return(0,o.extrudeFace)(c,u)}},9128:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createCylinder=t.createCone=void 0;var r=i(1972),o=i(64),n=i(2468),s=i(8292),a=i(2984),l=i(3440),c=i(8360),u=i(2956),h=i(4524),d=i(6776),p=i(6508),g=i(5837),f=i(9984),v=i(4728),m=function(e,t,i,m,y,_){var E=e,A=t,x=Math.abs(i),C=void 0===m?x:Math.abs(m);if(x<n.KERNEL_TOLERANCE){E=t,A=e;var w=x;x=C,C=w}v.ConsoleUtils.assert(x>n.KERNEL_TOLERANCE);var b=r.Vector3.createFloat64();r.Vector3.subtract(b,A,E);var M=r.Vector3.length(b);v.ConsoleUtils.assert(M>n.KERNEL_TOLERANCE),r.Vector3.scale(b,b,1/M);var T=C-x,V=Math.abs(T)>n.KERNEL_TOLERANCE,S=0;V&&(S=Math.atan2(T,M));var L,R=r.Vector3.createFloat64();_&&r.Vector3.subtract(R,_,r.Vector3.scale(R,b,r.Vector3.dot(_,b))),(!_||r.Vector3.squaredLength(R)<n.KERNEL_TOLERANCE*n.KERNEL_TOLERANCE)&&r.Vector3.computeOrthogonal(R,b),r.Vector3.normalize(R,R),r.Vector3.scale(R,R,x);var P=y||1;v.ConsoleUtils.assert(P>0&&P<=1);var D=Math.max(x,C);Math.abs(D*(1-P))<n.KERNEL_TOLERANCE?V?(L=new a.Cone).set(E,x,b,S,R,1):(L=new l.Cylinder).set(E,x,b,R,1):V?(L=new u.EllipticalCone).set(E,R,P,b,S,1):(L=new c.EllipticalCylinder).set(E,R,P,b,1);var O=[0,M/Math.cos(S)];L.limitRangeU(O);var I=(0,o.makeConeOrCylinderVParamLoop)(L,O[0]),N=(0,o.makeConeOrCylinderVParamLoop)(L,O[1]);I.getCoedges()[0].setReversed(!0);var k=[];k[0]=new d.Face,k[0].setSurface(L),k[0].addLoops([I,N]);var B=I.getCoedges()[0].getEdge();if(B.getCurve()){var F=new h.Loop;F.addCoedge((0,o.createCoedgeOnEdge)(B)),(U=new d.Face).addLoop(F);var z=new s.Plane;z.set(E,b),U.setSurface(z),U.setReversed(!0),k.push(U),v.ConsoleUtils.assert(F.getCoedges()[0].uvAngleSubtended(E)<-n.KERNEL_TOLERANCE)}var j=N.getCoedges()[0].getEdge();if(j.getCurve()){var U,G=new h.Loop;G.addCoedge((0,o.createCoedgeOnEdge)(j)),(U=new d.Face).addLoop(G);var W=new s.Plane;W.set(A,b),U.setSurface(W),k.push(U),v.ConsoleUtils.assert(G.getCoedges()[0].uvAngleSubtended(A)<-n.KERNEL_TOLERANCE)}var Y=new p.Shell;Y.addFaces(k);var H=new g.Lump;H.addShell(Y);var q=new f.Body;return q.addLump(H),q};t.createCone=m,t.createCylinder=function(e,t,i,r,o){return m(e,t,i,i,r,o)}},4268:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.svgFromWire=void 0;var r=i(2468),o=i(4728);t.svgFromWire=function(e){e.getTopologyType()===r.TOPOLOGY_TYPES.WIREBODY&&console.warn("svgFromWire: Pass a wire, not a wire body."),o.ConsoleUtils.assert(e.getTopologyType()===r.TOPOLOGY_TYPES.WIRE,"Input topology is not a Wire");var t=e.getOrderedEdges();if(0===t.edges.length)return"";for(var i=t.start,n=i.getPosition(),s="M "+n[0]+" "+n[1],a=0;a<t.edges.length;++a){var l=t.edges[a];n=(i=i===l.getStartVertex()?l.getEndVertex():l.getStartVertex()).getPosition();var c=l.getCurve();if(c)if(c.getGeometryType()===r.GEOMETRY_TYPES.LINE)s+=" L "+n[0]+" "+n[1];else if(c.getGeometryType()!==r.GEOMETRY_TYPES.BCURVE||3!==c.getDegree()||c.isRational())console.warn("Unhandled curve type in svgFromWire");else{for(var u=[],h=c.getBezierSegments(),d=0;d<h.length;d++){var p=h[d];if(p)for(var g=p.getControlPoints(),f=0;f<g.length;f+=3)u.push([g[f],g[f+1]])}i===l.getStartVertex()!==l.isReversed()&&u.reverse(),o.ConsoleUtils.assert(u.length===4*h.length,"Unexpected number of control points");for(var v=0;v<h.length;++v)s+=" C "+u[4*v+1][0]+" "+u[4*v+1][1]+" "+u[4*v+2][0]+" "+u[4*v+2][1]+" ",v===h.length-1?s+=n[0]+" "+n[1]:s+=u[4*v+3][0]+" "+u[4*v+3][1]}}return s}},7616:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mergeConnectedFaces=t.mergeFaces=t.findConnectedFaces=t.findConnectedEdges=t.mergeCoincidentVertices=t.transformTopology=t.reverseFace=void 0;var r=i(1972),o=i(2468),n=i(4524),s=i(4728),a=function(e,t){var i=!1,r=!0,o=new Set;t&&(void 0!==t.inputFacesOnly&&(i=t.inputFacesOnly),void 0!==t.allowVertexConnections&&(r=t.allowVertexConnections),void 0!==t.barrierEdges&&(o=new Set(t.barrierEdges)));for(var n,s=new Set,a=new Set(e),l=[];a.size>0;)s.clear(),n=a.values().next().value,a.delete(n),s.add(n),s.forEach((function(t){var n=new Set;r?t.collectVertices().forEach((function(e){e.collectEdges(n)})):(t.collectEdges(n),o.forEach((function(e){n.delete(e)}))),n.forEach((function(t){for(var r=t.getCoedge(),o=r;o;){if(o.getLoop()){var n=o.getLoop().getFace();s.has(n)||i&&!(e.indexOf(n)>=0)||(s.add(n),a.delete(n))}(o=o.getPartner())===r&&(o=void 0)}}))})),l.push(Array.from(s));return l},l=function(e){if(1!==e.length){var t=new Set;e.forEach((function(e){e.collectEdges(t)}));var i=new Set,r=[];t.forEach((function(t){var o=t.getCoedges(),n=o.map((function(t){return e.indexOf(t.getFace())>=0}));if(2===o.length&&n[0]&&n[1])r.push(t);else for(var s=0;s<o.length;s++)n[s]&&(i.add(o[s]),o[s].resetUVCurve())}));for(var o=[];i.size>0;){for(var a=[],l=i.values().next().value;l;){a.push(l),i.delete(l);var c=l,u=void 0,h=2*l.getEndVertex().getEdges().length;do{if(c=c.getNext(),i.has(c)){u=c;break}c=c.getPartner()}while(c&&c!==l&&--h>0);l=u}s.ConsoleUtils.assert(a[0].getStartVertex()===a[a.length-1].getEndVertex()),o.push(a)}r.forEach((function(e){e.setStartVertex(null),e.setEndVertex(null)}));var d=e[0];d.setLoops([]),o.forEach((function(e){var t=new n.Loop;t.addCoedges(e),d.addLoop(t)}));for(var p=1;p<e.length;p++)e[p].getShell()&&e[p].getShell().removeFace(e[p]);var g=d.getSurface();g.unlimitRangeU(),g.unlimitRangeV()}};t.reverseFace=function(e){e.setReversed(!e.isReversed());for(var t,i=e.getLoops(),r=0;r<i.length;++r){for(var o=i[r].getCoedges(),n=0;n<o.length;++n)(t=o[n]).setReversed(!t.isReversed());o.reverse()}},t.transformTopology=function(e,t){Array.isArray(e)||(e=[e]);for(var i=new Set,r=new Set,n=new Set,s=0;s<e.length;++s){var a=e[s],l=a.getTopologyType();a.collectVertices(i),l!==o.TOPOLOGY_TYPES.VERTEX&&a.collectEdges(r),l!==o.TOPOLOGY_TYPES.VERTEX&&l!==o.TOPOLOGY_TYPES.EDGE&&l!==o.TOPOLOGY_TYPES.COEDGE&&l!==o.TOPOLOGY_TYPES.LOOP&&a.collectFaces(n)}i.forEach((function(e){e.getPoint()&&e.getPoint().transform(t)})),r.forEach((function(e){e.getCurve()&&e.getCurve().transform(t)})),n.forEach((function(e){e.getSurface()&&e.getSurface().transform(t)}))},t.mergeCoincidentVertices=function(e){for(var t=o.KERNEL_TOLERANCE*o.KERNEL_TOLERANCE,i=[],n=0;n<e.length;++n){var s,a=e[n],l=a.getStartVertex(),c=a.getEndVertex();for(s=0;s<i.length&&!(r.Vector3.squaredDistance(l.getPosition(),i[s].getPosition())<t);++s);if(s===i.length?i.push(l):(i[s].setPrecision(Math.max(i[s].getPrecision(),l.getPrecision())),a.setStartVertex(i[s])),l!==c)for(s=0;s<i.length&&!(r.Vector3.squaredDistance(c.getPosition(),i[s].getPosition())<t);++s);s===i.length?i.push(c):(i[s].setPrecision(Math.max(i[s].getPrecision(),c.getPrecision())),a.setEndVertex(i[s]))}},t.findConnectedEdges=function(e,t){for(var i=t||!1,r=[],o=new Set,n=0;n<e.length;++n){var s=e[n];if(!o.has(s)){for(var a=[],l=[s],c=0;c<l.length;++c){var u=l[c];o.has(u)||i&&!(e.indexOf(u)>=0)||(o.add(u),a.push(u),l=l.concat(u.getStartVertex().getEdges(),u.getEndVertex().getEdges()))}r.push(a)}}return r},t.findConnectedFaces=a,t.mergeFaces=l,t.mergeConnectedFaces=function(e){var t=[];return a(e,{inputFacesOnly:!0,allowVertexConnections:!1}).forEach((function(e){l(e),t.push(e[0])})),t}},4728:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={assert:function(e,t){if(!e)throw new Error(t)}};t.ConsoleUtils=i},6120:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=!1,r=!1,o={},n={init3D:function(e){for(var t in i=!0,e)"function"==typeof e[t]&&(n[t]=e[t].bind(e))},setLevel:function(e,t){var i=o[e];return o[e]=t,console.log("Debug of "+e+" set to level "+t),i},level:function(e){if(!i)return 0;var t=o[e];return void 0===t?0:t},setConsoleWarnings:function(e){r=e},warn:function(e){r&&console.warn(e)}};t.DebugUtils=n},6344:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.edgesAreCoincident=t.curvesAreCoincident=void 0;var r=i(1972),o=i(2468),n=i(4728),s=i(6120);function a(e,t,i,o,n){var s=e.evaluatePosition(t),a=i.closestToPointParam(s,o),l=i.evaluatePosition(a);return r.Vector3.squaredDistance(s,l)<n*n}function l(e,t,i,o,n,s){var l=[0,0,0];if(r.Vector3.isParallel(e,t.getNormal()))return!0;r.Vector3.add(l,t.getCenter(),e);var c=t.closestToPointParam(l,o);if(c>o[0]&&c<o[1]&&!a(t,c,i,n,s))return!1;r.Vector3.sub(l,t.getCenter(),e);var u=t.closestToPointParam(l,o);return!(u>o[0]&&u<o[1]&&!a(t,u,i,n,s))}function c(e,t,i,r,o){if(!a(e,.5*(i[0]+i[1]),t,r,o))return!1;var n=t.closestToPointParam(e.getCenter(),r);return!(n>r[0]&&n<r[1]&&!a(t,n,e,i,o))}var u=function(e,t,i,u,h){i?0===i.length&&(i=e.getRangeUnlimited()):i=e.getRange(),u?0===u.length&&(u=t.getRangeUnlimited()):u=t.getRange(),h||(h=o.KERNEL_TOLERANCE);var d=e.getGeometryType(),p=t.getGeometryType();if(!(isFinite(i[0])&&isFinite(i[1])&&isFinite(u[0])&&isFinite(u[1]))){var g=i[0]===Number.NEGATIVE_INFINITY&&i[1]===Number.POSITIVE_INFINITY,f=u[0]===Number.NEGATIVE_INFINITY&&u[1]===Number.POSITIVE_INFINITY;return!(!g||!f)&&(n.ConsoleUtils.assert(d===o.GEOMETRY_TYPES.LINE&&p===o.GEOMETRY_TYPES.LINE),function(e,t,i){if(e===t)return!0;if(!a(e,0,t,[],i)||!a(t,0,e,[],i))return!1;var o=e.evaluateDt(0);r.Vector3.normalize(o,o);var n=t.evaluateDt(0);return r.Vector3.normalize(n,n),r.Vector3.dot(o,n)<0&&r.Vector3.negate(n,n),r.Vector3.equals(o,n,r.FLOAT64_TOLERANCE)}(e,t,h))}return e===t&&Math.abs(i[0]-u[0])<r.FLOAT64_TOLERANCE&&Math.abs(i[1]-u[1])<r.FLOAT64_TOLERANCE||!!(a(e,i[0],t,u,h)&&a(e,i[1],t,u,h)&&a(t,u[0],e,i,h)&&a(t,u[1],e,i,h))&&(d===o.GEOMETRY_TYPES.LINE&&p===o.GEOMETRY_TYPES.LINE||(d===o.GEOMETRY_TYPES.CIRCLE&&p===o.GEOMETRY_TYPES.CIRCLE?function(e,t,i,o,n){var s=.5*(i[0]+i[1]),c=.5*(o[0]+o[1]);if(!a(e,s,t,o,n)||!a(t,c,e,i,n))return!1;var u=r.Vector3.sub([0,0,0],t.getCenter(),e.getCenter());if(r.Vector3.squaredLength(u)>r.FLOAT64_TOLERANCE*r.FLOAT64_TOLERANCE){if(r.Vector3.normalize(u,u),!l(u,e,t,i,o,n))return!1;if(!l(u,t,e,o,i,n))return!1}if(r.Vector3.dot(e.getNormal(),t.getNormal())<0?r.Vector3.add(u,e.getNormal(),t.getNormal()):r.Vector3.sub(u,e.getNormal(),t.getNormal()),r.Vector3.squaredLength(u)>r.FLOAT64_TOLERANCE*r.FLOAT64_TOLERANCE){if(r.Vector3.normalize(u,u),!l(u,e,t,i,o,n))return!1;if(!l(u,t,e,o,i,n))return!1}if(i[1]-i[0]<2*Math.PI-r.FLOAT64_TOLERANCE){var h=e.evaluatePosition(s+Math.PI),d=t.closestToPointParam(h,o);if(d>o[0]&&d<o[1]&&!a(t,d,e,i,n))return!1}if(o[1]-o[0]<2*Math.PI-r.FLOAT64_TOLERANCE){var p=t.evaluatePosition(c+Math.PI),g=e.closestToPointParam(p,i);if(g>i[0]&&g<i[1]&&!a(e,g,t,o,n))return!1}return!0}(e,t,i,u,h):d===o.GEOMETRY_TYPES.CIRCLE&&p===o.GEOMETRY_TYPES.LINE?c(e,t,i,u,h):d===o.GEOMETRY_TYPES.LINE&&p===o.GEOMETRY_TYPES.CIRCLE?c(t,e,u,i,h):function(e,t,i,o,n){for(var a=[i[0],i[1]],l=[e.evaluatePosition(i[0]),e.evaluatePosition(i[1])],c=0;c<100;++c){var u=.5*(a[0]+a[1]),h=e.evaluatePosition(u),d=t.closestToPointParam(h,o),p=t.evaluatePosition(d),g=r.Vector3.sub([0,0,0],p,h);if(r.Vector3.squaredLength(g)>n*n)return!1;if(r.Vector3.distance(l[0],h)+r.Vector3.distance(h,l[1])<n)return!0;var f=e.evaluateDt(u);r.Vector3.dot(f,g)<0?(a[0]=u,l[0]=h):(a[1]=u,l[1]=h)}return s.DebugUtils.warn("Binary search in coincidence check exceeded maximum iterations"),!0}(e,t,i,u,h)))};t.curvesAreCoincident=u,t.edgesAreCoincident=function(e,t){if(e===t)return!0;var i=Math.max(o.KERNEL_TOLERANCE,e.getPrecision(),t.getPrecision()),n=e.getCurve(),s=t.getCurve();if(!n||!s){if(n||s)return!1;var a=e.getStartVertex(),l=t.getStartVertex();i=Math.max(i,a.getPrecision(),l.getPrecision());var c=a.getPosition(),h=l.getPosition();return r.Vector3.squaredDistance(c,h)<i*i}var d=e.getRange();e.isReversed()&&(d=[-d[1],-d[0]]);var p=t.getRange();return t.isReversed()&&(p=[-p[1],-p[0]]),u(n,s,d,p,i)}},3900:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CCI=void 0;var r=i(1972),o=i(9892),n=i(880),s=function(e,t){this.cutInfo=e,this.cutByInfo=t},a=function(e,t,i,r,n){this._cu1=e,this._range1=t,this._cu2=i,this._range2=r,this._epsilon=n,this._tree=new o.SubCurveTree(e,t,i,r,n)};a.prototype.intersect=function(){var e=[];this._tree.build();for(var t=0;t<this._tree._overlaps.length;++t){var i=this._tree._overlaps[t][0],r=this._tree._overlaps[t][1];e=e.concat(this._solve(i._range,r._range))}return this._merge(e),e},a.prototype._distanceSquared=function(e,t){var i=this._cu1.evaluatePosition(e),o=this._cu2.evaluatePosition(t);return r.Vector3.squaredDistance(i,o)},a.prototype._solve=function(e,t){var i=[],r=[.5*(e[0]+e[1]),.5*(t[0]+t[1])],o=this._relaxNR(r,[e,t]),a=o===n.RelaxResult.Success;if(o===n.RelaxResult.OutOfRange){var l=r[0]<e[0]+1e-12||r[0]>e[1]-1e-12,c=r[1]<t[0]+1e-12||r[1]>t[1]-1e-12;(l||c)&&this._distanceSquared(r[0],r[1])<this._epsilon*this._epsilon&&(a=!0)}return a&&i.push(new s({param:r[0],atVertex:void 0},{param:r[1],atVertex:void 0})),i},a.prototype._relaxNR=function(e,t){var i=this,o=(0,n.newtonRaphson2D)((function(e){var t=i._cu1.evaluatePosition(e[0]),o=i._cu2.evaluatePosition(e[1]),n=[t[0]-o[0],t[1]-o[1]],s=i._cu1.evaluateDt(e[0]),a=i._cu2.evaluateDt(e[1]);return r.Vector3.negate(a,a),{val:n,deriv1:s,deriv2:a}}),e,t);return e[0]=o.param[0],e[1]=o.param[1],o.status},a.prototype._merge=function(e){e.sort((function(e,t){return e.cutInfo.param-t.cutInfo.param}));for(var t=0;t<e.length;t++)if(e[t])for(var i=e[t].cutInfo.param,r=e[t].cutByInfo.param,o=t+1;o<e.length;o++)if(e[o]){var n=e[o].cutInfo.param,s=e[o].cutByInfo.param;if(n>i+1e-11)break;if(Math.abs(s-r)<=1e-11){e[t]=void 0;break}}for(t=0;t<e.length;t++)e[t]||(e.splice(t,1),t--)},t.CCI=a},8460:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.computeCurveCurveIntersections=void 0;var r=i(1972),o=i(2468),n=i(3565),s=i(1096),a=i(7580),l=i(6940),c=i(5856),u=i(5416),h=i(5896),d=i(3900),p=o.KERNEL_TOLERANCE,g=function(e,t,i,o){var n=t,s=e.getRange();if(e.getCurve().isPeriodicUnlimited()&&(n<s[0]-r.FLOAT64_TOLERANCE||n>s[1]+r.FLOAT64_TOLERANCE)){var a=e.getCurve().getPeriodUnlimited();n=(0,h.foldNearTo)(n,.5*(s[0]+s[1]),a)}var l=Math.abs(n-s[0])<Math.abs(n-s[1])?0:1,c=r.Vector3.length(e.evaluateDt(n));return Math.abs(n-s[l])*c<i?{param:s[l],atVertex:e.getVertex(l)}:n>=s[0]&&n<=s[1]?{param:n,atVertex:void 0}:!e.isClosed()&&o.distanceToPoint(e.getVertex(l).getPosition())<i?{param:s[l],atVertex:e.getVertex(l)}:void 0},f=function(e,t,i,o,n){var s=g(e,t,n,i);if(s){if(s.atVertex){var a=i.getRange();e===i&&(a=[o-.1*(c=Math.abs(a[1]-a[0])),o+.1*c]);var l=i.closestToPointParam(s.atVertex.getPosition(),a);r.Vector3.distance(i.evaluatePosition(l),s.atVertex.getPosition())<n&&(o=l)}var c,u=g(i,o,n,e);if(u)if(u.atVertex&&(a=e.getRange(),e===i&&(a=[t-.1*(c=Math.abs(a[1]-a[0])),t+.1*c]),l=e.closestToPointParam(u.atVertex.getPosition(),a),r.Vector3.distance(e.evaluatePosition(l),u.atVertex.getPosition())<n&&(s=g(e,t=l,n,i))),s)return{cutInfo:s,cutByInfo:u}}},v=function(e,t,i){var r=[t-e.getRange()[0],t-e.getRange()[1]];if(r[0]>=i&&r[1]<=-i)return{param:t,atVertex:void 0};var o=Math.abs(r[0])<Math.abs(r[1])?0:1;return Math.abs(r[o])<i?{param:e.getRange()[o],atVertex:e.getVertex(o)}:void 0},m=function(e,t,i,n,s,a,l){var c=e.getCurve().getPeriodUnlimited(),u=t.getCurve().getPeriodUnlimited(),d=[i[0],i[2]],p=[n[0],n[2]],f=[s/r.Vector3.length(e.evaluateDt(d[0])),s/r.Vector3.length(e.evaluateDt(d[1]))],v=[s/r.Vector3.length(t.evaluateDt(p[0])),s/r.Vector3.length(t.evaluateDt(p[1]))];if(((0,h.isParameterWithinPeriodicRange)(d[0],e.getRange(),c,f[0])||(0,h.isParameterWithinPeriodicRange)(d[1],e.getRange(),c,f[1]))&&((0,h.isParameterWithinPeriodicRange)(p[0],t.getRange(),u,v[0])||(0,h.isParameterWithinPeriodicRange)(p[1],t.getRange(),u,v[1]))){for(var m=0;m<2;m++){d[m]=(0,h.adjustParameterToPeriodicRange)(d[m],e.getRange(),c,!1,!0),p[m]=(0,h.adjustParameterToPeriodicRange)(p[m],t.getRange(),u,!1,!0);var y=(0,h.periodicDifference)(d[m],e.getRange()[0],c)<3e-15||(0,h.periodicDifference)(d[m],e.getRange()[1],c)<3e-15,_=(0,h.periodicDifference)(p[m],t.getRange()[0],u)<3e-15||(0,h.periodicDifference)(p[m],t.getRange()[1],u)<3e-15;if(d[m]-e.getRange()[0]<f[m]&&(d[m]=e.getRange()[0],y=!0),e.getRange()[1]-d[m]<f[m]&&(d[m]=e.getRange()[1],y=!0),p[m]-t.getRange()[0]<v[m]&&(p[m]=t.getRange()[0],_=!0),t.getRange()[1]-p[m]<v[m]&&(p[m]=t.getRange()[1],_=!0),y){var E=t.closestToPointParam(e.evaluatePosition(d[m]));p[m]=(0,h.adjustParameterToPeriodicRange)(E,t.getRange(),u,!1,!0)}if(_){var A=e.closestToPointParam(t.evaluatePosition(p[m]));d[m]=(0,h.adjustParameterToPeriodicRange)(A,e.getRange(),c,!1,!0),((0,h.periodicDifference)(d[m],e.getRange()[0],c)<3e-15||(0,h.periodicDifference)(d[m],e.getRange()[1],c)<3e-15)&&(E=t.closestToPointParam(e.evaluatePosition(d[m])),p[m]=(0,h.adjustParameterToPeriodicRange)(E,t.getRange(),u,!1,!0))}}var x,C;if((0,h.periodicDifference)(d[0],d[1],c)<Math.min(f[0],f[1])&&(0,h.periodicDifference)(p[0],p[1],u)<Math.min(v[0],v[1]))x=g(e,.5*(d[0]+d[1]),s,e),C=g(t,.5*(p[0]+p[1]),s,t);else for(x=g(e,i[1],s,e),C=g(t,n[1],s,t),m=0;m<2;m++)if(!((0,h.periodicDifference)(d[m],x.param,c)<f[m]&&(0,h.periodicDifference)(p[m],C.param,u)<v[m])){var w,b,M=g(e,d[m],s,e),T=g(t,p[m],s,t);if(isFinite(c)){var V=(0,h.getShortestParametricRange)(M.param,x.param,c);w=(0,h.periodicDifference)(x.param,V[0],c)<=o.KERNEL_ANGULAR_TOLERANCE}else w=M.param>x.param;isFinite(u)?(V=(0,h.getShortestParametricRange)(T.param,C.param,u),b=(0,h.periodicDifference)(C.param,V[0],u)<=o.KERNEL_ANGULAR_TOLERANCE):b=T.param>C.param,a.push({rangeInfo:w?[x,M]:[M,x],rangeByInfo:b?[C,T]:[T,C]})}l&&l.push({firstParam:x.param,secondParam:C.param})}},y=function(e,t,i,o){var n=e.getRange(),s=e.evaluatePosition(0),a=e.evaluateDt(0),l=r.Vector2.length(a),c=t.getRange(),u=t.evaluatePosition(0),d=t.evaluateDt(0),p=r.Vector2.length(d),g=[a[1]/l,-a[0]/l],m=t.evaluatePosition(c[0]);r.Vector2.subtract(m,m,s);var y=r.Vector2.dot(m,g),_=t.evaluatePosition(c[1]);r.Vector2.subtract(_,_,s);var E=r.Vector2.dot(_,g);if(Math.abs(y)<=o&&Math.abs(E)<=o){var A=r.Vector2.dot(m,a)/(l*l),x=r.Vector2.dot(_,a)/(l*l),C=[Math.min(A,x),Math.max(A,x)],w=o/l,b=o/p;if(C[1]<n[0]-w||C[0]>n[1]+w)return[];var M=[Math.max(n[0],C[0]),Math.min(n[1],C[1])];if(M[1]-M[0]<w){var T=.5*(M[0]+M[1]),V=Math.abs(x-A)>r.FLOAT64_TOLERANCE?c[0]+(c[1]-c[0])*(T-A)/(x-A):.5*(c[0]+c[1]);return[{cutInfo:v(e,T,w),cutByInfo:v(t,V,b)}]}if(!i)return[];var S=c[0]+(c[1]-c[0])*(M[0]-A)/(x-A),L=c[0]+(c[1]-c[0])*(M[1]-A)/(x-A);return[{rangeInfo:[v(e,M[0],w),v(e,M[1],w)],rangeByInfo:[v(t,Math.min(S,L),b),v(t,Math.max(S,L),b)]}]}if(y>o&&E>o||y<-o&&E<-o)return[];var R=[[a[0],-d[0],u[0]-s[0]],[a[1],-d[1],u[1]-s[1]]],P=(0,h.solveTwoEquationsTwoVariables)(R);if(P){var D=f(e,P[0],t,P[1],o);if(D)return[D]}return[]},_=function(e,t,i){var o,n=t.getCenter(),s=e.closestToPointParam(n,[]),a=e.evaluatePosition(s),l=r.Vector3.squaredDistance(a,n),c=[],u=t.getRadius(),h=u-Math.sqrt(l);if(h<-i);else if(h<i)o=t.closestToPointParam(a,[]),c.push({lineParam:s,circleParam:o});else for(var d=Math.sqrt(u*u-l)/r.Vector3.length(e.evaluateDt(0)),p=0;p<2;++p){var g=s+(0===p?-1:1)*d,f=e.evaluatePosition(g);o=t.closestToPointParam(f,[]),c.push({lineParam:g,circleParam:o})}return c},E=function(e,t,i,r,o,n){var s=[i[0]+t*r[0]-e*r[1],i[1]+t*r[1]+e*r[0],0];return{firstParam:o.closestToPointParam(s,[0,2*Math.PI]),secondParam:n.closestToPointParam(s,[0,2*Math.PI])}},A=function(e,t){t||(t=o.KERNEL_TOLERANCE);for(var i=[],r=!1,n=[],s=[],a=0;a<e.length;++a)e[a].hasOwnProperty("rangeInfo")?(!1===r?(n=e[a].rangeInfo,s=e[a].rangeByInfo):Math.abs(n[1].param-e[a].rangeInfo[0].param)<t&&Math.abs(s[1].param-e[a].rangeByInfo[0].param)<t?(n[1]=e[a].rangeInfo[1],s[1]=e[a].rangeByInfo[1]):(i.push({rangeInfo:n,rangeByInfo:s}),n=e[a].rangeInfo,s=e[a].rangeByInfo),r=!0):e[a].hasOwnProperty("cutInfo")?(r&&i.push({rangeInfo:n,rangeByInfo:s}),i.push(e[a]),r=!1):console.warn("unknown segment type in intersection code");return r&&i.push({rangeInfo:n,rangeByInfo:s}),i},x=function(e,t,i,o,n){var s=i.getControlPoints(),a=i.getKnotVector(),l=e.getBoundingBox(),c=[];if(!i.getBoundingBox([a[0],a[a.length-1]]).intersectsWithTolerance(l,n))return c;var d=new Float64Array(s.length),p=s.length/3-1,y=r.Vector2.createFloat64FromValues(e.getStartVertex().getPosition()[0],e.getStartVertex().getPosition()[1]),_=r.Vector3.createFloat64();r.Vector3.sub(_,e.getEndVertex().getPosition(),e.getStartVertex().getPosition()),r.Vector3.normalize(_,_);for(var E=r.Vector2.createFloat64FromValues(_[0],_[1]),A=r.Vector2.createFloat64(),x=!0,C=0;C<=p;++C)A[0]=s[3*C+0],A[1]=s[3*C+1],d[3*C+0]=C/p,d[3*C+1]=(0,h.signedDistanceTo2DLine)(y,E,A),Math.abs(d[3*C+1])>n&&(x=!1),d[3*C+2]=0;if(x)return o?(c=function(e,t,i,o,n){var s=o.length/3-1,a=r.Vector3.createFloat64FromValues(o[0],o[1],o[2]),l=e.closestToPointParam(a),c=r.Vector3.createFloat64FromValues(o[3*s+0],o[3*s+1],o[3*s+2]),u=e.closestToPointParam(c),h=[v(e,l,i),v(e,u,i)];if(h[0].param>h[1].param){var d=h[0];h[0]=h[1],h[1]=d}var p=n[0],f=n[n.length-1];if(t.isReversed()){var m=p;p=-f,f=-m}var y=[g(t,p,i,e),g(t,f,i,e)];return h[0]&&h[1]&&y[0]&&y[1]?[{rangeInfo:h,rangeByInfo:y}]:(console.warn("Error in intersection computation."),[])}(e,t,n,s,a),c):[];var w=new Float64Array(3),b=[];return c=function(e,t,i,r,o,n,s,a,l){var c,u=[],h=r.length/3-1;3===n?(s[0]>s[1]&&(c=s[0],s[0]=s[1],s[1]=c),s[1]>s[2]&&(c=s[1],s[1]=s[2],s[2]=c),s[0]>s[1]&&(c=s[0],s[0]=s[1],s[1]=c)):2===n&&s[0]>s[1]&&(c=s[0],s[0]=s[1],s[1]=c);var d=[!1,!1,!1],p=o[o.length-1]-o[0],v=t.getCurve().tangentLength(o[0])*p;Math.abs(r[1])<i&&(0===n||s[0]>i/v)&&(n++,s[2]=s[1],s[1]=s[0],s[0]=0,d[0]=!0);var y=t.getCurve().tangentLength(o[o.length-1])*p;Math.abs(r[3*h+1])<i&&(0===n||1-s[n-1]>i/y)&&(s[n]=1,d[n]=!0,n++);for(var _=e.isReversed()?-1:1,E=t.isReversed()?-1:1,A=0,x=0;x<n+1;++x){var C=!1;if(x!==n){var w=s[x];s[x]=o[0]+(o[o.length-1]-o[0])*s[x];var b=t.getCurve().evaluatePosition(s[x]),M=e.getCurve().closestToPointParam(b,[]),T=f(e,M*_,t,s[x]*E,i);T&&(T.cutInfo.virtualIntersection=d[x],T.cutByInfo.virtualIntersection=d[x],u.push(T))}else w=o[o.length-1],C=Math.abs(r[3*h+1])>i;if(0===x&&w>0&&Math.abs(r[0])>i&&(C=!0),l){var V=void 0;if(a.length>0&&a[0][0]>=A&&a[0][0]<=w&&(V=a[0]),a.length>1&&a[1][0]>=A&&a[1][0]<=w&&(V=a[1]),void 0!==V&&Math.abs(V[1])<i&&!C){var S=[o[0]+(o[o.length-1]-o[0])*A,o[0]+(o[o.length-1]-o[0])*w],L=[e.getCurve().closestToPointParam(t.getCurve().evaluatePosition(S[0]),[]),e.getCurve().closestToPointParam(t.getCurve().evaluatePosition(S[1]),[])];if(Math.abs(L[0]-L[1])>i){var R=[g(e,L[0]*_,i,t),g(e,L[1]*_,i,t)],P=[g(t,S[0]*E,i,e),g(t,S[1]*E,i,e)];if(R[0]&&R[1]&&P[0]&&P[1]){var D=o[0]+(o[o.length-1]-o[0])*V[0];D!==S[0]&&D!==S[1]||(D=.5*(S[0]+S[1]));var O=e.getCurve().closestToPointParam(t.getCurve().evaluatePosition(D),[]);m(e,t,[L[0]*_,O*_,L[1]*_],[S[0]*E,D*E,S[1]*E],i,u);var I={cutInfo:g(e,O*_,i,e),cutByInfo:g(t,D*E,i,e)};I.cutInfo.virtualIntersection=!0,I.cutByInfo.virtualIntersection=!0,u.push(I)}}}}A=w}return u}(e,t,n,d,a,u.SplineCurveHelper.intersect_xAxis_NonRationalCubicBSpline_XYPlanar3D([0,0,0],d,w,b),w,b,o),c},C=function(e,t,i,r){var o=e.getBoundingBox(),n=[];if(!t.getBoundingBox().intersectsWithTolerance(o,r))return n;for(var s=t.getCurve().getBezierSegments(),a=s.length,l=0;l<a;l++)for(var c=x(e,t,s[l],i,r),u=0;u<c.length;++u)n.push(c[u]);return A(n)},w=function(e,t,i,o,n){var a=i.getControlPoints(),l=i.getKnotVector(),u=e.getBoundingBox(),d=[];if(!i.getBoundingBox([l[0],l[l.length-1]]).intersectsWithTolerance(u,n))return d;for(var v=!0,m=r.Vector2.createFloat64(),y=r.Vector2.createFloat64(),E=r.Vector2.createFloat64(),A=0;A<a.length/3-2&&v;++A)m[0]=a[3*A+0],m[1]=a[3*A+1],y[0]=a[3*A+3],y[1]=a[3*A+4],E[0]=a[3*A+6],E[1]=a[3*A+7],v=Math.abs((0,h.orient2D)(m,y,E))<p;if(v){var x=new s.Line,C=r.Vector3.createFloat64FromValues(a[0],a[1],a[2]),w=r.Vector3.createFloat64FromValues(a[a.length-3],a[a.length-2],a[a.length-1]);x.setFromEndpoints(C,w);var b=r.Vector3.distance(w,C),M=_(x,e.getCurve(),n);for(A=0;A<M.length;++A)if(M[A].lineParam>=0&&M[A].lineParam<=b){M[A].lineParam=t.getCurve().closestToPointParam(x.evaluatePosition(M[A].lineParam),[]);var T=g(e,M[A].circleParam*(e.isReversed()?-1:1),n,t),V=g(t,M[A].lineParam*(t.isReversed()?-1:1),n,e);V&&T&&d.push({cutInfo:T,cutByInfo:V})}return d}var S=r.Vector2.createFloat64(),L=r.Vector2.createFloat64(),R=r.Vector2.createFloat64(),P=r.Vector2.createFloat64();S[0]=-a[0]+3*a[3]-3*a[6]+a[9],S[1]=-a[1]+3*a[4]-3*a[7]+a[10],L[0]=3*a[0]-6*a[3]+3*a[6],L[1]=3*a[1]-6*a[4]+3*a[7],R[0]=-3*a[0]+3*a[3],R[1]=-3*a[1]+3*a[4],P[0]=a[0],P[1]=a[1];var D=e.getCurve().getCenter(),O=e.getCurve().getRadius()*e.getCurve().getRadius(),I=O,N=new Float64Array(7);N[0]=I*S[0]*S[0]+O*S[1]*S[1],N[1]=2*I*S[0]*L[0]+2*L[1]*O*S[1],N[2]=2*R[0]*I*S[0]+L[1]*L[1]*O+I*L[0]*L[0]+2*R[1]*O*S[1],N[3]=-2*D[1]*O*S[1]+2*L[1]*R[1]*O+2*R[0]*I*L[0]-2*I*S[0]*D[0]+2*I*S[0]*P[0]+2*P[1]*O*S[1],N[4]=-2*I*D[0]*L[0]+R[1]*R[1]*O-2*D[1]*L[1]*O+2*I*P[0]*L[0]+R[0]*R[0]*I+2*P[1]*L[1]*O,N[5]=-2*D[1]*R[1]*O-2*R[0]*I*D[0]+2*R[0]*I*P[0]+2*P[1]*R[1]*O,N[6]=I*D[0]*D[0]-2*P[1]*D[1]*O-I*O+D[1]*D[1]*O+P[1]*P[1]*O-2*I*D[0]*P[0]+I*P[0]*P[0];var k=(0,c.getRealPolynomialRoots)(N);for(A=0;A<k.length;++A)if(k[A]>=0&&k[A]<=1){k[A]=l[0]+(l[l.length-1]-l[0])*k[A];var B=t.getCurve().evaluatePosition(k[A]),F=e.getCurve().closestToPointParam(B,[]),z=f(e,F*(e.isReversed()?-1:1),t,k[A]*(t.isReversed()?-1:1),n);z&&d.push(z)}return d},b=function(e,t,i,r,o){var n=e.getBoundingBox(),s=[];if(!t.getBoundingBox().intersectsWithTolerance(n,o))return s;var a=0;e.isClosed()&&r&&(a=1);for(var l=t.getCurve().getBezierSegments(),c=l.length,u=0;u<c;u++)for(var h=w(e,t,l[u],0,o),d=0;d<h.length;++d)for(var p=-a;p<=a;++p)s.push({cutInfo:{atVertex:h[d].cutInfo.atVertex,param:h[d].cutInfo.param+p*Math.PI*2},cutByInfo:h[d].cutByInfo});return A(s)},M=function(e,t,i,u,d,v,m){var _=i.getControlPoints(),E=i.getKnotVector(),A=u.getControlPoints(),C=u.getKnotVector(),w=i.getBoundingBox([E[0],E[E.length-1]]),b=u.getBoundingBox([C[0],C[C.length-1]]),M=e===t,T=!1,V=!1;M&&Math.abs(_[_.length-3]-A[0])<v&&Math.abs(_[A.length-2]-A[1])<v&&Math.abs(_[A.length-1]-A[2])<v&&(T=!0),M&&Math.abs(_[0]-A[_.length-3])<v&&Math.abs(_[1]-A[A.length-2])<v&&Math.abs(_[2]-A[A.length-1])<v&&(V=!0);var S=[];if(!w.intersectsWithTolerance(b,v))return S;var L=!0,R=!0,P=r.Vector2.createFloat64(),D=r.Vector2.createFloat64(),O=r.Vector2.createFloat64();for(De=0;De<_.length/3-2&&L;++De)P[0]=_[3*De+0],P[1]=_[3*De+1],D[0]=_[3*De+3],D[1]=_[3*De+4],O[0]=_[3*De+6],O[1]=_[3*De+7],L=Math.abs((0,h.orient2D)(P,D,O))<p;for(De=0;De<A.length/3-2&&R;++De)P[0]=A[3*De+0],P[1]=A[3*De+1],D[0]=A[3*De+3],D[1]=A[3*De+4],O[0]=A[3*De+6],O[1]=A[3*De+7],R=Math.abs((0,h.orient2D)(P,D,O))<p;if(L||R)return S=function(e,t,i,c,u,h,d,p,v){var m=u.getControlPoints(),_=h.getControlPoints(),E=[];if(e&&!t||!e&&t){var A,C,w=new s.Line;e?(A=r.Vector3.createFloat64FromValues(m[0],m[1],m[2]),C=r.Vector3.createFloat64FromValues(m[m.length-3],m[m.length-2],m[m.length-1])):(A=r.Vector3.createFloat64FromValues(_[0],_[1],_[2]),C=r.Vector3.createFloat64FromValues(_[_.length-3],_[_.length-2],_[_.length-1])),w.setFromEndpoints(A,C);var b=new a.Edge(w),M=r.Vector3.distance(C,A);b.setRange([0,M]);var T=new n.Point;T.setPosition(A[0],A[1],A[2]);var V=new n.Point;V.setPosition(C[0],C[1],C[2]);var S,L=new l.Vertex(T),R=new l.Vertex(V);b.setStartVertex(L),b.setEndVertex(R),ee=e?x(b,c,h,d,p):x(b,i,u,d,p);for(var P=0;P<ee.length;++P)if(ee[P].hasOwnProperty("cutInfo")&&ee[P].hasOwnProperty("cutByInfo")){if(ee[P].cutInfo.param>=0&&ee[P].cutInfo.param<=M&&(e?(ee[P].cutInfo.param=i.closestToPointParam(w.evaluatePosition(ee[P].cutInfo.param)),S=f(i,ee[P].cutInfo.param,c,ee[P].cutByInfo.param,p)):(ee[P].cutInfo.param=c.closestToPointParam(w.evaluatePosition(ee[P].cutInfo.param)),S=f(i,ee[P].cutByInfo.param,c,ee[P].cutInfo.param,p)),S))if(v){var D=S.cutInfo.param,O=S.cutByInfo.param;(I=Math.abs(D-O)*r.Vector3.length(i.evaluateDt(D)))>o.KERNEL_TOLERANCE&&!ee[P].cutInfo.virtualIntersection&&E.push(S)}else E.push(S)}else if(ee[P].hasOwnProperty("rangeInfo")&&ee[P].hasOwnProperty("rangeByInfo")&&ee[P].rangeInfo[0].param>=0&&ee[P].rangeInfo[0].param<=M&&ee[P].rangeInfo[1].param>=0&&ee[P].rangeInfo[1].param<=M)if(e?(ee[P].rangeInfo[0].param=i.closestToPointParam(w.evaluatePosition(ee[P].rangeInfo[0].param)),ee[P].rangeInfo[1].param=i.closestToPointParam(w.evaluatePosition(ee[P].rangeInfo[1].param))):(ee[P].rangeInfo[0].param=c.closestToPointParam(w.evaluatePosition(ee[P].rangeInfo[0].param)),ee[P].rangeInfo[1].param=c.closestToPointParam(w.evaluatePosition(ee[P].rangeInfo[1].param))),e?(te=[g(i,ee[P].rangeInfo[0].param,p,c),g(i,ee[P].rangeInfo[1].param,p,c)],ie=[g(c,ee[P].rangeByInfo[0].param,p,i),g(c,ee[P].rangeByInfo[1].param,p,i)]):(te=[g(i,ee[P].rangeByInfo[0].param,p,c),g(i,ee[P].rangeByInfo[1].param,p,c)],ie=[g(c,ee[P].rangeInfo[0].param,p,i),g(c,ee[P].rangeInfo[1].param,p,i)]),te[0]&&te[1]&&ie[0]&&ie[1]){var I=Math.abs(te[1].param-ie[0].param)*r.Vector3.length(i.evaluateDt(te[1]));(!v||v&&I>o.KERNEL_TOLERANCE)&&E.push({rangeInfo:te,rangeByInfo:ie})}else console.warn("Error in intersection computation.")}else{var N=new s.Line,k=new s.Line,B=r.Vector3.createFloat64FromValues(m[0],m[1],m[2]),F=r.Vector3.createFloat64FromValues(m[m.length-3],m[m.length-2],m[m.length-1]),z=r.Vector3.createFloat64FromValues(_[0],_[1],_[2]),j=r.Vector3.createFloat64FromValues(_[_.length-3],_[_.length-2],_[_.length-1]);N.setFromEndpoints(B,F),k.setFromEndpoints(z,j);var U=new a.Edge(N),G=r.Vector3.distance(F,B),W=new a.Edge(k),Y=r.Vector3.distance(j,z);U.setRange([0,G]),W.setRange([0,Y]);var H=new n.Point;H.setPosition(B[0],B[1],B[2]);var q=new n.Point;q.setPosition(F[0],F[1],F[2]);var K=new n.Point;K.setPosition(z[0],z[1],z[2]);var Q=new n.Point;Q.setPosition(j[0],j[1],j[2]);var Z=new l.Vertex(H),J=new l.Vertex(q),X=new l.Vertex(K),$=new l.Vertex(Q);U.setStartVertex(Z),U.setEndVertex(J),W.setStartVertex(X),W.setEndVertex($);var ee=y(U,W,d,p);for(P=0;P<ee.length;++P)if(ee[P].hasOwnProperty("cutInfo")&&ee[P].hasOwnProperty("cutByInfo"))ee[P].cutInfo.param>=0&&ee[P].cutInfo.param<=G&&ee[P].cutByInfo.param>=0&&ee[P].cutByInfo.param<=Y&&(ee[P].cutInfo.param=i.closestToPointParam(N.evaluatePosition(ee[P].cutInfo.param)),ee[P].cutByInfo.param=c.closestToPointParam(k.evaluatePosition(ee[P].cutByInfo.param)),S=f(i,ee[P].cutInfo.param,c,ee[P].cutByInfo.param,p))&&(D=S.cutInfo.param,O=S.cutByInfo.param,I=Math.abs(D-O)*r.Vector3.length(i.evaluateDt(D)),(!v||v&&I>o.KERNEL_TOLERANCE)&&E.push(S));else if(ee[P].hasOwnProperty("rangeInfo")&&ee[P].hasOwnProperty("rangeByInfo")&&ee[P].rangeInfo[0].param>=0&&ee[P].rangeInfo[0].param<=G&&ee[P].rangeInfo[1].param>=0&&ee[P].rangeInfo[1].param<=G&&ee[P].rangeByInfo[0].param>=0&&ee[P].rangeByInfo[0].param<=Y&&ee[P].rangeByInfo[1].param>=0&&ee[P].rangeByInfo[1].param<=Y){ee[P].rangeInfo[0].param=i.closestToPointParam(N.evaluatePosition(ee[P].rangeInfo[0].param)),ee[P].rangeInfo[1].param=i.closestToPointParam(N.evaluatePosition(ee[P].rangeInfo[1].param)),ee[P].rangeByInfo[0].param=c.closestToPointParam(k.evaluatePosition(ee[P].rangeByInfo[0].param)),ee[P].rangeByInfo[1].param=c.closestToPointParam(k.evaluatePosition(ee[P].rangeByInfo[1].param));var te=[g(i,ee[P].rangeInfo[0].param,p,c),g(i,ee[P].rangeInfo[1].param,p,c)],ie=[g(c,ee[P].rangeByInfo[0].param,p,i),g(c,ee[P].rangeByInfo[1].param,p,i)];te[0]&&te[1]&&ie[0]&&ie[1]?(I=Math.abs(te[1].param-ie[0].param)*r.Vector3.length(i.evaluateDt(te[1])),(!v||v&&I>o.KERNEL_TOLERANCE)&&E.push({rangeInfo:te,rangeByInfo:ie})):console.warn("Error in intersection computation.")}}return E}(L,R,e,t,i,u,d,v,m),S;var I=-_[0]+3*_[3]-3*_[6]+_[9],N=3*_[0]-6*_[3]+3*_[6],k=-3*_[0]+3*_[3],B=_[0],F=-_[1]+3*_[4]-3*_[7]+_[10],z=3*_[1]-6*_[4]+3*_[7],j=-3*_[1]+3*_[4],U=_[1],G=B*B,W=k*k,Y=N*N,H=I*I,q=B*B*B,K=k*k*k,Q=N*N*N,Z=I*I*I,J=U*U,X=j*j,$=z*z,ee=F*F,te=U*U*U,ie=j*j*j,re=z*z*z,oe=F*F*F,ne=-A[0]+3*A[3]-3*A[6]+A[9],se=3*A[0]-6*A[3]+3*A[6],ae=-3*A[0]+3*A[3],le=A[0],ce=-A[1]+3*A[4]-3*A[7]+A[10],ue=3*A[1]-6*A[4]+3*A[7],he=-3*A[1]+3*A[4],de=A[1],pe=le*le,ge=le*le*le,fe=de*de,ve=de*de*de,me=ae*ae,ye=ae*ae*ae,_e=he*he,Ee=he*he*he,Ae=se*se,xe=se*se*se,Ce=ue*ue,we=ue*ue*ue,be=ne*ne,Me=ce*ce,Te=new Float64Array(10),Ve=I*ce-F*ne;Te[0]=Ve*Ve*Ve,Te[1]=3*(I*ue-F*se)*Ve*Ve,Te[2]=3*(I*ce-F*ne)*(H*he*ce+H*Ce-I*F*ae*ce-2*I*F*se*ue-I*F*ne*he+ee*ae*ne+ee*Ae),Te[3]=3*B*H*F*Me-6*B*I*ee*ne*ce+3*B*oe*be-3*k*N*I*F*Me+3*k*N*ee*ne*ce+2*k*H*z*Me-k*I*z*F*ne*ce-k*z*ee*be+Q*F*Me-Y*I*z*Me-2*Y*z*F*ne*ce+N*H*j*Me+N*I*j*F*ne*ce+2*N*I*$*ne*ce-2*N*j*ee*be+N*$*F*be-3*Z*U*Me+3*Z*de*Me+6*Z*he*ue*ce+Z*we+6*H*U*F*ne*ce-3*H*j*z*ne*ce-3*H*F*le*Me-6*H*F*ae*ue*ce-6*H*F*se*he*ce-3*H*F*se*Ce-6*H*F*ne*de*ce-6*H*F*ne*he*ue-3*I*U*ee*be+3*I*j*z*F*be-I*re*be+6*I*ee*le*ne*ce+6*I*ee*ae*se*ce+6*I*ee*ae*ne*ue+3*I*ee*Ae*ue+6*I*ee*se*ne*he+3*I*ee*be*de-3*oe*le*be-6*oe*ae*se*ne-oe*xe,Te[4]=6*B*H*F*ue*ce-6*B*I*ee*se*ce-6*B*I*ee*ne*ue+6*B*oe*se*ne-6*k*N*I*F*ue*ce+3*k*N*ee*se*ce+3*k*N*ee*ne*ue+4*k*H*z*ue*ce-k*I*z*F*se*ce-k*I*z*F*ne*ue-2*k*z*ee*se*ne+2*Q*F*ue*ce-2*Y*I*z*ue*ce-2*Y*z*F*se*ce-2*Y*z*F*ne*ue+2*N*H*j*ue*ce+N*I*j*F*se*ce+N*I*j*F*ne*ue+2*N*I*$*se*ce+2*N*I*$*ne*ue-4*N*j*ee*se*ne+2*N*$*F*se*ne-6*Z*U*ue*ce+6*Z*de*ue*ce+3*Z*_e*ce+3*Z*he*Ce+6*H*U*F*se*ce+6*H*U*F*ne*ue-3*H*j*z*se*ce-3*H*j*z*ne*ue-6*H*F*le*ue*ce-6*H*F*ae*he*ce-3*H*F*ae*Ce-6*H*F*se*de*ce-6*H*F*se*he*ue-6*H*F*ne*de*ue-3*H*F*ne*_e-6*I*U*ee*se*ne+6*I*j*z*F*se*ne-2*I*re*se*ne+6*I*ee*le*se*ce+6*I*ee*le*ne*ue+3*I*ee*me*ce+6*I*ee*ae*se*ue+6*I*ee*ae*ne*he+3*I*ee*Ae*he+6*I*ee*se*ne*de-6*oe*le*se*ne-3*oe*me*ne-3*oe*ae*Ae,Te[5]=6*B*H*F*he*ce+3*B*H*F*Ce-6*B*I*ee*ae*ce-6*B*I*ee*se*ue-6*B*I*ee*ne*he+6*B*oe*ae*ne+3*B*oe*Ae-6*k*N*I*F*he*ce-3*k*N*I*F*Ce+3*k*N*ee*ae*ce+3*k*N*ee*se*ue+3*k*N*ee*ne*he+4*k*H*z*he*ce+2*k*H*z*Ce-k*I*z*F*ae*ce-k*I*z*F*se*ue-k*I*z*F*ne*he-2*k*z*ee*ae*ne-k*z*ee*Ae+2*Q*F*he*ce+Q*F*Ce-2*Y*I*z*he*ce-Y*I*z*Ce-2*Y*z*F*ae*ce-2*Y*z*F*se*ue-2*Y*z*F*ne*he+2*N*H*j*he*ce+N*H*j*Ce+N*I*j*F*ae*ce+N*I*j*F*se*ue+N*I*j*F*ne*he+2*N*I*$*ae*ce+2*N*I*$*se*ue+2*N*I*$*ne*he-4*N*j*ee*ae*ne-2*N*j*ee*Ae+2*N*$*F*ae*ne+N*$*F*Ae-6*Z*U*he*ce-3*Z*U*Ce+6*Z*de*he*ce+3*Z*de*Ce+3*Z*_e*ue+6*H*U*F*ae*ce+6*H*U*F*se*ue+6*H*U*F*ne*he-3*H*j*z*ae*ce-3*H*j*z*se*ue-3*H*j*z*ne*he-6*H*F*le*he*ce-3*H*F*le*Ce-6*H*F*ae*de*ce-6*H*F*ae*he*ue-6*H*F*se*de*ue-3*H*F*se*_e-6*H*F*ne*de*he-6*I*U*ee*ae*ne-3*I*U*ee*Ae+6*I*j*z*F*ae*ne+3*I*j*z*F*Ae-2*I*re*ae*ne-I*re*Ae+6*I*ee*le*ae*ce+6*I*ee*le*se*ue+6*I*ee*le*ne*he+3*I*ee*me*ue+6*I*ee*ae*se*he+6*I*ee*ae*ne*de+3*I*ee*Ae*de-6*oe*le*ae*ne-3*oe*le*Ae-3*oe*me*se,Te[6]=3*G*I*ee*ce-3*G*oe*ne-3*B*k*N*ee*ce+B*k*I*z*F*ce+2*B*k*z*ee*ne+2*B*Y*z*F*ce-B*N*I*j*F*ce-2*B*N*I*$*ce+4*B*N*j*ee*ne-2*B*N*$*F*ne-6*B*H*U*F*ce+3*B*H*j*z*ce+6*B*H*F*de*ce+6*B*H*F*he*ue+6*B*I*U*ee*ne-6*B*I*j*z*F*ne+2*B*I*re*ne-6*B*I*ee*le*ce-6*B*I*ee*ae*ue-6*B*I*ee*se*he-6*B*I*ee*ne*de+6*B*oe*le*ne+6*B*oe*ae*se+K*ee*ce-W*N*z*F*ce-2*W*I*j*F*ce+W*I*$*ce-W*j*ee*ne+k*Y*j*F*ce+6*k*N*I*U*F*ce-k*N*I*j*z*ce-6*k*N*I*F*de*ce-6*k*N*I*F*he*ue-3*k*N*U*ee*ne+k*N*j*z*F*ne+3*k*N*ee*le*ce+3*k*N*ee*ae*ue+3*k*N*ee*se*he+3*k*N*ee*ne*de-4*k*H*U*z*ce+k*H*X*ce+4*k*H*z*de*ce+4*k*H*z*he*ue+k*I*U*z*F*ne+2*k*I*X*F*ne-k*I*j*$*ne-k*I*z*F*le*ce-k*I*z*F*ae*ue-k*I*z*F*se*he-k*I*z*F*ne*de-2*k*z*ee*le*ne-2*k*z*ee*ae*se-2*Q*U*F*ce+2*Q*F*de*ce+2*Q*F*he*ue+2*Y*I*U*z*ce-2*Y*I*z*de*ce-2*Y*I*z*he*ue+2*Y*U*z*F*ne-Y*X*F*ne-2*Y*z*F*le*ce-2*Y*z*F*ae*ue-2*Y*z*F*se*he-2*Y*z*F*ne*de-2*N*H*U*j*ce+2*N*H*j*de*ce+2*N*H*j*he*ue-N*I*U*j*F*ne-2*N*I*U*$*ne+N*I*X*z*ne+N*I*j*F*le*ce+N*I*j*F*ae*ue+N*I*j*F*se*he+N*I*j*F*ne*de+2*N*I*$*le*ce+2*N*I*$*ae*ue+2*N*I*$*se*he+2*N*I*$*ne*de-4*N*j*ee*le*ne-4*N*j*ee*ae*se+2*N*$*F*le*ne+2*N*$*F*ae*se+3*Z*J*ce-6*Z*U*de*ce-6*Z*U*he*ue+3*Z*fe*ce+6*Z*de*he*ue+Z*Ee-3*H*J*F*ne+3*H*U*j*z*ne+6*H*U*F*le*ce+6*H*U*F*ae*ue+6*H*U*F*se*he+6*H*U*F*ne*de-H*ie*ne-3*H*j*z*le*ce-3*H*j*z*ae*ue-3*H*j*z*se*he-3*H*j*z*ne*de-6*H*F*le*de*ce-6*H*F*le*he*ue-6*H*F*ae*de*ue-3*H*F*ae*_e-6*H*F*se*de*he-3*H*F*ne*fe-6*I*U*ee*le*ne-6*I*U*ee*ae*se+6*I*j*z*F*le*ne+6*I*j*z*F*ae*se-2*I*re*le*ne-2*I*re*ae*se+3*I*ee*pe*ce+6*I*ee*le*ae*ue+6*I*ee*le*se*he+6*I*ee*le*ne*de+3*I*ee*me*he+6*I*ee*ae*se*de-3*oe*pe*ne-6*oe*le*ae*se-oe*ye,Te[7]=3*G*I*ee*ue-3*G*oe*se-3*B*k*N*ee*ue+B*k*I*z*F*ue+2*B*k*z*ee*se+2*B*Y*z*F*ue-B*N*I*j*F*ue-2*B*N*I*$*ue+4*B*N*j*ee*se-2*B*N*$*F*se-6*B*H*U*F*ue+3*B*H*j*z*ue+6*B*H*F*de*ue+3*B*H*F*_e+6*B*I*U*ee*se-6*B*I*j*z*F*se+2*B*I*re*se-6*B*I*ee*le*ue-6*B*I*ee*ae*he-6*B*I*ee*se*de+6*B*oe*le*se+3*B*oe*me+K*ee*ue-W*N*z*F*ue-2*W*I*j*F*ue+W*I*$*ue-W*j*ee*se+k*Y*j*F*ue+6*k*N*I*U*F*ue-k*N*I*j*z*ue-6*k*N*I*F*de*ue-3*k*N*I*F*_e-3*k*N*U*ee*se+k*N*j*z*F*se+3*k*N*ee*le*ue+3*k*N*ee*ae*he+3*k*N*ee*se*de-4*k*H*U*z*ue+k*H*X*ue+4*k*H*z*de*ue+2*k*H*z*_e+k*I*U*z*F*se+2*k*I*X*F*se-k*I*j*$*se-k*I*z*F*le*ue-k*I*z*F*ae*he-k*I*z*F*se*de-2*k*z*ee*le*se-k*z*ee*me-2*Q*U*F*ue+2*Q*F*de*ue+Q*F*_e+2*Y*I*U*z*ue-2*Y*I*z*de*ue-Y*I*z*_e+2*Y*U*z*F*se-Y*X*F*se-2*Y*z*F*le*ue-2*Y*z*F*ae*he-2*Y*z*F*se*de-2*N*H*U*j*ue+2*N*H*j*de*ue+N*H*j*_e-N*I*U*j*F*se-2*N*I*U*$*se+N*I*X*z*se+N*I*j*F*le*ue+N*I*j*F*ae*he+N*I*j*F*se*de+2*N*I*$*le*ue+2*N*I*$*ae*he+2*N*I*$*se*de-4*N*j*ee*le*se-2*N*j*ee*me+2*N*$*F*le*se+N*$*F*me+3*Z*J*ue-6*Z*U*de*ue-3*Z*U*_e+3*Z*fe*ue+3*Z*de*_e-3*H*J*F*se+3*H*U*j*z*se+6*H*U*F*le*ue+6*H*U*F*ae*he+6*H*U*F*se*de-H*ie*se-3*H*j*z*le*ue-3*H*j*z*ae*he-3*H*j*z*se*de-6*H*F*le*de*ue-3*H*F*le*_e-6*H*F*ae*de*he-3*H*F*se*fe-6*I*U*ee*le*se-3*I*U*ee*me+6*I*j*z*F*le*se+3*I*j*z*F*me-2*I*re*le*se-I*re*me+3*I*ee*pe*ue+6*I*ee*le*ae*he+6*I*ee*le*se*de+3*I*ee*me*de-3*oe*pe*se-3*oe*le*me,Te[8]=3*G*I*ee*he-3*G*oe*ae-3*B*k*N*ee*he+B*k*I*z*F*he+2*B*k*z*ee*ae+2*B*Y*z*F*he-B*N*I*j*F*he-2*B*N*I*$*he+4*B*N*j*ee*ae-2*B*N*$*F*ae-6*B*H*U*F*he+3*B*H*j*z*he+6*B*H*F*de*he+6*B*I*U*ee*ae-6*B*I*j*z*F*ae+2*B*I*re*ae-6*B*I*ee*le*he-6*B*I*ee*ae*de+6*B*oe*le*ae+K*ee*he-W*N*z*F*he-2*W*I*j*F*he+W*I*$*he-W*j*ee*ae+k*Y*j*F*he+6*k*N*I*U*F*he-k*N*I*j*z*he-6*k*N*I*F*de*he-3*k*N*U*ee*ae+k*N*j*z*F*ae+3*k*N*ee*le*he+3*k*N*ee*ae*de-4*k*H*U*z*he+k*H*X*he+4*k*H*z*de*he+k*I*U*z*F*ae+2*k*I*X*F*ae-k*I*j*$*ae-k*I*z*F*le*he-k*I*z*F*ae*de-2*k*z*ee*le*ae-2*Q*U*F*he+2*Q*F*de*he+2*Y*I*U*z*he-2*Y*I*z*de*he+2*Y*U*z*F*ae-Y*X*F*ae-2*Y*z*F*le*he-2*Y*z*F*ae*de-2*N*H*U*j*he+2*N*H*j*de*he-N*I*U*j*F*ae-2*N*I*U*$*ae+N*I*X*z*ae+N*I*j*F*le*he+N*I*j*F*ae*de+2*N*I*$*le*he+2*N*I*$*ae*de-4*N*j*ee*le*ae+2*N*$*F*le*ae+3*Z*J*he-6*Z*U*de*he+3*Z*fe*he-3*H*J*F*ae+3*H*U*j*z*ae+6*H*U*F*le*he+6*H*U*F*ae*de-H*ie*ae-3*H*j*z*le*he-3*H*j*z*ae*de-6*H*F*le*de*he-3*H*F*ae*fe-6*I*U*ee*le*ae+6*I*j*z*F*le*ae-2*I*re*le*ae+3*I*ee*pe*he+6*I*ee*le*ae*de-3*oe*pe*ae,Te[9]=q*oe-G*k*z*ee-2*G*N*j*ee+G*N*$*F-3*G*I*U*ee+3*G*I*j*z*F-G*I*re+3*G*I*ee*de-3*G*oe*le+B*W*j*ee+3*B*k*N*U*ee-B*k*N*j*z*F-3*B*k*N*ee*de-B*k*I*U*z*F-2*B*k*I*X*F+B*k*I*j*$+B*k*I*z*F*de+2*B*k*z*ee*le-2*B*Y*U*z*F+B*Y*X*F+2*B*Y*z*F*de+B*N*I*U*j*F+2*B*N*I*U*$-B*N*I*X*z-B*N*I*j*F*de-2*B*N*I*$*de+4*B*N*j*ee*le-2*B*N*$*F*le+3*B*H*J*F-3*B*H*U*j*z-6*B*H*U*F*de+B*H*ie+3*B*H*j*z*de+3*B*H*F*fe+6*B*I*U*ee*le-6*B*I*j*z*F*le+2*B*I*re*le-6*B*I*ee*le*de+3*B*oe*pe-K*U*ee+K*ee*de+W*N*U*z*F-W*N*z*F*de+2*W*I*U*j*F-W*I*U*$-2*W*I*j*F*de+W*I*$*de-W*j*ee*le-k*Y*U*j*F+k*Y*j*F*de-3*k*N*I*J*F+k*N*I*U*j*z+6*k*N*I*U*F*de-k*N*I*j*z*de-3*k*N*I*F*fe-3*k*N*U*ee*le+k*N*j*z*F*le+3*k*N*ee*le*de+2*k*H*J*z-k*H*U*X-4*k*H*U*z*de+k*H*X*de+2*k*H*z*fe+k*I*U*z*F*le+2*k*I*X*F*le-k*I*j*$*le-k*I*z*F*le*de-k*z*ee*pe+Q*J*F-2*Q*U*F*de+Q*F*fe-Y*I*J*z+2*Y*I*U*z*de-Y*I*z*fe+2*Y*U*z*F*le-Y*X*F*le-2*Y*z*F*le*de+N*H*J*j-2*N*H*U*j*de+N*H*j*fe-N*I*U*j*F*le-2*N*I*U*$*le+N*I*X*z*le+N*I*j*F*le*de+2*N*I*$*le*de-2*N*j*ee*pe+N*$*F*pe-Z*te+3*Z*J*de-3*Z*U*fe+Z*ve-3*H*J*F*le+3*H*U*j*z*le+6*H*U*F*le*de-H*ie*le-3*H*j*z*le*de-3*H*F*le*fe-3*I*U*ee*pe+3*I*j*z*F*pe-I*re*pe+3*I*ee*pe*de-oe*ge;var Se=(0,c.getRealPolynomialRoots)(Te),Le=u.getApproxParameterSpaceTolerance(),Re=-Le,Pe=1+Le;T&&(Re=Le),V&&(Pe=1-Le);for(var De=0;De<Se.length;++De)if(Se[De]>=Re&&Se[De]<=Pe){Se[De]<0?Se[De]=0:Se[De]>1&&(Se[De]=1),Se[De]=C[0]+(C[C.length-1]-C[0])*Se[De];var Oe=t.getCurve().evaluatePosition(Se[De]);if(w.isPointInsideWithTolerance(Oe)){var Ie=i.closestToPointParam(Oe,[]);if(Ie>=E[0]&&Ie<=E[E.length-1]){var Ne=e.getCurve().evaluatePosition(Ie);if(r.Vector3.squaredDistance(Ne,Oe)<=v*v){var ke=f(e,Ie*(e.isReversed()?-1:1),t,Se[De]*(t.isReversed()?-1:1),v);ke&&S.push(ke)}}}}return S},T=function(e,t,i,o){var n=[],a=t.getControlPoints(),l=e.isReversed()?-1:1,c=new s.Line,h=r.Vector3.createFloat64FromValues(a[0],a[1],a[2]),d=r.Vector3.createFloat64FromValues(a[a.length-3],a[a.length-2],a[a.length-1]);c.setFromEndpoints(h,d);var p=r.Vector3.distance(d,h),g=r.Vector3.createFloat64FromValues(a[3],a[4],a[5]),v=r.Vector3.createFloat64FromValues(a[6],a[7],a[8]);if(c.closestToPointParam(g,[])>0&&c.closestToPointParam(g,[])<p&&c.closestToPointParam(v,[])>0&&c.closestToPointParam(v,[])<p)return n;var m,y=-a[0]+3*a[3]-3*a[6]+a[9],_=-a[1]+3*a[4]-3*a[7]+a[10],E=3*a[0]-6*a[3]+3*a[6],A=3*a[1]-6*a[4]+3*a[7],x=-3*a[0]+3*a[3],C=-3*a[1]+3*a[4],w=E/y,b=x/y,M=A/_,T=C/_;if(Math.abs(w-M)<o||Math.abs(T-b)<o)return n;var V=new Float64Array(4);if(Math.abs(y)<o&&Math.abs(_)<o)return n;Math.abs(y)<o?(m=-x/E,w=M,b=T):m=Math.abs(_)<o?-C/A:(T-b)/(w-M),V[0]=(-m*m*m-w*m*m-b*m)/2,V[1]=(3*m*m+2*m*w+2*b)/2,V[2]=-1.5*m,V[3]=1;var S,L=new Float64Array(3);if(3!==u.SplineCurveHelper.solve_cubic_uniqueRoots(V,L))return n;if(L[1]<L[0]&&(S=L[0],L[0]=L[1],L[1]=S),L[2]<L[0]&&(S=L[0],L[0]=L[2],L[2]=S),L[2]<L[1]&&(S=L[1],L[1]=L[2],L[2]=S),L[0]>=0&&L[0]<=1&&L[2]>=0&&L[2]<=1){var R=t.getKnotVector();L[0]=R[0]+(R[R.length-1]-R[0])*L[0],L[2]=R[0]+(R[R.length-1]-R[0])*L[2];var P=f(e,L[0]*l,e,L[2]*l,o);P&&n.push(P)}return n};t.computeCurveCurveIntersections=function(e,t,i,n,s){s=void 0===s?o.KERNEL_TOLERANCE:s;var a,l=e.getCurveType(),c=l===o.GEOMETRY_TYPES.CIRCLE,u=l===o.GEOMETRY_TYPES.LINE,p=l===o.GEOMETRY_TYPES.BCURVE&&!e.getCurve().isRational()&&3===e.getCurve().getDegree(),v=t.getCurveType(),x=v===o.GEOMETRY_TYPES.CIRCLE,w=v===o.GEOMETRY_TYPES.LINE,V=v===o.GEOMETRY_TYPES.BCURVE&&!t.getCurve().isRational()&&3===t.getCurve().getDegree();return a=u&&x?function(e,t,i){for(var r=_(e.getCurve(),t.getCurve(),i),o=[],n=0;n<r.length;++n){var s=(e.isReversed()?-1:1)*r[n].lineParam,a=(t.isReversed()?-1:1)*r[n].circleParam,l=f(e,s,t,a,i);l&&o.push(l)}return o}(e,t,s):c&&w?function(e,t,i,r){var o=_(t.getCurve(),e.getCurve(),r),n=[],s=0;e.isClosed()&&i&&(s=1);for(var a=0;a<o.length;++a){var l=(e.isReversed()?-1:1)*o[a].circleParam,c=(t.isReversed()?-1:1)*o[a].lineParam,u=f(e,l,t,c,r);if(u)for(var h=-s;h<=s;++h)n.push({cutInfo:{atVertex:u.cutInfo.atVertex,param:u.cutInfo.param+h*Math.PI*2},cutByInfo:u.cutByInfo})}return n}(e,t,n,s):u&&w?y(e,t,i,s):c&&x?function(e,t,i,o,n){var s=[],a=e.getCurve().getCenter(),l=e.getCurve().getRadius(),c=t.getCurve().getCenter(),u=t.getCurve().getRadius(),d=2*Math.PI,p=r.Vector3.createFloat64();r.Vector3.sub(p,c,a);var v=r.Vector3.length(p),y=Math.abs(l-u);if(v<y-n)return s;if(v+y<n){var _=n/l;if(e.getRange()[1]-e.getRange()[0]>d-_&&t.getRange()[1]-t.getRange()[0]>d-_)return s.push({rangeInfo:[g(e,e.getRange()[0],n,t),g(e,e.getRange()[1],n,t)],rangeByInfo:[g(t,t.getRange()[0],n,e),g(t,t.getRange()[1],n,e)]}),s;var A=[],x=e.closestToPointParam(t.evaluatePosition(0),[0,d]),C=r.Vector3.dot(e.evaluateDt(x),t.evaluateDt(0))<0,w=e.getRange(),b=t.getRange();b=C?[x-b[1],x-b[0]]:[x+b[0],x+b[1]];var M=(0,h.foldAbove)(b[0],w[0],d)-b[0];if((b=[b[0]+M,b[1]+M])[0]<w[1]+_&&A.push([Math.min(b[0],w[1]),Math.min(w[1],b[1])]),b[1]>w[0]+d-_&&A.push([w[0],Math.max(w[0],Math.min(w[1],b[1]-d))]),w[1]-w[0]>d-_||b[1]-b[0]>d-_)for(var T=A.length-1;T>=0&&1!==A.length;--T)A[T][1]-A[T][0]<_&&A.splice(T,1);for(T=0;T<A.length;++T){var V=A[T],S=C?[x-V[1],x-V[0]]:[V[0]-x,V[1]-x],L=(0,h.foldAbove)(S[0],t.getRange()[0],d)-S[0];if(S=[S[0]+L,S[1]+L],V[1]-V[0]<_){var R=.5*(V[0]+V[1]),P=.5*(S[0]+S[1]),D=g(e,R,n,t),O=g(t,P,n,e);D&&O&&s.push({cutInfo:D,cutByInfo:O})}else{var I=[g(e,V[0],n,t),g(e,V[1],n,t)],N=[g(t,S[0],n,e),g(t,S[1],n,e)];I[0]&&I[1]&&N[0]&&N[1]&&s.push({rangeInfo:I,rangeByInfo:N})}}return s}var k=(l*l-u*u+v*v)/(2*v),B=l*l-k*k,F=l-Math.abs(k),z=[],j=[];if(F<-n);else{var U=Math.sqrt(Math.max(0,B));if(r.Vector3.scale(p,p,1/v),U<2*n)z.push(E(0,k,a,p,e,t)),j.push(!1);else if(F<n)if(j.push(!1),i){j[j.length-1]=!0;var G=E(0,k,a,p,e,t),W=[E(U,k,a,p,e,t),E(-U,k,a,p,e,t)];m(e,t,[W[0].firstParam,G.firstParam,W[1].firstParam],[W[0].secondParam,G.secondParam,W[1].secondParam],n,s,z)}else z.push(E(0,k,a,p,e,t));else z.push(E(U,k,a,p,e,t)),z.push(E(-U,k,a,p,e,t))}var Y=0;for(e.isClosed()&&o&&(Y=1),T=0;T<z.length;++T){var H=f(e,z[T].firstParam,t,z[T].secondParam,n);if(H)for(var q=-Y;q<=Y;++q)s.push({cutInfo:{atVertex:H.cutInfo.atVertex,param:H.cutInfo.param+q*Math.PI*2},cutByInfo:H.cutByInfo}),j[T]&&(s[s.length-1].cutInfo.virtualIntersection=!0,s[s.length-1].cutByInfo.virtualIntersection=!0)}return s}(e,t,i,n,s):u&&V?C(e,t,i,s):p&&w?function(e,t,i,r,o){var n=C(t,e,i,o),s=[],a=0,l=0;r&&e.getCurve().isPeriodicUnlimited()&&(a=1,l=e.getCurve().getPeriodUnlimited());for(var c=0;c<n.length;++c)if(n[c].hasOwnProperty("cutInfo")&&n[c].hasOwnProperty("cutByInfo"))for(var u=-a;u<=a;++u)s.push({cutInfo:{atVertex:n[c].cutByInfo.atVertex,param:n[c].cutByInfo.param+u*l},cutByInfo:n[c].cutInfo});else n[c].hasOwnProperty("rangeInfo")&&n[c].hasOwnProperty("rangeByInfo")&&s.push({rangeInfo:n[c].rangeByInfo,rangeByInfo:n[c].rangeInfo});return s}(e,t,i,n,s):c&&V?b(e,t,0,n,s):p&&x?function(e,t,i,r,o){var n=b(t,e,0,!1,o),s=[],a=0,l=0;r&&e.getCurve().isPeriodicUnlimited()&&(a=1,l=e.getCurve().getPeriodUnlimited());for(var c=0;c<n.length;++c)if(n[c].hasOwnProperty("cutInfo")&&n[c].hasOwnProperty("cutByInfo"))for(var u=-a;u<=a;++u)s.push({cutInfo:{atVertex:n[c].cutByInfo.atVertex,param:n[c].cutByInfo.param+u*l},cutByInfo:n[c].cutInfo});else n[c].hasOwnProperty("rangeInfo")&&n[c].hasOwnProperty("rangeByInfo")&&s.push({rangeInfo:n[c].rangeByInfo,rangeByInfo:n[c].rangeInfo});return s}(e,t,0,n,s):p&&V?function(e,t,i,r,o){var n=e===t,s=e.getBoundingBox(),a=t.getBoundingBox(),l=[];if(!s.intersectsWithTolerance(a,o))return l;var c,u,h,d,p=e.getCurve().getBezierSegments(),g=p.length,f=t.getCurve().getBezierSegments(),v=f.length,m=[],y=0,_=0,E=0;for(r&&e.getCurve().isPeriodic()&&e.isClosed()&&(_=1,E=e.getCurve().getPeriod()),c=0;c<g;c++)for(n&&(y=c+1),u=y;u<v;u++){var x=n&&u===c+1;for(m=M(e,t,p[c],f[u],i,o,x),h=0;h<m.length;++h)for(d=-_;d<=_;++d)m[h].cutInfo&&l.push({cutInfo:{atVertex:m[h].cutInfo.atVertex,param:m[h].cutInfo.param+d*E},cutByInfo:m[h].cutByInfo}),m[h].rangeInfo&&l.push(m[h])}if(n)for(c=0;c<g;++c)for(m=T(e,p[c],0,o),h=0;h<m.length;++h)for(d=-_;d<=_;++d)m[h].cutInfo&&l.push({cutInfo:{atVertex:m[h].cutInfo.atVertex,param:m[h].cutInfo.param+d*E},cutByInfo:m[h].cutByInfo}),m[h].rangeInfo&&l.push(m[h]);return A(l)}(e,t,i,n,s):function(e,t,i,r,n){var s=e.getBoundingBox(),a=t.getBoundingBox(),l=[];if(!s.intersectsWithTolerance(a,n))return l;var c=e.isReversed(),u=t.isReversed(),h=e.getRange();c&&(h=[-h[1],-h[0]]);var p=t.getRange();u&&(p=[-p[1],-p[0]]),l=new d.CCI(e.getCurve(),h,t.getCurve(),p,o.KERNEL_TOLERANCE).intersect();for(var g=0;g<l.length;++g)c&&(l[g].cutInfo?l[g].cutInfo.param*=-1:l[g].rangeInfo&&(l[g].rangeInfo=[l[g].rangeInfo[1],l[g].rangeInfo[0]],l[g].rangeInfo[0].param*=-1,l[g].rangeInfo[1].param*=-1)),u&&(l[g].cutByInfo?l[g].cutByInfo.param*=-1:l[g].rangeByInfo&&(l[g].rangeByInfo[0].param*=-1,l[g].rangeByInfo[1].param*=-1));return l}(e,t,0,0,s),a}},9892:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SubCurveTree=void 0;var r=i(2468),o=100*r.KERNEL_TOLERANCE,n=Math.PI/180*10,s=function(e,t,i){void 0===i&&(i=0),this._cu=e,this._range=t,this._bx=e.getBoundingBox(t).clone(),this._simple=void 0,this._split_param=void 0,this._children=[],this._depth=i};s.prototype.isSimple=function(){if(void 0===this._simple){this._simple=!1;var e=[this._range[0]+1e-8,this._range[1]-1e-8];if(this._split_param=this._cu.suggestSplittingParam(e),void 0===this._split_param){this._split_param=.5*(this._range[0]+this._range[1]);var t=this._cu.getTangentCone(this._range);(t.isDegenerate()||t.angle<n)&&(this._simple=!0)}}return this._simple},s.prototype.canDivide=function(){return!(this._depth>=10||this._range[1]-this._range[0]<2e-8||Math.max(this._bx.getWidth(0),this._bx.getWidth(1),this._bx.getWidth(2))<o)},s.prototype.divide=function(){if(0===this._children.length){var e=[this._range[0],this._split_param],t=[this._split_param,this._range[1]];this._children=[new s(this._cu,e,this._depth+1),new s(this._cu,t,this._depth+1)]}},s.prototype.fullSubdivision=function(){if(!this.isSimple()&&this.canDivide()){this.divide();for(var e=0;e<this._children.length;++e)this._children[e].fullSubdivision()}},s.prototype.toString=function(){if(this._children.length>0){for(var e="",t=0;t<this._children.length;++t)e+=this._children[t];return e}return"t=["+this._range[0]+" "+this._range[1]+"] "+this._bx+"\n"};var a=function(e,t,i,r,o){this._cu1_root_node=new s(e,t),this._cu2_root_node=new s(i,r),this._epsilon=o,this._overlaps=[]};a.prototype.process=function(e,t){if(e._bx.intersectsWithTolerance(t._bx,this._epsilon)){var i=e.canDivide(),r=t.canDivide(),o=e.isSimple()||!i,n=t.isSimple()||!r;if(o&&n)this._overlaps.push([e,t]);else if(i&&r){e.divide(),t.divide();for(var s=0;s<e._children.length;++s)for(var a=0;a<t._children.length;++a)this.process(e._children[s],t._children[a])}else if(i)for(e.divide(),s=0;s<e._children.length;++s)this.process(e._children[s],t);else if(r)for(t.divide(),s=0;s<t._children.length;++s)this.process(e,t._children[s])}},a.prototype.build=function(){this.process(this._cu1_root_node,this._cu2_root_node)},t.SubCurveTree=a},9888:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i={setNMIAttributeStr:function(e,t){e.typeid="autodesk.brep:nmiattributestr-1.0.0",e.values={primaryId:t.primaryId,secondaryId:t.secondaryId,approachId:t.approachId,operationIds:t.operationIds}},setNMIAttributeArr:function(e,t){e.typeid="autodesk.brep:nmiattributearr-1.0.0";for(var i=t.tagInfo,r=new Array(i.length),o=0;o<i.length;++o){var n=i[o];r[o]={primaryId:n.primaryId,secondaryId:n.secondaryId,approachId:n.approachId,operationIds:n.operationIds}}e.values={tagInfo:r}},setTextAttribute:function(e,t){e.typeid="autodesk.brep:textattribute-1.0.0",e.values={text:t.text}}};t.AttributeSetters=i},6752:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.propertyToRange=t.GeometrySetters=void 0;var r=i(1972),o=function(e,t,i){const r=t[i];e[0]=r.x,e[1]=r.y,e[2]=r.z},n=function(e,t){const i=e[t];var r=i.type;return"infinite"===r||0===r?[]:[i.low,i.high]},s=function(e,t){var i=n(e,"uRange");t.unlimitRangeU(),i.length>0&&t.limitRangeU(i);var r=n(e,"vRange");t.unlimitRangeV(),r.length>0&&t.limitRangeV(r)},a=function(e,t){var i=n(e,"range");t.unlimitRange(),i.length>0&&t.limitRange(i)},l={setBCurveFromProperty:function(e,t){var i,r,o=t.degree,n=t.knots,s=t.controlPoints,l=t.weights,c=s.length/3;if(0===l.length)for(r=new Array(c),i=0;i<c;++i)r[i]=1;else r=l;e.set(s,r,o,n),a(t,e)},setBSurfaceFromProperty:function(e,t){var i,r,o=t.uDegree,n=t.vDegree,a=t.uKnots,l=t.vKnots,c=t.controlPoints,u=t.weights;if(0===u.length){var h=c.length/3;for(r=new Array(h),i=0;i<h;++i)r[i]=1}else r=u;e.set(o,n,a,l,c,r),s(t,e)},setCircleFromProperty:function(e,t){var i=r.Vector3.createFloat64(),n=r.Vector3.createFloat64(),s=r.Vector3.createFloat64();o(i,t,"center"),o(n,t,"normal"),o(s,t,"radius"),e.set(i,n,s),a(t,e)},setConeFromProperty:function(e,t){var i=r.Vector3.createFloat64(),n=r.Vector3.createFloat64(),a=r.Vector3.createFloat64();o(i,t,"center"),o(n,t,"axis"),o(a,t,"radius");var l=r.Vector3.length(a);r.Vector3.normalize(a,a);var c=t.angle,u=t.uCoordScale;e.set(i,l,n,c,a,u),s(t,e)},setCylinderFromProperty:function(e,t){var i=r.Vector3.createFloat64(),n=r.Vector3.createFloat64(),a=r.Vector3.createFloat64();o(i,t,"center"),o(n,t,"axis"),o(a,t,"radius");var l=r.Vector3.length(a);r.Vector3.normalize(a,a);var c=t.uCoordScale;e.set(i,l,n,a,c),s(t,e)},setEllipseFromProperty:function(e,t){var i=r.Vector3.createFloat64(),n=r.Vector3.createFloat64(),s=r.Vector3.createFloat64();o(i,t,"center"),o(n,t,"normal"),o(s,t,"majorRadius");var l=t.radiusRatio;e.set(i,n,s,l),a(t,e)},setEllipticalConeFromProperty:function(e,t){var i=r.Vector3.createFloat64(),n=r.Vector3.createFloat64(),a=r.Vector3.createFloat64();o(i,t,"center"),o(n,t,"axis"),o(a,t,"majorRadius");var l=t.angle,c=t.radiusRatio,u=t.uCoordScale;e.set(i,a,c,n,l,u),s(t,e)},setEllipticalCylinderFromProperty:function(e,t){var i=r.Vector3.createFloat64(),n=r.Vector3.createFloat64(),a=r.Vector3.createFloat64();o(i,t,"center"),o(n,t,"axis"),o(a,t,"majorRadius");var l=t.radiusRatio,c=t.uCoordScale;e.set(i,a,l,n,c),s(t,e)},setLineFromProperty:function(e,t){var i=r.Vector3.createFloat64(),n=r.Vector3.createFloat64();o(i,t,"position"),o(n,t,"direction"),e.set(i,n),a(t,e)},setPlaneFromProperty:function(e,t){var i=r.Vector3.createFloat64(),n=r.Vector3.createFloat64(),a=r.Vector3.createFloat64();o(i,t,"origin"),o(n,t,"normal"),o(a,t,"uAxis"),e.set(i,n,a),s(t,e)},setPointFromProperty:function(e,t){e.setPosition(t.position.x,t.position.y,t.position.z)},setSphereFromProperty:function(e,t){var i=r.Vector3.createFloat64(),n=r.Vector3.createFloat64(),a=r.Vector3.createFloat64();o(i,t,"center"),o(n,t,"radius"),o(a,t,"axis");var l=r.Vector3.length(n);r.Vector3.normalize(n,n),e.set(i,l,a,n),s(t,e)},setTorusFromProperty:function(e,t){var i=r.Vector3.createFloat64(),n=r.Vector3.createFloat64(),a=r.Vector3.createFloat64();o(i,t,"center"),o(n,t,"axis"),o(a,t,"coordAxis");var l=t.majorRadius,c=t.minorRadius,u=t.lemon;e.set(i,l,c,n,a,u),s(t,e)},setHapCurveFromProperty:function(e,t){for(var i=t.spans,r=new Array(i.length),o=0;o<i.length;++o)r[o]={},r[o].polyOrder=i[o].polyOrder,r[o].lowParam=i[o].lowParam,r[o].highParam=i[o].highParam,r[o].coefs=i[o].coefs.slice(0);var n={};n.spans=r;var s=t.periodic;void 0===s&&(s=!1),n.periodic=s,n.closed=s,e.setHapDefinition(n),a(t,e)},setCurveRangeFromProperty:a,setSurfaceRangeFromProperty:s};t.GeometrySetters=l,t.propertyToRange=n},6232:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SolidDefLoader=t.getTopologyRank=void 0;var r,o=i(3565),n=i(1096),s=i(5512),a=i(8972),l=i(8796),c=i(8292),u=i(3440),h=i(8360),d=i(4372),p=i(2984),g=i(2956),f=i(1408),v=i(92),m=i(9984),y=i(5837),_=i(6508),E=i(6776),A=i(4524),x=i(672),C=i(7580),w=i(6940),b=i(6500),M=i(7575),T=i(9324),V=i(2468),S=i(6752),L=i(7360),R=i(9888),P=i(8032),D=((r={})[V.TOPOLOGY_TYPES.BODY]=10,r[V.TOPOLOGY_TYPES.WIREBODY]=9,r[V.TOPOLOGY_TYPES.LUMP]=8,r[V.TOPOLOGY_TYPES.SHELL]=7,r[V.TOPOLOGY_TYPES.FACE]=6,r[V.TOPOLOGY_TYPES.WIRE]=5,r[V.TOPOLOGY_TYPES.LOOP]=4,r[V.TOPOLOGY_TYPES.COEDGE]=3,r[V.TOPOLOGY_TYPES.EDGE]=2,r[V.TOPOLOGY_TYPES.VERTEX]=1,function(e){var t=void 0;return"function"==typeof e.getTopologyType&&(t=r[e.getTopologyType()]),t||0}),O=function(){this._runTimeMap=new Map,this._typeidToFuncMap={},this.addLoader("body",L.TopologySetters.setBodyData,m.Body),this.addLoader("wirebody",L.TopologySetters.setWireBodyData,b.WireBody),this.addLoader("wire",L.TopologySetters.setWireData,M.Wire),this.addLoader("lump",L.TopologySetters.setLumpData,y.Lump),this.addLoader("shell",L.TopologySetters.setShellData,_.Shell),this.addLoader("face",L.TopologySetters.setFaceData,E.Face),this.addLoader("loop",L.TopologySetters.setLoopData,A.Loop),this.addLoader("coedge",L.TopologySetters.setCoedgeData,x.Coedge),this.addLoader("edge",L.TopologySetters.setEdgeData,C.Edge),this.addLoader("vertex",L.TopologySetters.setVertexData,w.Vertex),this.addLoader("point",S.GeometrySetters.setPointFromProperty,o.Point),this.addLoader("line",S.GeometrySetters.setLineFromProperty,n.Line),this.addLoader("circle",S.GeometrySetters.setCircleFromProperty,s.Circle),this.addLoader("ellipse",S.GeometrySetters.setEllipseFromProperty,a.Ellipse),this.addLoader("bcurve",S.GeometrySetters.setBCurveFromProperty,l.BCurve),this.addLoader("plane",S.GeometrySetters.setPlaneFromProperty,c.Plane),this.addLoader("sphere",S.GeometrySetters.setSphereFromProperty,d.Sphere),this.addLoader("torus",S.GeometrySetters.setTorusFromProperty,f.Torus),this.addLoader("cylinder",S.GeometrySetters.setCylinderFromProperty,u.Cylinder),this.addLoader("cone",S.GeometrySetters.setConeFromProperty,p.Cone),this.addLoader("ellipticalcylinder",S.GeometrySetters.setEllipticalCylinderFromProperty,h.EllipticalCylinder),this.addLoader("ellipticalcone",S.GeometrySetters.setEllipticalConeFromProperty,g.EllipticalCone),this.addLoader("bsurface",S.GeometrySetters.setBSurfaceFromProperty,v.BSurface),this.addLoader("nmiattributestr",R.AttributeSetters.setNMIAttributeStr,T.Attribute),this.addLoader("nmiattributearr",R.AttributeSetters.setNMIAttributeArr,T.Attribute),this.addLoader("textattribute",R.AttributeSetters.setTextAttribute,T.Attribute)};O.prototype.addLoader=function(e,t,i){this._typeidToFuncMap[e]=[t,i]},O.prototype._reset=function(){this._runTimeMap.clear()},O.prototype.getDataSettingFunction=function(e){var t=this._typeidToFuncMap[e];if(t)return t[0]},O.prototype.createRunTimeObject=function(e){var t=this.getTypeContructor(e);if(t)return new t},O.prototype.getTypeContructor=function(e){var t=this._typeidToFuncMap[e];if(t&&2===t.length)return t[1]},O.prototype.setObjectProperties=function(e,t,i){var r=this.getDataSettingFunction(e,i);const o=this;"function"==typeof r&&r(t,i,(e=>{if(!e)return;const t=e;return t?o._runTimeMap.get(t):void 0}))},O.prototype.makeGeometryObjectsProto=function(e){Object.keys(e).forEach((t=>{const i=e[t],r=i[i.geometry],o=this.createRunTimeObject(i.geometry);o&&(this._runTimeMap.set(t,o),this.setObjectProperties(i.geometry,o,r),o.setGuid(t))}))},O.prototype.makeGeometryObject=function(e){var t=e.getTypeid(),i=this.createRunTimeObject(t);return i?this.setObjectProperties(t,i,e):console.error("No constructor"),i},O.prototype.makeTopologyObject=function(e){var t=e.getTypeid(),i=this.createRunTimeObject(t);return i||console.error("No constructor"),i},O.prototype.makeAttributeObjectsProto=function(e){Object.keys(e).forEach((t=>{const i=e[t],r=i[i.attribute],o=new T.Attribute;this._runTimeMap.set(t,o),this.setObjectProperties(i.attribute,o,r),o.setGuid(t)}))},O.prototype.makeTopologyObjectsProto=function(e){var t=[];Object.keys(e).forEach((i=>{const r=e[i],o=r[r.topology],n=this.createRunTimeObject(r.topology);n&&(this._runTimeMap.set(i,n),t.push({type:r.topology,obj:n,prop:o}),n.setGuid(i))}));for(var i=0;i<t.length;++i)this.setObjectProperties(t[i].type,t[i].obj,t[i].prop)},O.prototype._collectGeometries=function(e){this._runTimeMap.forEach((function(t){void 0!==t.getGeometryType&&e.set(t.getGuid(),t)}))},O.prototype._collectTopologies=function(e){this._runTimeMap.forEach((function(t){void 0!==t.getTopologyType&&e.set(t.getGuid(),t)}))},O.prototype.loadModelPSet=function(e,t,i){var r=e.get("geometries");if(r){var o=e.get("attributes"),n=e.get("topologies");if(n)return this.makeGeometryObjects(r),o&&this.makeAttributeObjects(o),this.makeTopologyObjects(n),this.getHighestObject(t,i)}},O.prototype.getHighestObject=function(e,t){var i=void 0,r=0;return this._runTimeMap.forEach((function(e){if(10!==r){var t=D(e);t>r&&t>0&&(r=t,i=e)}})),e&&this._collectGeometries(e),t&&this._collectTopologies(t),this._reset(),i},O.prototype.loadModelProtoMessage=function(e,t,i){const r=e.geometries;if(!r)return;const o=e.attributes,n=e.topologies;return n?(this.makeGeometryObjectsProto(r),o&&this.makeAttributeObjectsProto(o),this.makeTopologyObjectsProto(n),this.getHighestObject(t,i)):void 0},O.prototype.loadProtoBinary=function(e,t,i){let r=e;r instanceof ArrayBuffer&&(r=new Uint8Array(r));const o=P.Autodesk.lookupType("SolidDef.model_1_0_0").decode(r);return this.loadModelProtoMessage(o,t,i)},t.getTopologyRank=D,t.SolidDefLoader=O},8032:(e,t,i)=>{"use strict";var r=i(4883),o=(r.roots.default||(r.roots.default=new r.Root)).addJSON({Autodesk:{nested:{SolidDef:{nested:{SolidDef_grpc:{methods:{}},point3d_1_0_0:{fields:{x:{type:"double",id:1},y:{type:"double",id:2},z:{type:"double",id:3}}},vector3d_1_0_0:{fields:{x:{type:"double",id:1},y:{type:"double",id:2},z:{type:"double",id:3}}},geometry_1_0_0:{fields:{}},geometry_1_0_0_Type:{oneofs:{geometry:{oneof:["point","bsurface","cone","cylinder","ellipticalcone","ellipticalcylinder","plane","sphere","surface","torus","bcurve","circle","curve","ellipse","line"]}},fields:{point:{type:"point_1_0_0",id:1},bsurface:{type:"bsurface_1_0_0",id:2},cone:{type:"cone_1_0_0",id:3},cylinder:{type:"cylinder_1_0_0",id:4},ellipticalcone:{type:"ellipticalcone_1_0_0",id:5},ellipticalcylinder:{type:"ellipticalcylinder_1_0_0",id:6},plane:{type:"plane_1_0_0",id:7},sphere:{type:"sphere_1_0_0",id:8},surface:{type:"surface_1_0_0",id:9},torus:{type:"torus_1_0_0",id:10},bcurve:{type:"bcurve_1_0_0",id:11},circle:{type:"circle_1_0_0",id:12},curve:{type:"curve_1_0_0",id:13},ellipse:{type:"ellipse_1_0_0",id:14},line:{type:"line_1_0_0",id:15}}},paramrange_1_0_0:{fields:{low:{type:"double",id:1},high:{type:"double",id:2},type:{type:"typeEnum",id:3}},nested:{typeEnum:{values:{infinite:0,finite:1,boundBelow:2,boundAbove:3}}}},point_1_0_0:{fields:{position:{type:"point3d_1_0_0",id:1}}},bsurface_1_0_0:{fields:{uDegree:{type:"uint32",id:1},vDegree:{type:"uint32",id:2},uKnots:{rule:"repeated",type:"double",id:3},vKnots:{rule:"repeated",type:"double",id:4},controlPoints:{rule:"repeated",type:"double",id:5},weights:{rule:"repeated",type:"double",id:6},uRange:{type:"paramrange_1_0_0",id:7},vRange:{type:"paramrange_1_0_0",id:8}}},cone_1_0_0:{fields:{center:{type:"point3d_1_0_0",id:1},axis:{type:"vector3d_1_0_0",id:2},radius:{type:"vector3d_1_0_0",id:3},angle:{type:"double",id:4},uCoordScale:{type:"double",id:5},uRange:{type:"paramrange_1_0_0",id:6},vRange:{type:"paramrange_1_0_0",id:7}}},cylinder_1_0_0:{fields:{center:{type:"point3d_1_0_0",id:1},axis:{type:"vector3d_1_0_0",id:2},radius:{type:"vector3d_1_0_0",id:3},uCoordScale:{type:"double",id:4},uRange:{type:"paramrange_1_0_0",id:5},vRange:{type:"paramrange_1_0_0",id:6}}},ellipticalcone_1_0_0:{fields:{center:{type:"point3d_1_0_0",id:1},axis:{type:"vector3d_1_0_0",id:2},majorRadius:{type:"vector3d_1_0_0",id:3},radiusRatio:{type:"double",id:4},angle:{type:"double",id:5},uCoordScale:{type:"double",id:6},uRange:{type:"paramrange_1_0_0",id:7},vRange:{type:"paramrange_1_0_0",id:8}}},ellipticalcylinder_1_0_0:{fields:{center:{type:"point3d_1_0_0",id:1},axis:{type:"vector3d_1_0_0",id:2},majorRadius:{type:"vector3d_1_0_0",id:3},radiusRatio:{type:"double",id:4},uCoordScale:{type:"double",id:5},uRange:{type:"paramrange_1_0_0",id:6},vRange:{type:"paramrange_1_0_0",id:7}}},plane_1_0_0:{fields:{origin:{type:"point3d_1_0_0",id:1},normal:{type:"vector3d_1_0_0",id:2},uAxis:{type:"vector3d_1_0_0",id:3},uRange:{type:"paramrange_1_0_0",id:4},vRange:{type:"paramrange_1_0_0",id:5}}},sphere_1_0_0:{fields:{center:{type:"point3d_1_0_0",id:1},radius:{type:"vector3d_1_0_0",id:2},axis:{type:"vector3d_1_0_0",id:3},uRange:{type:"paramrange_1_0_0",id:4},vRange:{type:"paramrange_1_0_0",id:5}}},surface_1_0_0:{fields:{uRange:{type:"paramrange_1_0_0",id:1},vRange:{type:"paramrange_1_0_0",id:2}}},surface_1_0_0_Type:{oneofs:{surface:{oneof:["bsurface","cone","cylinder","ellipticalcone","ellipticalcylinder","plane","sphere","torus"]}},fields:{bsurface:{type:"bsurface_1_0_0",id:1},cone:{type:"cone_1_0_0",id:2},cylinder:{type:"cylinder_1_0_0",id:3},ellipticalcone:{type:"ellipticalcone_1_0_0",id:4},ellipticalcylinder:{type:"ellipticalcylinder_1_0_0",id:5},plane:{type:"plane_1_0_0",id:6},sphere:{type:"sphere_1_0_0",id:7},torus:{type:"torus_1_0_0",id:8}}},torus_1_0_0:{fields:{center:{type:"point3d_1_0_0",id:1},axis:{type:"vector3d_1_0_0",id:2},majorRadius:{type:"double",id:3},minorRadius:{type:"double",id:4},coordAxis:{type:"vector3d_1_0_0",id:5},lemon:{type:"bool",id:6},uRange:{type:"paramrange_1_0_0",id:7},vRange:{type:"paramrange_1_0_0",id:8}}},bcurve_1_0_0:{fields:{degree:{type:"uint32",id:1},knots:{rule:"repeated",type:"double",id:2},controlPoints:{rule:"repeated",type:"double",id:3},weights:{rule:"repeated",type:"double",id:4},range:{type:"paramrange_1_0_0",id:5}}},circle_1_0_0:{fields:{center:{type:"point3d_1_0_0",id:1},normal:{type:"vector3d_1_0_0",id:2},radius:{type:"vector3d_1_0_0",id:3},range:{type:"paramrange_1_0_0",id:4}}},curve_1_0_0:{fields:{range:{type:"paramrange_1_0_0",id:1}}},curve_1_0_0_Type:{oneofs:{curve:{oneof:["bcurve","circle","ellipse","line"]}},fields:{bcurve:{type:"bcurve_1_0_0",id:1},circle:{type:"circle_1_0_0",id:2},ellipse:{type:"ellipse_1_0_0",id:3},line:{type:"line_1_0_0",id:4}}},ellipse_1_0_0:{fields:{center:{type:"point3d_1_0_0",id:1},normal:{type:"vector3d_1_0_0",id:2},majorRadius:{type:"vector3d_1_0_0",id:3},radiusRatio:{type:"double",id:4},range:{type:"paramrange_1_0_0",id:5}}},line_1_0_0:{fields:{position:{type:"point3d_1_0_0",id:1},direction:{type:"vector3d_1_0_0",id:2},range:{type:"paramrange_1_0_0",id:3}}},attribute_1_0_0:{fields:{}},attribute_1_0_0_Type:{oneofs:{attribute:{oneof:["nmiattribute","nmiattributearr","nmiattributestr","textattribute"]}},fields:{nmiattribute:{type:"nmiattribute_1_0_0",id:1},nmiattributearr:{type:"nmiattributearr_1_0_0",id:4},nmiattributestr:{type:"nmiattributestr_1_0_0",id:2},textattribute:{type:"textattribute_1_0_0",id:3}}},body_1_0_0:{fields:{lumps:{rule:"repeated",type:"string",id:1},attributes:{rule:"repeated",type:"string",id:2}}},coedge_1_0_0:{fields:{edge:{type:"string",id:1},partner:{type:"string",id:2},reversed:{type:"bool",id:3},attributes:{rule:"repeated",type:"string",id:4}}},edge_1_0_0:{fields:{vertex0:{type:"string",id:1},vertex1:{type:"string",id:2},precision:{type:"double",id:3},range:{type:"paramrange_1_0_0",id:4},reversed:{type:"bool",id:5},geometry:{type:"string",id:6},attributes:{rule:"repeated",type:"string",id:7}}},face_1_0_0:{fields:{loops:{rule:"repeated",type:"string",id:1},reversed:{type:"bool",id:2},geometry:{type:"string",id:3},attributes:{rule:"repeated",type:"string",id:4}}},loop_1_0_0:{fields:{coedges:{rule:"repeated",type:"string",id:1},attributes:{rule:"repeated",type:"string",id:2}}},lump_1_0_0:{fields:{shells:{rule:"repeated",type:"string",id:1},attributes:{rule:"repeated",type:"string",id:2}}},model_1_0_0:{fields:{geometries:{keyType:"string",type:"geometry_1_0_0_Type",id:1},topologies:{keyType:"string",type:"topology_1_0_0_Type",id:2},attributes:{keyType:"string",type:"attribute_1_0_0_Type",id:3}}},shell_1_0_0:{fields:{faces:{rule:"repeated",type:"string",id:1},attributes:{rule:"repeated",type:"string",id:2}}},topology_1_0_0:{fields:{attributes:{rule:"repeated",type:"string",id:1}}},topology_1_0_0_Type:{oneofs:{topology:{oneof:["body","coedge","edge","face","loop","lump","shell","vertex","wire","wirebody"]}},fields:{body:{type:"body_1_0_0",id:1},coedge:{type:"coedge_1_0_0",id:2},edge:{type:"edge_1_0_0",id:3},face:{type:"face_1_0_0",id:4},loop:{type:"loop_1_0_0",id:5},lump:{type:"lump_1_0_0",id:6},shell:{type:"shell_1_0_0",id:7},vertex:{type:"vertex_1_0_0",id:8},wire:{type:"wire_1_0_0",id:9},wirebody:{type:"wirebody_1_0_0",id:10}}},vertex_1_0_0:{fields:{precision:{type:"double",id:1},geometry:{type:"string",id:2},attributes:{rule:"repeated",type:"string",id:3}}},wire_1_0_0:{fields:{edges:{rule:"repeated",type:"string",id:1},attributes:{rule:"repeated",type:"string",id:2}}},wirebody_1_0_0:{fields:{wires:{rule:"repeated",type:"string",id:1},attributes:{rule:"repeated",type:"string",id:2}}},nmiattribute_1_0_0:{fields:{primaryId:{type:"uint64",id:1},secondaryId:{type:"int64",id:2},approachId:{type:"int64",id:3},operationIds:{rule:"repeated",type:"int64",id:4}}},nmiattributearr_1_0_0:{fields:{tagInfo:{rule:"repeated",type:"nmiattributestr_1_0_0",id:1}}},nmiattributestr_1_0_0:{fields:{primaryId:{type:"string",id:1},secondaryId:{type:"string",id:2},approachId:{type:"string",id:3},operationIds:{rule:"repeated",type:"string",id:4}}},textattribute_1_0_0:{fields:{text:{type:"string",id:1}}},entity:{oneofs:{entity:{oneof:["point3d","vector3d","geometry","paramrange","point","bsurface","cone","cylinder","ellipticalcone","ellipticalcylinder","plane","sphere","surface","torus","bcurve","circle","curve","ellipse","line","attribute","body","coedge","edge","face","loop","lump","model","shell","topology","vertex","wire","wirebody","nmiattribute","nmiattributearr","nmiattributestr","textattribute"]}},fields:{id:{type:"string",id:1},point3d:{type:"point3d_1_0_0",id:2},vector3d:{type:"vector3d_1_0_0",id:3},geometry:{type:"geometry_1_0_0",id:4},paramrange:{type:"paramrange_1_0_0",id:5},point:{type:"point_1_0_0",id:6},bsurface:{type:"bsurface_1_0_0",id:7},cone:{type:"cone_1_0_0",id:8},cylinder:{type:"cylinder_1_0_0",id:9},ellipticalcone:{type:"ellipticalcone_1_0_0",id:10},ellipticalcylinder:{type:"ellipticalcylinder_1_0_0",id:11},plane:{type:"plane_1_0_0",id:12},sphere:{type:"sphere_1_0_0",id:13},surface:{type:"surface_1_0_0",id:14},torus:{type:"torus_1_0_0",id:15},bcurve:{type:"bcurve_1_0_0",id:16},circle:{type:"circle_1_0_0",id:17},curve:{type:"curve_1_0_0",id:18},ellipse:{type:"ellipse_1_0_0",id:19},line:{type:"line_1_0_0",id:20},attribute:{type:"attribute_1_0_0",id:21},body:{type:"body_1_0_0",id:22},coedge:{type:"coedge_1_0_0",id:23},edge:{type:"edge_1_0_0",id:24},face:{type:"face_1_0_0",id:25},loop:{type:"loop_1_0_0",id:26},lump:{type:"lump_1_0_0",id:27},model:{type:"model_1_0_0",id:28},shell:{type:"shell_1_0_0",id:29},topology:{type:"topology_1_0_0",id:30},vertex:{type:"vertex_1_0_0",id:31},wire:{type:"wire_1_0_0",id:32},wirebody:{type:"wirebody_1_0_0",id:33},nmiattribute:{type:"nmiattribute_1_0_0",id:34},nmiattributearr:{type:"nmiattributearr_1_0_0",id:37},nmiattributestr:{type:"nmiattributestr_1_0_0",id:35},textattribute:{type:"textattribute_1_0_0",id:36}}}}}}}});e.exports=o},5316:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.saveToProtoBinary=t.saveToProtoMessage=t.SolidDefSaver=void 0;var r=i(8032),o=function(){};o.prototype.setVersion=function(e){console.warn("SolidDefSaver.prototype.setVersion is deprecated,")};const n=function(e){const t=r.Autodesk.lookupType("SolidDef.model_1_0_0"),i={topologies:{},geometries:{},attributes:{}};return e.addToModelObject(i),t.create(i)};t.SolidDefSaver=o,t.saveToProtoMessage=n,t.saveToProtoBinary=function(e){const t=r.Autodesk.lookupType("SolidDef.model_1_0_0"),i=n(e);return t.encode(i).finish()}},7360:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TopologySetters=void 0;var r=i(6752);const o={},n=function(e,t,i){const r=t.attributes;if(r){e.removeAllAttributes();for(var o=0;o<r.length;++o){let t=i(r[o]);e.addAttribute(t)}}};o.setBodyData=function(e,t,i){for(var r=t.lumps,o=new Array(r.length),s=0;s<r.length;++s){var a=r[s];o[s]=i(a),o[s].setBody(e)}e.setLumps(o),n(e,t,i)},o.setLumpData=function(e,t,i){for(var r=t.shells,o=new Array(r.length),s=0;s<r.length;++s){var a=r[s];o[s]=i(a),o[s].setLump(e)}e.setShells(o),n(e,t,i)},o.setShellData=function(e,t,i){for(var r=t.faces,o=new Array(r.length),s=0;s<r.length;++s){var a=r[s];o[s]=i(a),o[s].setShell(e)}e.setFaces(o),n(e,t,i)},o.setFaceData=function(e,t,i){for(var r=t.loops,o=new Array(r.length),s=0;s<r.length;++s){var a=r[s];o[s]=i(a),o[s].setFace(e)}e.setLoops(o),e.setReversed(t.reversed),e.setSurface(i(t.geometry)),n(e,t,i)},o.setLoopData=function(e,t,i){for(var r=t.coedges,o=new Array(r.length),s=0;s<r.length;++s){var a=r[s];o[s]=i(a),o[s].setLoop(e)}e.setCoedges(o),n(e,t,i)},o.setCoedgeData=function(e,t,i){e.setEdge(i(t.edge)),e.setReversed(t.reversed),e.setPartner(i(t.partner)),e.getEdge()&&!e.getEdge().getCoedge()&&e.getEdge().setCoedge(e),n(e,t,i)},o.setEdgeData=function(e,t,i){e.setVertex(0,i(t.vertex0)),e.setVertex(1,i(t.vertex1));var o=(0,r.propertyToRange)(t,"range");e.sett0(o[0]),e.sett1(o[1]),e.setReversed(t.reversed),e.setPrecision(t.precision),e.setCurve(i(t.geometry)),n(e,t,i)},o.setVertexData=function(e,t,i){e.setPrecision(t.precision),e.setPoint(i(t.geometry)),n(e,t,i)},o.setWireBodyData=function(e,t,i){for(var r=t.wires,o=new Array(r.length),s=0;s<r.length;++s){var a=r[s];o[s]=i(a),o[s].setWireBody(e)}e.setWires(o),n(e,t,i)},o.setWireData=function(e,t,i){for(var r=t.edges,o=new Array(r.length),s=0;s<r.length;++s){var a=r[s];o[s]=i(a),o[s].setWire(e)}e.setEdges(o),n(e,t,i)},t.TopologySetters=o},3888:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.controlPointsFromHomogeneous=t.controlPointsToHomogeneous=t.getUniqueKnots=t.findKnotSpanAndMultiplicity=t.findKnotSpan=void 0;var r=i(2468),o=i(4728),n=function(e,t){var i=0,r=t.length-1;if(e<=t[i]){for(;t[i]===t[i+1]&&i<r-1;)i+=1;return i}if(e>=t[r]){for(;t[r]===t[r-1]&&r>i+1;)r-=1;return r-1}for(var o=Math.floor((i+r)/2);e<t[o]||e>=t[o+1];)e<t[o]?r=o:i=o,o=Math.floor((i+r)/2);return o};t.findKnotSpan=n,t.findKnotSpanAndMultiplicity=function(e,t){var i=r.PARAMETER_SPACE_TOLERANCE,o=n(e,t),s=0,a=e,l=o;if(e<t[l]+i)for(a=t[l];l>=0&&Math.abs(t[l]-a)<i;)--l,++s;else if(e>t[l+1]-i){for(a=t[++l];l<t.length&&Math.abs(t[l]-a)<i;)++l,++s;a=l<t.length?t[o=l-1]:t[t.length-1]}return{span:o,multiplicity:s,knot:a}},t.getUniqueKnots=function(e){for(var t=[e[0]],i=1;i<e.length;++i)e[i]!==e[i-1]&&t.push(e[i]);return t},t.controlPointsToHomogeneous=function(e,t){o.ConsoleUtils.assert(e.length>0&&e.length===3*t.length);for(var i=t.length,r=new Array(4*i),n=0;n<i;++n){var s=t[n];r[4*n]=e[3*n]*s,r[4*n+1]=e[3*n+1]*s,r[4*n+2]=e[3*n+2]*s,r[4*n+3]=s}return r},t.controlPointsFromHomogeneous=function(e){o.ConsoleUtils.assert(e.length>0&&e.length%4==0);for(var t=e.length/4,i=new Array(3*t),r=new Array(t),n=0;n<t;++n){var s=e[4*n+3];i[3*n]=e[4*n]/s,i[3*n+1]=e[4*n+1]/s,i[3*n+2]=e[4*n+2]/s,r[n]=s}return{P:i,w:r}}},5564:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.relaxBCurveToPerpendicular=t.closestBCurveSegments=t.maxDistanceSqrToHull=t.minDistanceSqrToHull=void 0;var r=i(1972),o=i(2468),n=i(48),s=i(1e3),a=function(e,t){var i,n=t.length/3,s=r.Vector3.asFloat64(0,0,0);for(i=0;i<n;++i)s[0]+=t[3*i],s[1]+=t[3*i+1],s[2]+=t[3*i+2];r.Vector3.scale(s,s,1/n),r.Vector3.sub(s,s,e);var a=r.Vector3.squaredLength(s);if(a<o.KERNEL_TOLERANCE*o.KERNEL_TOLERANCE)return 0;var l=Number.POSITIVE_INFINITY;for(i=0;i<n;++i){var c=s[0]*(t[3*i]-e[0])+s[1]*(t[3*i+1]-e[1])+s[2]*(t[3*i+2]-e[2]);c<l&&(l=c)}return l<=0?0:l*l/a},l=function(e,t){for(var i=t.length/3,r=0,o=0;o<i;++o){var n=t[3*o]-e[0],s=t[3*o+1]-e[1],a=t[3*o+2]-e[2],l=n*n+s*s+a*a;l>r&&(r=l)}return r};t.minDistanceSqrToHull=a,t.maxDistanceSqrToHull=l,t.closestBCurveSegments=function(e,t,i,o){for(var n=Number.POSITIVE_INFINITY,s=[],c=0;c<t.length;++c){var u,h=t[c],d=h.getRangeUnlimited();if(o){u=!1;for(var p=0;p<o.length;++p)if(d[1]>=o[p][0]+r.FLOAT64_TOLERANCE&&d[0]<=o[p][1]-r.FLOAT64_TOLERANCE){u=!0;break}}else u=!0;if(u){var g=i?i[c]:0,f=h.getControlPoints(),v=a(e,f);if((v=Math.max(0,v-g))<=n){var m=l(e,f)+g;s.push({index:c,minDistSqr:v,maxDistSqr:m}),m<n&&(n=m)}}}return(s=s.filter((function(e){return e.minDistSqr<=n}))).sort((function(e,t){var i=e.minDistSqr-t.minDistSqr;return 0===i?e.maxDistSqr-t.maxDistSqr:i})),s},t.relaxBCurveToPerpendicular=function(e,t,i,o,a,l,c,u){var h=c||r.FLOAT64_TOLERANCE,d=u||32,p=t.length/3,g=e.length-p-1;return(0,s.newtonRaphson1D)((function(r){var s=(0,n.evaluateBCurveDerivs)(r,2,g,e,t,i),a=s[0],l=s[1],c=s[2],u=[a[0]-o[0],a[1]-o[1],a[2]-o[2]];return{val:2*(u[0]*l[0]+u[1]*l[1]+u[2]*l[2]),deriv:2*(u[0]*c[0]+u[1]*c[1]+u[2]*c[2]+(l[0]*l[0]+l[1]*l[1]+l[2]*l[2]))}}),l,a,h,d)}},6200:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.decomposeBCurveFlags=t.decomposeBCurveToBezier=t.decomposeBCurveControlPoints=void 0;var r=i(3888),o=i(4728),n=function(e,t,i){o.ConsoleUtils.assert(t.length%i==0);var r,n,s,a=e.length-t.length/i-1;o.ConsoleUtils.assert(a>0);var l=e.length-1,c=a,u=a+1,h=0,d=[],p=[];for(p[h]=new Array((a+1)*i),r=0;r<=a;++r)for(s=0;s<i;++s)p[h][r*i+s]=t[r*i+s];for(;u<l;){for(var g=1;u<l&&e[u+1]===e[u];)++u,++g;var f=u===l;if(f||(p[h+1]=new Array((a+1)*i)),g<a){var v=e[u]-e[c];for(n=a;n>g;--n)d[n-g-1]=v/(e[c+n]-e[c]);var m=a-g;for(n=1;n<=m;++n){for(var y=m-n,_=g+n,E=a;E>=_;--E){var A=d[E-_];for(s=0;s<i;++s)p[h][E*i+s]=p[h][E*i+s]*A+p[h][(E-1)*i+s]*(1-A)}if(!f)for(s=0;s<i;++s)p[h+1][y*i+s]=p[h][a*i+s]}}if(f)break;for(++h,r=a-g;r<=a;++r)for(s=0;s<i;++s)p[h][r*i+s]=t[(u-a+r)*i+s];c=u,++u}return p};t.decomposeBCurveControlPoints=n,t.decomposeBCurveToBezier=function(e,t,i){var s,a=i&&i.length>0;o.ConsoleUtils.assert(t.length>0&&t.length%3==0),o.ConsoleUtils.assert(!a||t.length===3*i.length);var l,c,u=e.length-t.length/3-1;if(o.ConsoleUtils.assert(u>0),a){var h=(0,r.controlPointsToHomogeneous)(t,i);for(l=n(e,h,4),c=[],s=0;s<l.length;++s){var d=(0,r.controlPointsFromHomogeneous)(l[s]);l[s]=d.P,c[s]=d.w}}else l=n(e,t,3),c=void 0;var p=(0,r.getUniqueKnots)(e);o.ConsoleUtils.assert(p.length===l.length+1);var g=new Array(p.length-1);for(s=0;s<g.length;++s)g[s]=new Array(2*u+2),g[s].fill(p[s],0,u+1),g[s].fill(p[s+1],u+1);return{U:g,P:l,w:c}},t.decomposeBCurveFlags=function(e,t){var i,r=e.length-t.length-1,o=new Array(t.length);o.fill(!1);var n=r-1;for(i=0;i<t.length;++i)if(t[i]){var s=Math.max(i-n,0),a=Math.min(i+n,o.length-1);o.fill(!0,s,a+1)}var l=[],c=e.length-1,u=r+1,h=0;for(l[h]=!1,i=0;i<=r;++i)o[i]&&(l[h]=!0);for(;u<c;){for(var d=1;u<c&&e[u+1]===e[u];)++u,++d;if(u===c)break;for(l[++h]=!1,i=r-d;i<=r;++i)o[u-r+i]&&(l[h]=!0);++u}return l}},48:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.evaluateBCurveDerivs=t.evaluateBCurvePoint=t.evaluateBasisDerivatives=t.evaluateBasisFunctions=void 0;var r,o,n,s,a=i(1972),l=i(5896),c=i(3888),u=(r=null,o=null,function(e,t,i,n){(null===r||r.length<i+1)&&(r=new Float64Array(i+1),o=new Float64Array(i+1));var s=new Float64Array(i+1);s[0]=1;for(var a=1;a<=i;++a){r[a]=t-n[e+1-a],o[a]=n[e+a]-t;for(var l=0,c=0;c<a;++c){var u=s[c]/(o[c+1]+r[a-c]);s[c]=l+o[c+1]*u,l=r[a-c]*u}s[a]=l}return s}),h=function(){var e=null,t=null,i=null,r=null;return function(o,n,s,a,l,c){var u,h,d;if(null===t||t.length<s+1){for(e=[new Float64Array(s+1),new Float64Array(s+1)],t=new Array(s+1),u=0;u<s+1;++u)t[u]=new Float64Array(s+1);i=new Float64Array(s+1),r=new Float64Array(s+1)}if(!c)for(c=new Array(a+1),u=0;u<=a;++u)c[u]=new Float64Array(s+1);for(t[0][0]=1,u=1;u<=s;++u){i[u]=n-l[o+1-u],r[u]=l[o+u]-n;var p=0;for(d=0;d<u;++d){t[u][d]=r[d+1]+i[u-d];var g=t[d][u-1]/t[u][d];t[d][u]=p+r[d+1]*g,p=i[u-d]*g}t[u][u]=p}for(u=0;u<=s;++u)c[0][u]=t[u][s];for(d=0;d<=s;++d){var f=0,v=1;for(e[0][0]=1,h=1;h<=a;++h){var m,y=0,_=d-h,E=s-h;for(d>=h&&(e[v][0]=e[f][0]/t[E+1][_],y=e[v][0]*t[_][E]),m=d-1<=E?h-1:s-d,u=_>=-1?1:-_;u<=m;++u)e[v][u]=(e[f][u]-e[f][u-1])/t[E+1][_+u],y+=e[v][u]*t[_+u][E];d<=E&&(e[v][h]=-e[f][h-1]/t[E+1][d],y+=e[v][h]*t[d][E]),c[h][d]=y,u=f,f=v,v=u}}for(d=s,h=1;h<=a;++h){for(u=0;u<=s;++u)c[h][u]*=d;d*=s-h}return c}}(),d=(n=null,s=null,function(e,t,i,r,o,u){var d,p,g;if(null===n||n.length<i+1){for(n=new Array(i+1),d=0;d<=i;++d)n[d]=new Float64Array(i+1);s=new Float64Array(i+1)}var f=Math.min(t,i),v=u&&u.length>0,m=(0,c.findKnotSpan)(e,r);h(m,e,i,f,r,n);var y=new Array(t+1);for(d=0;d<=t;++d)y[d]=a.Vector3.createFloat64();for(p=0;p<=f;++p){var _=3*(m-i);if(v)for(s[p]=0,d=0;d<=i;++d)g=u[m-i+d]*n[p][d],y[p][0]+=o[_]*g,y[p][1]+=o[_+1]*g,y[p][2]+=o[_+2]*g,s[p]+=g,_+=3;else for(d=0;d<=i;++d)g=n[p][d],y[p][0]+=o[_]*g,y[p][1]+=o[_+1]*g,y[p][2]+=o[_+2]*g,_+=3}if(v)for(p=0;p<=f;++p){var E=y[p];for(d=1;d<=p;++d)g=-l.binomialCoefficients[p][d]*s[d],a.Vector3.scaleAndAdd(E,E,y[p-d],g);a.Vector3.scale(E,E,1/s[0])}return y});t.evaluateBasisFunctions=u,t.evaluateBasisDerivatives=h,t.evaluateBCurvePoint=function(e,t,i,r,o){var n,s,l=(0,c.findKnotSpan)(e,i),h=u(l,e,t,i),d=o&&o.length>0,p=a.Vector3.createFloat64(),g=0,f=3*(l-t);if(d){for(n=0;n<=t;++n)s=o[l-t+n]*h[n],p[0]+=r[f]*s,p[1]+=r[f+1]*s,p[2]+=r[f+2]*s,g+=s,f+=3;a.Vector3.scale(p,p,1/g)}else for(n=0;n<=t;++n)s=h[n],p[0]+=r[f]*s,p[1]+=r[f+1]*s,p[2]+=r[f+2]*s,f+=3;return p},t.evaluateBCurveDerivs=d},9952:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e,t){this.content=[],this.scoreFunction=e,this.lookupFunction=t,this.lookupFunction&&(this.nodeDict={})};i.prototype={push:function(e){this.content.push(e),this.lookupFunction&&(this.nodeDict[this.lookupFunction(e)]=this.content.length-1),this.bubbleUp(this.content.length-1)},pop:function(){var e=this.content[0],t=this.content.pop();return this.content.length>0&&(this.content[0]=t,this.lookupFunction&&(this.nodeDict[this.lookupFunction(t)]=0),this.sinkDown(0)),this.lookupFunction&&delete this.nodeDict[this.lookupFunction(e)],e},peek:function(){return this.content[0]},getNodeIndex:function(e){if(this.lookupFunction)return this.nodeDict[this.lookupFunction(e)];for(var t=this.content.length,i=0;i<t;i++)if(this.content[i]===e)return i;throw new Error("Node not found.")},updated:function(e){var t=this.getNodeIndex(e),i=this.scoreFunction(e),r=Math.floor((t+1)/2)-1,o=this.content[r];if(t>0&&i<this.scoreFunction(o))this.bubbleUp(t);else{var n=2*(t+1),s=n-1,a=this.content[s],l=this.content[n];(a&&i>this.scoreFunction(a)||l&&i>this.scoreFunction(l))&&this.sinkDown(t)}},remove:function(e){var t=this.content.length,i=this.getNodeIndex(e),r=this.content.pop();i!==t-1&&(this.content[i]=r,this.scoreFunction(r)<this.scoreFunction(e)?this.bubbleUp(i):this.sinkDown(i))},size:function(){return this.content.length},bubbleUp:function(e){for(var t=this.content[e];e>0;){var i=Math.floor((e+1)/2)-1,r=this.content[i];if(!(this.scoreFunction(t)<this.scoreFunction(r)))break;this.content[i]=t,this.content[e]=r,this.lookupFunction&&(this.nodeDict[this.lookupFunction(t)]=i,this.nodeDict[this.lookupFunction(r)]=e),e=i}},sinkDown:function(e){for(var t=this.content.length,i=this.content[e],r=this.scoreFunction(i);;){var o=2*(e+1),n=o-1,s=null;if(n<t){var a=this.content[n],l=this.scoreFunction(a);l<r&&(s=n)}if(o<t){var c=this.content[o];this.scoreFunction(c)<(null===s?r:l)&&(s=o)}if(null===s)break;this.content[e]=this.content[s],this.content[s]=i,this.lookupFunction&&(this.nodeDict[this.lookupFunction(this.content[e])]=e,this.nodeDict[this.lookupFunction(this.content[s])]=s),e=s}}},t.BinaryHeap=i},3344:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BoundingBox=void 0;var r=i(1972),o=i(2468),n=function(e,t){this.min=e?r.Vector3.createFloat64FromValues(e[0],e[1],e[2]):r.Vector3.createFloat64FromValues(1/0,1/0,1/0),this.max=t?r.Vector3.createFloat64FromValues(t[0],t[1],t[2]):r.Vector3.createFloat64FromValues(-1/0,-1/0,-1/0)};n.prototype.toString=function(){return"(x:"+this.min[0]+", y:"+this.min[1]+", z:"+this.min[2]+") -> (x:"+this.max[0]+", y:"+this.max[1]+", z:"+this.max[2]+")"},n.prototype.copy=function(e){return r.Vector3.copy(this.min,e.min),r.Vector3.copy(this.max,e.max),this},n.prototype.clone=function(){return new n(this.min,this.max)},n.prototype.getWidth=function(e){var t=0;return 0<=e&&e<=2?(t=this.max[e]-this.min[e],isFinite(t)?t:0):(console.error("wrong axis argument supplied to BoundingBox.getWidth(): "+e),0)},n.prototype.getMaxMinAligned=function(e,t,i){for(var o,s,a,l=this.getCorners(),c=[],u=[],h=[],d=0;d<l.length;++d)o=r.Vector3.dot(l[d],e),s=r.Vector3.dot(l[d],t),a=r.Vector3.dot(l[d],i),c.push(o),u.push(s),h.push(a);var p=Math.min.apply(void 0,c),g=Math.min.apply(void 0,u),f=Math.min.apply(void 0,h),v=Math.max.apply(void 0,c),m=Math.max.apply(void 0,u),y=Math.max.apply(void 0,h);return new n([p,g,f],[v,m,y])},n.prototype.include=function(e){return this.includeX(e.min[0],e.max[0]),this.includeY(e.min[1],e.max[1]),this.includeZ(e.min[2],e.max[2]),this},n.prototype.includeX=function(e,t){return this.min[0]=Math.min(this.min[0],e),this.max[0]=Math.max(this.max[0],t),this},n.prototype.includeY=function(e,t){return this.min[1]=Math.min(this.min[1],e),this.max[1]=Math.max(this.max[1],t),this},n.prototype.includeZ=function(e,t){return this.min[2]=Math.min(this.min[2],e),this.max[2]=Math.max(this.max[2],t),this},n.prototype.includeSphere=function(e){var t=e.getCenter(),i=e.getRadius();return this.includeX(t[0]-i,t[0]+i),this.includeY(t[1]-i,t[1]+i),this.includeZ(t[2]-i,t[2]+i),this},n.prototype.translate=function(e){return r.Vector3.add(this.min,this.min,e),r.Vector3.add(this.max,this.max,e),this},n.prototype.getCorners=function(){var e=this.getDiagonal();return[r.Vector3.clone(this.min),r.Vector3.createFloat64FromValues(this.min[0]+e[0],this.min[1],this.min[2]),r.Vector3.createFloat64FromValues(this.min[0],this.min[1]+e[1],this.min[2]),r.Vector3.createFloat64FromValues(this.min[0],this.min[1],this.min[2]+e[2]),r.Vector3.createFloat64FromValues(this.min[0]+e[0],this.min[1]+e[1],this.min[2]),r.Vector3.createFloat64FromValues(this.min[0]+e[0],this.min[1],this.min[2]+e[2]),r.Vector3.createFloat64FromValues(this.min[0],this.min[1]+e[1],this.min[2]+e[2]),r.Vector3.clone(this.max)]},n.prototype.transform=function(e){if(!this.isEmpty()){var t=this.getCorners();this.max[0]=-1/0,this.max[1]=-1/0,this.max[2]=-1/0,this.min[0]=1/0,this.min[1]=1/0,this.min[2]=1/0;for(var i=0;i<t.length;++i)r.Vector3.transformMatrix44(t[i],t[i],e),r.Vector3.max(this.max,this.max,t[i]),r.Vector3.min(this.min,this.min,t[i])}return this},n.prototype.includePointXYZ=function(e){return this.includeX(e.x,e.x),this.includeY(e.y,e.y),this.includeZ(e.z,e.z),this},n.prototype.includePoint=function(e){return this.includeX(e[0],e[0]),this.includeY(e[1],e[1]),this.includeZ(e[2],e[2]),this},n.prototype.getCenter=function(){var e=r.Vector3.createFloat64();return r.Vector3.add(e,this.min,this.max),r.Vector3.scale(e,e,.5),e},n.prototype.getDiagonal=function(){var e=r.Vector3.createFloat64();return r.Vector3.sub(e,this.max,this.min),e},n.prototype.isPointInside=function(e){return!(e[0]<this.min[0]||e[0]>this.max[0]||e[1]<this.min[1]||e[1]>this.max[1]||e[2]<this.min[2]||e[2]>this.max[2])},n.prototype.isPointInsideWithTolerance=function(e,t){return t||(t=o.KERNEL_TOLERANCE),!(e[0]<this.min[0]-t||e[0]>this.max[0]+t||e[1]<this.min[1]-t||e[1]>this.max[1]+t||e[2]<this.min[2]-t||e[2]>this.max[2]+t)},n.prototype.intersects=function(e){return!(e.min[0]>this.max[0]||e.max[0]<this.min[0]||e.min[1]>this.max[1]||e.max[1]<this.min[1]||e.min[2]>this.max[2]||e.max[2]<this.min[2])},n.prototype.intersectsWithTolerance=function(e,t){return t||(t=o.KERNEL_TOLERANCE),!(e.min[0]>this.max[0]+t||e.max[0]<this.min[0]-t||e.min[1]>this.max[1]+t||e.max[1]<this.min[1]-t||e.min[2]>this.max[2]+t||e.max[2]<this.min[2]-t)},n.prototype.isEmpty=function(){return this.max[0]<this.min[0]||this.max[1]<this.min[1]||this.max[2]<this.min[2]},n.prototype.setEmpty=function(){return this.max[0]=-1/0,this.min[0]=1/0,this.max[1]=-1/0,this.min[1]=1/0,this.max[2]=-1/0,this.min[2]=1/0,this},n.prototype.isBounded=function(){return isFinite(this.max[0])&&isFinite(this.max[1])&&isFinite(this.max[2])&&isFinite(this.min[0])&&isFinite(this.min[1])&&isFinite(this.min[2])},t.BoundingBox=n},1288:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.closestBSurfacePointApprox=t.closestBSurfacePatches=void 0;var r=i(1972),o=i(5896),n=i(5564),s=i(6824);t.closestBSurfacePatches=function(e,t,i){for(var o=Number.POSITIVE_INFINITY,s=[],a=0;a<t.length;++a)for(var l=0;l<t[a].length;++l){var c,u=t[a][l],h=u.getRangeUnlimitedU(),d=u.getRangeUnlimitedV();if(i){c=!1;for(var p=0;p<i.length;++p)if(h[1]>=i[p][0][0]+r.FLOAT64_TOLERANCE&&h[0]<=i[p][0][1]-r.FLOAT64_TOLERANCE&&d[1]>=i[p][1][0]+r.FLOAT64_TOLERANCE&&d[0]<=i[p][1][1]-r.FLOAT64_TOLERANCE){c=!0;break}}else c=!0;if(c){var g=u.getControlPoints(),f=(0,n.minDistanceSqrToHull)(e,g,!0);if(f<=o){var v=(0,n.maxDistanceSqrToHull)(e,g);s.push({index:[a,l],minDistSqr:f,maxDistSqr:v}),v<o&&(o=v)}}}return(s=s.filter((function(e){return e.minDistSqr<=o}))).sort((function(e,t){var i=e.minDistSqr-t.minDistSqr;return 0===i?e.maxDistSqr-t.maxDistSqr:i})),s},t.closestBSurfacePointApprox=function(e,t,i,n,a,l,c,u,h){var d=t>1?2*t:1,p=i>1?2*i:1,g=(u[1]-u[0])/(n[n.length-1]-n[0]),f=(h[1]-h[0])/(a[a.length-1]-a[0]);d=Math.max(1,Math.round(d*g)),p=Math.max(1,Math.round(p*f));for(var v=(u[1]-u[0])/d,m=(h[1]-h[0])/p,y=Number.POSITIVE_INFINITY,_={u:void 0,v:void 0},E=void 0,A=r.Vector3.createFloat64(),x=0;x<=p;++x){for(var C=h[0]+x*m,w=[],b=0;b<=d;++b){var M,T,V=u[0]+b*v;w[b]=(0,s.evaluateBSurfacePoint)(V,C,t,i,n,a,l,c),b>0&&x>0&&(M=(0,o.closestPointToTriangle)(e,E[b-1],E[b],w[b-1],A),(T=r.Vector3.squaredDistance(e,A))<y&&(y=T,_.u=V+v*(M.coordA-1),_.v=C+m*(M.coordB-1)),M=(0,o.closestPointToTriangle)(e,w[b],w[b-1],E[b],A),(T=r.Vector3.squaredDistance(e,A))<y&&(y=T,_.u=V-v*M.coordA,_.v=C-m*M.coordB))}E=w}return _}},192:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.decomposeBSurfaceToBezier=t.decomposeBSurfaceControlPoints=t.decomposeBSurfaceControlPointsV=t.decomposeBSurfaceControlPointsU=void 0;var r=i(3888),o=i(4728),n=function(e,t,i,r){o.ConsoleUtils.assert(i.length%r==0);var n=t.length-e-1;o.ConsoleUtils.assert(i.length/r%n==0);var s,a,l,c,u=i.length/(r*n),h=e+1,d=u,p=t.length-1,g=e,f=e+1,v=0,m=[],y=[];for(y[v]=new Array(h*d*r),s=0;s<=e;++s)for(l=0;l<u;++l)for(c=0;c<r;++c)y[v][(s*d+l)*r+c]=i[(s*u+l)*r+c];for(;f<p;){for(var _=1;f<p&&t[f+1]===t[f];)++f,++_;var E=f===p;if(E||(y[v+1]=new Array(h*d*r)),_<e){var A=t[f]-t[g];for(a=e;a>_;--a)m[a-_-1]=A/(t[g+a]-t[g]);var x=e-_;for(a=1;a<=x;++a){for(var C=x-a,w=_+a,b=e;b>=w;--b){var M=m[b-w];for(l=0;l<u;++l)for(c=0;c<r;++c)y[v][(b*d+l)*r+c]=y[v][(b*d+l)*r+c]*M+y[v][((b-1)*d+l)*r+c]*(1-M)}if(!E)for(l=0;l<u;++l)for(c=0;c<r;++c)y[v+1][(C*d+l)*r+c]=y[v][(e*d+l)*r+c]}}if(E)break;for(++v,s=e-_;s<=e;++s)for(l=0;l<u;++l)for(c=0;c<r;++c)y[v][(s*d+l)*r+c]=i[((f-e+s)*u+l)*r+c];g=f,++f}return y},s=function(e,t,i,r){o.ConsoleUtils.assert(i.length%r==0);var n=t.length-e-1;o.ConsoleUtils.assert(i.length/r%n==0);var s,a,l,c,u=i.length/(r*n),h=u,d=e+1,p=t.length-1,g=e,f=e+1,v=0,m=[],y=[];for(y[v]=new Array(h*d*r),s=0;s<=e;++s)for(l=0;l<u;++l)for(c=0;c<r;++c)y[v][(s+l*d)*r+c]=i[(s+l*n)*r+c];for(;f<p;){for(var _=1;f<p&&t[f+1]===t[f];)++f,++_;var E=f===p;if(E||(y[v+1]=new Array(h*d*r)),_<e){var A=t[f]-t[g];for(a=e;a>_;--a)m[a-_-1]=A/(t[g+a]-t[g]);var x=e-_;for(a=1;a<=x;++a){for(var C=x-a,w=_+a,b=e;b>=w;--b){var M=m[b-w];for(l=0;l<u;++l)for(c=0;c<r;++c)y[v][(b+l*d)*r+c]=y[v][(b+l*d)*r+c]*M+y[v][(b-1+l*d)*r+c]*(1-M)}if(!E)for(l=0;l<u;++l)for(c=0;c<r;++c)y[v+1][(C+l*d)*r+c]=y[v][(e+l*d)*r+c]}}if(E)break;for(++v,s=e-_;s<=e;++s)for(l=0;l<u;++l)for(c=0;c<r;++c)y[v][(s+l*d)*r+c]=i[(f-e+s+l*n)*r+c];g=f,++f}return y},a=function(e,t,i,r,a,l){o.ConsoleUtils.assert(a.length%l==0),o.ConsoleUtils.assert(a.length/l==(i.length-e-1)*(r.length-t-1));var c,u=i.length>2*e+2,h=r.length>2*t+2;if(!u&&!h)return[[a.slice()]];c=u?n(e,i,a,l):[a];for(var d=0;d<c.length;++d)c[d]=h?s(t,r,c[d],l):[c[d]];return c};t.decomposeBSurfaceControlPointsU=n,t.decomposeBSurfaceControlPointsV=s,t.decomposeBSurfaceControlPoints=a,t.decomposeBSurfaceToBezier=function(e,t,i,n,s,l){var c,u,h,d,p=l&&l.length>0;if(o.ConsoleUtils.assert(s.length>0&&s.length%3==0),o.ConsoleUtils.assert(!p||s.length===3*l.length),p){var g=(0,r.controlPointsToHomogeneous)(s,l);for(h=a(e,t,i,n,g,4),d=[],c=0;c<h.length;++c)for(d[c]=[],u=0;u<h[c].length;++u){var f=(0,r.controlPointsFromHomogeneous)(h[c][u]);h[c][u]=f.P,d[c][u]=f.w}}else h=a(e,t,i,n,s,3),d=void 0;var v=(0,r.getUniqueKnots)(i);o.ConsoleUtils.assert(v.length===h.length+1);var m=new Array(v.length-1);for(c=0;c<m.length;++c)m[c]=new Array(2*e+2),m[c].fill(v[c],0,e+1),m[c].fill(v[c+1],e+1);var y=(0,r.getUniqueKnots)(n);o.ConsoleUtils.assert(y.length===h[0].length+1);var _=new Array(y.length-1);for(c=0;c<_.length;++c)_[c]=new Array(2*t+2),_[c].fill(y[c],0,t+1),_[c].fill(y[c+1],t+1);return{U:m,V:_,P:h,w:d}}},6824:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.evaluateBSurfaceDerivs=t.evaluateBSurfacePoint=void 0;var r=i(1972),o=i(5896),n=i(3888),s=i(48);t.evaluateBSurfacePoint=function(e,t,i,o,a,l,c,u){return u&&u.length>0?function(e,t,i,o,a,l,c,u){for(var h,d=l.length-o-1,p=(0,n.findKnotSpan)(e,a),g=(0,s.evaluateBasisFunctions)(p,e,i,a),f=(0,n.findKnotSpan)(t,l),v=(0,s.evaluateBasisFunctions)(f,t,o,l),m=p-i,y=r.Vector4.createFloat64(),_=r.Vector4.createFloat64(),E=0;E<=o;E++){r.Vector4.set(_,0,0,0,0),h=f-o+E;for(var A=0;A<=i;A++){var x=(m+A)*d+h,C=g[A]*u[x];_[0]+=C*c[3*x],_[1]+=C*c[3*x+1],_[2]+=C*c[3*x+2],_[3]+=C}y[0]+=v[E]*_[0],y[1]+=v[E]*_[1],y[2]+=v[E]*_[2],y[3]+=v[E]*_[3]}return r.Vector3.createFloat64FromValues(y[0]/y[3],y[1]/y[3],y[2]/y[3])}(e,t,i,o,a,l,c,u):function(e,t,i,o,a,l,c){for(var u,h=l.length-o-1,d=(0,n.findKnotSpan)(e,a),p=(0,s.evaluateBasisFunctions)(d,e,i,a),g=(0,n.findKnotSpan)(t,l),f=(0,s.evaluateBasisFunctions)(g,t,o,l),v=d-i,m=r.Vector3.createFloat64(),y=r.Vector3.createFloat64(),_=0;_<=o;_++){r.Vector3.set(y,0,0,0),u=g-o+_;for(var E=0;E<=i;E++){var A=(v+E)*h+u;y[0]+=p[E]*c[3*A],y[1]+=p[E]*c[3*A+1],y[2]+=p[E]*c[3*A+2]}m[0]+=f[_]*y[0],m[1]+=f[_]*y[1],m[2]+=f[_]*y[2]}return m}(e,t,i,o,a,l,c)},t.evaluateBSurfaceDerivs=function(e,t,i,a,l,c,u,h,d){return function(e,t,i,a,l,c,u,h,d){var p,g,f,v,m,y,_=new Array(i+1),E=new Array(i+1),A=new Array(i+1),x=new Array(i+1);for(p=0;p<=i;p++){for(_[p]=new Array(i+1-p),E[p]=new Array(i+1-p),g=0;g<=i-p;g++)_[p][g]=r.Vector3.createFloat64(),E[p][g]=0;A[p]=new Array(a+1),x[p]=new Array(l+1)}var C=Math.min(i,a),w=(0,n.findKnotSpan)(e,c);(0,s.evaluateBasisDerivatives)(w,e,a,C,c,A);var b=Math.min(i,l),M=(0,n.findKnotSpan)(t,u);(0,s.evaluateBasisDerivatives)(M,t,l,b,u,x);var T=d&&d.length>0,V=u.length-l-1,S=new Array(l+1);for(p=0;p<=C;p++){for(f=0;f<=l;f++)for(S[f]=[0,0,0,0],v=0;v<=a;v++){var L=(w-a+v)*V+(M-l+f),R=A[p][v];T&&(R*=d[L],S[f][3]+=R),S[f][0]+=R*h[3*L],S[f][1]+=R*h[3*L+1],S[f][2]+=R*h[3*L+2]}var P=Math.min(i-p,b);for(g=0;g<=P;g++)for(f=0;f<=l;f++)_[p][g][0]+=x[g][f]*S[f][0],_[p][g][1]+=x[g][f]*S[f][1],_[p][g][2]+=x[g][f]*S[f][2],T&&(E[p][g]+=x[g][f]*S[f][3])}if(T){var D=o.binomialCoefficients,O=r.Vector3.createFloat64();for(p=0;p<=i;p++)for(g=0;g<=i-p;g++){var I=_[p][g];for(y=1;y<=g;y++)r.Vector3.scaleAndAdd(I,I,_[p][g-y],-D[g][y]*E[0][y]);for(m=1;m<=p;m++){for(r.Vector3.scaleAndAdd(I,I,_[p-m][g],-D[p][m]*E[m][0]),r.Vector3.set(O,0,0,0),y=1;y<=g;y++)r.Vector3.scaleAndAdd(O,O,_[p-m][g-y],D[g][y]*E[m][y]);r.Vector3.scaleAndAdd(I,I,O,-D[p][m])}r.Vector3.scale(I,I,1/E[0][0])}}return _}(e,t,i,a,l,c,u,h,d)}},6275:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.extractBSurfaceParamLineV=t.extractBSurfaceParamLineU=t.insertBSurfaceKnotV=t.insertBSurfaceKnotU=void 0;var r=i(1972),o=i(3888),n=i(2468),s=function(e,t,i,o,n,s,a){var l,c,u=new Array(o);for(c=0;c<o;++c){u[c]=new Array(n-c-i);var h=t-n+c+1;for(l=0;l<n-c-i;++l)u[c][l]=(e-s[h+l])/(s[l+t+1]-s[h+l])}for(var d=a.length,p=new Array(d),g=new Array(n-i+1),f=0;f<d;++f){for(p[f]=new Array(n-i+o-1),l=0;l<=n-i;++l)g[l]=r.Vector4.clone(a[f][l]);for(c=0;c<o;++c){for(l=0;l<n-c-i;++l)r.Vector4.lerp(g[l],g[l],g[l+1],u[c][l]);p[f][c]=r.Vector4.clone(g[0]),p[f][n+o-i-c-2]=r.Vector4.clone(g[n-c-i-1])}for(l=o;l<n-i-1;l++)p[f][l]=r.Vector4.clone(g[l-o+1])}return p};t.insertBSurfaceKnotU=function(e,t,i,a,l,c,u,h){t=Math.min(t,i);var d=h&&h.length>0,p=(0,o.findKnotSpanAndMultiplicity)(e,l);e=p.knot;var g=p.span,f=p.multiplicity,v=t-f;if(e<l[0]+n.PARAMETER_SPACE_TOLERANCE||e>l[l.length-1]-n.PARAMETER_SPACE_TOLERANCE||f>=t)return{uknots:l.slice(),P:u.slice(),weights:d?h.slice():void 0};var m,y,_=l.length-i-1,E=c.length-a-1,A=new Array(E),x=g-i,C=g-f;for(y=0;y<E;++y)for(A[y]=new Array(C-x+1),m=x;m<=C;++m){var w=m*E+y,b=d?h[w]:1;A[y][m-x]=r.Vector4.createFloat64FromValues(b*u[3*w],b*u[3*w+1],b*u[3*w+2],b)}var M=s(e,g,f,v,i,l,A),T=l.slice(0,g+1);for(m=0;m<v;++m)T.push(e);T=T.concat(l.slice(g+1));var V,S=new Array(3*(_+v)*E),L=new Array((_+v)*E);for(y=0;y<E;++y){for(m=0;m<=x;++m)w=V=m*E+y,S[3*V]=u[3*w],S[3*V+1]=u[3*w+1],S[3*V+2]=u[3*w+2],L[V]=h[w];for(m=0;m<M[y].length;++m){V=(m+x+1)*E+y;var R=M[y][m];S[3*V]=R[0]/R[3],S[3*V+1]=R[1]/R[3],S[3*V+2]=R[2]/R[3],L[V]=R[3]}for(m=C;m<_;++m)w=m*E+y,S[3*(V=(m+v)*E+y)]=u[3*w],S[3*V+1]=u[3*w+1],S[3*V+2]=u[3*w+2],L[V]=h[w]}return{uknots:T,P:S,weights:d?L:void 0}},t.insertBSurfaceKnotV=function(e,t,i,a,l,c,u,h){t=Math.min(t,a);var d=h&&h.length>0,p=(0,o.findKnotSpanAndMultiplicity)(e,c);e=p.knot;var g=p.span,f=p.multiplicity,v=t-f;if(e<c[0]+n.PARAMETER_SPACE_TOLERANCE||e>c[c.length-1]-n.PARAMETER_SPACE_TOLERANCE||f>=t)return{vknots:c.slice(),P:u.slice(),weights:d?h.slice():void 0};var m,y,_=l.length-i-1,E=c.length-a-1,A=new Array(_),x=g-a,C=g-f;for(m=0;m<_;++m)for(A[m]=new Array(C-x+1),y=x;y<=C;++y){var w=m*E+y,b=d?h[w]:1;A[m][y-x]=r.Vector4.createFloat64FromValues(b*u[3*w],b*u[3*w+1],b*u[3*w+2],b)}var M=s(e,g,f,v,a,c,A),T=c.slice(0,g+1);for(y=0;y<v;++y)T.push(e);T=T.concat(c.slice(g+1));var V,S=new Array(3*_*(E+v)),L=new Array(_*(E+v));for(m=0;m<_;++m){for(y=0;y<=x;++y)w=m*E+y,S[3*(V=m*(E+v)+y)]=u[3*w],S[3*V+1]=u[3*w+1],S[3*V+2]=u[3*w+2],L[V]=h[w];for(y=0;y<M[m].length;++y){V=m*(E+v)+(y+x+1);var R=M[m][y];S[3*V]=R[0]/R[3],S[3*V+1]=R[1]/R[3],S[3*V+2]=R[2]/R[3],L[V]=R[3]}for(y=C;y<E;++y)w=m*E+y,S[3*(V=m*(E+v)+(y+v))]=u[3*w],S[3*V+1]=u[3*w+1],S[3*V+2]=u[3*w+2],L[V]=h[w]}return{vknots:T,P:S,weights:d?L:void 0}},t.extractBSurfaceParamLineU=function(e,t,i,n,a,l,c){var u=c&&c.length>0,h=(0,o.findKnotSpanAndMultiplicity)(e,a);e=h.knot;var d,p,g,f=h.span,v=e===a[a.length-1],m=v?i+1:h.multiplicity,y=i-m,_=n.length-t-1,E=a.length-i-1,A=new Array(3*_),x=new Array(_);if(m>=i)for(p=v?E-1:f-i,d=0;d<_;++d)g=d*E+p,A[3*d]=l[3*g],A[3*d+1]=l[3*g+1],A[3*d+2]=l[3*g+2],x[d]=u?c[g]:1;else{var C=new Array(_),w=f-i,b=f-m;for(d=0;d<_;++d)for(C[d]=new Array(b-w+1),p=w;p<=b;++p){g=d*E+p;var M=u?c[g]:1;C[d][p-w]=r.Vector4.createFloat64FromValues(M*l[3*g],M*l[3*g+1],M*l[3*g+2],M)}var T=s(e,f,m,y,i,a,C);for(p=y-1,d=0;d<_;++d){var V=T[d][p];A[3*d]=V[0]/V[3],A[3*d+1]=V[1]/V[3],A[3*d+2]=V[2]/V[3],x[d]=V[3]}}return{ctrlPts:A,weights:u?x:void 0}},t.extractBSurfaceParamLineV=function(e,t,i,n,a,l,c){var u=c&&c.length>0,h=(0,o.findKnotSpanAndMultiplicity)(e,n);e=h.knot;var d,p,g,f=h.span,v=e===n[n.length-1],m=v?t+1:h.multiplicity,y=t-m,_=n.length-t-1,E=a.length-i-1,A=new Array(3*E),x=new Array(E);if(m>=t)for(d=v?_-1:f-t,p=0;p<E;++p)g=d*E+p,A[3*p]=l[3*g],A[3*p+1]=l[3*g+1],A[3*p+2]=l[3*g+2],x[p]=u?c[g]:1;else{var C=new Array(E),w=f-t,b=f-m;for(p=0;p<E;++p)for(C[p]=new Array(b-w+1),d=w;d<=b;++d){g=d*E+p;var M=u?c[g]:1;C[p][d-w]=r.Vector4.createFloat64FromValues(M*l[3*g],M*l[3*g+1],M*l[3*g+2],M)}var T=s(e,f,m,y,t,n,C);for(d=y-1,p=0;p<E;++p){var V=T[p][d];A[3*p]=V[0]/V[3],A[3*p+1]=V[1]/V[3],A[3*p+2]=V[2]/V[3],x[p]=V[3]}}return{ctrlPts:A,weights:u?x:void 0}}},4336:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TessellationCache=t.CurveTessellator=void 0;var r=i(1972),o=i(2468),n=i(5896),s=i(6120),a={getCircularArcRenderPoints:function(e,t,i,r,o){var n=e.getRadius(),s=2*Math.acos((n-i)/n),a=t[1]-t[0],l=Math.ceil(a/s),c=0;for(!1===r&&c++;c<=l;++c){var u=c/l,h=t[0]*(1-u)+t[1]*u;o.push(e.evaluatePosition(h))}return n*(1-Math.cos(a/l*.5))},getAdaptiveRenderPoints:function(e,t,i,n){for(var a=t||.001,l=a*a,c=[],u=[],h=r.Vector3.createFloat64(),d=0,p=function(t,i,n,a,g){var f=n-t,v=.5*(t+n),m=e.evaluatePosition(v);r.Vector3.scaleAndAdd(h,[0,0,0],i,.5),r.Vector3.scaleAndAdd(h,h,a,.5);var y=r.Vector3.squaredDistance(h,m);if(g>64)s.DebugUtils.warn("Max recursion depth reach in getAdaptiveRenderPoints");else if(f>10*o.PARAMETER_SPACE_TOLERANCE&&y>l)return p(t,i,v,m,g+1),void p(v,m,n,a,g+1);d=Math.max(d,y),c.push(i),u.push(t)},g=n||function(e,t,i){for(var r=new Array(7),o=t,n=(i-t)/6,s=0;s<7;s++){var a=o;s>0&&s<6&&(a+=Math.sin(s)*n*.1),r[s]=a,o+=n}return r}(0,i[0],i[1]),f=0;f<g.length-1;++f){var v=g[f],m=g[f+1],y=e.evaluatePosition(v),_=e.evaluatePosition(m);p(v,y,m,_,0),f===g.length-2&&(c.push(_),u.push(m))}return{positions:c,params:u,tolerance:Math.sqrt(d)}}},l=function(){this._hasDirtyTessellation=!0,this._tessellationCache=void 0,this._trimmedTessellationCache={positions:void 0,offsets:void 0,transitions:[1,-1]}};l.prototype.setDirty=function(e){this._hasDirtyTessellation=e},l.prototype.isDirty=function(){return this._hasDirtyTessellation},l.prototype.reset=function(){this._hasDirtyTessellation=!0,this._tessellationCache=void 0,this._trimmedTessellationCache={positions:void 0,offsets:void 0,transitions:[1,-1]}},l.prototype.setCache=function(e){this._tessellationCache=e,this._hasDirtyTessellation=!1},l.prototype.getCache=function(){return this._tessellationCache},l.prototype.getTolerance=function(){if(this._tessellationCache)return this._tessellationCache.tolerance},l.prototype.getTessellation=function(e,t,i,s){var a=!1;if(!1===this._hasDirtyTessellation&&this._tessellationCache.tolerance>i+r.FLOAT64_TOLERANCE&&(this._hasDirtyTessellation=!0),this._hasDirtyTessellation){this._hasDirtyTessellation=!1;var l=s(i);this._tessellationCache={positions:l.positions,params:l.params,tolerance:l.tolerance},a=l.didRetessellate}var c=[e[0],e[e.length-1]],u=0,h=t.getRangeUnlimited();t.isPeriodicUnlimited()&&(u=(c=(0,n.normalizeParametricRangeToShiftedRange)(c,h))[0]-e[0]);var d=this._trimmedTessellationCache,p=d.transitions[0]-c[0],g=d.transitions[d.transitions.length-1]-c[1],f=p*p+g*g<r.FLOAT64_TOLERANCE;if(f&&e.length>2){f=d.transitions.length===e.length;for(var v=1;f&&v<e.length-1;++v)f=d.transitions[v-1]===e[v-1]+u}if(!f||a){var m;for(d.transitions.length=e.length,m=0;m<e.length;++m)d.transitions[m]=e[m]+u;d.positions=[t.evaluatePosition(e[0])],d.offsets=[0];var y,_,E=1,A=c[0];for(m=1;m<e.length;m++){var x=e[m]+u;for(_=0;_<this._tessellationCache.positions.length;_++)if((y=this._tessellationCache.params[_])>A+o.PARAMETER_SPACE_TOLERANCE){if(y>=x-o.PARAMETER_SPACE_TOLERANCE)break;r.Vector3.sqrDist(d.positions[E-1],this._tessellationCache.positions[_])>o.KERNEL_TOLERANCE*o.KERNEL_TOLERANCE&&(d.positions[E++]=r.Vector3.clone(this._tessellationCache.positions[_]))}if(t.isPeriodicUnlimited()&&x>h[1])for(_=1;_<this._tessellationCache.positions.length&&(y=this._tessellationCache.params[_])<x-(h[1]-h[0])-o.PARAMETER_SPACE_TOLERANCE;_++)r.Vector3.sqrDist(d.positions[E-1],this._tessellationCache.positions[_])>o.KERNEL_TOLERANCE*o.KERNEL_TOLERANCE&&(d.positions[E++]=r.Vector3.clone(this._tessellationCache.positions[_]));var C=t.evaluatePosition(x);r.Vector3.sqrDist(d.positions[E-1],C)<o.KERNEL_TOLERANCE*o.KERNEL_TOLERANCE&&E>d.offsets[d.offsets.length-1]+1&&E--,d.positions[E++]=C,d.offsets.push(d.positions.length-1),A=x}}return{positions:d.positions,offsets:d.offsets,tolerance:this._tessellationCache.tolerance}},t.CurveTessellator=a,t.TessellationCache=l},1e3:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.invertIntegral1D=t.integrateFunction1D=t.newtonRaphson1D=void 0;var r,o,n,s=i(2468),a=i(5896),l=i(6120),c=(r=[.9914553711208126,.9491079123427585,.8648644233597691,.7415311855993945,.5860872354676911,.4058451513773972,.20778495500789848,0],o=[.022935322010529224,.06309209262997856,.10479001032225019,.14065325971552592,.1690047266392679,.19035057806478542,.20443294007529889,.20948214108472782],n=[.1294849661688697,.27970539148927664,.3818300505051189,.4179591836734694],function(e,t,i){var a=function(e,t,i){for(var s=.5*(t+i),a=.5*(i-t),l=e(s),c=l*o[7],u=l*n[3],h=0;h<7;++h){var d=a*r[h],p=e(s-d)+e(s+d);c+=p*o[h],h%2==1&&(u+=p*n[Math.floor(h/2)])}var g=200*Math.abs(c-u)*a;return{length:c*a,error:g*=Math.sqrt(g)}}(e,t[0],t[1]);if(void 0===i)i=0;else if(i>8)return l.DebugUtils.warn("Max depth reached in integrateFunction1D!"),a.length;if(a.error>s.KERNEL_TOLERANCE){var u=.5*(t[0]+t[1]);return c(e,[t[0],u],i+1)+c(e,[u,t[1]],i+1)}return a.length});t.newtonRaphson1D=function(e,t,i,r,o){var n,s=i;t&&(s=(0,a.clamp)(s,t[0],t[1]));var c=0;do{++c;var u=e(s),h=s-u.val/u.deriv;t&&(h=(0,a.clamp)(h,t[0],t[1])),n=Math.abs(h-s),s=h}while(n>r&&c<o);return c>=o&&l.DebugUtils.warn("Maximum number of iterations reached. Something wrong is going on here !!!"),s},t.integrateFunction1D=c,t.invertIntegral1D=function(e,t,i){var r=s.KERNEL_TOLERANCE,o=c(e,i);if(t<r)return i[0];if(t>o-r)return i[1];for(var n=i[0],l=i[1],u=t;l-n>s.PARAMETER_SPACE_TOLERANCE;){var h=u/o,d=n+(h=(0,a.clamp)(h,.01,.99))*(l-n),p=c(e,[n,d]),g=o-(p=(0,a.clamp)(p,0,o));if(Math.abs(u-p)<r)return d;p>u?(l=d,o=p):(n=d,u-=p,o=g)}return.5*(n+l)}},880:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.newtonRaphson2D=t.RelaxResult=void 0;var r=i(1972),o={};o[o.Success=0]="Success",o[o.OutOfRange=1]="OutOfRange",o[o.DegenerateStep=2]="DegenerateStep",o[o.TooManySteps=3]="TooManySteps",o[o.RootNotFound=4]="RootNotFound",t.RelaxResult=o,t.newtonRaphson2D=function(e,t,i,n,s){n=n||1e-12,s=s||100;var a=[void 0,void 0];i&&2===i.length&&(i[0]&&2===i[0].length&&(a[0]=i[0]),i[1]&&2===i[1].length&&(a[1]=i[1])),a[0]&&(a[0][0],a[0][1]),a[1]&&(a[1][0],a[1][1]);for(var l=[0,0],c=1/0,u=1/0,h=!1,d=r.Matrix22.createFloat64(),p=r.Matrix22.createFloat64(),g=r.Vector2.clone(t),f=o.Success,v=0;v<=s;v++){var m=e(g);if(c=r.Vector2.squaredLength(m.val),g[0],g[1],c<r.FLOAT64_TOLERANCE*r.FLOAT64_TOLERANCE){f=o.Success;break}if(v>0){var y=Math.max(Math.abs(l[0]),Math.abs(l[1]));if(y<n){c>=u&&(r.Vector2.sub(g,g,l),c=u,m=e(g));var _=10*n*(r.Vector2.len(m.deriv1)+r.Vector2.len(m.deriv2)),E=_*_;f=c>E?h?o.OutOfRange:o.RootNotFound:o.Success;break}}if(v===s){c>=u&&(r.Vector2.sub(g,g,l),c=u),f=o.TooManySteps;break}if(v>0&&c>=u){var A=u/(u+c);A=Math.max(A,.1),r.Vector2.sub(g,g,l),r.Vector2.scale(l,l,A),r.Vector2.add(g,g,l),c=u}else{if(u=c,r.Matrix22.set(d,-m.deriv1[0],-m.deriv1[1],-m.deriv2[0],-m.deriv2[1]),Math.abs(r.Matrix22.determinant(d))<r.FLOAT64_TOLERANCE){f=o.DegenerateStep;break}r.Matrix22.invert(p,d),r.Vector2.transformMatrix22(l,m.val,p),l[0],l[1],r.Vector2.add(g,g,l),h=!1;for(var x=0;x<3;x++){var C=x>=2,w=x%2;if(a[w]){var b=0;if(g[w]<a[w][0]?(b=g[w]-a[w][0],g[w]=a[w][0]):g[w]>a[w][1]&&(b=g[w]-a[w][1],g[w]=a[w][1]),0!==b){g[w];var M=l[w];if(l[w]-=b,C);else{var T=1-w;if(g[T]-=l[T],Math.abs(l[w])>n){var V=l[w]/M;l[T]*=V}else{h=!0;var S=0===T?m.deriv1:m.deriv2;l[T]=-r.Vector2.dot(m.val,S)/Math.max(r.Vector2.dot(S,S),r.FLOAT64_TOLERANCE)}g[T]+=l[T],l[0],l[1]}}}}}}return o[f],g[0],g[1],{param:g,status:f}}},6704:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=16777619,r=function(e,t){if(t<1)return"";for(var i="";t>1;)1&t&&(i+=e),t>>=1,e+=e;return i+e},o={isInitialized:!1,rngA:4027999010,rngB:3993266363,rngC:3605298456,rotl32:function(e,t){return(e<<t>>>0|e>>>32-t)>>>0},initialize:function(e,t){return o.isInitialized&&!t?0:(o.isInitialized&&(o.rngA=4027999010,o.rngB=3993266363,o.rngC=3605298456),o.isInitialized=!0,void 0!==e?i=e:(i=(new Date).getTime(),i^=Math.floor(2147483647*Math.random()+1)),o.rngA+=2097151&i,o.rngB+=i>>7&524287,o.rngC+=i>>13,i);var i},genRandUInt32:function(){return o.rngA=~(2911329625*o.rngA),o.rngA=o.rotl32(o.rngA,17),o.rngB=4031235431*o.rngB,o.rngB=o.rotl32(o.rngB,15),o.rngC=3286325185-o.rotl32(o.rngC,19),o.rngA+o.rngB^o.rngC}},n=function(e){for(var t="",i=0;i<4;i++){var o=e[i].toString(16);t+=r("0",8-o.length)+o}return t.substr(0,8)+"-"+t.substr(8,4)+"-"+t.substr(12,4)+"-"+t.substr(16,4)+"-"+t.substr(20,12)},s=function(e,t){var i=t;return void 0===i&&(i=new Uint32Array(4)),i[0]=parseInt("0x"+e.substr(0,8),16),i[1]=parseInt("0x"+e.substr(9,4)+e.substr(14,4),16),i[2]=parseInt("0x"+e.substr(19,4)+e.substr(24,4),16),i[3]=parseInt("0x"+e.substr(28,8),16),i},a=function(e,t){var r=new Uint32Array(t);return r[0]+=2654435769,r[1]+=104395303,r[2]+=452930477,r[3]+=982451653,r[0]+=e[3]<<6,r[1]+=e[0]<<6,r[2]+=e[1]<<6,r[3]+=e[2]<<6,r[0]+=e[2]>>2,r[1]+=e[3]>>2,r[2]+=e[0]>>2,r[3]+=e[1]>>2,r[0]=(r[0]^e[1])*i>>>0,r[1]=(r[1]^e[2])*i>>>0,r[2]=(r[2]^e[3])*i>>>0,r[3]=(r[3]^e[0])*i>>>0,r};o.initialize(),t.uint32x4ToGUID=n,t.guidToUint32x4=s,t.generateGUID=function(){var e=new Uint32Array(4);return e[0]=o.genRandUInt32(),e[1]=o.genRandUInt32(),e[2]=o.genRandUInt32(),e[3]=o.genRandUInt32(),n(e)},t.isGUID=function(e){return/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/.test(e)},t.combineGuids=function(e,t){var i=s(e),r=s(t),o=a(i,r);return n(o)},t.hashCombine4xUint32=a},5896:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.definePlaneThroughPoints=t.getPlaneTransforms=t.limitRange=t.PI2=t.sortedIndex=t.clamp=t.orient2D=t.signedDistanceTo2DLine=t.intersectIntervals=t.solveTwoEquationsTwoVariables=t.closestPointToTriangle=t.closestPointToPolyline=t.distancePointToLineSegment=t.projectPointToLineSegment=t.angleDifference=t.periodicDifference=t.minMaxCosSinFunc=t.convertToOtherPeriodicRange=t.adjustParameterToPeriodicRange=t.getShortestParametricRange=t.isParameterWithinPeriodicRange=t.normalizeSegmentsToPeriodicRange=t.normalizeParametricRange=t.normalizeParametricRangeToShiftedRange=t.normalizeParameterToShiftedRange=t.adjustAngleToRange=t.normalizeAngleRange=t.normalizeAngle=t.normalizeParameter=t.foldNearTo=t.foldAbove=t.fold=t.modulus=t.getSignedAngle=t.isPointInsidePolygon2D=t.binomialCoefficients=void 0;var r=i(1972),o=i(2468),n=i(4728),s=2*Math.PI,a=[];!function(){for(var e=0;e<8;++e){a[e]=[1];for(var t=1;t<e;++t)a[e][t]=a[e-1][t-1]+a[e-1][t];a[e][e]=1}}();var l=function(e,t,i){return Math.min(Math.max(t,e),i)},c=function(e,t){return e-t*Math.floor(e/t)},u=function(e,t){var i=e%t;return i<0?i+t:i},h=function(e,t,i){return u(e-t,i)+t},d=function(e,t){return e<0?t+e%t:e%t},p=function(e,t){return d(e-t[0],t[1]-t[0])+t[0]},g=function(e,t){n.ConsoleUtils.assert(e[1]>=e[0],"normalizeParametricRange: in_range ends not in order.");var i=e[1]-e[0],r=d(e[0],t);return[r,r+i]},f=function(e,t,i,r,o){if(!isFinite(i))return e;var n=g(t,i),s=d(e,i),a=s+i;if(r=!!r,s>=n[0]&&s<=n[1])return t[0]+(s-n[0]);if(a>=n[0]&&a<=n[1])return t[0]+(a-n[0]);var l=Math.abs(n[0]-s),c=Math.abs(s-n[1]),u=Math.abs(n[0]-a),h=Math.abs(a-n[1]);return o?Math.min(l,u)<Math.min(c,h)?t[0]:t[1]:Math.min(l,c)>Math.min(u,h)&&!r?t[0]+(a-n[0]):t[0]+(s-n[0])},v=function(e,t,i){var r=Math.abs(e-t);return isFinite(i)&&(r%=i)>i/2?i-r:r},m=function(e,t,i){var n=r.Vector3.sub(r.Vector3.createFloat64(),t,e),s=r.Vector3.dot(n,n);if(s<o.KERNEL_TOLERANCE*o.KERNEL_TOLERANCE)return 0;var a=r.Vector3.sub(r.Vector3.createFloat64(),i,e);return r.Vector3.dot(a,n)/s};t.binomialCoefficients=a,t.isPointInsidePolygon2D=function(e,t){for(var i=!1,r=t.length,o=0,n=r-2;o<r;o+=2)t[o+1]>e[1]!=t[n+1]>e[1]&&e[0]<(t[n]-t[o])*(e[1]-t[o+1])/(t[n+1]-t[o+1])+t[o]&&(i=!i),n=o;return i},t.getSignedAngle=function(e,t){var i=l(r.Vector2.dot(e,t),-1,1),o=t[0]*e[1]-t[1]*e[0];return 0===o?.5*Math.PI*(i-1):o<0?-Math.acos(i):Math.acos(i)},t.modulus=c,t.fold=u,t.foldAbove=h,t.foldNearTo=function(e,t,i){return h(e,t-i/2,i)},t.normalizeParameter=d,t.normalizeAngle=function(e){return d(e,s)},t.normalizeAngleRange=function(e){return g(e,2*Math.PI)},t.adjustAngleToRange=function(e,t){return f(e,t,2*Math.PI)},t.normalizeParameterToShiftedRange=p,t.normalizeParametricRangeToShiftedRange=function(e,t){n.ConsoleUtils.assert(e[1]>=e[0],"normalizeParametricRangeToShiftedRange: in_range ends not in order.");var i=e[1]-e[0],r=p(e[0],t);return[r,r+i]},t.normalizeParametricRange=g,t.normalizeSegmentsToPeriodicRange=function(e,t,i,r,n){for(var s=void 0!==r?r:o.KERNEL_TOLERANCE,a=void 0!==n?n:t[1]-t[0],l=[],c=0;c<e.length;c++){var u=p(e[c][0],t),h=e[c][1]-e[c][0];if(h>=a)return[[t[0],t[1]]];var d=u+h;d<t[1]?l.push([u,d]):(l.push([u,t[1]]),l.push([t[0],d-t[1]+t[0]]))}var g=[];for(l.sort((function(e,t){return e[0]-t[0]})),c=0;c<l.length;c++){for(var f=l[c];c+1<l.length&&l[c+1][0]<f[1];)f[1]=Math.max(f[1],l[c+1][1]),c++;(Math.abs(f[1]-f[0])>s||!i)&&g.push(f)}return g},t.isParameterWithinPeriodicRange=function(e,t,i,r){var o=f(e,t,i);return r=r||0,o>t[0]-r&&o<t[1]+r},t.getShortestParametricRange=function(e,t,i){if((e=d(e,i))>(t=d(t,i))){var r=e;e=t,t=r}return e-t+i<t-e?[t,e+i]:[e,t]},t.adjustParameterToPeriodicRange=f,t.convertToOtherPeriodicRange=function(e,t,i,r){if(!isFinite(i))return n.ConsoleUtils.assert(e[0]>=t[0]-r,"The start of the input range doesn't lie in the target range."),n.ConsoleUtils.assert(e[1]<=t[1]+r,"The input range doesn't lie within the target range."),e;if(r=r||0,e[1]-e[0]>=i-r)return t[1]-t[0]<i-r&&console.error("The input range is larger than the target range."),t;var o=f(e[0],t,i);n.ConsoleUtils.assert(o>=t[0]-r,"The start of the input range doesn't lie in the target range.");var s=o+e[1]-e[0];return n.ConsoleUtils.assert(s<=t[1]+r,"The input range doesn't lie within the target range."),[o,s]},t.minMaxCosSinFunc=function(e,t,i,r){if(0===e&&0===t)return[i,i];var o,n=g(r,2*Math.PI),s=f(Math.atan(t/e),n,Math.PI,!0),a=[];for(o=0;o<3;++o)n[0]<=s&&n[1]>=s&&a.push(e*Math.cos(s)+t*Math.sin(s)),s+=Math.PI;if(r[1]-r[0]<2*Math.PI)for(o=0;o<2;o++)a.push(e*Math.cos(r[o])+t*Math.sin(r[o]));return[Math.min.apply(null,a)+i,Math.max.apply(null,a)+i]},t.periodicDifference=v,t.angleDifference=function(e,t){return v(e,t,2*Math.PI)},t.projectPointToLineSegment=m,t.distancePointToLineSegment=function(e,t,i,o){var n=m(e,t,i);n=l(n,0,1);var s=o||r.Vector3.createFloat64();return r.Vector3.lerp(s,e,t,n),r.Vector3.distance(s,i)},t.closestPointToPolyline=function(e,t,i,o,n){for(var s="number"==typeof t[0],a=s?t.length/3:t.length,c=void 0,u=Number.POSITIVE_INFINITY,h=r.Vector3.createFloat64(),d=0;d<a-1;++d){var p=i?i[d]:d,g=i?i[d+1]:d+1,f=0,v=1;if(!(o&&(o[0]>p&&(f=(o[0]-p)/(g-p)),o[1]<g&&(v=(o[1]-p)/(g-p)),v<f))){var y,_;s?(y=[t[3*d],t[3*d+1],t[3*d+2]],_=[t[3*d+3],t[3*d+4],t[3*d+5]]):(y=t[d],_=t[d+1]);var E=m(y,_,e);E=l(E,f,v),r.Vector3.lerp(h,y,_,E);var A=r.Vector3.squaredDistance(h,e);A<u&&(c=(1-E)*p+E*g,u=A,n&&r.Vector3.copy(n,h))}}return c},t.closestPointToTriangle=function(e,t,i,n,s){var a,c,u=r.Vector3.sub(r.Vector3.createFloat64(),i,t),h=r.Vector3.sub(r.Vector3.createFloat64(),n,t),d=r.Vector3.sub(r.Vector3.createFloat64(),e,t),p=r.Vector3.squaredLength(u),g=r.Vector3.squaredLength(h),f=r.Vector3.dot(u,h),v=r.Vector3.dot(d,u),y=r.Vector3.dot(d,h);if(p<o.KERNEL_TOLERANCE*o.KERNEL_TOLERANCE&&g<o.KERNEL_TOLERANCE*o.KERNEL_TOLERANCE)a=c=0;else if(p<o.KERNEL_TOLERANCE*o.KERNEL_TOLERANCE)a=0,c=l(y/g,0,1);else if(g<o.KERNEL_TOLERANCE*o.KERNEL_TOLERANCE)a=l(v/p,0,1),c=0;else{var _=r.Matrix22.createFloat64FromValues(p,f,f,g);if(Math.abs(r.Matrix22.determinant(_))>r.FLOAT64_TOLERANCE){r.Matrix22.invert(_,_);var E=[v,y];r.Vector2.transformMatrix22(E,E,_),a=E[0],c=E[1]}else c=y/g,(a=v/p)<=0||c<=0?(a=l(a,0,1),c=l(c,0,1)):a<c?(a=l(a,0,1),c=0):(a=0,c=l(c,0,1))}if(a<0&&y>=0&&y<=g&&(a=0,c=y/g),c<0&&v>=0&&v<=p&&(a=v/p,c=0),a+c>1){var A=m(i,n,e);A>=0&&A<=1&&(a=1-A,c=A)}if(a<0||c<0||a+c>1){var x=r.Vector3.squaredLength(d),C=r.Vector3.squaredDistance(e,i),w=r.Vector3.squaredDistance(e,n);C<=x&&C<=w?(a=1,c=0):w<=x&&w<=C?(a=0,c=1):a=c=0}return s&&(r.Vector3.scaleAndAdd(s,t,u,a),r.Vector3.scaleAndAdd(s,s,h,c)),{coordA:a,coordB:c}},t.solveTwoEquationsTwoVariables=function(e){var t=e[0][0],i=e[0][1],r=e[1][0],o=e[1][1],n=t*o-i*r;if(0!==n){var s=o*e[0][2]-i*e[1][2],a=-r*e[0][2]+t*e[1][2];return[s/=n,a/=n]}},t.intersectIntervals=function(e,t,i){i=i||0;for(var r=[],o=0;o<e.length;o++)for(var n=0;n<t.length;n++){var s=Math.max(e[o][0],t[n][0]),a=Math.min(e[o][1],t[n][1]);a-i>s&&(a>s?r.push([s,a]):r.push([a,a]))}return r},t.signedDistanceTo2DLine=function(e,t,i){var r=i[0]-e[0],o=i[1]-e[1];return t[1]*r-t[0]*o},t.orient2D=function(e,t,i){var r=e[0]-i[0],o=t[0]-i[0],n=e[1]-i[1];return r*(t[1]-i[1])-n*o},t.clamp=l,t.sortedIndex=function(e,t){for(var i=0,r=e.length;r>i;){var o=Math.floor((i+r)/2);t>e[o]?i=o+1:r=o}return r},t.PI2=s,t.limitRange=function(e,t,i,o){if(n.ConsoleUtils.assert(2===t.length),n.ConsoleUtils.assert(t[0]<=t[1]),i)return t[1]-t[0]<o+r.FLOAT64_TOLERANCE?[t[0],t[1]]:(console.warn("limitRange : in_limitRange length cannot be greater than in_period"),[t[0],t[0]+o]);var s=Math.max(e[0],t[0]),a=Math.min(e[1],t[1]);return s>a&&(s>a+r.FLOAT64_TOLERANCE&&console.warn("limitRange : requested range must overlap in_oldRange"),s=a=t[0]>e[1]?e[1]:e[0]),[s,a]},t.getPlaneTransforms=function(e){var t,i,o=e.evaluateDu(0,0),n=e.evaluateDv(0,0),s=e.getOrigin();if(!r.Vector3.isParallel(o,[1,0,0],1)||!r.Vector3.isParallel(n,[0,1,0],1)||Math.abs(s[2])>r.FLOAT64_TOLERANCE){var a=e.evaluateNormal(0,0);t=r.Matrix44.createFloat64FromValues(o[0],o[1],o[2],0,n[0],n[1],n[2],0,a[0],a[1],a[2],0,s[0],s[1],s[2],1),i=r.Matrix44.createFloat64(),r.Matrix44.invert(i,t)}return{uvToThreeSpace:t,threeSpaceToUV:i}},t.definePlaneThroughPoints=function(e){var t,i,n,s=[0,0,0],a=[0,0,0];if(!(e.length<3)){var l=[0,0,0];for(t=0;t<e.length;++t)r.Vector3.add(l,l,e[t]);r.Vector3.scale(l,l,1/e.length);var u=[0,0,0];i=0;var h=0,d=0;for(t=0;t<e.length;++t){(n=r.Vector3.squaredDistance(l,e[t]))>d&&(d=n,h=t),(n/=100)>i&&(i=n,r.Vector3.sub(u,e[t],l));var p=(t+1)%e.length;(n=r.Vector3.squaredDistance(e[t],e[p]))>i&&(i=n,r.Vector3.sub(u,e[p],e[t]))}if(!(d<o.KERNEL_TOLERANCE*o.KERNEL_TOLERANCE)){r.Vector3.normalize(u,u);var g=[0,0,0];for(i=0,t=0;t<e.length;++t)r.Vector3.sub(s,e[t],l),r.Vector3.cross(s,s,u),(n=r.Vector3.squaredLength(s))>i&&(i=n,r.Vector3.copy(g,s));if(!(i<o.KERNEL_TOLERANCE*o.KERNEL_TOLERANCE)){r.Vector3.normalize(g,g);var f=e[h],v=e[c(h-1,e.length)],m=e[c(h+1,e.length)];r.Vector3.sub(s,v,f),r.Vector3.sub(a,m,f),r.Vector3.dot(r.Vector3.cross(a,a,s),g)<0&&r.Vector3.negate(g,g);var y=[0,0,0];r.Vector3.cross(y,g,u),r.Vector3.normalize(y,y);var _=Number.POSITIVE_INFINITY,E=Number.NEGATIVE_INFINITY,A=Number.POSITIVE_INFINITY,x=Number.NEGATIVE_INFINITY;for(t=0;t<e.length;++t){r.Vector3.sub(s,e[t],l);var C=r.Vector3.dot(s,u),w=r.Vector3.dot(s,y);_=Math.min(_,C),E=Math.max(E,C),A=Math.min(A,w),x=Math.max(x,w)}return{origin:l,normal:g,uAxis:u,vAxis:y,uRange:[_,E],vRange:[A,x]}}}}}},5416:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SplineCurveHelper=void 0;var r=i(1972),o=i(2468),n=i(5896),s=i(6120),a=i(3888),l=i(48),c=i(5856),u=function(){};u.getApproxBezierParameterSpaceTolerance=function(e,t){var i=e.getDiagonal(),n=2*t/r.Vector3.length(i);return n<.01*o.PARAMETER_SPACE_TOLERANCE?.01*o.PARAMETER_SPACE_TOLERANCE:n},u.solve_cubic_uniqueRoots=function(e,t){var i=e[2]*e[2]-3*e[1],r=e[2]*(2*e[2]*e[2]-9*e[1])+27*e[0];if(0===r&&0===i)return t[0]=-e[2]/3,1;if(r*r/4<i*i*i){var o=-2*Math.sqrt(i),n=Math.acos(-r/(i*o));return t[0]=(o*Math.cos(n/3)-e[2])/3,t[1]=(o*Math.cos((n+2*Math.PI)/3)-e[2])/3,t[2]=(o*Math.cos((n-2*Math.PI)/3)-e[2])/3,3}var s=Math.pow(Math.abs(r)/2+Math.sqrt(r*r/4-i*i*i),1/3)/3;return r>0&&(s=-s),t[0]=s+i/(9*s)-e[2]/3,1};var h=function(e,t,i){return 6*((1-i)*(e[6+t]-2*e[3+t]+e[t])+i*(e[9+t]-2*e[6+t]+e[3+t]))},d=function(e,t){return 6*(e[9+t]-e[t]+3*(e[3+t]-e[6+t]))},p=function(e,t){var i=new Array(3);!function(e,t,i){i[0]=3*(e[3+t]-e[t]),i[1]=6*(e[t]+e[6+t]-2*e[3+t]),i[2]=3*(e[9+t]-e[t]+3*(e[3+t]-e[6+t]))}(e,t,i);var r,o=new Array(2),n=function(e,t){var i=e[1]*e[1]-4*e[2]*e[0];if(i<0)return 0;if(0===i)return t[0]=-.5*e[1]/e[2],1;var r=e[1]>0?-.5*(e[1]+Math.sqrt(i)):-.5*(e[1]-Math.sqrt(i));return t[0]=r/e[2],t[1]=e[0]/r,2}(i,o);2===n&&o[0]>o[1]&&(r=o[0],o[0]=o[1],o[1]=r);for(var s=[],a=0;a<n;a++)o[a]>0&&o[a]<1&&((r=Math.abs(h(e,t,o[a]))<1e-12)?(r=Math.abs(d(e,t))<1e-12)&&s.push(o[a]):s.push(o[a]));return s},g=function(e,t,i){return e+t[0]+t[1]*i+t[2]*i*i+t[3]*i*i*i};u.intersect_xAxis_NonRationalCubicBSpline_XYPlanar3D=function(e,t,i,r){var n=new Float64Array(4),s=new Float64Array(4);n[0]=t[0]-e[0],n[1]=3*(t[3]-t[0]),n[2]=3*(t[0]+t[6]-2*t[3]),n[3]=t[9]-t[0]+3*(t[3]-t[6]),s[0]=t[1]-e[1],s[1]=3*(t[4]-t[1]),s[2]=3*(t[1]+t[7]-2*t[4]),s[3]=t[10]-t[1]+3*(t[4]-t[7]);var a,l=s;if(Math.abs(l[3])>1e-4)l[0]/=l[3],l[1]/=l[3],l[2]/=l[3],l[3]=1,a=this.solve_cubic_uniqueRoots(l,i);else{var u=[].slice.call(l).reverse();0===u[0]&&(u=u.slice(1));var h=(0,c.getRealPolynomialRoots)(u);a=h.length;for(var d=0;d<a;d++)i[d]=h[d]}if(1===a)return(f=i[0])<0||f>1?0:(i[0]=g(e[0],n,f),1);d=0;for(var p=0;p<a;++p)(f=i[p])>=0&&f<=1&&(i[d]=g(e[0],n,f),++d);if(void 0!==r){var f,v;if(Math.abs(s[3])<1e-12)Math.abs(s[2])<1e-12?v=-1:(f=-s[1]/(2*s[2]),v=0);else{var m=2/3*s[2]/s[3];v=m*m/4-1/3*s[1]/s[3],f=-m/2}if(0===v)if(f<0||f>1){var y=g(e[0],s,0),_=g(e[0],s,1);Math.abs(y)>Math.abs(_)?r.push([g(e[0],n,0),y]):r.push([g(e[0],n,1),_])}else r.push([g(e[0],n,f),g(e[0],s,f)]);else if(v>0){for(p=0;p<2;p++)(f=-m/2+(0===p?-1:1)*Math.sqrt(v))<-o.PARAMETER_SPACE_TOLERANCE||f>1+o.PARAMETER_SPACE_TOLERANCE||(f=Math.max(Math.min(1,f),0),r.push([g(e[0],n,f),g(e[0],s,f)]));if(r.length>1&&r[0][0]>r[1][0]){var E=r[0];r[0]=r[1],r[1]=E}}}return d},u.isPointInsideSplineRegionXYPlanar3D=function(e,t,i){var o,s,a=new Float64Array(3),l=t.getBezierSegments();if(t.isRational()||!l||3!==t.getDegree()){for(var c=t.tessellate().positions,u=new Float64Array(2*c.length),h=0;h<c.length;++h)u[2*h]=c[h].x,u[2*h+1]=c[h].y;return(0,n.isPointInsidePolygon2D)(e,u)}var d,p=0,g=r.Vector3.createFloat64();for(h=0;h<l.length;++h){s=l[h].getControlPoints(),o=this.intersect_xAxis_NonRationalCubicBSpline_XYPlanar3D(e,s,a);for(var f=0;f<o;++f)r.Vector3.set(g,a[f],e[1],0),(d=t.closestToPointParam(g))>=i[0]&&d<=i[1]&&a[f]>e[0]&&++p}var v=t.evaluatePosition(i[0]),m=t.evaluatePosition(i[1]),y=r.Vector3.createFloat64();r.Vector3.normalize(y,r.Vector3.sub(y,m,v)),y[1]<0&&r.Vector3.negate(y,y);var _=r.Vector2.createFloat64FromValues(e[0],e[1]);return(0,n.signedDistanceTo2DLine)(v,y,_)<=0&&e[1]>=Math.min(v[1],m[1])&&e[1]<=Math.max(v[1],m[1])&&++p,1&p},u.insertKnot=function(e,t,i,r,o){var n,s,l,c=[],u=[],h=[],d=i.length/4,p=d+e+1,g=(0,a.findKnotSpanAndMultiplicity)(r,t),f=o-g.multiplicity;if(f<1)return{U:c=t.slice(),Pw:u=i.slice()};for(n=0;n<=g.span;++n)c[n]=t[n];for(n=1;n<=f;++n)c[g.span+n]=r;for(n=g.span+1;n<p;++n)c[n+f]=t[n];for(n=0;n<=g.span-e;++n)for(s=0;s<4;++s)u[4*n+s]=i[4*n+s];for(n=g.span-g.multiplicity;n<d;++n)for(s=0;s<4;++s)u[4*(n+f)+s]=i[4*n+s];for(n=0;n<=e-g.multiplicity;++n)for(s=0;s<4;++s)h[4*n+s]=i[4*(g.span-e+n)+s];for(var v=1;v<=f;++v){for(l=g.span-e+v,n=0;n<=e-v-g.multiplicity;++n){var m=(r-t[l+n])/(t[n+g.span+1]-t[l+n]);for(s=0;s<4;++s)h[4*n+s]=h[4*(n+1)+s]*m+h[4*n+s]*(1-m)}for(s=0;s<4;++s)u[4*l+s]=h[s],u[4*(g.span+f-v-g.multiplicity)+s]=h[4*(e-v-g.multiplicity)+s]}for(n=l+1;n<g.span-g.multiplicity;++n)for(s=0;s<4;++s)u[4*n+s]=h[4*(n-l)+s];return{U:c,Pw:u}},u.refineKnotVector=function(e,t,i,r){var n,s,l=[],c=[],u=i.length/4-1,h=r.length-1,d=u+e+1,p=(0,a.findKnotSpan)(r[0],t),g=(0,a.findKnotSpan)(r[h],t)+1;for(n=0;n<=p-e;++n)for(s=0;s<4;++s)c[4*n+s]=i[4*n+s];for(n=g-1;n<=u;++n)for(s=0;s<4;++s)c[4*(n+h+1)+s]=i[4*n+s];for(n=0;n<=p;++n)l[n]=t[n];for(n=g+e;n<=d;++n)l[n+h+1]=t[n];var f=g+e-1,v=g+e+h;for(n=h;n>=0;--n){for(;r[n]<=t[f]&&f>p;){for(s=0;s<4;++s)c[4*(v-e-1)+s]=i[4*(f-e-1)+s];l[v]=t[f],--v,--f}for(s=0;s<4;++s)c[4*(v-e-1)+1]=c[4*(v-e)+s];for(var m=1;m<=e;++m){var y=v-e+m,_=l[v+m]-r[n];if(Math.abs(_)<o.KERNEL_TOLERANCE)for(s=0;s<4;++s)c[4*(y-1)+s]=c[4*y+s];else for(_/=l[v+m]-t[f-e+m],s=0;s<4;++s)c[4*(y-1)+s]=c[4*(y-1)+s]*_+c[4*y+s]*(1-_)}l[v]=r[n],--v}return{U:l,Pw:c}};var f=function(e,t,i,o){var s=(0,n.projectPointToLineSegment)(t,i,e);return o&&(s=(0,n.clamp)(s,0,1)),r.Vector3.lerp(r.Vector3.createFloat64(),t,i,s)};u.validControlPolygon=function(e){for(var t=e.length/3,i=e.length,o=r.Vector3.createFloat64(),n=r.Vector3.createFloat64(),s=r.Vector3.createFloat64(),a=3,l=1;l<t-1;++l){r.Vector3.set(o,e[a],e[a+1],e[a+2]),r.Vector3.set(n,e[a-3],e[a-2],e[a-1]),r.Vector3.set(s,e[a+3],e[a+4],e[a+5]);var c=f(o,n,s,!1);if(r.Vector3.sub(o,o,c),l<t/2?r.Vector3.sub(n,[e[i-3],e[i-2],e[i-1]],c):r.Vector3.sub(n,[e[0],e[1],e[2]],c),r.Vector3.dot(o,n)>0)return!1;a+=3}return!0};var v,m,y,_,E,A,x,C,w,b,M,T,V=function(e){if(e)for(var t=0;t<e.length;++t)if(Math.abs(e[t]-1)>r.FLOAT64_TOLERANCE)return!0;return!1},S=(v=new Float64Array(4),m=new Float64Array(4),y=new Float64Array(4),_=new Float64Array(16),function(e,t,i,r,o){var n,s,a,l,c,u,h=1-i;if(v[0]=h*h*h,v[1]=3*i*h*h,v[2]=3*i*i*h,v[3]=i*i*i,m[0]=-3*h*h,m[1]=3*(i-1)*(3*i-1),m[2]=3*i*(2-3*i),m[3]=3*i*i,y[0]=6*h,y[1]=6*(3*i-2),y[2]=6*(1-3*i),y[3]=6*i,void 0===o?V(t):o){for(var d=0;d<4;++d)_[4*d+r]=e[3*d+r]*t[d],_[4*d+3]=t[d];for(n=_[r]*v[0],s=_[r]*m[0],a=_[r]*y[0],d=1;d<4;++d)n+=_[4*d+r]*v[d],s+=_[4*d+r]*m[d],a+=_[4*d+r]*y[d];for(l=_[3]*v[0],c=_[3]*m[0],u=_[3]*y[0],d=1;d<4;++d)l+=_[4*d+3]*v[d],c+=_[4*d+3]*m[d],u+=_[4*d+3]*y[d];n/=l,s/=c,a/=u}else for(n=e[r]*v[0],s=e[r]*m[0],a=e[r]*y[0],d=1;d<4;++d)n+=e[3*d+r]*v[d],s+=e[3*d+r]*m[d],a+=e[3*d+r]*y[d];return[n,s,a]}),L=function(e,t,i,r){var o=r;o[0]=i[0]-t[0],o[1]=i[1]-t[1];var n=o[0]*o[0]+o[1]*o[1],s=(e[0]-t[0])*o[0]+(e[1]-t[1])*o[1];if(0===n||s<=0)r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[1]=r[0]*r[0]+r[1]*r[1],r[0]=0;else if(s>n)r[0]=e[0]-i[0],r[1]=e[1]-i[1],r[1]=r[0]*r[0]+r[1]*r[1],r[0]=1;else{var a=s/n;r[0]=t[0]+a*o[0]-e[0],r[1]=t[1]+a*o[1]-e[1],r[1]=r[0]*r[0]+r[1]*r[1],r[0]=a}},R=function(e,t,i,r){var o=r;o[0]=i[0]-t[0],o[1]=i[1]-t[1],o[2]=i[2]-t[2];var n=o[0]*o[0]+o[1]*o[1]+o[2]*o[2],s=(e[0]-t[0])*o[0]+(e[1]-t[1])*o[1]+(e[2]-t[2])*o[2];if(0===n||s<=0)r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r[1]=r[0]*r[0]+r[1]*r[1]+r[1]*r[1],r[0]=0;else if(s>n)r[0]=e[0]-i[0],r[1]=e[1]-i[1],r[2]=e[2]-i[2],r[1]=r[0]*r[0]+r[1]*r[1]+r[1]*r[1],r[0]=1;else{var a=s/n;r[0]=t[0]+a*o[0]-e[0],r[1]=t[1]+a*o[1]-e[1],r[2]=t[2]+a*o[2]-e[2],r[1]=r[0]*r[0]+r[1]*r[1]+r[2]*r[2],r[0]=a}};u.closestStartPoint=(w=new Float64Array(3),b=new Float64Array(3),M=new Float64Array(3),T=new Float64Array(2),function(e,t,i,r){if(i)for(T[0]=0,T[1]=1/0,x=t.points.length,C=0;C<x-3;C+=3)w[0]=t.points[C],w[1]=t.points[C+1],b[0]=t.points[C+3],b[1]=t.points[C+4],L(e,w,b,M),M[1]<T[1]&&(E=C/3,A=(1-M[0])*t.offset[E]+M[0]*t.offset[E+1],(!r||A>=r[0]&&A<=r[1])&&(T[0]=A,T[1]=M[1]));else for(T[1]=1/0,x=t.points.length,C=0;C<x-3;C+=3)w[0]=t.points[C],w[1]=t.points[C+1],w[2]=t.points[C+2],b[0]=t.points[C+3],b[1]=t.points[C+4],b[2]=t.points[C+5],R(e,w,b,M),M[1]<T[1]&&(E=C/3,A=(1-M[0])*t.offset[E]+M[0]*t.offset[E+1],(!r||A>=r[0]&&A<=r[1])&&(T[0]=A,T[1]=M[1]));return T[0]}),u.extremalParams=function(e,t){if(3!==e.getDegree())return s.DebugUtils.warn("SplineCurveHelper.extremalParams called with non-degree 3 curve"),[];var i,n,a=e.getBezierSegments(),l=[];for(i=0;i<a.length;++i){var c=a[i].getControlPoints(),h=a[i].getWeights(),d=a[i].getKnotVector(),p=u.extremalParamsXYPlanarBezierCurve(c,h,t),g=[];for(n=0;n<p.length;n++)g.push(d[0]*(1-p[n])+d[d.length-1]*p[n]);l.push(g)}var f=[];for(i=0;i<a.length;++i)if(f=f.concat(l[i]),i<a.length-1||e.isPeriodicUnlimited()){var v=a[i],m=a[(i+1)%a.length],y=l[i],_=l[(i+1)%a.length],E=v.getRangeUnlimited()[1],A=m.getRangeUnlimited()[0],x=0===y.length||E-y[y.length-1]>o.PARAMETER_SPACE_TOLERANCE,C=0===_.length||_[0]-A>o.PARAMETER_SPACE_TOLERANCE;if(x&&C){var w=v.evaluateDt(E)[t],b=m.evaluateDt(A)[t];(Math.abs(w)<r.FLOAT64_TOLERANCE||Math.abs(b)<r.FLOAT64_TOLERANCE||Math.sign(w)!==Math.sign(b))&&f.push(E)}}return f},u.extremalParamsXYPlanarBezierCurve=function(e,t,i,r,o){var n=V(t);if(!n)return p(e,i);for(var s,a,l=1e-6,c=r||16,u=o||1e-12,h=[],d=void 0,g=0;g<8;g++){if(a=S(e,t,g/7,i,n),void 0!==d&&Math.sign(a[1])!==d){var f=(g-1+Math.abs(s)/(Math.abs(a[1])+Math.abs(s)))/7;h.push(f)}d=Math.sign(a[1]),s=a[1]}0===h.length&&(h[0]=0+u,h[1]=1-u),h.length>2&&console.error("More than two roots in the second derivative of a cubic polynomial. This should not happen.");var v,m,y,_=[],E=[];for(g=0;g<h.length;g++){var A=0;do{++A,y=0!==(a=S(e,t,h[g],i,n))[2]?h[g]-a[1]/a[2]:h[g],v=Math.abs(a[1]),m=Math.abs(h[g]-y),h[g]=y}while((v>u||m>l)&&A<c);_[g]=v,E[g]=a[2]}for(g=0;g<h.length;g++)if(h[g]<0||h[g]>1||_[g]>u)h.splice(g,1),g--;else if(Math.abs(E[g])<l){var x=(S(e,t,h[g]+5e-7,i,n)[2]-S(e,t,h[g]-5e-7,i,n)[2])/l;Math.abs(x)>l&&(h.splice(g,1),g--)}if(2===h.length){if(Math.abs(h[0]-h[1])<l){var C=_[0]/(_[0]+_[1]);return[h[0]*(1-C)+h[1]*C]}return h}return h},u.evaluateNURBSCurvePointWithFactors=function(e,t,i,r,o,n){var s,c,u,h=(0,a.findKnotSpan)(o,t),d=(0,l.evaluateBasisFunctions)(h,o,e,t),p=new Float64Array(3),g=0,f=3*(h-e);for(n.rangeMin=h-e,n.rangeMax=h,c=0;c<=e;++c){for(s=r[h-e+c]*d[c],n.factors[c]=s,u=0;u<3;++u)p[u]+=i[f+u]*s;g+=s,f+=3}for(c=0;c<3;++c)p[c]/=g;for(c=0;c<=e;++c)n.factors[c]/=g;return p};var P=function(e,t,i,o,n,s,a,c,h,d,p,g,v){var m=.5*(i+n),y=(0,l.evaluateBCurvePoint)(m,e,t,a,h?c:void 0);if(g>v)p.push({offset:m,point:y});else{var _=f(y,o,s,!1),E=r.Vector3.squaredDistance(s,o),A=r.Vector3.squaredDistance(_,y);u.validControlPolygon(a)&&A<d*E?p.push({offset:m,point:y}):(P(e,t,i,o,m,y,a,c,h,d,p,g+1,v),P(e,t,m,y,n,s,a,c,h,d,p,g+1,v))}};u.renderNURBSCurve=function(e,t,i,n,s,a,c,u){var h=a||o.DEFAULT_CURVE_RESOLUTION,d=c||[t[0],t[t.length-1]];u=void 0===u||u;var p,g=V(n);if(s){var f,v,m=[];f=(0,l.evaluateBCurvePoint)(d[0],e,t,i,g?n:void 0),v=(0,l.evaluateBCurvePoint)(d[1],e,t,i,g?n:void 0),m.push({offset:d[0],point:f}),P(e,t,d[0],f,d[1],v,i,n,g,o.SPLINE_DISTANCE_TOLERANCE,m,0,4),m.push({offset:d[1],point:v}),p=new Array(4*m.length);for(var y=u?0:1,_=u?0:1;_<m.length;_++)p[y]=m[_].point[0],p[y+1]=m[_].point[1],p[y+2]=m[_].point[2],p[y+3]=m[_].offset,y+=4}else{for(var E=0,A=3;A<i.length;A+=3)E+=r.Vector3.distance([i[A-3],i[A-2],i[A-1]],[i[A],i[A+1],i[A+2]]);for(h=10*Math.round(E),u?(A=0,p=new Float32Array(3*h)):(A=1,p=new Float32Array(3*(h-1)));A<h;++A){var x,C=d[0]+(d[1]-d[0])*A/(h-1);x=(0,l.evaluateBCurvePoint)(C,e,t,i,g?n:void 0);for(var w=3*A,b=0;b<3;++b)p[w+b]=x[b]}}return p},u.evaluateCurve=function(e,t,i,r,n,s){if(n){var a=(0,l.evaluateBCurvePoint)(t[0],e,t,i,r),c=(0,l.evaluateBCurvePoint)(t[t.length-1],e,t,i,r),u=[];u.push({offset:t[0],point:a}),P(e,t,t[0],a,t[t.length-1],c,i,r,!0,o.SPLINE_DISTANCE_TOLERANCE,u,0,3),u.push({offset:t[t.length-1],point:c});for(var h=[],d=[],p=0;p<u.length;++p)h.push(u[p].offset),d.push(u[p].point[0],u[p].point[1],u[p].point[2])}else{var g=s||.01,f=t[0],v=0;h=[],d=[];do{var m=(0,l.evaluateBCurvePoint)(f,e,t,i,r);for(h[v]=f,p=0;p<3;++p)d[3*v+p]=m[p];++v,f+=g}while(f<=t[t.length-1])}return{offset:h,points:d}};var D=function(e,t,i){var r=new Float64Array(2);r[0]=i[0]-t[0],r[1]=i[1]-t[1];var o=r[0]*r[0]+r[1]*r[1];if(0===o)return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[0]*r[0]+r[1]*r[1];var n=(e[0]-t[0])*r[0]+(e[1]-t[1])*r[1];return n<0?(r[0]=e[0]-t[0],r[1]=e[1]-t[1]):n>o?(r[0]=e[0]-i[0],r[1]=e[1]-i[1]):(n/=o,r[0]=t[0]+n*r[0]-e[0],r[1]=t[1]+n*r[1]-e[1]),r[0]*r[0]+r[1]*r[1]},O=function(e,t){var i,r=!1,o=t.length;i=0;for(var n=o-3;i<o;i+=3)t[i+1]>e[1]!=t[n+1]>e[1]&&e[0]<(t[n]-t[i])*(e[1]-t[i+1])/(t[n+1]-t[i+1])+t[i]&&(r=!r),n=i;return r},I=function(e,t){for(var i,r=new Float64Array(2),o=Number.NEGATIVE_INFINITY,n=0;n<t.length;n+=3)r[0]=t[n]-e[0],r[1]=t[n+1]-e[1],(i=r[0]*r[0]+r[1]*r[1])>o&&(o=i);return o},N=function(e,t,i){for(var r,o=t.length,n=new Float64Array(2),s=new Float64Array(2),a=Number.POSITIVE_INFINITY,l=0;l<o-3;l+=3)n[0]=t[l],n[1]=t[l+1],s[0]=t[l+3],s[1]=t[l+4],(r=D(e,n,s))<a&&(a=r);return void 0!==i&&i&&(n[0]=t[o-3],n[1]=t[o-2],s[0]=t[0],s[1]=t[1],(r=D(e,n,s))<a&&(a=r)),a};u.closestSegmentsXYPlanar=function(e,t,i,r){for(var o=Number.POSITIVE_INFINITY,n=[],s=0;s<t.length;++s){var a,l=t[s],c=l.getRangeUnlimited();if(r){a=!1;for(var u=0;u<r.length;++u)if(c[1]>=r[u][0]&&c[0]<=r[u][1]){a=!0;break}}else a=!0;if(a){var h,d,p=i?i[s]:0,g=l.getControlPoints();O(e,g)?h=0:(h=N(e,g,!0),h=Math.max(0,h-p)),h<=o&&(d=I(e,g)+p,n.push({index:s,minDistSqr:h,maxDistSqr:d}),d<o&&(o=d))}}var f=[];for(s=0;s<n.length;++s)n[s].minDistSqr<=o&&f.push(n[s]);return f.sort((function(e,t){var i=e.minDistSqr-t.minDistSqr;return 0===i?e.maxDistSqr-t.maxDistSqr:i})),f},u.findKnotMultiplicity=function(e,t){for(var i=0,r=0;r<t.length;++r){if(t[r]>e+1e-8)return i;Math.abs(t[r]-e)<1e-8&&i++}return i},u.unclampCurve=function(e,t,i,r){var o,n,s,a,l,c=i.length/4-1,u=r||1;for(o=0;o<e-1;++o)for(t[e-o-1]=t[e-o]-(t[c-o+1]-t[c-o])*u,s=e-1,n=o;n>=0;--n){for(a=(t[e]-t[s])/(t[e+n+1]-t[s]),l=0;l<4;++l)i[4*n+l]=(i[4*n+l]-a*i[4*(n+1)+l])/(1-a);s-=1}for(t[0]=t[1]-(t[c-e+2]-t[c-e+1])*u,o=0;o<e-1;++o)for(t[c+o+2]=t[c+o+1]+(t[e+o+1]-t[e+o])*u,n=o;n>=0;--n)for(a=(t[c+1]-t[c-n])/(t[c-n+o+2]-t[c-n]),l=0;l<4;++l)i[4*(c-n)+l]=(i[4*(c-n)+l]-(1-a)*i[4*(c-n-1)+l])/a;t[c+e+1]=t[c+e]+(t[2*e]-t[2*e-1])*u},u.extractCurveSegment=function(e,t,i,r,o){var n=this.insertKnot(e,r,o,t,e);n=this.insertKnot(e,n.U,n.Pw,i,e);var s,l=(0,a.findKnotSpan)(t,n.U);for(r.length=n.U.length-(l-e),r[0]=t,s=1;s<r.length;++s)r[s]=n.U[s+l-e];var c=r.length-e-1,u=4*(n.Pw.length/4-c);for(o.length=n.Pw.length-u,s=0;s<o.length;++s)o[s]=n.Pw[s+u];l=(0,a.findKnotSpan)(i,r),r.length=l+1,r.push(i),o.length=4*(r.length-e-1)};var k=function(e,t,i,r){for(var o=0,n=0;n<4;++n)o+=(e[t+n]-i[r+n])*(e[t+n]-i[r+n]);return Math.sqrt(o)};u.removeKnot=function(e,t,i,r,n){if(t<=r[0]||t>=r[r.length-1])return 0;var s,l,c,u,h,d=[],p=e+1,g=(0,a.findKnotSpanAndMultiplicity)(t,r);if(g.multiplicity<1)return 0;for(var f,v,m,y,_=(2*g.span-g.multiplicity-e)/2,E=o.KERNEL_TOLERANCE,A=g.span-g.multiplicity,x=g.span-e,C=!1,w=[0,0,0,0],b=0;b<i;++b){for(f=x-1,h=0;h<4;++h)d[0+h]=n[4*f+h],d[4*(A+1-f)+h]=n[4*(A+1)+h];for(s=x,l=A,c=1,u=A-f,C=!1;l-s>b;){for(v=(t-r[s])/(r[s+p+b]-r[s]),m=(t-r[l-b])/(r[l+p]-r[l-b]),h=0;h<4;++h)d[4*c+h]=(n[4*s+h]-(1-v)*d[4*(c-1)+h])/v,d[4*u+h]=(n[4*l+h]-m*d[4*(u+1)+h])/(1-m);++s,++c,--l,--u}if(l-s<b)k(d,4*(c-1),d,4*(u+1))<=E&&(C=!0);else{for(v=(t-r[s])/(r[s+p+b]-r[s]),h=0;h<4;++h)w[h]=v*d[4*(c+b+1)+h]+(1-v)*d[4*(c-1)+h];k(n,4*s,w,0)<=E&&(C=!0)}if(!C)break;for(s=x,l=A;l-s>b;){for(h=0;h<4;++h)n[4*s+h]=d[4*(s-f)+h],n[4*l+h]=d[4*(l-f)+h];++s,--l}--x,++A}if(0===b)return 0;for(y=g.span+1;y<r.length;++y)r[y-b]=r[y];for(r.length=r.length-b,s=l=_,y=1;y<b;++y)y%2==1?s+=1:l-=1;for(y=s+1;y<n.length/4;++y){for(h=0;h<4;++h)n[4*l+h]=n[4*y+h];l+=1}return n.length=n.length-4*b,b},u.joinCurves=function(e,t,i,r,o){var n,s=t[t.length-1];for(t.length=t.length-1,n=e+1;n<r.length;++n)t.push(r[n]);for(n=4;n<o.length;++n)i.push(o[n]);var a=this.removeKnot(e,s,e-1,t,i);a!==e-1&&console.warn("Failed knot removal, only removed seam knot "+a+" times.")},u.clampCurve=function(e,t,i){var r=t[e],o=t[t.length-e-1];this.extractCurveSegment(e,r,o,t,i)},u.makePeriodic=function(e,t,i){var r,o,n=function(e,t,i){var r,o,n,s=0;for(r=1;r<i.length/4;++r){for(n=0,o=0;o<3;++o)n+=(i[4*r+o]-i[4*(r-1)+o])*(i[4*r+o]-i[4*(r-1)+o]);s+=Math.sqrt(n)}for(n=0,o=0;o<3;++o)n+=(i[o]-i[i.length-4+o])*(i[o]-i[i.length-4+o]);var a=Math.sqrt(n),l=(t[t.length-1]-t[0])/s,c=i.length/4-1,u=t.slice();for(r=0;r<e-1;++r)u[e-r-1]=u[e-r]-(u[c-r+1]-u[c-r]),u[c+r+2]=u[c+r+1]+(u[e+r+1]-u[e+r]);var h=u[1]-(u[c-e+2]-u[c-e+1]),d=u[c+e]+(u[2*e]-u[2*e-1]);return l/((t[0]-h+d-t[t.length-1])/a)}(e,t,i);this.unclampCurve(e,t,i,n);var s=t.length;for(r=e-1;r>=0;--r)t[s-r]=t[s-r-1]+(t[e-(r-1)]-t[e-r]);var a=i.length/4;for(i.length=4*a+4*e,t.length=s+e,r=0;r<e;++r){for(o=0;o<4;++o)i[4*(a+r)+o]=i[4*r+o];t[s+r]=t[s+r-1]+(t[e+r+1]-t[e+r])}this.clampCurve(e,t,i)},t.SplineCurveHelper=u},2355:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TangentCone=void 0;var r=i(1972),o=i(2468),n=i(5896),s=function(e,t){this.set(e,t)};s.prototype.set=function(e,t){void 0===e||void 0===t?(this.axis=void 0,this.angle=void 0):(this.axis=r.Vector3.clone(e),this.angle=t)},s.prototype.toString=function(){return this.isDegenerate()?"degenerate":"(x:"+this.axis[0]+", y:"+this.axis[1]+", z:"+this.axis[2]+", radians:"+this.angle+")"},s.prototype.copy=function(e){return e.isDegenerate()?(this.axis=void 0,this.angle=void 0):(this.axis=r.Vector3.clone(e.axis),this.angle=e.angle),this},s.prototype.clone=function(){return new s(this.axis,this.angle)},s.prototype.isDegenerate=function(){return void 0===this.axis||void 0===this.angle},s.prototype.includeVector=function(e){if(r.Vector3.squaredLength(e)<o.KERNEL_TOLERANCE*o.KERNEL_TOLERANCE)return this;if(this.isDegenerate())return this.axis||(this.axis=r.Vector3.createFloat64()),r.Vector3.normalize(this.axis,e),this.angle=0,this;var t=r.Vector3.dot(this.axis,e)/r.Vector3.length(e);t=(0,n.clamp)(t,-1,1);var i=Math.acos(t);return this.angle=Math.max(this.angle,i),this},s.prototype.includeCone=function(e){if(e.isDegenerate())return this;if(this.isDegenerate())return this.copy(e);var t=r.Vector3.dot(this.axis,e.axis),i=Math.acos((0,n.clamp)(t,-1,1));if(this.angle>=e.angle+i)return this;if(e.angle>=this.angle+i)return this.copy(e);if(i>Math.PI-o.KERNEL_ANGULAR_TOLERANCE)return this.angle=Math.PI,this;var s=(this.angle+e.angle+i)/2;if(s>=Math.PI)return this.angle=Math.PI,this;var a=Math.sin(s-e.angle),l=Math.sin(s-this.angle);return r.Vector3.scale(this.axis,this.axis,a),r.Vector3.scaleAndAdd(this.axis,this.axis,e.axis,l),r.Vector3.normalize(this.axis,this.axis),this.angle=s,this},s.prototype.contains=function(e,t){if(t="number"==typeof t?t:o.KERNEL_ANGULAR_TOLERANCE,!this.isDegenerate())return r.Vector3.squaredLength(e)<o.KERNEL_TOLERANCE*o.KERNEL_TOLERANCE||r.Vector3.angle(this.axis,e)<this.angle+t},t.TangentCone=s},9608:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOrderedFacesOnVertex=function(e){const t=e.getEdges(),r=new i(e),o=[];return t.forEach((t=>{const i=t.getCoedges();for(let t=0;t<i.length;++t)if(i[t].getStartVertex()===e){const e=r.marchFan(i[t]);e.faces.length>0&&o.push(e);break}})),o};class i{constructor(e){this._vertex=e,this._visitedCoeds=new Set,this._unvisitedCoeds=new Set,this._faces=[],this._type="unset"}addVisitedCoedge(e){this._visitedCoeds.add(e),this._unvisitedCoeds.delete(e)}getNextFace(e){const t=e.getFace();t&&this._faces.push(t),this.addVisitedCoedge(e)}getPrevFace(e){const t=e.getFace();t&&this._faces.unshift(t),this.addVisitedCoedge(e)}collectUnvisitedCoeds(e){e.getEdge().getCoedges().forEach((e=>{this._visitedCoeds.has(e)||e.getStartVertex()!==this._vertex||this._unvisitedCoeds.add(e)}))}nextFace(e){const t=e.getPartner();if(!t)return void("unset"===this._type&&(this._type="chain"));if(this._visitedCoeds.has(t))return;if(t.getPartner()!==e&&(this._type="unordered",this.collectUnvisitedCoeds(e)),t.getEndVertex()!==this._vertex)return this._type="unordered",void this.collectUnvisitedCoeds(t);this.addVisitedCoedge(t);const i=t.getNext();if(!this._visitedCoeds.has(i))return this.getNextFace(i),i;"unset"===this._type&&(this._type="cycle")}prevFace(e){const t=e.getPrevious();if(this._visitedCoeds.has(t))return;const i=t.getPartner();return i&&!this._visitedCoeds.has(i)?(i.getPartner()!==t&&(this._type="unordered",this.collectUnvisitedCoeds(t)),i.getStartVertex()!==this._vertex?(this._type="unordered",void this.collectUnvisitedCoeds(i.getNext())):(this.addVisitedCoedge(t),this.getPrevFace(i),i)):void 0}collectFanFaces(e){if(this._visitedCoeds.has(e))return;const t=e;this.getNextFace(t);let i=t;for(;i;)i=this.nextFace(i);for(i=t;i;)i=this.prevFace(i)}marchFan(e){for(this._faces=[],this._type="unset",this.collectFanFaces(e);this._unvisitedCoeds.size>0;){const e=this._unvisitedCoeds.values();this.collectFanFaces(e.next().value)}return{faces:this._faces,type:this._type}}}},3584:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.facetPlanarFace=void 0;var r,o=i(1972),n=i(2468),s=i(2640),a=i(5896),l=i(9140),c=(r=i(2856))&&r.__esModule?r:{default:r},u=i(6120),h=1e-6,d=1e-8,p=n.KERNEL_TOLERANCE,g=function(e,t,i){var r,n=e[(0,a.modulus)(t-1,e.length)],s=e[(0,a.modulus)(t+1,e.length)],l=e[t],c=l[0]-n[0],u=l[1]-n[1],h=s[0]-l[0],d=s[1]-l[1],g=Math.sqrt(c*c+u*u),f=Math.sqrt(h*h+d*d);c*h+u*d<-.95*g*f?(c*=-1,u*=-1):i?(r=c,c=-u,u=r,r=h,h=-d,d=r):(r=c,c=u,u=-r,r=h,h=d,d=-r);var v=.5*(c/g+h/f),m=.5*(u/g+d/f),y=Math.sqrt(v*v+m*m);e[t]=o.Vector3.clone(l),e[t][0]+=p*v/y,e[t][1]+=p*m/y},f=function(e){return String(e[0])+String(e[1])},v=function(e){for(var t=!1,i={},r=0;r<e.length;r++){var o=f(e[r]);void 0===i[o]?i[o]=[]:t=!0,i[o].push(r)}return{table:i,foundSelfIntersection:t}},m=function(e){var t=v(e);if(t.foundSelfIntersection){for(var i=(0,s.isLoopCCW)(e),r=[],o=0;o<e.length-1;o++)r[o]=!1;var n=[];for(o=0;o<e.length-1;o++)if(!r[o]){var l=[],c=o;r[c]=!0,l.push(e[c]);var u=f(l[0]),h=e[(0,a.modulus)(c+1,e.length)],d=f(h),p=[];for(t.table[u].length>1&&p.push(0);d!==u;){if(l.push(h),l.length>e.length)throw new Error("splitHole failure");var m=t.table[d];if(1===m.length)c++;else{p.push(l.length-1);for(var y=[],_=0;_<m.length;_++)m[_]!==c&&y.push(m[_]);var E=Math.atan2(e[c+1][1]-e[c][1],e[c+1][0]-e[c][0]);E=(0,a.normalizeParameterToShiftedRange)(E-Math.PI,[-Math.PI,Math.PI]);var A=-1,x=0;for(_=0;_<y.length;_++){var C=Math.atan2(e[(0,a.modulus)(y[_]+1,e.length)][1]-e[y[_]][1],e[(0,a.modulus)(y[_]+1,e.length)][0]-e[y[_]][0]);C<E&&i?C+=a.PI2:C>E&&!i&&(C-=a.PI2);var w=Math.abs(C-E);w>x&&(x=w,A=y[_])}c=A}h=e[(0,a.modulus)(c+1,e.length)],d=f(h),r[c]=!0}for(_=0;_<p.length;_++)g(l,p[_],i);n.push(l)}return n}return[e]},y=function(e,t){for(var i=[],r=0;r<e.length;r++){i[r]={index:void 0,loop:void 0};for(var o=e[r],n=0;n<t.length;n++)for(var s=t[n],a=0;a<s.length;a++)if(s[a][0]===o[0]&&s[a][1]===o[1]){i[r].index=a,i[r].loop=s;break}}return i};function _(e,t){var i,r=!1,o=t.length,n=o-1;for(i=0;i<o;i+=2)t[i][1]>e[1]!=t[n][1]>e[1]&&e[0]<(t[n][0]-t[i][0])*(e[1]-t[i][1])/(t[n][1]-t[i][1])+t[i][0]&&(r=!r),n=i;return r}function E(e,t,i){for(var r,n,a=y(e,[t].concat(i)),l=[],c=[],h=void 0,p=void 0,g=0;g<4;++g)a[g]&&void 0!==a[g].index&&(h?p||a[g].loop===h||(p=a[g].loop):h=a[g].loop,a[g].loop===h?(r=h,n=l):(r=p,n=c),(w=[a[g].index-1,a[g].index])[0]<0&&(w[0]=r.length-1),n.push(w),n.push([a[g].index,(a[g].index+1)%r.length]));p||(p=h,c=l);var f,v,m=void 0,E=h,A=l;for(g=0;g<3;++g){for(f=0;f<l.length;++f){for(v=0;v<c.length&&(l===c&&v>=f||!(m=(0,s.intersectSegments)(h[l[f][0]],h[l[f][1]],p[c[v][0]],p[c[v][1]],0))||!m.intersection);++v);if(m&&m.intersection)break}if(m&&m.intersection||h===p)break;0===g?(h=p,l=c):1===g&&(h=E,l=A,p=E,c=A)}if(void 0!==m&&m.intersection){var x=o.Vector3.subtract(o.Vector3.createFloat64(),h[l[f][1]],h[l[f][0]]);o.Vector3.scale(x,x,m.solutions[0]);var C=o.Vector3.add(x,x,h[l[f][0]]);if(l[f][0]>l[f][1]){var w=l[f][1];l[f][1]=l[f][0],l[f][0]=w}if(0===l[f][0]&&1!==l[f][1]&&(l[f][0]=l[f][1],l[f][1]=0),c[v][0]>c[v][1]&&0!==c[v][1]&&(w=c[v][1],c[v][1]=c[v][0],c[v][0]=w),0===c[v][0]&&1!==c[v][1]&&(c[v][0]=c[v][1],c[v][1]=0),h===p){if(h.length<4)return void console.error("REGION: Failed to fix loop tessellation! [loop too short]");console.log("REGION: Fixing self-intersection");var b=new Array(4);l[f][0]<c[v][0]?(b[0]=l[f][0],b[1]=l[f][1],b[2]=c[v][0],b[3]=c[v][1]):(b[0]=c[v][0],b[1]=c[v][1],b[2]=l[f][0],b[3]=l[f][1]);var M=[];for(g=0;g<=b[0];++g)M.push(h[g]);var T=o.Vector3.subtract(o.Vector3.createFloat64(),h[b[0]],h[b[1]]);o.Vector3.normalize(T,T),o.Vector3.scale(T,T,d);var V=o.Vector3.add(o.Vector3.createFloat64(),C,T);for(M.push(V),g=b[2];g>=b[1];--g)M.push(h[g]);var S=o.Vector3.subtract(o.Vector3.createFloat64(),C,T);if(M.push(S),b[3]>b[2])for(g=b[3];g<h.length;++g)M.push(h[g]);for(h.length=M.length,g=0;g<M.length;++g)h[g]=M[g]}else{console.log("REGION: Fixing loop-loop intersection");var L=h,R=p,P=c[v][0],D=c[v][1],O=l[f][0],I=l[f][1];(t===R||R.length>L.length&&t!==L)&&(L=p,R=h,P=l[f][0],D=l[f][1],O=c[v][0],I=c[v][1]);var N=1;t!==R&&t!==L&&(N=-1);var k=1;_(R[D],L)&&(k=-1,w=P,P=D,D=w),o.Vector3.subtract(R[D],R[P],R[D]),o.Vector3.normalize(R[D],R[D]),o.Vector3.scale(R[D],R[D],N*d),o.Vector3.add(R[D],C,R[D]);var B,F,z=D;do{(D+=k)<0?D=R.length-1:D%=R.length}while(D!==P&&!_(R[D],L));(P=D-k)<0&&(P=R.length-1),I=O;do{B=L[I],F=L[I=++I%L.length],m=(0,s.intersectSegments)(B,F,R[P],R[D],0)}while(O!==I&&!m.intersection);m.intersection&&(o.Vector3.scale(x,o.Vector3.subtract(x,F,B),m.solutions[0]),o.Vector3.add(C,x,B),o.Vector3.subtract(R[P],R[D],R[P]),o.Vector3.normalize(R[P],R[P]),o.Vector3.scale(R[P],R[P],N*d),o.Vector3.add(R[P],C,R[P])),Math.min(Math.abs(z-P),Math.abs(z-P-R.length))>1&&console.warn("REGION: Remove loop segment! FIXME!")}}else u.DebugUtils.warn("REGION: Failed to fix loop tessellation! [no intersected segments]")}var A=function(e,t){var i=e;for(i<0?i+=t.length:i%=t.length;t[i]!==i;)i=t[i];return i},x=function(e,t,i,r){return o.Vector3.distance(i[e],i[t])<h?(r[0]=e,r[1]=e,1):0},C=function(e,t,i,r,n){var s=new Array(2);if(s[0]=r[e],s[1]=r[i],o.Vector3.length(o.Vector3.subtract(o.Vector3.createFloat64(),s[0],s[1]))<h)return n[0]=e,n[1]=e,n[2]=e,2;var a=(s[0][0]-s[1][0])*(r[t][1]-s[1][1])-(s[0][1]-s[1][1])*(r[t][0]-s[1][0]);return a>-10000000000000001e-32&&a<10000000000000001e-32?(n[0]=e,n[1]=e,n[2]=i,1):0},w=function(e,t,i,r,o,n){return(0,s.intersectSegments)(o[e],o[t],o[i],o[r]).intersection?(n[0]=e,n[1]=t,n[2]=t,n[3]=r,1):(n[0]=-1,0)},b=function(e){if(e.length<4)return e;for(var t,i,r,o,n=e.length,s=new Int32Array(n),a=0;a<n;++a)s[a]=a;var l,c=new Array(3),u=new Array(3);for(u[0]=0,u[1]=0,u[2]=0,a=0;a<n;++a)t=A(a,s),i=A(a+1,s),(l=x(t,i,e,c))&&(++u[0],s[t]=c[0],s[i]=c[1],t=A(a+=l,s),i=A(a+1,s)),r=A(a+2,s),(l=C(t,i,r,e,c))&&(++u[1],s[t]=c[0],s[i]=c[1],s[r]=c[2],t=A(a+=l,s),i=A(a+1,s),r=A(a+2,s)),o=A(a+3,s),(l=w(t,i,r,o,e,c))&&(++u[2],s[t]=c[0],s[i]=c[1],s[r]=c[2],s[o]=c[3],a+=l);var h=[];for(a=0;a<e.length;++a)s[a]===a&&h.push(e[a]);return h},M=function(e,t,i){for(var r=y(e,[t].concat(i)),o=0;o<r.length;o++)g(r[o].loop,r[o].index,(0,s.isLoopCCW)(r[o].loop))},T=function(e,t){var i=!1;!function(e){var t=v(e);if(t.foundSelfIntersection)for(var i=(0,s.isLoopCCW)(e),r=c.default.keys(t.table),o=0;o<r.length;o++)if(t.table[r[o]].length>1)for(var n=t.table[r[o]],a=0;a<n.length;a++)g(e,n[a],i)}(e);for(var r=[],o=0;o<t.length;o++)r.push.apply(r,m(t[o]));var n=b(e),a=[];for(o=0;o<r.length;o++)a.push(b(r[o]));var h=8;do{i=!0;var d=(0,c.default)(n).map((function(e){return new l.poly2tri.Point(e[0],e[1])})),p=new l.poly2tri.SweepContext(d);for(o=0;o<a.length;o++){var f=(0,c.default)(a[o]).map((function(e){return new l.poly2tri.Point(e[0],e[1])}));p.addHole(f)}try{p.triangulate()}catch(e){if("poly2tri Intersecting Constraints"===e.message.substr(0,33))i=!1,E(e.points,n,a);else if("poly2tri EdgeEvent: Collinear not supported"===e.message.substr(0,43))i=!1,M(e.points,n,a);else{if(!e.points)throw e;i=!1,E(e.points,n,a)}}}while(!i&&h-- >0);return h<=0&&u.DebugUtils.warn("Computation of region tessellation failed, due to too many intersections."),p};t.facetPlanarFace=function(e,t){var i=e.getSurface(),r=(0,a.getPlaneTransforms)(i),n=new s.LoopCalculator(e,r.threeSpaceToUV).getRank0Loops();if(1!==n.length)throw new Error("Each region should have exactly one top-loop");var l=n[0],c=(0,s.tessellateLoop)(l._loop,t);if(r.threeSpaceToUV)for(var u=0;u<c.length;u++)o.Vector3.transformMatrix44(c[u],c[u],r.threeSpaceToUV);for(var h=[],d=l.getImmediatelyInsideLoops(),p=0;p<d.length;p++){var g=(0,s.tessellateLoop)(d[p]._loop,t);if(h.push(g),r.threeSpaceToUV)for(u=0;u<g.length;u++)o.Vector3.transformMatrix44(g[u],g[u],r.threeSpaceToUV)}var f=T(c,h),v=f.getTriangles(),m=new Uint32Array(3*v.length),y=new Float32Array(3*f.pointCount()),_=o.Vector3.createFloat64();for(u=0;u<f.pointCount();u++){var E=f.getPoint(u);o.Vector3.set(_,E.x,E.y,0),r.uvToThreeSpace&&o.Vector3.transformMatrix44(_,_,r.uvToThreeSpace),y[3*u]=_[0],y[3*u+1]=_[1],y[3*u+2]=_[2],E.index=u}for(u=0;u<v.length;u++){var A=v[u].getPoints();for(e.isReversed()&&A.reverse(),p=0;p<A.length;p++){var x=A[p];m[3*u+p]=x.index}}return{indexBuffer:m,vertexBuffer:y}}},2640:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoopCalculator=t.intersectSegments=t.isLoopCCW=t.tessellateLoop=void 0;var r=i(1972),o=i(2468),n=i(5896),s=function(e,t){this._loop=e,this._enclosureRank=0,this._isOuterLoop=!1,this._insideLoops=[],this._isOpen=!1,this._coedges=this._loop.getCoedges();for(var i=0;i<this._coedges.length;++i)this._coedges[i].generateUVCurve(t)};s.prototype.addInsideLoop=function(e){this._insideLoops.push(e)},s.prototype.uvAngleSubtended=function(e){if(!this.isClosedLoop())throw new Error("uvAngleSubtended cannot work with open loops");for(var t=0,i=0;i<this._coedges.length;i++)t+=this._coedges[i].uvAngleSubtended(e);return t},s.prototype.getArbitraryPointOnLoop=function(){if(1===this._coedges.length){var e=this._coedges[0].t0();return this._coedges[0].evaluatePosition(e)}var t=this._coedges[0].getStartVertex();if(t)return t.getPosition()},s.prototype.isInside=function(e){var t=this.getArbitraryPointOnLoop(),i=Math.abs(e.uvAngleSubtended(t)),r=Math.floor(i/(2*Math.PI)),n=i-2*r*Math.PI;return!!(Math.abs(n)<o.KERNEL_TOLERANCE&&r||Math.abs(n-2*Math.PI)<o.KERNEL_TOLERANCE)},s.prototype.getEnclosureRank=function(){return this._enclosureRank},s.prototype.resetEnclosureRank=function(){this._enclosureRank=0},s.prototype.decreaseEnclosureRank=function(){this._enclosureRank--},s.prototype.setIsOuterLoop=function(e){this._isOuterLoop=e},s.prototype.isOuterLoop=function(){return this._isOuterLoop},s.prototype.isClosedLoop=function(){return!this._isOpen},s.prototype.addInsideLoop=function(e){this._insideLoops.push(e)},s.prototype.getImmediatelyInsideLoops=function(){for(var e=[],t=0;t<this._insideLoops.length;t++)this._insideLoops[t].getEnclosureRank()===this._enclosureRank-1&&e.push(this._insideLoops[t]);return e};var a=function(e,t){this._face=e,this._loops=[];for(var i=0;i<this._face.getLoops().length;++i)this._loops.push(new s(this._face.getLoops()[i],t));this._calcSenses()};a.prototype._calcSenses=function(){for(var e=this._loops.length,t=0;t<e;t++)this._loops[t].resetEnclosureRank();for(t=0;t<e;t++)if(this._loops[t].isClosedLoop())for(var i=0;i<e;i++)this._loops[i].isClosedLoop()&&t!==i&&this._loops[t].isInside(this._loops[i])&&!this._loops[i].isInside(this._loops[t])&&(this._loops[t].decreaseEnclosureRank(),this._loops[i].addInsideLoop(this._loops[t]));for(t=0;t<e;t++){var r=0-this._loops[t].getEnclosureRank();this._loops[t].setIsOuterLoop(r%2==0)}},a.prototype.getRank0Loops=function(){var e=[];return this._loops.forEach((function(t){0===t.getEnclosureRank()&&e.push(t)})),e},t.tessellateLoop=function(e,t){for(var i=[],o=0,n=e.getCoedges().length;o<n;++o){var s=e.getCoedges()[o],a=s.getEdge(),l=a.tessellate(void 0,t).positions;l=l.slice(1,l.length-1),(l=[r.Vector3.clone(a.getStartVertex().getPosition())].concat(l)).push(r.Vector3.clone(a.getEndVertex().getPosition())),s.isReversed()&&l.reverse(),i=i.concat(l.slice(0,l.length-1))}return i},t.isLoopCCW=function(e){for(var t=0,i=0;i<e.length;i++){var r=(i+1)%e.length;t+=e[i][0]*e[r][1]-e[i][1]*e[r][0]}return t>0},t.intersectSegments=function(e,t,i,o,s){var a=[[t[0]-e[0],-(o[0]-i[0]),i[0]-e[0]],[t[1]-e[1],-(o[1]-i[1]),i[1]-e[1]]],l=(0,n.solveTwoEquationsTwoVariables)(a);if(void 0===l)return!1;var c=r.Vector3.distance(e,t),u=r.Vector3.distance(i,o);return{intersection:-s<l[0]*c&&(l[0]-1)*c<s&&-s<l[1]*u&&(l[1]-1)*u<s,solutions:l}},t.LoopCalculator=a},8080:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBoundedRegionFaces=t.getRegionEdges=t.mergeSketchRegions=void 0;var r=i(2468),o=i(7616),n=i(8768),s=function(e,t){var i=e.getProgenitorMap(),o=new Set;return t.forEach((function(e){i.getDescendants(e).forEach((function(e){e.getTopologyType()===r.TOPOLOGY_TYPES.EDGE&&o.add(e)}))})),Array.from(o)},a=function(e,t){var i=(0,o.findConnectedFaces)(e,{allowVertexConnections:!1,barrierEdges:t}),r=[];return i.forEach((function(e){(function(e,t){e=new Set(e),t=new Set(t);var i=new Set;e.forEach((function(e){e.collectEdges(i)})),i=Array.from(i);for(var r=0;r<i.length;r++){var o=i[r];if(!t.has(o)){var n=o.getCoedges();if(n.length<2)return!1;for(var s=0;s<n.length;s++)if(!e.has(n[s].getFace()))return!1}}return!0})(e,t)&&(r=r.concat(e))})),r},l=function(e,t){for(var i=0;i<e.length;i++)if(t.indexOf(e[i])<0)return!1;return!0};t.mergeSketchRegions=function(e){var t,i,r=[];e.forEach((function(e){r=r.concat(e.getEdges())}));var c=new n.SketchRegionSolver;c.compute(r);var u=c.getFaces(),h=[],d=[];for(t=0;t<e.length;t++){var p=s(c,e[t].getEdges());if(0!==p.length){var g=a(u,p);0!==g.length&&(d.push(p),h.push(g))}}for(var f=[],v=new Set(u),m=!0;h.length>0;){var y=[];for(t=0;t<h.length;t++){var _=!1;for(i=0;i<h.length;i++)if(t!==i&&l(h[t],h[i])){_=!0;break}y.push(_)}var E=new Set;for(t=h.length-1;t>=0;t--)y[t]?h[t].forEach((function(e){E.add(e),v.delete(e)})):(h.splice(t,1),d.splice(t,1));m&&(f=f.concat(Array.from(v))),v=E,m=!m}return(0,o.mergeConnectedFaces)(f)},t.getRegionEdges=s,t.getBoundedRegionFaces=a},3227:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RegionTopologyFace=t.RegionTopologyEdge=t.RegionTopologyVertex=void 0;var r,o=i(1972),n=i(6940),s=i(7580),a=i(6776),l=i(2468),c=i(4728),u=(r=i(2856))&&r.__esModule?r:{default:r},h=function(e){n.Vertex.call(this,e),this._associatedVertices=[]};(h.prototype=Object.create(n.Vertex.prototype)).setAssociatedEntities=function(e){this._associatedVertices=u.default.clone(e)},h.prototype.getAssociatedEntities=function(){return this._associatedVertices};var d=function(e){s.Edge.call(this,e),this._sourceEdge=void 0,this._associatedEdges=[],this._isDangling=!1};(d.prototype=Object.create(s.Edge.prototype)).setAssociatedEdges=function(e){this._associatedEdges=e},d.prototype.getAssociatedEntities=function(){return u.default.map(this._associatedEdges,(function(e){return e.edge}))},d.prototype.getAssociatedEdgeInfo=function(){return this._associatedEdges},d.prototype.setToEdgeSegment=function(e,t){this._sourceEdge=e,this._curve=e.getCurve(),this._reversed=e.isReversed(),this.setRange(t)},d.prototype.setIsDangling=function(e){this._isDangling=e},d.prototype.isDangling=function(){return this._isDangling},d.prototype.getSourceEdge=function(){return this._sourceEdge};var p=function(e){a.Face.call(this,e),this._danglingEdges=[]};(p.prototype=Object.create(a.Face.prototype)).addDanglingEdge=function(e){this._danglingEdges.push(e)},p.prototype.isPointInsideFace=function(e){for(var t=0,i=0;i<this.getLoops().length;++i)for(var r=this.getLoops()[i],o=0;o<r.getCoedges().length;++o){var n=r.getCoedges()[o];n.getEdge().isDangling()||(t+=n.uvAngleSubtended(e))}t=Math.abs(t);var s=Math.floor(t/(2*Math.PI)),a=t-2*s*Math.PI;return!!(Math.abs(a)<l.PARAMETER_SPACE_TOLERANCE&&s||Math.abs(a-2*Math.PI)<l.PARAMETER_SPACE_TOLERANCE)},p.prototype.getRepresentativePoint=function(){var e,t,i=o.Vector3.createFloat64(),r=this.getBoundingBox(),n=(r.max[0]-r.min[0])/33,s=(r.max[1]-r.min[1])/33;for(e=1;e<32;++e)for(t=1;t<32;++t)if(i[0]=r.min[0]+n*e,i[1]=r.min[1]+s*t,this.isPointInsideFace(i))return i;return c.ConsoleUtils.assert(!1),r.getCenter()},p.prototype.getDanglingEdges=function(){return this._danglingEdges},t.RegionTopologyVertex=h,t.RegionTopologyEdge=d,t.RegionTopologyFace=p},744:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.matchRegionEdgeRecipe=t.deserializeRegionEdgeRecipe=t.serializeRegionEdgeRecipe=t.createRecipeFromRegionEdge=t.matchRegionFaceRecipe=t.deserializeRegionFaceRecipe=t.serializeRegionFaceRecipe=t.createRecipeFromRegionFace=void 0;var r,o=i(1972),n=i(5896),s=i(2468),a=i(9952),l=i(4728),c=i(6120),u=(r=i(2856))&&r.__esModule?r:{default:r},h=function(e,t){var i=u.default.filter(t.regionVertices,(function(t){return u.default.contains(t.getAssociatedEntities(),e.getStartVertex())}));l.ConsoleUtils.assert(1===i.length),i=i[0];var r=[],o=[],n=new Set,s=i,a=void 0;if(s)do{r.push(s);var c=u.default.filter(s.getEdges(),(function(t){return t!==a&&u.default.contains(t.getAssociatedEntities(),e)&&!n.has(t)}));if(0===c.length){l.ConsoleUtils.assert(!e.isClosed()),l.ConsoleUtils.assert(u.default.contains(s.getAssociatedEntities(),e.getEndVertex()));break}var h=void 0;if(c.length>1){c.sort((function(e,t){return e.t0()-t.t0()}));for(var d=0;d<c.length;d++)if(c[d].getStartVertex()===s){h=c[d];break}l.ConsoleUtils.assert(h)}else h=c[0];s=h.getOtherVertex(s),l.ConsoleUtils.assert(s),a=h,n.add(a),o.push(a)}while(s!==i);return{edges:o,vertices:r}},d=function(e,t,i){var r=[],n=u.default.filter(t,(function(t){return t!==e}));if(0===n.length);else for(var a=i.vertices,l=0;l<a.length;l++){for(var c=a[l],h=!1,d=c.getEdges(),p=0;p<d.length;p++)if(u.default.intersection(n,d[p].getAssociatedEntities()).length>0){h=!0;break}h&&r.push({vertex:c,indexInTopology:l})}if(e.isClosed()&&2===r.length&&1===n.length){var g=!1;if(n[0].getCurveType()===s.GEOMETRY_TYPES.LINE){var f=n[0],v=f.closestToPointParam(r[0].vertex.getPosition());g=f.closestToPointParam(r[1].vertex.getPosition())<v}else if(e.getCurveType()===s.GEOMETRY_TYPES.CIRCLE&&n[0].getCurveType()===s.GEOMETRY_TYPES.CIRCLE){var m=e.getCurve().getCenter(),y=o.Vector3.sub([0,0,0],n[0].getCurve().getCenter(),m);if(o.Vector3.length(y)>0){o.Vector3.normalize(y,y);var _=o.Vector3.sub([0,0,0],r[0].vertex.getPosition(),m),E=o.Vector3.sub([0,0,0],r[1].vertex.getPosition(),m),A=_.x*y.y-_.y*y.x,x=E.x*y.y-E.y*y.x;A>0&&x<0&&(g=!0)}}if(g){var C=r[1];r[1]=r[0],r[0]=C}}return r},p=function(e,t,i,r,o){var n,s={};s[e.getGuid()]={dist:0,prev:null,prevEdge:null,vertex:e,guid:e.getGuid()};var l=new a.BinaryHeap((function(e){return e.dist}),(function(e){return e.guid}));for(l.push(s[e.getGuid()]);0!==l.size();){var c=l.pop();if(c===t)break;n=c.vertex.getEdges();for(var h=0;h<n.length;h++){var d=n[h].getOtherVertex(c.vertex);if(d&&!r[n[h].getGuid()]&&(!i[d.getGuid()]||d===t)){for(var p=n[h].getEndVertex()===d,g=!1,f=n[h].getAssociatedEntities(),v=0;v<o.length;v++)if(u.default.contains(f,o[v].edge)&&o[v].orientation===p){g=!0;break}var m=s[c.guid].dist;g||(m+=1),void 0===s[d.getGuid()]?(s[d.getGuid()]={dist:m,prev:c,prevEdge:n[h],vertex:d,guid:d.getGuid()},l.push(s[d.getGuid()])):s[d.getGuid()].dist>m&&(s[d.getGuid()].dist=m,s[d.getGuid()].prev=c,s[d.getGuid()].prevEdge=n[h],l.updated(s[d.getGuid()]))}}}var y=s[t.getGuid()];if(y){n=[];for(var _=[],E=y,A=t;E.prevEdge;){var x=E.prevEdge;n.push(x),E=E.prev,_.push(x.getEndVertex()===A),A=x.getOtherVertex(A)}return{dist:y.dist,edges:n.reverse(),orientations:_.reverse(),startVertex:e,endVertex:t}}return{dist:1/0,edges:[]}},g=function(e,t,i,r,o,s,a){for(var l=e[o],c={},h=0;h<l.length;h++)null!==l[h].endVertex&&(c[l[h].endVertex.getGuid()]?c[l[h].endVertex.getGuid()].incomingEdges.push({edge:l[h].edge,orientation:l[h].edgeOriented}):c[l[h].endVertex.getGuid()]={edgeIndex:h,edgeInfo:l[h],vertex:l[h].endVertex,incomingEdges:[{edge:l[h].edge,orientation:l[h].edgeOriented}]});if(u.default.values(c).length>0){var d=s.vertices,g=s.edges,f=u.default.keys(c),v={dist:1/0},m=r;do{m=(0,n.modulus)(m-1,e.length);for(var y=u.default.keys(a[m]),_=0;_<y.length;_++){var E=a[m][y[_]].vertex;if(E)for(var A=0;A<f.length;A++){var x=c[f[A]].vertex,C=a[m][y[_]].outgoingEdges.concat(c[f[A]].incomingEdges),w=p(E,x,d,g,C);w.dist<v.dist&&((v=w).startIndex=m)}}}while(m!==t&&v.dist===1/0);if(v.dist<1/0){var b=a[v.startIndex][v.startVertex.getGuid()],M=a[o][v.endVertex.getGuid()],T=b.cost+v.dist;(!M||T<M.cost||o===t&&v.endVertex.getGuid()===i.getGuid()&&null===M.previousGuid)&&(a[o][v.endVertex.getGuid()]={previousGuid:v.startVertex.getGuid(),edgeSegment:null,indexRange:[],cost:b.cost+v.dist,vertex:v.endVertex,previousIndex:v.startIndex,connectionEdges:v.edges,connectionOrientation:v.orientations,outgoingEdges:[]})}}},f=function(e,t,i,r,o){var s=[],a=e[t][i].endVertex;s[t]={},s[t][a.getGuid()]={previousGuid:null,edgeSegment:null,previousIndex:null,cost:0,vertex:a,outgoingEdges:[]};var l=t;do{var c=(0,n.modulus)(l+1,e.length),h=e[c];s[c]=s[c]||{};for(var d=u.default.keys(s[l]),p=0,f=0;f<d.length;f++)for(var v=d[f],m=0;m<h.length;m++)if(h[m].startVertices[v]){s[l][v].outgoingEdges.push({edge:h[m].edge,orientation:h[m].edgeOriented});var y=h[m].endVertex;if(null!==y){var _=s[l][v].cost;h[m].edge.isClosed()||h[m].endVertexTopologyIndex>h[m].startVertices[v].vertexIndex!==h[m].edgeOriented&&(_+=1),(!s[c][y.getGuid()]||s[c][y.getGuid()].cost>_||c===t&&y.getGuid()===a.getGuid()&&null===s[c][y.getGuid()].previousGuid)&&(s[c][y.getGuid()]={previousGuid:v,edgeSegment:h[m],indexRange:[h[m].startVertices[v].vertexIndex,h[m].endVertexTopologyIndex],cost:_,vertex:y,previousIndex:l,outgoingEdges:[]},p++)}else _=s[l][v].cost,(!s[c][v]||s[c][v].cost>_)&&(s[c][v]={previousGuid:v,edgeSegment:h[m],indexRange:[],cost:_,previousIndex:l,outgoingEdges:[]})}0===p&&g(e,t,a,l,c,r,s),l=c}while(l!==t);null!==s[t][a.getGuid()].previousGuid&&s[t][a.getGuid()].cost<o.cost&&(o.cost=s[t][a.getGuid()].cost,o.state=s,o.startGuid=a.getGuid())},v=function(e,t){for(var i=function(e,t){var i={},r={},o={},s=t;do{var a=(0,n.modulus)(s+1,e.length),l=e[s],c=e[a],u=o;o={};for(var h=0;h<c.length;h++){var d=c[h].topologyAlongEdge.vertices,p=c[h].topologyAlongEdge.edges;c[h].startVertices={};var g=void 0,f=void 0,v=l.length;void 0!==u[c[h].edge.getGuid()]&&v++;for(var m=0;m<v;m++){var y=void 0;if(m===l.length)y=u[c[h].edge.getGuid()];else{if(!l[m].endVertex)continue;y=l[m].endVertex.getGuid()}for(var _=void 0,E=0;E<d.length;E++)if(d[E].getGuid()===y){_=E;break}void 0!==_&&(c[h].startVertices[y]={vertex:d[_],vertexIndex:_},null!==c[h].endVertex&&(c[h].edgeOriented?(g=void 0!==g?Math.min(g,_):_,f=void 0!==f?Math.max(f,c[h].endVertexTopologyIndex):c[h].endVertexTopologyIndex):(g=void 0!==g?Math.max(g,_):_,f=void 0!==f?Math.min(f,c[h].endVertexTopologyIndex):c[h].endVertexTopologyIndex)),void 0===o[c[h].edge.getGuid()]&&(o[c[h].edge.getGuid()]=y))}if(void 0!==g&&void 0!==f){if(g!==f){var A;A=c[h].edge.isClosed()?c[h].edgeOriented?1:-1:g<f?1:-1;var x=g;do{if(i[d[x].getGuid()]=d[x],A>0)x!==f&&(r[p[x].getGuid()]=p[x]);else{var C=(0,n.modulus)(x-1,p.length);r[p[C].getGuid()]=p[C]}x=(0,n.modulus)(x+A,d.length)}while(x!==f)}i[d[f].getGuid()]=d[f]}}s=a}while(s!==t);return{vertices:i,edges:r}}(e,t),r={cost:1/0,state:void 0,startGuid:void 0},o=0;o<e[t].length;o++)null!==e[t][o].endVertex&&f(e,t,o,i,r);if(r.cost===1/0)return{edges:void 0,edgeOrientedFlags:void 0,score:1/0};var s=function(e,t){var i=[],r=e.startGuid,o=t;do{i.push(e.state[o][r]);var s=e.state[o][r].previousIndex;r=e.state[o][r].previousGuid,o=s}while(o!==t);i=i.reverse();var a=[],l=[];for(o=0;o<i.length;o++)if(0!==i[o].indexRange.length){var c,u,h,d,p=i[o].edgeSegment.topologyAlongEdge;i[o].indexRange[0]<i[o].indexRange[1]?(c=i[o].indexRange[0],u=i[o].indexRange[1],i[o].edgeSegment.edge.isClosed()&&!i[o].edgeSegment.edgeOriented?(h=-1,c=(0,n.modulus)(i[o].indexRange[0]-1,p.edges.length),u=(0,n.modulus)(i[o].indexRange[1]-1,p.edges.length),d=!1):(h=1,c=(0,n.modulus)(i[o].indexRange[0],p.edges.length),u=(0,n.modulus)(i[o].indexRange[1],p.edges.length),d=!0)):i[o].edgeSegment.edge.isClosed()&&i[o].edgeSegment.edgeOriented?(h=1,c=(0,n.modulus)(i[o].indexRange[0],p.edges.length),u=(0,n.modulus)(i[o].indexRange[1],p.edges.length),d=!0):(h=-1,c=(0,n.modulus)(i[o].indexRange[0]-1,p.edges.length),u=(0,n.modulus)(i[o].indexRange[1]-1,p.edges.length),d=!1);var g=c;do{a.push(p.edges[g]),l.push(d),g=(0,n.modulus)(g+h,p.edges.length)}while(g!==u)}else if(i[o].connectionEdges)for(g=0;g<i[o].connectionEdges.length;g++)a.push(i[o].connectionEdges[g]),l.push(i[o].connectionOrientation[g]);return{topologyEdges:a,edgeOrientedFlags:l}}(r,t);return{edges:s.topologyEdges,edgeOrientedFlags:s.edgeOrientedFlags,score:r.cost}},m=function(e,t){var i,r=function(e,t){for(var i=[],r=0;r<e.length;r++){for(var o=e[r],n=[],s=0;s<o.length;s++){var a=o[s],l=t.sketchEdges[a.edgeRef];l&&n.push({edgeRef:a.edgeRef,edgeOriented:a.edgeOriented,intersectionNumber:a.intersectionNumber,totalIntersections:a.totalIntersections,edge:l,topologyAlongEdge:h(l,t),endVertex:null,endVertexTopologyIndex:null})}i.push(n)}return i}(e,t);if(c.DebugUtils.level("region_match")>=2){var o=u.default.pluck(u.default.flatten(r),"edge");for(i=0;i<o.length;i++)c.DebugUtils.drawEdge3D(o[i],{color:0,render:!1});c.DebugUtils.render()}if(function(e){for(var t=0;t<e.length;t++)for(var i=u.default.pluck(e[(t+1)%e.length],"edge"),r=0;r<e[t].length;r++){var o=e[t][r],n=d(o.edge,i,o.topologyAlongEdge);if(0===o.totalIntersections)o.endVertex=null;else if(n.length===o.totalIntersections){var s=n[o.intersectionNumber];o.endVertexTopologyIndex=s.indexInTopology,o.endVertex=s.vertex}else 0===n.length||c.DebugUtils.warn("Region matching problem! Intersection counts do not match"),o.endVertex=null}}(r),c.DebugUtils.level("region_match")>=2){var n=u.default.pluck(u.default.flatten(r),"endVertex");for(i=0;i<n.length;i++)null!==n[i]&&c.DebugUtils.drawVertex3D(n[i],{color:65280,render:!1});c.DebugUtils.render()}var s=function(e){for(var t=1/0,i=void 0,r=0;r<e.length;r++){var o=e[r];if(0!==o.length){for(var n=0,s=0;s<o.length;s++)null!==o[s].endVertex&&n++;var a=o.length-n;if(0===a)return r;n>0&&a<t&&(t=a,i=r)}}return i}(r);if(void 0===s){for(var a=0;a<r[0].length;a++){var l=r[0][a].edge;if(l.isClosed()&&u.default.all(r,(function(e){for(var t=0;t<e.length;t++)if(e[t].edge===l)return!0;return!1}))){var p=r[0][a].topologyAlongEdge.edges,g=new Array(p.length);for(i=0;i<g.length;i++)g[i]=r[0][a].edgeOriented;return r[0][a].edgeOriented||p.reverse(),c.DebugUtils.level("region_match")>=2&&c.DebugUtils.drawEdge3D(l,{color:16711680}),{edges:p,edgeOrientedFlags:g,matchStatus:2}}}return{edges:void 0,edgeOrientedFlags:void 0,matchStatus:0}}var f,m=v(r,s);if(c.DebugUtils.level("region_match")>=2&&void 0!==m.edges){for(i=0;i<m.edges.length;i++)c.DebugUtils.drawEdge3D(m.edges[i],{color:16711680,render:!1});c.DebugUtils.render()}return f=0===m.score?2:m.score===1/0?0:1,{edges:m.edges,edgeOrientedFlags:m.edgeOrientedFlags,matchStatus:f}},y=function(e,t){if(!e||!e.edges)return new Set;for(var i=new Set,r=0;r<e.edges.length;r++){var o=e.edgeOrientedFlags[r]===t,n=e.edges[r].getCoedges();l.ConsoleUtils.assert(n.length>=1&&n.length<=2);for(var s=void 0,a=0;a<n.length;a++)if(n[a].isReversed()===o){s=n[a].getFace();break}s&&!i.has(s)&&i.add(s)}var c=new Set(e.edges);return i.forEach((function(e){for(var t=Array.from(e.collectEdges()),r=0;r<t.length;r++){var o=t[r];if(!c.has(o)){var n=void 0,s=o.getFaces();l.ConsoleUtils.assert(s.length>=1&&s.length<=2),1===s.length?l.ConsoleUtils.assert(s[0]===e):2===s.length&&(l.ConsoleUtils.assert(s[0]===e||s[1]===e),n=s[0]===e?s[1]:s[0]),n&&!i.has(n)&&i.add(n)}}})),i};t.createRecipeFromRegionFace=function(e,t){for(var i=[],r=e.getLoops(),o=0;o<r.length;o++){for(var n=r[o].getCoedges(),s=[],a=0;a<n.length;a++){for(var l=n[a],c=l.getEdge().getAssociatedEdgeInfo(),p=l.getEndVertex(),g=n[(a+1)%n.length].getEdge().getAssociatedEdgeInfo(),f=u.default.pluck(g,"edge"),v=[],m=0;m<c.length;m++){for(var y=h(c[m].edge,t),_=d(c[m].edge,f,y),E=0,A=0;A<_.length;A++)if(_[A].vertex===p){E=A;break}var x={edgeRef:c[m].edge.getGuid(),edgeOriented:!(l.isReversed()^c[m].flipped),intersectionNumber:E,totalIntersections:_.length,edge:c[m].edge};v.push(x)}s.push(v)}i.push(s)}return i},t.serializeRegionFaceRecipe=function(e){for(var t=[],i=0;i<e.length;i++){for(var r=[],o=e[i],n=0;n<o.length;n++){for(var s=[],a=o[n],l=0;l<a.length;l++){var c=a[l];s.push(c.edgeRef+"_"+(c.edgeOriented?"t":"f")+"_"+c.intersectionNumber+"_"+c.totalIntersections)}r.push(s.join(";"))}t.push(r.join("+"))}return t.join("/")},t.deserializeRegionFaceRecipe=function(e){for(var t=e.split("/"),i=0;i<t.length;i++){t[i]=t[i].split("+");for(var r=t[i],o=0;o<r.length;o++){r[o]=r[o].split(";");for(var n=r[o],s=0;s<n.length;s++){var a=n[s].split("_");n[s]={edgeRef:a[0],edgeOriented:"t"===a[1],intersectionNumber:parseInt(a[2],10),totalIntersections:parseInt(a[3],10)}}}}return t},t.matchRegionFaceRecipe=function(e,t){var i,r,o,n=2,s=[];for(i=0;i<e.length;i++){var a=m(e[i],t);if(0===a.matchStatus&&0===i)return{regions:[],matchStatus:0};2!==a.matchStatus&&(n=1),s.push(a)}if(c.DebugUtils.level("region_match")>0){for(c.DebugUtils.clearView(),o=u.default.values(t.sketchEdges),i=0;i<o.length;i++)c.DebugUtils.drawEdge3D(o[i],{color:0,render:!1});for(i=0;i<s.length;i++)for(r=0;r<s[i].edges.length;r++){var l=0===i?65280:16711680;c.DebugUtils.drawEdge3D(s[i].edges[r],{color:l,render:!1})}c.DebugUtils.render()}var h=y(s[0],!1);for(r=1;r<s.length;r++)y(s[r],!0).forEach((function(e){h.delete(e)}));if(h=Array.from(h),c.DebugUtils.level("region_match")>0){for(i=0;i<h.length;i++)for(o=Array.from(h[i].collectEdges()),r=0;r<o.length;r++)c.DebugUtils.drawEdge3D(o[r],{color:13684736,render:!1});c.DebugUtils.render()}return{regions:h,matchStatus:n}},t.createRecipeFromRegionEdge=function(e,t){var i,r,o={startEdgeRefs:[],endEdgeRefs:[],edgeRef:[],edgeOriented:[],intersectionNumberStart:[],totalIntersectionsStart:[],intersectionNumberEnd:[],totalIntersectionsEnd:[]},n=e.getStartVertex(),s=[];n.getOtherEdges(e).forEach((function(e){var t=u.default.pluck(e.getAssociatedEdgeInfo(),"edge");for(i=0;i<t.length;i++)s.indexOf(t[i])<0&&(s.push(t[i]),o.startEdgeRefs.push(t[i].getGuid()))}));var a=e.getEndVertex(),l=[];a.getOtherEdges(e).forEach((function(e){var t=u.default.pluck(e.getAssociatedEdgeInfo(),"edge");for(i=0;i<t.length;i++)l.indexOf(t[i])<0&&(l.push(t[i]),o.endEdgeRefs.push(t[i].getGuid()))}));var c=e.getAssociatedEdgeInfo(),p=u.default.pluck(c,"edge");for(i=0;i<c.length;i++){var g=p[i],f=!c[i].flipped,v=h(g,t),m=u.default.unique(s.concat(p)),y=d(g,m,v),_=0;for(r=0;r<y.length;r++)if(y[r].vertex===n){_=r;break}var E=u.default.unique(l.concat(p)),A=d(g,E,v),x=0;for(r=0;r<A.length;r++)if(A[r].vertex===a){x=r;break}o.edgeRef.push(g.getGuid()),o.edgeOriented.push(f),o.intersectionNumberStart.push(_),o.totalIntersectionsStart.push(y.length),o.intersectionNumberEnd.push(x),o.totalIntersectionsEnd.push(A.length)}return o},t.serializeRegionEdgeRecipe=function(e){var t={edge:e.edgeRef,orient:e.edgeOriented,start:e.startEdgeRefs,end:e.endEdgeRefs,sIdx:e.intersectionNumberStart,sNum:e.totalIntersectionsStart,eIdx:e.intersectionNumberEnd,eNum:e.totalIntersectionsEnd};return JSON.stringify(t)},t.deserializeRegionEdgeRecipe=function(e){var t=JSON.parse(e);return{edgeRef:t.edge,edgeOriented:t.orient,startEdgeRefs:t.start,endEdgeRefs:t.end,intersectionNumberStart:t.sIdx,totalIntersectionsStart:t.sNum,intersectionNumberEnd:t.eIdx,totalIntersectionsEnd:t.eNum}},t.matchRegionEdgeRecipe=function(e,t){var i=[],r=0,o=[];e.startEdgeRefs.forEach((function(e){var i=t.sketchEdges[e];i&&o.push(i)}));var n=[];e.endEdgeRefs.forEach((function(e){var i=t.sketchEdges[e];i&&n.push(i)})),e.edgeRef.forEach((function(e){var i=t.sketchEdges[e];i&&o.indexOf(i)<0&&o.push(i),i&&n.indexOf(i)<0&&n.push(i)}));for(var s=0;s<e.edgeRef.length;s++){var a=t.sketchEdges[e.edgeRef[s]];if(a){var l=h(a,t),u=void 0,p=void 0,g=d(a,o,l);if(0===e.totalIntersectionsStart[s])u=l.vertices[0],p=0;else if(g.length===e.totalIntersectionsStart[s]){var f=g[e.intersectionNumberStart[s]];u=f.vertex,p=f.indexInTopology}var v=void 0,m=void 0,y=d(a,n,l);if(0===e.totalIntersectionsEnd[s])v=l.vertices[0],m=l.vertices.length;else if(y.length===e.totalIntersectionsEnd[s]){var _=y[e.intersectionNumberEnd[s]];v=_.vertex,0===(m=_.indexInTopology)&&a.isClosed()&&(m=l.vertices.length)}if(!e.edgeOriented[s]){var E=u;u=v,v=E,E=p,p=m,m=E}if(u&&v){if(!(p>=m)){i=l.edges.slice(p,m),r=2;break}c.DebugUtils.warn("Edge recipe match should find start vertex before end vertex")}}}return{edges:i,matchStatus:r}}},8768:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SketchRegionSolver=void 0;var r,o=i(1972),n=i(5896),s=i(2468),a=i(8292),l=i(1096),c=i(5512),u=i(8796),h=i(8972),d=i(3565),p=i(4524),g=i(672),f=i(8460),v=i(6344),m=i(6704),y=i(5416),_=i(2536),E=i(2208),A=i(3227),x=i(744),C=i(4728),w=i(6120),b=(r=i(2856))&&r.__esModule?r:{default:r};let M;var T=1e-5,V=function(){this.SIDE={LEFT:0,RIGHT:1},this._sketch=void 0,this._intersectionVertices=[],this._edgeSegments=[],this._cells=[],this._faces=[],this._workspace={edgeIntersections:[],edgeOverlapRegions:[],segmentBlackList:[],edges:[],edgeIDs:[],sweepLineIntersections:void 0,sweepLineRegions:void 0,currentVertex:void 0,nextVertex:void 0,edgesPerCell:void 0},this._sketchRegionTopologies={},this._planeGeometry=new a.Plane,this._planeGeometry.set([0,0,0],[0,0,1],[1,0,0]),this._sketchSummary={},this._internalToFinalMap=null,this._finalFaces=[],this._progenitorMap=null};V.prototype.compute=function(e){this._sketchEdges=e,this._initializeWorkspace(),this._findIntersections(),this._addGraphEdges(),this._mergeCoincidentSegments(),this._sortEdgesAroundVertex(),this._assignAdjacentEdges(),this._sweepRegions(),this._assignleftmostEdges(),this._removeGrazingIntersectionVertices(),this._updateVertexGuidLists(),this._removeTemporaryVertices(),this._assignLoops(),this._updateSketchRegionTopology(),this._clearWorkspace(),this._prepareResult()},V.prototype._initializeWorkspace=function(){var e=this._workspace;e.edges={};for(var t=0;t<this._sketchEdges.length;++t)e.edges[this._sketchEdges[t].getGuid()]=this._sketchEdges[t];for(e.edgeIDs=Object.getOwnPropertyNames(e.edges).sort(),e.edgeIntersections={},e.edgeOverlapRegions={},e.segmentBlackList={},t=0;t<e.edgeIDs.length;t++)e.edgeIntersections[e.edgeIDs[t]]=[],e.edgeOverlapRegions[e.edgeIDs[t]]=[],e.segmentBlackList[e.edgeIDs[t]]=[];e.sweepLineIntersections=void 0,e.sweepLineRegions=void 0,e.edgesPerCell=[],this._faces=[]},V.prototype._clearWorkspace=function(){this._workspace={edgeIntersections:[],edgeOverlapRegions:[],segmentBlackList:[],edges:[],edgeIDs:[],sweepLineIntersections:void 0,sweepLineRegions:void 0,currentVertex:void 0,nextVertex:void 0,sweepLinePosition:void 0,edgesPerCell:[]}},V.prototype._findIntersections=function(){for(var e=this._workspace,t=0;t<e.edgeIDs.length;t++){for(var i=e.edges[e.edgeIDs[t]],r=t;r<e.edgeIDs.length;r++){var a=e.edges[e.edgeIDs[r]];if(r>t||i.getCurveType()===s.GEOMETRY_TYPES.BCURVE)for(var l=(0,f.computeCurveCurveIntersections)(i,a,!0,!1,s.KERNEL_TOLERANCE),c=0;c<l.length;c++){var u=l[c];if(u.rangeInfo)e.edgeIntersections[e.edgeIDs[t]].push(b.default.extend(u.rangeInfo[0],{temporary:!1})),e.edgeIntersections[e.edgeIDs[t]].push(b.default.extend(u.rangeInfo[1],{temporary:!1})),e.edgeIntersections[e.edgeIDs[r]].push(b.default.extend(u.rangeByInfo[0],{temporary:!1})),e.edgeIntersections[e.edgeIDs[r]].push(b.default.extend(u.rangeByInfo[1],{temporary:!1})),e.edgeOverlapRegions[e.edgeIDs[t]].push({overlapRange:(0,n.convertToOtherPeriodicRange)([u.rangeInfo[0].param,u.rangeInfo[1].param],i.getRange(),i.getCurve().getPeriod(),s.KERNEL_TOLERANCE),otherEdge:e.edgeIDs[r],otherRange:(0,n.convertToOtherPeriodicRange)([u.rangeByInfo[0].param,u.rangeByInfo[1].param],a.getRange(),a.getCurve().getPeriod(),s.KERNEL_TOLERANCE)}),e.edgeOverlapRegions[e.edgeIDs[r]].push({overlapRange:(0,n.convertToOtherPeriodicRange)([u.rangeByInfo[0].param,u.rangeByInfo[1].param],a.getRange(),a.getCurve().getPeriod(),s.KERNEL_TOLERANCE),otherEdge:e.edgeIDs[t],otherRange:(0,n.convertToOtherPeriodicRange)([u.rangeInfo[0].param,u.rangeInfo[1].param],i.getRange(),i.getCurve().getPeriod(),s.KERNEL_TOLERANCE)});else{if(u.cutInfo.param<i.t0()||u.cutInfo.param>i.t1()){w.DebugUtils.warn("Intersection outside the bounds of the edge, ignoring");continue}e.edgeIntersections[e.edgeIDs[t]].push(b.default.defaults(u.cutInfo,{temporary:!1,virtualIntersection:!1})),e.edgeIntersections[e.edgeIDs[r]].push(b.default.defaults(u.cutByInfo,{temporary:!1,virtualIntersection:!1}))}}}var h=i.getStartVertex(),d=i.getEndVertex(),p=i.t0();h&&void 0!==b.default.findWhere(e.edgeIntersections[e.edgeIDs[t]],{param:p,atVertex:h})||e.edgeIntersections[e.edgeIDs[t]].push({param:p,atVertex:h,temporary:!1,virtualIntersection:void 0});var g=i.t1();d&&void 0!==b.default.findWhere(e.edgeIntersections[e.edgeIDs[t]],{param:g,atVertex:d})||e.edgeIntersections[e.edgeIDs[t]].push({param:g,atVertex:d,temporary:!1,virtualIntersection:void 0}),this._makeEdgeXMonotone(i,e.edgeIntersections[e.edgeIDs[t]])}var v=[];for(t=0;t<e.edgeIDs.length;t++)for(r=0;r<e.edgeIntersections[e.edgeIDs[t]].length;r++)v.push({position:e.edges[e.edgeIDs[t]].evaluatePosition(e.edgeIntersections[e.edgeIDs[t]][r].param),virtualIntersection:e.edgeIntersections[e.edgeIDs[t]][r].virtualIntersection});for(t=0;t<e.edgeIDs.length;t++){var m=e.edges[e.edgeIDs[t]];for(r=0;r<v.length;r++){var y=v[r];if(m.getBoundingBox().isPointInsideWithTolerance(y.position,s.KERNEL_TOLERANCE)){var _=m.closestToPointParam(y.position);o.Vector3.distance(y.position,m.evaluatePosition(_))<s.KERNEL_TOLERANCE&&_>m.t0()+s.PARAMETER_SPACE_TOLERANCE&&_<m.t1()-s.PARAMETER_SPACE_TOLERANCE&&e.edgeIntersections[e.edgeIDs[t]].push({param:_,atVertex:null,temporary:!0,virtualIntersection:y.virtualIntersection})}}}},V.prototype._addGraphEdges=function(){var e=this._workspace;this._intersectionVertices=[],this._edgeSegments=[];for(var t=function(t,i){var r=e.segmentBlackList[t],o=e.edges[t].getCurve(),a=o.getPeriod(),l=e.edges[t].isReversed()?-1:1,c=s.KERNEL_TOLERANCE/o.tangentLength(l*i[0]),u=s.KERNEL_TOLERANCE/o.tangentLength(l*i[1]);if(e.edges[t].getCurve().isPeriodic()){for(var h=0;h<r.length;h++)if((0,n.periodicDifference)(r[h].range[0],i[0],a)<c&&(0,n.periodicDifference)(r[h].range[1],i[1],a)<u)return r[h].edge}else for(h=0;h<r.length;h++)if(Math.abs(r[h].range[0]-i[0])<c&&Math.abs(r[h].range[1]-i[1])<u)return r[h].edge},i=0;i<e.edgeIDs.length;i++){var r=e.edges[e.edgeIDs[i]],a=1,l=this._createGUIDfromEdgeAndLocalID(r,a);e.edgeIntersections[e.edgeIDs[i]]=e.edgeIntersections[e.edgeIDs[i]].sort((function(e,t){return e.param-t.param}));for(var c=e.edgeIntersections[e.edgeIDs[i]],u=void 0,h=0;h<c.length;h++){var d=r.evaluatePosition(c[h].param),p=this._findVertexIndex(d);void 0===p?(p=this._intersectionVertices.length,this._intersectionVertices.push({position:d,adjacentEdges:[],vertices:[],index:p,guidList:[],mergedPositions:[],topologyVertex:void 0,temporary:c[h].temporary,virtualIntersection:c[h].virtualIntersection})):(this._intersectionVertices[p].temporary=this._intersectionVertices[p].temporary&&c[h].temporary,void 0!==c[h].virtualIntersection&&(void 0===this._intersectionVertices[p].virtualIntersection?this._intersectionVertices[p].virtualIntersection=c[h].virtualIntersection:this._intersectionVertices[p].virtualIntersection=this._intersectionVertices[p].virtualIntersection&&c[h].virtualIntersection),this._intersectionVertices[p].mergedPositions.push(d));var g=this._intersectionVertices[p];if(c[h].atVertex&&-1===g.vertices.indexOf(c[h].atVertex)&&g.vertices.push(c[h].atVertex),h>0&&u!==p){l=this._createGUIDfromEdgeAndLocalID(r,a),a++;var f=[c[h-1].param,c[h].param],v=t(r.getGuid(),f);if(void 0===v){var m={originalEdge:r,parameterRange:f,startVertex:this._intersectionVertices[u],endVertex:this._intersectionVertices[p],coincidentRanges:[],adjacent:[{prevEdge:void 0,nextEdge:void 0,face:void 0},{prevEdge:void 0,nextEdge:void 0,face:void 0}],index:this._edgeSegments.length,localGuid:l,topologyEdge:void 0};this._edgeSegments.push(m),this._intersectionVertices[u].adjacentEdges.push(m),this._intersectionVertices[p].adjacentEdges.push(m);for(var y=0;y<e.edgeOverlapRegions[e.edgeIDs[i]].length;y++){var _=e.edgeOverlapRegions[e.edgeIDs[i]][y],E=f,A=s.KERNEL_TOLERANCE;if(r.getCurve().isPeriodic()&&(r.getCurveType()===s.GEOMETRY_TYPES.CIRCLE&&(A/=r.getCurve().getRadius()),E=(0,n.convertToOtherPeriodicRange)(E,r.getRange(),r.getCurve().getPeriod(),A)),E[0]>=_.overlapRange[0]-s.KERNEL_TOLERANCE&&E[1]<=_.overlapRange[1]+s.KERNEL_TOLERANCE){var x=_.otherEdge,C=[e.edges[x].getCurve().closestToPointParam(m.startVertex.position),e.edges[x].getCurve().closestToPointParam(m.endVertex.position)];if(e.edges[x].getCurve().isPeriodic()){var w=m.originalEdge.getCurve().evaluateDt(m.parameterRange[0]),b=e.edges[x].getCurve().evaluateDt(C[0]);for(o.Vector3.dot(w,b)<0&&(M=C[0],C[0]=C[1],C[1]=M);C[1]<C[0];)C[1]+=e.edges[x].getCurve().getPeriod()}else if(C[0]>C[1]){var M=C[0];C[0]=C[1],C[1]=M}e.segmentBlackList[_.otherEdge].push({range:C,edge:m})}}}else{var T,V=o.Vector3.distance(v.startVertex.position,r.evaluatePosition(f[0]))>o.Vector3.distance(v.startVertex.position,r.evaluatePosition(f[1]));if(v.coincidentRanges.push({originalEdge:r,parameterRange:f,localGuid:l,flipped:V}),0===g.adjacentEdges.length&&((T=o.Vector3.distance(d,v.startVertex.position)<o.Vector3.distance(d,v.endVertex.position)?v.startVertex:v.endVertex).mergedPositions.push(d),d=T.position,p=T.index,c[h].atVertex&&-1===T.vertices.indexOf(c[h].atVertex)&&T.vertices.push(c[h].atVertex),this._intersectionVertices.pop()),v.startVertex.index!==u&&v.endVertex.index!==u){var S=v.startVertex.index===p?v.endVertex:v.startVertex,L=this._intersectionVertices[u];for(y=0;y<L.adjacentEdges.length;y++){var R=L.adjacentEdges[y];R.startVertex===L&&(R.startVertex=S),R.endVertex===L&&(R.endVertex=S),S.adjacentEdges.push(R)}for(S.mergedPositions.push(L.position),y=0;y<L.mergedPositions.length;y++)S.mergedPositions.push(L.mergedPositions[y]);for(c[h].atVertex&&-1===S.vertices.indexOf(c[h].atVertex)&&S.vertices.push(c[h].atVertex),this._intersectionVertices.splice(u,1),y=u;y<this._intersectionVertices.length;y++)this._intersectionVertices[y].index=y}}}u=p}}},V.prototype._mergeCoincidentSegments=function(){for(var e,t={},i=0;i<this._intersectionVertices.length;i++){for(var r=this._intersectionVertices[i],o={},n=0;n<r.adjacentEdges.length;n++){var a=(e=r.adjacentEdges[n]).startVertex===r?e.endVertex:e.startVertex;t[String(r.index)+"_"+String(a.index)]||(o[String(a.index)]=o[String(a.index)]||[],o[String(a.index)].push(e))}var l=b.default.keys(o);for(n=0;n<l.length;n++)if(t[l[n]+"_"+String(r.index)]=!0,o[l[n]].length>1)for(var c=o[l[n]],u=0;u<c.length;u++){for(var h=[],d=u+1;d<c.length;d++)(0,v.curvesAreCoincident)(c[u].originalEdge.getCurve(),c[d].originalEdge.getCurve(),c[u].parameterRange,c[d].parameterRange,s.KERNEL_TOLERANCE)&&(h.push(c[d]),c.splice(d,1),d--);for(d=0;d<h.length;d++){var p=h[d];c[u].coincidentRanges.push({originalEdge:p.originalEdge,parameterRange:p.parameterRange,localGuid:p.localGuid,flipped:p.startVertex!==c[u].startVertex}),p.startVertex.adjacentEdges.splice(p.startVertex.adjacentEdges.indexOf(p),1),p.endVertex.adjacentEdges.splice(p.endVertex.adjacentEdges.indexOf(p),1);var g=this._edgeSegments.indexOf(p);this._edgeSegments.splice(g,1);for(var f=g;f<this._edgeSegments.length;f++)this._edgeSegments[f].index=f}}}},V.prototype._sortEdgesAroundVertex=function(){for(var e=0;e<this._intersectionVertices.length;e++){for(var t=this._intersectionVertices[e],i=[],r=0;r<t.adjacentEdges.length;r++){var a=this._computeAngleAndPositionForEdge(r,t);i.push({index:r,originalAngle:a.angle,angle:a.angle,position:a.position,derivative:void 0})}for(var l=0,c=!1;!c;){c=!0;var u=-Math.PI+l;for(r=0;r<i.length;r++)if((0,n.angleDifference)(u,i[r].angle)<T){c=!1;break}if(c)break;l+=2e-5}for(r=0;r<t.adjacentEdges.length;r++)i[r].angle=(0,n.normalizeParameterToShiftedRange)(i[r].angle-l,[-Math.PI,Math.PI]);var h=this;i=i.sort((function(e,i){if((0,n.angleDifference)(e.angle,i.angle)>T)return e.angle-i.angle;var r=t.adjacentEdges[e.index],a=t.adjacentEdges[i.index],l=r.startVertex===t?r.parameterRange[0]:r.parameterRange[1],c=a.startVertex===t?a.parameterRange[0]:a.parameterRange[1],u=r.originalEdge.evaluatePosition(l),d=a.originalEdge.evaluatePosition(c),p=o.Vector3.distance(u,d),g=o.Vector3.createFloat64(),f=o.Vector3.createFloat64(),v=r.originalEdge.evaluateCurvature(l,g),m=a.originalEdge.evaluateCurvature(c,f);if(0===v&&0===m)return e.angle-i.angle;if(0===v||0===m){var y=1/Math.max(v,m);p+=1.5*Math.sqrt(Math.pow(y,2)-Math.pow(y-p,2))+s.KERNEL_TOLERANCE}else{var _=1/v,E=1/m;if(_<E){var A=_;_=E,E=A}o.Vector3.dot(g,f)<0?p+=-Math.sqrt(-.25*Math.pow(p,4)+Math.pow(p,3)*_-p*p*_*_-(p*p-2*p*_)*E*E+(p*p*p-3*p*p*_+2*p*_*_)*E)/(p-_-E)*1.5:p+=Math.sqrt(-.25*Math.pow(p,4)-Math.pow(p,3)*_-p*p*_*_-(p*p+2*p*_)*E*E+(p*p*p+3*p*p*_+2*p*_*_)*E)/(p+_-E)*1.5}var x=Math.min(o.Vector3.distance(r.endVertex.position,r.startVertex.position),o.Vector3.distance(a.endVertex.position,a.startVertex.position));p=Math.max(s.KERNEL_TOLERANCE,p),p=Math.min(.9*x,p);var C=!1;do{var w=h._computeEdgeDirectionAtVertex(e,t,p),b=h._computeEdgeDirectionAtVertex(i,t,p);C=(0,n.angleDifference)(w,b)>1e-8,p*=5}while(!C&&p<x);var M=w-b;return M>Math.PI?M-=n.PI2:M<-Math.PI&&(M+=n.PI2),M})),t.adjacentEdges=b.default.map(i,(function(e){return t.adjacentEdges[e.index]}))}},V.prototype._assignAdjacentEdges=function(){for(var e=0;e<this._edgeSegments.length;e++){var t=this._edgeSegments[e];this._assignAdjacentEdgesToSegment(t)}},V.prototype._assignAdjacentEdgesToSegment=function(e){var t=e.startVertex.adjacentEdges,i=t.indexOf(e);C.ConsoleUtils.assert(-1!==i,"Error in topology");for(var r=0,o=e.endVertex.adjacentEdges;r<o.length&&o[r]!==e;)r++;C.ConsoleUtils.assert(r<o.length,"Error in topology"),e.adjacent[this.SIDE.LEFT].nextEdge=o[(0,n.modulus)(r-1,o.length)],e.adjacent[this.SIDE.LEFT].prevEdge=t[(0,n.modulus)(i+1,t.length)],e.adjacent[this.SIDE.RIGHT].nextEdge=o[(0,n.modulus)(r+1,o.length)],e.adjacent[this.SIDE.RIGHT].prevEdge=t[(0,n.modulus)(i-1,t.length)]},V.prototype._sweepRegions=function(){var e=this._workspace,t=b.default.clone(this._intersectionVertices).sort((function(e,t){if(Math.abs(e.position[0]-t.position[0])<1e-9){for(var i=0;i<e.adjacentEdges.length;i++)for(var r=0;r<t.adjacentEdges.length;r++)if(e.adjacentEdges[i].originalEdge===t.adjacentEdges[r].originalEdge){var n=e.adjacentEdges[i],a=t.adjacentEdges[r],l=n.startVertex===e?n.parameterRange[0]:n.parameterRange[1],c=a.startVertex===t?a.parameterRange[0]:a.parameterRange[1],u=!0,h=o.Vector3.createFloat64();o.Vector3.normalize(h,n.originalEdge.evaluateDt(l));var d=o.Vector3.createFloat64();if(o.Vector3.normalize(d,a.originalEdge.evaluateDt(c)),Math.sign(h[0])!==Math.sign(d[0]))continue;if(Math.abs(h[0])>s.KERNEL_TOLERANCE&&Math.abs(d[0])>s.KERNEL_TOLERANCE)u=h[0]>0;else{if(Math.abs(e.position[1]-t.position[1])<s.KERNEL_TOLERANCE)continue;u=h[1]>0}return(l-c)*(u?1:-1)}return e.position[1]-t.position[1]}return e.position[0]-t.position[0]}));this._cells=[];var i={index:-1,loops:[],loopOrientations:[],dangling:[],leftmostVertex:void 0};e.sweepLineIntersections=[-1/0,1/0],e.sweepLineRegions=e.sweepLineRegions=[i];for(var r=[],n=0;n<t.length;n++){e.sweepLineRegions.length!==e.sweepLineIntersections.length-1&&console.error("Error during sweep computation");var a=t[n],l=b.default.clone(a.adjacentEdges),c=void 0;if(r[a.index]){for(var u=r[a.index],h=[],d=0;d<e.sweepLineIntersections.length-1;d++)b.default.contains(u,e.sweepLineIntersections[d])&&(void 0===c&&(c=d-1),b.default.contains(u,e.sweepLineIntersections[d+1])&&h.push(d));for(d=0;d<u.length;d++){for(var p=u[d],g=0;g<e.sweepLineIntersections.length;g++)e.sweepLineIntersections[g]===p&&e.sweepLineIntersections.splice(g,1);for(g=0;g<l.length;g++)l[g]===p&&l.splice(g,1)}for(d=h.length-1;d>=0;d--)e.sweepLineRegions.splice(h[d],1)}else c=this._findVertexOnSweepLine(a),e.sweepLineRegions.splice(c+1,0,e.sweepLineRegions[c]);if(l.length>0){var f=c+1;for(d=0;d<l.length;d++){var v=l[d];e.sweepLineIntersections.splice(f,0,v);var m=v.startVertex===a?v.endVertex:v.startVertex;if(void 0===r[m.index]&&(r[m.index]=[]),r[m.index].push(v),d>0){var y={index:this._cells.length,loops:[],loopOrientations:[],dangling:[],leftmostVertex:a};this._cells.push(y),e.sweepLineRegions.splice(f-1,0,y)}f++}for(f=c,d=0;d<l.length;d++){var _=(v=l[d]).startVertex!==a;v.adjacent[_?this.SIDE.RIGHT:this.SIDE.LEFT].face=e.sweepLineRegions[f+1],v.adjacent[_?this.SIDE.LEFT:this.SIDE.RIGHT].face=e.sweepLineRegions[f],f++}}else if(e.sweepLineRegions[c]!==e.sweepLineRegions[c+1]){var E=e.sweepLineRegions[c+1],A=e.sweepLineRegions[c];for(A===i?(A=E,E=i,e.sweepLineRegions.splice(c,1)):(void 0!==A.leftmostVertex&&(void 0===E.leftmostVertex||E.leftmostVertex.position[0]>A.leftmostVertex.position[0])&&(E.leftmostVertex=A.leftmostVertex),e.sweepLineRegions.splice(c+1,1)),d=0;d<this._edgeSegments.length;d++)this._edgeSegments[d].adjacent[this.SIDE.LEFT].face===A&&(this._edgeSegments[d].adjacent[this.SIDE.LEFT].face=E),this._edgeSegments[d].adjacent[this.SIDE.RIGHT].face===A&&(this._edgeSegments[d].adjacent[this.SIDE.RIGHT].face=E);for(d=0;d<e.sweepLineRegions.length;d++)e.sweepLineRegions[d]===A&&(e.sweepLineRegions[d]=E);this._cells[A.index]=void 0}else e.sweepLineRegions.splice(c+1,1)}for(n=0;n<this._cells.length;n++)void 0===this._cells[n]&&(this._cells.splice(n,1),n--);for(n=0;n<this._cells.length;n++)this._cells[n].index=n},V.prototype._assignleftmostEdges=function(){for(var e=this,t=0;t<this._cells.length;t++){var i=this._cells[t],r=i.leftmostVertex,o=b.default.filter(r.adjacentEdges,(function(t){var r=t.adjacent[e.SIDE.LEFT].face,o=t.adjacent[e.SIDE.RIGHT].face;return(r===i||o===i)&&r!==o}));if(C.ConsoleUtils.assert(o.length>=2,"In each loop there should be at least two adjacent edges"),o.length>2)for(var n=0;n<o.length;n++){var s=o[n].adjacent[e.SIDE.LEFT].face===i?e.SIDE.LEFT:e.SIDE.RIGHT,a=o[n].adjacent[s],l=o[n].startVertex===r?a.prevEdge:a.nextEdge;if(b.default.contains(o,l)){o=[o[n],l];break}}var c=o[0];c.loopsCurveAligned=!!(c.startVertex===r^o[0].adjacent[e.SIDE.RIGHT].face===i),i.leftmostEdge=c,i.leftmostVertex=void 0}},V.prototype._removeGrazingIntersectionVertices=function(){for(var e={},t=0,i=this._intersectionVertices.slice();i.length>0;){var r=i.pop();if(2===r.adjacentEdges.length&&(1===r.adjacentEdges[0].coincidentRanges.length||1===r.adjacentEdges[1].coincidentRanges.length)&&r.virtualIntersection){var o,s,a=1===r.adjacentEdges[0].coincidentRanges.length&&1===r.adjacentEdges[1].coincidentRanges.length,l=r.adjacentEdges.slice();if(a){if(o=[l[0].originalEdge,l[0].coincidentRanges[0].originalEdge],s=[l[1].originalEdge,l[1].coincidentRanges[0].originalEdge],!(o[0]===s[0]&&o[1]===s[1]||o[0]===s[1]&&o[1]===s[0]))continue;e[l[0].originalEdge.getGuid()]=!0,e[l[0].coincidentRanges[0].originalEdge.getGuid()]=!0,e[l[1].originalEdge.getGuid()]=!0,e[l[1].coincidentRanges[0].originalEdge]=!0;var c=[l[0].startVertex===r?l[0].endVertex:l[0].startVertex,r,l[1].startVertex===r?l[1].endVertex:l[1].startVertex]}else{var u;l[0].coincidentRanges.length>0?(u=0,o=[l[0].originalEdge,l[0].coincidentRanges[0].originalEdge]):(u=1,o=[l[1].originalEdge,l[1].coincidentRanges[0].originalEdge]),e[o[0].getGuid()]=!0,e[o[1].getGuid()]=!0,c=[l[u].startVertex===r?l[u].endVertex:l[u].startVertex,r],l=[l[u]]}var h=void 0,d=void 0;if(c[0].vertices.length>0?(h=c[0],d=a?[c[1],c[2]]:[c[1]]):a&&c[2].vertices.length>0?(h=c[2],d=[c[0],c[1]]):(h=c[1],d=a?[c[0],c[2]]:[c[0]]),d[0].vertices.length>0||d[1]&&(d[1].vertices.length>0||d[0]===d[1]))continue;for(var p=!0,g=b.default.without(d,r),f=0;f<g.length;f++){var v=g[f].adjacentEdges;if((v=b.default.difference(v,l)).length>2){p=!1;break}for(var m=0;m<v.length;m++)if(v[m].coincidentRanges.length>0||v[m].originalEdge!==o[0]&&v[m].originalEdge!==o[1]){p=!1;break}}if(!p)continue;for(f=0;f<g.length;f++){var y=g[f],_=b.default.intersection(l,y.adjacentEdges)[0],E=r!==h&&a?b.default.without(l,_)[0]:_,A=b.default.without(y.adjacentEdges,_);for(y.adjacentEdges[1]===_&&(A=A.reverse()),m=0;m<A.length;m++){var x=A[m],C=E.startVertex===h?0:1,w=void 0;if(E.originalEdge===x.originalEdge)w=E.parameterRange[C];else{var M=E.coincidentRanges[0].flipped?1-C:C;w=E.coincidentRanges[0].parameterRange[M]}x.startVertex===y?(x.startVertex=h,x.parameterRange[0]=w):(x.endVertex=h,x.parameterRange[1]=w);for(var T=0;T<x.adjacent.length;T++){var V=x.adjacent[T].face;V.leftmostEdge!==_&&V.leftmostEdge!==E||(x.loopsCurveAligned=V.leftmostEdge.loopsCurveAligned,V.leftmostEdge=x),(V.leftmostVertex===d[0]||void 0!==d[1]&&V.leftmostVertex===d[1])&&(V.leftmostVertex=h)}}var S=h.adjacentEdges.indexOf(E);Array.prototype.splice.apply(h.adjacentEdges,[S,1].concat(A));var L=h.adjacentEdges.length,R=[(0,n.modulus)(S-1,L),S,S+1,(S+2)%L];for(m=0;m<R.length;m++){var P=h.adjacentEdges[R[m]];this._assignAdjacentEdgesToSegment(P)}}this._intersectionVertices=b.default.difference(this._intersectionVertices,d),i=b.default.difference(i,d),this._edgeSegments=b.default.difference(this._edgeSegments,l),t++}}if(t>0){for(var D=0;D<this._intersectionVertices.length;D++)this._intersectionVertices[D].index=D;for(D=0;D<this._edgeSegments.length;D++)this._edgeSegments[D].index=D}var O=b.default.keys(e);for(D=0;D<O.length;D++){var I=O[D],N=[];for(f=0;f<this._edgeSegments.length;f++)for((k=this._edgeSegments[f]).originalEdge.getGuid()===I&&N.push([k,k.parameterRange[0]]),m=0;m<k.coincidentRanges.length;m++)k.coincidentRanges[m].originalEdge.getGuid()===I&&N.push([k,k.coincidentRanges[m].parameterRange[0]]);for(N.sort((function(e,t){return e[1]-t[1]})),f=0;f<N.length;f++){var k;for((k=N[f][0]).originalEdge.getGuid()===I&&(k.localGuid=this._createGUIDfromEdgeAndLocalID(k.originalEdge,f+1)),m=0;m<k.coincidentRanges.length;m++)k.coincidentRanges[m].originalEdge.getGuid()===I&&(k.coincidentRanges[m].localGuid=this._createGUIDfromEdgeAndLocalID(k.coincidentRanges[m].originalEdge,f+1))}}},V.prototype._removeTemporaryVertices=function(){for(var e=0,t=0;t<this._intersectionVertices.length;t++){var i=this._intersectionVertices[t];if(i.temporary&&2===i.adjacentEdges.length&&i.adjacentEdges[0].originalEdge===i.adjacentEdges[1].originalEdge&&i.adjacentEdges[0]!==i.adjacentEdges[1]){var r,o;i.adjacentEdges[0].endVertex===i?(r=i.adjacentEdges[0],o=i.adjacentEdges[1]):(r=i.adjacentEdges[1],o=i.adjacentEdges[0]),C.ConsoleUtils.assert(r.adjacent[this.SIDE.LEFT].face===o.adjacent[this.SIDE.LEFT].face),C.ConsoleUtils.assert(r.adjacent[this.SIDE.RIGHT].face===o.adjacent[this.SIDE.RIGHT].face);var n=r.parameterRange[1]-o.parameterRange[0],a=(r.originalEdge.isReversed()?-1:1)*r.parameterRange[0],l=s.KERNEL_TOLERANCE/r.originalEdge.getCurve().tangentLength(a);if(r.originalEdge.getCurve().isPeriodic()&&Math.abs(n-r.originalEdge.getCurve().getPeriod())<l)r.parameterRange[1]=o.parameterRange[1]+n;else{if(Math.abs(n)>l)continue;r.parameterRange[1]=o.parameterRange[1]}r.endVertex=o.endVertex,r.adjacent[this.SIDE.LEFT].nextEdge=o.adjacent[this.SIDE.LEFT].nextEdge,r.adjacent[this.SIDE.RIGHT].nextEdge=o.adjacent[this.SIDE.RIGHT].nextEdge,r.adjacent[this.SIDE.LEFT].prevEdge===o&&(r.adjacent[this.SIDE.LEFT].prevEdge=r),r.adjacent[this.SIDE.RIGHT].prevEdge===o&&(r.adjacent[this.SIDE.RIGHT].prevEdge=r);var c=r.adjacent[this.SIDE.LEFT].nextEdge;c.adjacent[this.SIDE.LEFT].prevEdge===o&&(c.adjacent[this.SIDE.LEFT].prevEdge=r),c.adjacent[this.SIDE.LEFT].nextEdge===o&&(c.adjacent[this.SIDE.LEFT].nextEdge=r),c.adjacent[this.SIDE.RIGHT].prevEdge===o&&(c.adjacent[this.SIDE.RIGHT].prevEdge=r),c.adjacent[this.SIDE.RIGHT].nextEdge===o&&(c.adjacent[this.SIDE.RIGHT].nextEdge=r);var u=r.adjacent[this.SIDE.RIGHT].nextEdge;u.adjacent[this.SIDE.LEFT].prevEdge===o&&(u.adjacent[this.SIDE.LEFT].prevEdge=r),u.adjacent[this.SIDE.LEFT].nextEdge===o&&(u.adjacent[this.SIDE.LEFT].nextEdge=r),u.adjacent[this.SIDE.RIGHT].prevEdge===o&&(u.adjacent[this.SIDE.RIGHT].prevEdge=r),u.adjacent[this.SIDE.RIGHT].nextEdge===o&&(u.adjacent[this.SIDE.RIGHT].nextEdge=r),o.adjacent[this.SIDE.LEFT].face.leftmostEdge===o&&(o.adjacent[this.SIDE.LEFT].face.leftmostEdge=r),o.adjacent[this.SIDE.RIGHT].face.leftmostEdge===o&&(o.adjacent[this.SIDE.RIGHT].face.leftmostEdge=r),void 0===r.loopsCurveAligned&&(r.loopsCurveAligned=o.loopsCurveAligned),(0,m.hashCombine4xUint32)(r.localGuid,o.localGuid,r.localGuid);var h=r.endVertex.adjacentEdges.indexOf(o);r.endVertex.adjacentEdges[h]=r,this._intersectionVertices.splice(t,1),this._edgeSegments.splice(o.index-e,1),t--,e++}else this._intersectionVertices[t].index-=e}for(t=0;t<this._edgeSegments.length;t++)this._edgeSegments[t].index=t},V.prototype._updateVertexGuidLists=function(){for(var e=0;e<this._intersectionVertices.length;e++){var t=this._intersectionVertices[e];if(t.vertices.length>0)for(var i=0;i<t.vertices.length;i++)t.guidList.push((0,m.guidToUint32x4)(t.vertices[i].getGuid()));else{var r={};for(i=0;i<t.adjacentEdges.length;i++){var o=t.adjacentEdges[i];if(!r[o.index]){r[o.index]=!0,t.guidList.push(o.localGuid);for(var n=0;n<o.coincidentRanges.length;n++)t.guidList.push(o.coincidentRanges[n].localGuid)}}}}},V.prototype._assignLoops=function(){var e=this._workspace;e.edgesPerCell=[];for(var t=0;t<this._cells.length;t++)e.edgesPerCell[t]=[];for(t=0;t<this._edgeSegments.length;t++){var i=this._edgeSegments[t],r=i.adjacent[this.SIDE.LEFT].face.index;r>=0&&e.edgesPerCell[r].push(i);var o=i.adjacent[this.SIDE.RIGHT].face.index;o>=0&&r!==o&&e.edgesPerCell[o].push(i)}var n=[];for(t=0;t<this._cells.length;t++){var s=[];n[t]=s;for(var a=this._followLoopFromEdge(this._cells[t].leftmostEdge,this._cells[t],!1,!0),l=0;l<a.loop.length;l++)s[a.loop[l].index]=!0;this._cells[t].loops.push(a.loop),this._cells[t].loopOrientations.push(a.orientations)}for(t=0;t<this._cells.length;t++){s=n[t];for(var c=0;c<e.edgesPerCell[t].length;c++){var u=e.edgesPerCell[t][c];if(u.adjacent[this.SIDE.LEFT].face!==u.adjacent[this.SIDE.RIGHT].face){if(!0!==s[u.index]){for(a=this._followLoopFromEdge(u,this._cells[t],!0,!1),l=0;l<a.loop.length;l++)s[a.loop[l].index]=!0;this._cells[t].loops.push(a.loop),this._cells[t].loopOrientations.push(a.orientations)}}else this._cells[t].dangling.push(u)}}},V.prototype._updateSketchRegionTopology=function(){for(var e=this._workspace,t=b.default.keys(this._sketchRegionTopologies),i=0;i<t.length;i++){var r=t[i];this._sketchRegionTopologies[r].updated=!1,"FaceID"===this._sketchRegionTopologies[r].topology.tuid&&this._sketchRegionTopologies[r].topology.removeAllEdges()}var o={},n={};for(i=0;i<this._intersectionVertices.length;i++){var a=this._addOrFindTopologySubcomponent("VertexID",s.GEOMETRY_TYPES.POINT,this._intersectionVertices[i].guidList,n);a.setPoint(new d.Point(this._intersectionVertices[i].position)),a.setAssociatedEntities(b.default.clone(this._intersectionVertices[i].vertices));for(var l=0;l<this._intersectionVertices[i].vertices.length;++l){var c=this._intersectionVertices[i].vertices[l].getGuid();C.ConsoleUtils.assert(!o[c],"vertex should only map to one topology vertex"),o[c]=a}this._intersectionVertices[i].topologyVertex=a}for(i=0;i<this._edgeSegments.length;i++){var u=this._edgeSegments[i],h=[u.localGuid];for(l=0;l<u.coincidentRanges.length;l++)h.push(u.coincidentRanges[l].localGuid);(w=this._addOrFindTopologySubcomponent("EdgeID",u.originalEdge.getCurveType(),h,n)).setToEdgeSegment(u.originalEdge,u.parameterRange),w.setStartVertex(u.startVertex.topologyVertex),w.setEndVertex(u.endVertex.topologyVertex);var f=[{edge:u.originalEdge,range:b.default.clone(u.parameterRange),flipped:!1}];for(l=0;l<u.coincidentRanges.length;l++)f.push({edge:u.coincidentRanges[l].originalEdge,range:b.default.clone(u.coincidentRanges[l].parameterRange),flipped:u.coincidentRanges[l].flipped});w.setAssociatedEdges(f),u.topologyEdge=w}for(i=0;i<this._cells.length;i++){var v=this._cells[i];for(h=[],l=0;l<e.edgesPerCell[i].length;l++)h.push((0,m.guidToUint32x4)(e.edgesPerCell[i][l].topologyEdge.getGuid()));var y=this._addOrFindTopologySubcomponent("FaceID",s.GEOMETRY_TYPES.PLANE,h,n);y.setSurface(this._planeGeometry);var _=[];for(l=0;l<v.loops.length;l++){var E=new p.Loop;E.setFace(y),_.push(E);for(var A=[],x=0;x<v.loops[l].length;x++){var w=v.loops[l][x].topologyEdge,M=new g.Coedge;M.setLoop(E),A.push(M),M.setEdge(w),M.setReversed(!v.loopOrientations[l][x]),w.getCoedge()?w.getCoedge().getPartner()||(w.getCoedge().setPartner(M),M.setPartner(w.getCoedge())):w.setCoedge(M),v.loops[l][x].topologyEdge.setIsDangling(!1)}E.setCoedges(A)}for(y.setLoops(_),this._faces.push(y),l=0;l<v.dangling.length;l++)y.addDanglingEdge(v.dangling[l].topologyEdge),v.dangling[l].topologyEdge.setIsDangling(!0)}for(i=0;i<t.length;i++)this._sketchRegionTopologies[t[i]].updated||delete this._sketchRegionTopologies[t[i]]},V.prototype._followLoopFromEdge=function(e,t,i,r){var o=[],n=[],s=e,a=[],l=e.adjacent[this.SIDE.LEFT].face===t?this.SIDE.LEFT:this.SIDE.RIGHT,c=!!(s.loopsCurveAligned^l!==this.SIDE.LEFT),u=c?e.startVertex:e.endVertex;do{if(s.adjacent[l].face!==t){console.error("REGION: Adjacent edge face does not match cell! FIXME!");break}if(a[s.index]){console.error("REGION: Malformed edges; walking edge lead us to despair");break}a[s.index]=!0,o.push(s),n.push(c);do{c?(u=s.endVertex,s=s.adjacent[l].nextEdge):(u=s.startVertex,s=s.adjacent[l].prevEdge),s.startVertex===s.endVertex?l=s.adjacent[this.SIDE.LEFT].face===t?this.SIDE.LEFT:this.SIDE.RIGHT:(l=s.startVertex===u?this.SIDE.LEFT:this.SIDE.RIGHT,s.adjacent[this.SIDE.LEFT].face===s.adjacent[this.SIDE.RIGHT].face&&(l=1-l,u=s.startVertex===u?s.endVertex:s.startVertex)),c=l===this.SIDE.LEFT}while(s.adjacent[this.SIDE.LEFT].face===s.adjacent[this.SIDE.RIGHT].face);r&&void 0===s.loopsCurveAligned&&(s.loopsCurveAligned=!!(c^l!==this.SIDE.LEFT))}while(s!==e);return{loop:o,orientations:n}},V.prototype._addNewRegionTopology=function(e){switch(e.tuid){case"VertexID":var t=new A.RegionTopologyVertex(new d.Point);return t.setGuid(e.guid),t;case"EdgeID":var i=void 0;switch(e.minortype){case s.GEOMETRY_TYPES.LINE:i=new l.Line;break;case s.GEOMETRY_TYPES.CIRCLE:i=new c.Circle;break;case s.GEOMETRY_TYPES.ELLIPSE:i=new h.Ellipse;break;case s.GEOMETRY_TYPES.BCURVE:i=new u.BCurve;break;default:console.error("Unhandled curve type")}var r=new A.RegionTopologyEdge(i);return r.setGuid(e.guid),r;case"FaceID":i=void 0,e.minortype===s.GEOMETRY_TYPES.PLANE?i=new a.Plane:console.error("Unhandled surface type");var o=new A.RegionTopologyFace(i);return o.setGuid(e.guid),o;default:console.error("Unhandled topology type")}},V.prototype._addOrFindTopologySubcomponent=function(e,t,i,r){var o=this._createNameFromGuidList(e,t,i,r);if(this._sketchRegionTopologies[o]){var n=this._sketchRegionTopologies[o];return n.updated=!0,n.topology}var s=this._addNewRegionTopology({tuid:e,minortype:t,guid:o});return this._sketchRegionTopologies[o]={topology:s,updated:!0},s};var S={VertexID:[1168004130,3764602020,2270554856,1368826480],EdgeID:[2942887333,1472546498,2159971906,413489693],FaceID:[2166479754,2329626594,2838556660,1584616933]},L={};L[s.GEOMETRY_TYPES.POINT]=[2299429810,2248164535,3202574069,2684287321],L[s.GEOMETRY_TYPES.LINE]=[910992607,3428993096,3010390753,2966835859],L[s.GEOMETRY_TYPES.CIRCLE]=[2229232555,842549819,2526558959,4217038233],L[s.GEOMETRY_TYPES.PLANE]=[2122299449,3667741317,2812958731,939246365],L[s.GEOMETRY_TYPES.BCURVE]=[420548527,2703575863,2792852189,2595995847],L[s.GEOMETRY_TYPES.ELLIPSE]=[902753991,1129557208,9277753211,1913737389];var R,P=16777619,D=function(e,t){var i=2166136261;return t&&(i=(i^t)*P>>>0),(((i=(((i=(((i=((i^255&e)>>>0)*P>>>0)^e>>8&255)>>>0)*P>>>0)^e>>16&255)>>>0)*P>>>0)^e>>24&255)>>>0)*P>>>0},O=(R=new Uint32Array(4),function(e){return R[0]=e,R[1]=P,R[2]=e,R[3]=e,(0,m.hashCombine4xUint32)(R,R)}),I=function(e,t){for(var i=0;i<e.length;i++)e[i]=(e[i]^t[i])>>>0};V.prototype._createNameFromGuidList=function(e,t,i,r){var o=b.default.clone(S[e]),n=L[t];C.ConsoleUtils.assert(o&&n,"Unsupported tuid or minortype!"),I(o,n);for(var s=0;s<i.length;s++)I(o,i[s]);var a=(0,m.uint32x4ToGUID)(o);if(r[a]){var l=++r[a];return(i=b.default.clone(i)).push(O(D(l))),this._createNameFromGuidList(e,t,i,r)}return r[a]=1,a},V.prototype._createGUIDfromEdgeAndLocalID=function(e,t){var i=(0,m.guidToUint32x4)(e.getGuid()),r=O(D(t));return(0,m.hashCombine4xUint32)(i,r)},V.prototype._findVertexIndex=function(e){for(var t=0;t<this._intersectionVertices.length;t++){if(o.Vector3.distance(this._intersectionVertices[t].position,e)<s.KERNEL_TOLERANCE)return t;for(var i=0;i<this._intersectionVertices[t].mergedPositions.length;i++)if(o.Vector3.distance(this._intersectionVertices[t].mergedPositions[i],e)<s.KERNEL_TOLERANCE)return t}},V.prototype._findVertexOnSweepLine=function(e){for(var t=this._workspace,i=0,r=t.sweepLineIntersections.length-1;r>=i;){if(i+1>=r)return i;var o=Math.floor((i+r)/2);this._isVertexAboveEdgeSegment(t.sweepLineIntersections[o],e)?i=o:r=o}console.error("Error in binary search function!")},V.prototype._isVertexAboveEdgeSegment=function(e,t){if(e===-1/0)return!0;if(e===1/0)return!1;var i=e.originalEdge;switch(i.getCurveType()){case s.GEOMETRY_TYPES.LINE:var r=i.getStartVertex().getPosition(),n=o.Vector3.createFloat64();o.Vector3.subtract(n,i.getEndVertex().getPosition(),r);var a=o.Vector3.createFloat64();return o.Vector3.subtract(a,t.position,r),(n[0]<0||0===n[0]&&n[1]<0)&&o.Vector3.negate(n,n),a[1]*n[0]-a[0]*n[1]>0;case s.GEOMETRY_TYPES.CIRCLE:var l=t.position[0]-i.getCurve().getCenter()[0],c=.5*(e.parameterRange[0]+e.parameterRange[1]),u=i.getCurve().evaluateDtt(c)[1]>0?-1:1;return Math.abs(l)>i.getCurve().getRadius()?i.getCurve().getCenter()[1]<t.position[1]:i.getCurve().getCenter()[1]+u*Math.sqrt(i.getCurve().getRadius()*i.getCurve().getRadius()-l*l)<t.position[1];default:return this.getYvalueForX(e,t.position[0])<t.position[1]}},V.prototype._makeEdgeXMonotone=function(e,t){var i=e.getCurve(),r=[];switch(e.getCurveType()){case s.GEOMETRY_TYPES.LINE:break;case s.GEOMETRY_TYPES.CIRCLE:var a=i.evaluatePosition(0);o.Vector3.subtract(a,a,i.getCenter());var l=i.getNormal()[2]>0?-1:1;r[0]=l*Math.atan2(a[1],a[0]),r[1]=r[0]-Math.PI;break;case s.GEOMETRY_TYPES.ELLIPSE:var c=i.getMajorAxis()[0]*i.getMajorRadius(),u=i.getMinorAxis()[0]*i.getMinorRadius();r[0]=Math.atan2(u,c),r[1]=r[0]-Math.PI;break;case s.GEOMETRY_TYPES.BCURVE:r=y.SplineCurveHelper.extremalParams(i,0);break;default:console.warn("Unsupported edge type in sketch region op")}for(var h=0;h<r.length;h++){var d=r[h];e.isReversed()&&(d=-d),i.isPeriodicUnlimited()&&(d=(0,n.adjustParameterToPeriodicRange)(d,e.getRange(),i.getPeriodUnlimited())),d>=e.t0()&&d<=e.t1()&&(t.push({param:d,atVertex:null,temporary:!0}),w.DebugUtils.level("region3D")>0&&w.DebugUtils.drawPoint3D(e.evaluatePosition(d),{color:16711935,label:"x monotonic"}))}},V.prototype.plotSegments=function(e,t){var i=this._workspace;M.hold("on"),M.clearFigure(),M.delayUpdates(!0);for(var r=0;r<this._intersectionVertices.length;r++){var n=M.plotColorForIndex(this._intersectionVertices[r].adjacentEdges.length);if("sweepLineState"===e&&(n="k",this._intersectionVertices[r]===i.currentVertex&&(n="g"),this._intersectionVertices[r]===i.nextVertex&&(n="b")),M.plot([this._intersectionVertices[r].position],n+"o"),"orderColored"===e)for(var s=this._intersectionVertices[r],a=[],l=0;l<s.adjacentEdges.length;l++){n=M.plotColorForIndex(l);var c=s.adjacentEdges[l],u=b.default.clone(c.parameterRange);c.startVertex!==s||a[c.index]?u[0]=.5*(u[0]+u[1]):u[1]=.5*(u[0]+u[1]),a[c.index]=!0;var h=c.originalEdge.tessellate(u).positions;M.plot(h,n+"-")}}if("orderColored"!==e)for(r=0;r<this._edgeSegments.length;r++){if(c=this._edgeSegments[r],"coincidenceCount"===e){var d=c.coincidentRanges.length+1;n=M.plotColorForIndex(d)}else n=M.plotColorForIndex(r);if("sweepLineState"===e&&(n=i.sweepLineIntersections.indexOf(c)>-1?"r":"k"),t&&t.highlightLoop&&(n=b.default.contains(t.highlightLoop,c)?"R":"k"),h=c.originalEdge.tessellate(c.parameterRange).positions,"regions"===e){var p=[],g=[];for(l=0;l<h.length;l++){if(l<h.length-1){var f=o.Vector3.createFloat64();o.Vector3.subtract(f,h[l+1],h[l])}else f=o.Vector3.createFloat64(),o.Vector3.subtract(f,h[l],h[l-1]);o.Vector3.normalize(f,f),o.Vector3.scale(f,f,.05),o.Vector3.cross(f,[0,0,1],f);var v=o.Vector3.clone(h[l]);p.push(o.Vector3.add(v,v,f));var m=o.Vector3.clone(h[l]);g.push(o.Vector3.subtract(m,m,f))}var y=c.adjacent[this.SIDE.LEFT].face.index;n=M.plotColorForIndex(y),M.plot(p,n+"-");var _=c.adjacent[this.SIDE.RIGHT].face.index;n=M.plotColorForIndex(_),M.plot(g,n+"-")}else M.plot(h,n+"-")}if("sweepLineState"===e&&i.sweepLinePosition){var E=i.sweepLinePosition,A=void 0;for(r=0;r<i.sweepLineIntersections.length;r++){var x,C=i.sweepLineIntersections[r];void 0!==(x=C===1/0?5:C===-1/0?-5:this.getYvalueForX(C,E))&&(M.plot([E],[x],"y."),void 0!==A&&(n=M.plotColorForIndex(i.sweepLineRegions[r-1].index),M.plot([E,E],[A,x],n+"-")),A=x)}}if(t&&t.showOrientation){h=[];var w=[],T=[];for(r=0;r<this._edgeSegments.length;r++){var V=!(void 0===(c=this._edgeSegments[r]).loopsCurveAligned||!0===c.loopsCurveAligned),S=V?.05:.95,L=c.parameterRange[0]*(1-S)+c.parameterRange[1]*S,R=c.originalEdge.evaluatePosition(L);h.push(R);var P=t.arrowSize||.1,D=V?-P:P;if(c.adjacent[this.SIDE.LEFT].face.index>=0){var O=c.originalEdge.evaluateDt(L);o.Vector3.normalize(O,O);var I=[R[0]-P*O[1],R[1]+P*O[0]];w.push(I),T.push([D*O[0],D*O[1]])}if(c.adjacent[this.SIDE.RIGHT].face.index>=0){var N=c.parameterRange[0]*S+c.parameterRange[1]*(1-S),k=c.originalEdge.evaluatePosition(N),B=c.originalEdge.evaluateDt(N);o.Vector3.normalize(B,B);var F=[k[0]+P*B[1],k[1]-P*B[0]];w.push(F),T.push([-D*B[0],-D*B[1]])}}M.plot(h,"k."),M.quiver(w,T,"g","c")}M.delayUpdates(!1),M.equalAxis()},V.prototype.plotEdgeSegment=function(e,t){M.plotEdgeList([e.originalEdge],!1,t+"-",{ranges:[e.parameterRange]})},V.prototype.plotEdgesAroundVertex=function(e,t){M.plot([e.position],"gx");for(var i=0;i<e.adjacentEdges.length;i++){var r,o=e.adjacentEdges[i];console.log(i),r=o.startVertex===e?[o.parameterRange[0],o.parameterRange[0]+t/o.originalEdge.getCurve().tangentLength(o.parameterRange[0])]:[o.parameterRange[1]-t/o.originalEdge.getCurve().tangentLength(o.parameterRange[0]),o.parameterRange[1]],M.plotEdgeList([o.originalEdge],!1,"-"+M.plotColorForIndex(i),{ranges:[r],showOrientation:!1,resolution:1e4})}},V.prototype.getYvalueForX=function(e,t){var i=e.parameterRange[0],r=e.parameterRange[1],o=e.originalEdge.evaluatePosition(i),n=e.originalEdge.evaluatePosition(r),a=o[0],l=n[0];if(a>l){var c=i;i=r,r=c,c=a,a=l,l=c,c=o,o=n,n=c}if(t<=a+s.KERNEL_TOLERANCE||t>=l-s.KERNEL_TOLERANCE)return Math.abs(t-a)<=s.KERNEL_TOLERANCE?o[1]:Math.abs(t-l)<=s.KERNEL_TOLERANCE?n[1]:void console.warn("Failure in getYvalueForX, in_x oustide segment range, returning undefined");for(;l>=a;){if(a+s.KERNEL_TOLERANCE>=l)return h[1];var u=(i+r)/2,h=e.originalEdge.evaluatePosition(u);if(Math.abs(i-r)<=s.PARAMETER_SPACE_TOLERANCE)return C.ConsoleUtils.assert(!1,"Could not converge to a solution for getYvalueForX"),h[1];h[0]<t?(a=h[0],i=u):(l=h[0],r=u)}console.warn("Failure in getYvalueForX, returning undefined")},V.prototype._computeAngleAndPositionForEdge=function(e,t,i){var r=t.adjacentEdges[e],n=r.startVertex===t,s=r.parameterRange[n?0:1];if(void 0===i||!((s+=(n?1:-1)*i)<r.parameterRange[0]||s>r.parameterRange[1])){var a=o.Vector3.createFloat64();return o.Vector3.normalize(a,r.originalEdge.evaluateDt(s)),n||o.Vector3.negate(a,a),{angle:Math.atan2(a[1],a[0]),position:r.originalEdge.evaluatePosition(s)}}},V.prototype._computeEdgeDirectionAtVertex=function(e,t,i){var r=t.adjacentEdges[e.index],n=r.startVertex===t,s=r.parameterRange[n?0:1],a=s+(n?1:-1)*i/o.Vector3.length(r.originalEdge.evaluateDt(s)),l=r.originalEdge.evaluatePosition(a),c=o.Vector3.subtract(l,l,t.position);return Math.atan2(c[1],c[0])},V.prototype._prepareResult=function(){var e=new _.TopologyCloner;this._finalFaces=e.cloneFaces(this._faces),this._internalToFinalMap=e.getProgenitorMap(),this._progenitorMap=new E.ProgenitorMap;for(var t=e.getProgenitorMap().getAllNewTopology(),i=0;i<t.length;i++){var r=t[i],o=e.getProgenitorMap().getProgenitors(r)[0],n=void 0;r.getTopologyType()===s.TOPOLOGY_TYPES.FACE?(n=new Set,o.collectEdges().forEach((function(e){e.getAssociatedEntities().forEach((function(e){n.add(e)}))})),n=Array.from(n)):(r.getTopologyType()===s.TOPOLOGY_TYPES.EDGE||r.getTopologyType()===s.TOPOLOGY_TYPES.VERTEX)&&(n=o.getAssociatedEntities()),n&&this._progenitorMap.addEntry(r,n)}this._sketchSummary={regionFaces:[],regionEdges:[],regionVertices:[],sketchEdges:{}};for(var a=b.default.keys(this._sketchRegionTopologies),l=0;l<a.length;l++){var c=this._sketchRegionTopologies[a[l]].topology;c instanceof A.RegionTopologyFace?this._sketchSummary.regionFaces.push(c):c instanceof A.RegionTopologyEdge?this._sketchSummary.regionEdges.push(c):c instanceof A.RegionTopologyVertex?this._sketchSummary.regionVertices.push(c):C.ConsoleUtils.assert(!1)}for(var u=0;u<this._sketchEdges.length;u++){var h=this._sketchEdges[u];this._sketchSummary.sketchEdges[h.getGuid()]=h}},V.prototype.getFaces=function(){return this._finalFaces},V.prototype.getRegionTopologyFaces=function(){return this._faces},V.prototype.getProgenitorMap=function(){return this._progenitorMap},V.prototype.createFaceRecipe=function(e){var t=this._finalFaces.indexOf(e);if(t<0)return"";var i=this._faces[t],r=(0,x.createRecipeFromRegionFace)(i,this._sketchSummary);return(0,x.serializeRegionFaceRecipe)(r)},V.prototype.matchFaceRecipe=function(e){for(var t=(0,x.deserializeRegionFaceRecipe)(e),i=(0,x.matchRegionFaceRecipe)(t,this._sketchSummary),r=[],o=0;o<i.regions.length;o++){var n=this._faces.indexOf(i.regions[o]);C.ConsoleUtils.assert(n>=0),r.push(this._finalFaces[n])}return r},V.prototype.createEdgeRecipe=function(e){var t=this._internalToFinalMap.getProgenitors(e);if(!t||1!==t.length)return"";var i=(0,x.createRecipeFromRegionEdge)(t[0],this._sketchSummary);return(0,x.serializeRegionEdgeRecipe)(i)},V.prototype.matchEdgeRecipe=function(e){for(var t=(0,x.deserializeRegionEdgeRecipe)(e),i=(0,x.matchRegionEdgeRecipe)(t,this._sketchSummary),r=[],o=0;o<i.edges.length;o++){var n=this._internalToFinalMap.getDescendants(i.edges[o]);C.ConsoleUtils.assert(1===n.length),r.push(n[0])}return r},t.SketchRegionSolver=V},9324:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Attribute=void 0;var r=i(40);const o={"autodesk.brep:nmiattributestr-1.0.0":"nmiattributestr","autodesk.brep:nmiattributearr-1.0.0":"nmiattributearr","autodesk.brep:textattribute-1.0.0":"textattribute"};var n=function(e,t){r.Base.call(this),this._topologies=[],this.typeid=e,this.values=t||{}};(n.prototype=Object.create(r.Base.prototype)).getValues=function(){return this.values},n.prototype.getTypeid=function(){return this.typeid},n.prototype.getTopologies=function(){return this._topologies},n.prototype.addTopology=function(e){this._topologies?this._topologies.push(e):this._topologies=[e]},n.prototype.removeTopology=function(e){var t=this._topologies.indexOf(e);return t>-1&&(this._topologies.splice(t,1),!0)},n.prototype.toObject=function(){return this.values},n.prototype.addToModelObject=function(e){if(!e.attributes[this.getGuid()]){const t=o[this.typeid];if(t){const i={};i[t]=this.toObject(),e.attributes[this.getGuid()]=i}else console.warn("Attribute.addToModelObject : Unknown attribute type for proto object!")}},t.Attribute=n},40:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Base=void 0;var r=i(6704);const o=i(8032).Autodesk.lookup("SolidDef.paramrange_1_0_0.typeEnum");var n=function(){this._guid=""};n.prototype.setGuid=function(e){this._guid=e},n.prototype.getGuid=function(){return this._guid||(this._guid=(0,r.generateGUID)()),this._guid},n.prototype.refsToStrings=function(e){if(e){const t=new Array(e.length);for(let i=0;i<e.length;++i)t[i]=e[i].getGuid();return t}return[]},n.prototype.refToString=function(e){return e?e.getGuid():""},n.prototype.toObject=function(){return console.warn("Base.toObject : abstract method invoked!"),{}},n.prototype.vectorToObject=function(e){return{x:e[0],y:e[1],z:e[2]}},n.prototype.rangeToObject=function(e,t){var i=1,r=0;t&&void 0!==e&&2===e.length&&isFinite(e[0])&&isFinite(e[1])&&(i=e[0],r=e[1]);var n=i<=r?"finite":"infinite";return{low:i,high:r,type:o.values[n]}},n.prototype.addToModelObject=function(e){console.warn("Base.addToModelObject : abstract method invoked!")},t.Base=n},9024:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseGeometry=void 0;var r=i(40),o=i(2468),n=function(){r.Base.call(this)};(n.prototype=Object.create(r.Base.prototype)).getGeometryType=function(){console.warn("BaseGeometry.getGeometryType : abstract method invoked!")},n.prototype.clone=function(){console.warn("BaseGeometry.clone : abstract method invoked")},n.prototype.copy=function(e){this._guid=""},n.prototype.addToModelObject=function(e){if(!e.geometries[this.getGuid()]){const t={};t[o.GEOMETRY_TYPES.toString(this.getGeometryType()).toLowerCase()]=this.toObject(),e.geometries[this.getGuid()]=t}},t.BaseGeometry=n},9547:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseTopology=void 0;var r=i(40),o=i(2468),n=function(){r.Base.call(this),this._attributes=[]};(n.prototype=Object.create(r.Base.prototype)).getTopologyType=function(){console.warn("BaseTopology.getTopologyType : abstract method invoked!")},n.prototype.getBoundingBox=function(){console.warn("BaseTopology.getBoundingBox : abstract method invoked!")},n.prototype.getBody=function(){console.warn("BaseTopology.getBody : abstract method invoked!")},n.prototype.collectFaces=function(e){return console.warn("BaseTopology.collectFaces : abstract method invoked!"),e||new Set},n.prototype.collectEdges=function(e){return console.warn("BaseTopology.collectEdges : abstract method invoked!"),e||new Set},n.prototype.collectVertices=function(e){return console.warn("BaseTopology.collectVertices : abstract method invoked!"),e||new Set},n.prototype.getAttributes=function(){return this._attributes},n.prototype.addAttribute=function(e){this._attributes?this._attributes.push(e):this._attributes=[e],e.addTopology(this)},n.prototype.removeAttribute=function(e){var t=this._attributes.indexOf(e);return t>-1&&(this._attributes.splice(t,1),e.removeTopology(this),!0)},n.prototype.removeAllAttributes=function(){if(this._attributes)for(let e=0;e<this._attributes.length;e++)this.removeAttribute(this._attributes[e])},n.prototype.isVertex=function(){return this.getTopologyType()===o.TOPOLOGY_TYPES.VERTEX},n.prototype.getFaces=function(){return Array.from(this.collectFaces())},n.prototype.getEdges=function(){return Array.from(this.collectEdges())},n.prototype.getVertices=function(){return Array.from(this.collectVertices())},n.prototype.addAllToModelObject=function(e,t){if(!e.topologies[this.getGuid()]){const t={};t[o.TOPOLOGY_TYPES.toString(this.getTopologyType()).toLowerCase()]=this.toObject(),e.topologies[this.getGuid()]=t}t.forEach((t=>{null!=t&&(Array.isArray(t)?t.forEach((t=>{t.addToModelObject(e)})):t.addToModelObject(e))}))},t.BaseTopology=n},8796:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BCurve=void 0;var r=i(1972),o=i(3344),n=i(2355),s=i(2468),a=i(1472),l=i(1096),c=i(5896),u=i(1e3),h=i(4728),d=i(6120),p=i(4336),g=i(5416),f=i(3888),v=i(48),m=i(6200),y=i(5564),_=function(){a.Curve.call(this),this._controlPoints=[],this._weights=[],this._degree=0,this._knots=[],this._isRational=void 0,this._isPeriodic=void 0,this._isClosed=void 0,this._isPlanarXY=void 0,this._discretizationCache=void 0,this._segments=void 0,this._hasDirtySegments=!0,this._isDirtyControlPoint=[],this._tessellationCache=new p.TessellationCache};(_.prototype=Object.create(a.Curve.prototype)).getGeometryType=function(){return s.GEOMETRY_TYPES.BCURVE},_.prototype.clone=function(){var e=new _;return e.copy(this),e},_.prototype.getControlPointsVector3=function(){for(var e=new Array(this._controlPoints.length/3),t=0;t<this._controlPoints.length/3;t++)e[t]=r.Vector3.createFloat64FromValues(this._controlPoints[3*t],this._controlPoints[3*t+1],this._controlPoints[3*t+2]);return e},_.prototype.copy=function(e){a.Curve.prototype.copy.call(this,e),this._isRational=e._isRational,this._weights=e._weights.slice(0),this._degree=e._degree,this._knots=e._knots.slice(0),this._isPeriodic=e._isPeriodic,this._isClosed=e._isClosed,this._weights=e._weights.slice(0),this._controlPoints=e._controlPoints.slice(0),this._isPlanarXY=e._isPlanarXY,this._hasDirtySegments=!0,this._tessellationCache.reset()},_.prototype.set=function(e,t,i,o){this.dirtyCurveRepresentation(),this._weights=Array.prototype.slice.call(t),this._degree=i;var n=0;if(this._isRational=!1,this._weights.length!==t.length){this._weights=Array.prototype.slice.call(t);var s=this._weights[0];for(n=1;n<this._weights.length;++n)if(Math.abs(this._weights[n]-s)>r.FLOAT64_TOLERANCE){this._isRational=!0;break}}else for(s=this._weights[0],n=1;n<this._weights.length;++n)this._weights[n]=t[n],Math.abs(this._weights[n]-s)>r.FLOAT64_TOLERANCE&&(this._isRational=!0);if(this._knots.length!==o.length)this._knots=Array.prototype.slice.call(o);else for(n=0;n<this._knots.length;++n)this._knots[n]=o[n];var a=e.length/3;if(0===this._weights.length)for(this._weights=new Array(a),n=0;n<a;++n)this._weights[n]=1;if(this._controlPoints.length!==e.length)this._controlPoints=Array.prototype.slice.call(e);else for(n=0;n<e.length;++n)this._controlPoints[n]=e[n];this._isDirtyControlPoint.length!==a&&(this._isDirtyControlPoint=new Array(a)),this._isDirtyControlPoint.fill(!1)},_.prototype.dirtyCurveRepresentation=function(){this._isPlanarXY=void 0,this._isRational=void 0,this._isClosed=void 0,this._isPeriodic=void 0,this._discretizationCache=void 0,this._hasDirtySegments=!0,this._tessellationCache.setDirty(!0)},_.prototype.hasDirtyTessellation=function(){return this._tessellationCache.isDirty()},_.prototype.getTessellationCacheTolerance=function(){return this._tessellationCache.getTolerance()},_.prototype.weightedControlPoints=function(){for(var e=[],t=0;t<this._controlPoints.length/3;++t){var i=this._weights[t];e.push(this._controlPoints[3*t]*i,this._controlPoints[3*t+1]*i,this._controlPoints[3*t+2]*i,i)}return e},_.prototype.getControlPoints=function(){return this._controlPoints},_.prototype._findChangedControlPoints=function(e){var t=e.length===this._controlPoints.length;t||(this._isDirtyControlPoint=new Array(e.length/3),this._isDirtyControlPoint.fill(!0));for(var i=0;i<e.length/3;++i)if(t){var r=e[3*i]-this._controlPoints[3*i],o=e[3*i+1]-this._controlPoints[3*i+1],n=e[3*i+2]-this._controlPoints[3*i+2];r*r+o*o+n*n>s.KERNEL_TOLERANCE*s.KERNEL_TOLERANCE&&(this._isDirtyControlPoint[i]=!0)}else this._isDirtyControlPoint[i]=!0},_.prototype.setControlPoints=function(e){this._findChangedControlPoints(e),this._controlPoints=e,this.dirtyCurveRepresentation()},_.prototype.copyControlPoints=function(e){if(this._findChangedControlPoints(e),e!==this._controlPoints){this._controlPoints.length=e.length;for(var t=0;t<e.length;++t)this._controlPoints[t]=e[t]}this.dirtyCurveRepresentation()},_.prototype.transform=function(e){for(var t=[],i=r.Vector3.createFloat64(),o=0;o<this._controlPoints.length;o+=3)r.Vector3.set(i,this._controlPoints[o],this._controlPoints[o+1],this._controlPoints[o+2]),r.Vector3.transformMatrix44(i,i,e),t.push(i[0],i[1],i[2]);this.setControlPoints(t)},_.prototype.getControlPointPosition=function(e){return r.Vector3.createFloat64FromValues(this._controlPoints[3*e],this._controlPoints[3*e+1],this._controlPoints[3*e+2])},_.prototype.extendBBoxFromControlPoints=function(e){for(var t=r.Vector3.createFloat64(),i=0;i<this._controlPoints.length;i+=3)r.Vector3.set(t,this._controlPoints[i],this._controlPoints[i+1],this._controlPoints[i+2]),e.includePoint(t)},_.prototype.setControlPointPosition=function(e,t,i,r){this._controlPoints[3*e]=t,this._controlPoints[3*e+1]=i,this._controlPoints[3*e+2]=r,this._isDirtyControlPoint[e]=!0,this.dirtyCurveRepresentation()},_.prototype.getWeights=function(){return this._weights},_.prototype.setWeights=function(e){this._weights=e,this.dirtyCurveRepresentation()},_.prototype.getKnotVector=function(){return this._knots},_.prototype.setKnotVector=function(e){this._knots=e,this.dirtyCurveRepresentation()},_.prototype.getDegree=function(){return this._degree},_.prototype.isRational=function(){if(void 0===this._isRational&&(this._isRational=!1,this._weights))for(var e=this._weights[0],t=0;t<this._weights.length;++t)if(Math.abs(this._weights[t]-e)>r.FLOAT64_TOLERANCE)return this._isRational=!0,!0;return this._isRational},_.prototype.isSimpleBezier=function(){return this._knots.length===2*this._degree+2},_.prototype.getNumControlPoints=function(){return this._controlPoints.length/3},_.prototype.getTessellationCache=function(){return this._tessellationCache.getCache()},_.prototype.getEvaluationCache=function(){return void 0===this._discretizationCache&&this.evaluate(),this._discretizationCache},_.prototype.getRangeUnlimited=function(){return[this._knots[0],this._knots[this._knots.length-1]]},_.prototype.isPeriodicUnlimited=function(){return this._checkClosure(),this._isPeriodic},_.prototype.isClosedUnlimited=function(){return this._checkClosure(),this._isClosed},_.prototype._checkClosure=function(){if(void 0===this._isClosed||void 0===this._isPeriodic){this._isClosed=this._isPeriodic=!1;var e=this.getRangeUnlimited(),t=this.evaluatePosition(e[0]),i=this.evaluatePosition(e[1]);if(r.Vector3.equals(t,i,s.KERNEL_TOLERANCE)){this._isClosed=!0;var o=this.evaluateDt(e[0]),n=this.evaluateDt(e[1]);r.Vector3.isParallel(o,n,1,s.KERNEL_ANGULAR_TOLERANCE)&&(this._isPeriodic=!0)}}},_.prototype.getBezierSegments=function(){return this._decomposeCurve(),this.isSimpleBezier()?[this]:this._segments},_.prototype.isPlanarXY=function(){if(void 0===this._isPlanarXY){var e=s.SPLINE_DISTANCE_TOLERANCE;this._isPlanarXY=!0;for(var t=1/0,i=-1/0,r=2;r<this._controlPoints.length;r+=3)t=Math.min(t,this._controlPoints[r]),i=Math.max(i,this._controlPoints[r]);Math.abs(i-t)>2*e&&(this._isPlanarXY=!1)}return this._isPlanarXY},_.prototype.getBezierSegmentsInRange=function(e,t){for(var i=this.getBezierSegments(),r=e||this._knots[0],o=t||this._knots[this._knots.length-1],n=[],s=0;s<i.length;++s){var a=i[s].getKnotVector();r<=a[a.length-1]&&a[0]>=o&&n.push(i[s])}return n},_.prototype.getApproxParameterSpaceTolerance=function(){if(12===this.getControlPoints().length)return g.SplineCurveHelper.getApproxBezierParameterSpaceTolerance(this.getBoundingBox(),s.KERNEL_TOLERANCE);this._decomposeCurve();for(var e=0,t=0;t<this._segments.size();++t)e+=g.SplineCurveHelper.getApproxBezierParameterSpaceTolerance(this._segments[t].getBoundingBox(),s.KERNEL_TOLERANCE);return e},_.prototype.getArcLength=function(e){void 0===e?e=this.getRange():0===e.length&&(e=this.getRangeUnlimited());for(var t=this._restrictRangeToUnlimited(e),i=0,o=this.getBezierSegments(),n=0;n<o.length;++n)for(var a=o[n],l=a.getRangeUnlimited(),c=0;c<t.length;++c){var h=[Math.max(l[0],t[c][0]),Math.min(l[1],t[c][1])];h[1]-h[0]>s.PARAMETER_SPACE_TOLERANCE&&(i+=(0,u.integrateFunction1D)((function(e){return r.Vector3.length(a.evaluateDt(e))}),h))}return i},_.prototype.getParameterFromArcLength=function(e,t){void 0===t?t=this.getRange():0===t.length&&(t=this.getRangeUnlimited());var i=this;return(0,u.invertIntegral1D)((function(e){return r.Vector3.length(i.evaluateDt(e))}),e,t)},_.prototype._decomposeCurve=function(){if(this._hasDirtySegments)if(this._hasDirtySegments=!1,this.isSimpleBezier())this._segments=void 0;else{var e;this._isDirtyControlPoint.length===this.getNumControlPoints()?e=(0,m.decomposeBCurveFlags)(this.getKnotVector(),this._isDirtyControlPoint):(this._isDirtyControlPoint=new Array(this.getNumControlPoints()),(e=new Array(this.getNumControlPoints())).fill(!0)),this._isDirtyControlPoint.fill(!1);var t=(0,m.decomposeBCurveToBezier)(this._knots,this._controlPoints,this.isRational()?this._weights:void 0);this._segments&&this._segments.length===t.P.length||(this._segments=[]);for(var i=0;i<t.P.length;++i)void 0===this._segments[i]&&(this._segments[i]=new _,e[i]=!0),e[i]&&this._segments[i].set(t.P[i],t.w?t.w[i]:new Array(2*this._degree+2).fill(1),this._degree,t.U[i])}},_.prototype.evaluatePosition=function(e){this.isPeriodicUnlimited()&&(e=(0,c.normalizeParameterToShiftedRange)(e,[this._knots[0],this._knots[this._knots.length-1]]));var t=this.isRational()?this._weights:void 0;return(0,v.evaluateBCurvePoint)(e,this._degree,this._knots,this._controlPoints,t)},_.prototype.evaluateDt=function(e){this.isPeriodicUnlimited()&&(e=(0,c.normalizeParameterToShiftedRange)(e,[this._knots[0],this._knots[this._knots.length-1]]));var t=this.isRational()?this._weights:void 0;return(0,v.evaluateBCurveDerivs)(e,1,this._degree,this._knots,this._controlPoints,t)[1]},_.prototype.closestToRayParam=function(e,t,i,o){if(!(this._controlPoints.length<9)){if(this.isPlanarXY()){var n=t[2],a=r.Vector3.createFloat64();if(Math.abs(n)<s.KERNEL_ANGULAR_TOLERANCE)r.Vector3.copy(a,e);else{var l=(this._controlPoints[2]-e[2])/n;r.Vector3.add(a,r.Vector3.scale(a,t,l),e)}return this.closestToPointParam(a)}d.DebugUtils.warn("BCurve.closestToRayParam() only defined for planar curves")}},_.prototype.closestToPointParam=function(e,t){void 0===t?t=this.getRange():0===t.length&&(t=this.getRangeUnlimited());for(var i=this._restrictRangeToUnlimited(t),o=r.FLOAT64_TOLERANCE,n=this.getBezierSegments(),s=(0,y.closestBCurveSegments)(e,n,void 0,i),a=Number.POSITIVE_INFINITY,l=void 0,u=0;u<s.length;++u)if(!(s[u].minDistSqr>a))for(var h=n[s[u].index],d=h.getRangeUnlimited(),p=0;p<i.length;++p){var g=[Math.max(d[0],i[p][0]),Math.min(d[1],i[p][1])];if(!(g[1]-g[0]<=r.FLOAT64_TOLERANCE)){var f=h.getEvaluationCache(),v=(0,c.closestPointToPolyline)(e,f.points,f.offset,g),m=(0,y.relaxBCurveToPerpendicular)(this._knots,this._controlPoints,this.isRational()?this._weights:void 0,e,v,g,o,32),_=h.evaluatePosition(m),E=r.Vector3.squaredDistance(_,e);E<a&&(a=E,l=m);var A=h.evaluatePosition(g[0]),x=r.Vector3.squaredDistance(A,e);x<a&&(a=x,l=g[0]);var C=h.evaluatePosition(g[1]),w=r.Vector3.squaredDistance(C,e);w<a&&(a=w,l=g[1])}}return this.isPeriodicUnlimited()&&(l=(0,c.foldNearTo)(l,.5*(t[0]+t[1]),this.getPeriodUnlimited())),l},_.prototype.evaluate=function(){var e=this.getBezierSegments();if(e[0]===this)void 0===this._discretizationCache&&(this._discretizationCache=g.SplineCurveHelper.evaluateCurve(this.getDegree(),this.getKnotVector(),this.getControlPoints(),this.getWeights(),!0));else for(var t=0;t<e.length;++t){var i=e[t];void 0===i._discretizationCache&&(i._discretizationCache=g.SplineCurveHelper.evaluateCurve(i.getDegree(),i.getKnotVector(),i.getControlPoints(),i.getWeights(),!0))}},_.prototype._getFullTessellation=function(e){var t,i,o=this.getBezierSegments(),n=0,s=!1;if(o[0]===this){s=!0;var a=p.CurveTessellator.getAdaptiveRenderPoints(this,e,this.getRangeUnlimited());t=a.positions,i=a.params,n=Math.max(n,a.tolerance)}else{t=[],i=[];for(var l=0;l<o.length;++l){var c=o[l];if(c.hasDirtyTessellation()||c.getTessellationCacheTolerance()>e+r.FLOAT64_TOLERANCE){s=!0;var u=p.CurveTessellator.getAdaptiveRenderPoints(c,e,c.getRangeUnlimited());c._tessellationCache.setCache(u),n=Math.max(n,u.tolerance)}c._tessellationCache&&(0===l?(t.push.apply(t,c._tessellationCache.getCache().positions),i.push.apply(i,c._tessellationCache.getCache().params)):(t.push.apply(t,c._tessellationCache.getCache().positions.slice(1)),i.push.apply(i,c._tessellationCache.getCache().params.slice(1))))}}return{positions:t,params:i,didRetessellate:s,tolerance:n}},_.prototype.tessellate=function(e,t){return t=t||s.TESSELLATION.LINEAR_PRECISION,this._tessellationCache.getTessellation(e,this,t,this._getFullTessellation.bind(this))},_.prototype.getBoundingBox=function(e){void 0===e?e=this.getRange():0===e.length&&(e=this.getRangeUnlimited());var t=this._restrictRangeToUnlimited(e),i=new o.BoundingBox,r=this.getRangeUnlimited();if(t[0][0]<r[0]+s.PARAMETER_SPACE_TOLERANCE&&t[0][1]>r[1]-s.PARAMETER_SPACE_TOLERANCE)this.extendBBoxFromControlPoints(i);else for(var n=this.getBezierSegments(),a=0;a<t.length;a++)for(var l=0;l<n.length;l++){var c=n[l];(c=c._getSubset(t[a][0],t[a][1]))&&c.extendBBoxFromControlPoints(i)}return i},_.prototype.getTangentCone=function(e){void 0===e?e=this.getRange():0===e.length&&(e=this.getRangeUnlimited());var t=this.evaluatePosition(e[0]),i=this.evaluatePosition(e[1]);r.Vector3.sub(i,i,t),r.Vector3.squaredLength(i)<.01*s.KERNEL_TOLERANCE*s.KERNEL_TOLERANCE&&(i=this.evaluateDt(.5*(e[0]+e[1]))),r.Vector3.normalize(i,i);for(var o=new n.TangentCone(i,0),a=this._restrictRangeToUnlimited(e),l=r.Vector3.createFloat64FromValues(0,0,0),c=this.getBezierSegments(),u=0;u<a.length;u++)for(var h=0;h<c.length;h++){var d=c[h];if(d=d._getSubset(a[u][0],a[u][1]))for(var p=d._controlPoints,g=0;g<p.length-3;g+=3)l[0]=p[g+3]-p[g],l[1]=p[g+4]-p[g+1],l[2]=p[g+5]-p[g+2],r.Vector3.dot(l,i)>=0?o.includeVector(l):o.angle=Math.PI}return o},_.prototype._getSubset=function(e,t){var i;if(this.isPeriodicUnlimited())return t-e>this.getPeriodUnlimited()-s.PARAMETER_SPACE_TOLERANCE?this:((i=this.clone())._periodicTrimToParams(e,t),i);var r=this.getRangeUnlimited();return e>r[1]-s.PARAMETER_SPACE_TOLERANCE||t<r[0]+s.PARAMETER_SPACE_TOLERANCE?void 0:e<r[0]+s.PARAMETER_SPACE_TOLERANCE&&t>r[1]-s.PARAMETER_SPACE_TOLERANCE?this:(i=this.clone(),e>r[0]+s.PARAMETER_SPACE_TOLERANCE&&i.trimToParam(!0,e),t<r[1]-s.PARAMETER_SPACE_TOLERANCE&&i.trimToParam(!1,t),i)},_.prototype._periodicTrimToParams=function(e,t){h.ConsoleUtils.assert(this._isPeriodic);var i=this.getRangeUnlimited(),r=(0,c.normalizeParametricRangeToShiftedRange)([e,t],i);if(r[1]>i[1])this._isClosed=this._isPeriodic=!1,this.trimToParam(!0,r[1]-(i[1]-i[0]),void 0),this.trimToParam(!1,r[0],void 0);else{var o,n,s=this.getControlPoints(),a=this.getKnotVector(),l=this.getWeights(),u=this.getDegree(),d=this.getPeriodUnlimited(),p=[],f=a.slice(),v=a.slice(),m=[];for(n=0;n<s.length/3;++n)p[4*n+0]=s[3*n+0]*l[n],p[4*n+1]=s[3*n+1]*l[n],p[4*n+2]=s[3*n+2]*l[n],p[4*n+3]=l[n];for(o=p.slice(),g.SplineCurveHelper.extractCurveSegment(u,r[1],i[1],f,p),g.SplineCurveHelper.extractCurveSegment(u,i[0],r[0],v,o),n=0;n<v.length;++n)v[n]=v[n]+d;g.SplineCurveHelper.joinCurves(u,f,p,v,o);var y=p.length/4,_=[];for(m.length=y,_.length=3*y,n=0;n<y;++n){var E=p[4*n+3];_[3*n]=p[4*n]/E,_[3*n+1]=p[4*n+1]/E,_[3*n+2]=p[4*n+2]/E,m[n]=E}this.set(_,m,u,f),this._isClosed=this._isPeriodic=!1}},_.prototype.trimToParam=function(e,t,i){if(this.isPeriodicUnlimited())return h.ConsoleUtils.assert(void 0!==i),void this._periodicTrimToParams(t,i);var r,o,n=this.getControlPoints(),s=this.getKnotVector(),a=this.getWeights(),l=this.getDegree(),c=[];for(r=0;r<n.length/3;++r)c[4*r+0]=n[3*r+0]*a[r],c[4*r+1]=n[3*r+1]*a[r],c[4*r+2]=n[3*r+2]*a[r],c[4*r+3]=a[r];var u=[],d=0,p=g.SplineCurveHelper.insertKnot(l,s,c,t,l),v=(0,f.findKnotSpan)(t,p.U);for(e?(p.U.splice(0,v-l+1,t),o=p.U.length-l-1,d=4*(p.Pw.length/4-o)):(p.U.splice(v+1,p.U.length,t),o=p.U.length-l-1),c.length=3*o,u.length=o,r=0;r<o;++r){var m=p.Pw[4*r+3+d];c[3*r]=p.Pw[4*r+0+d]/m,c[3*r+1]=p.Pw[4*r+1+d]/m,c[3*r+2]=p.Pw[4*r+2+d]/m,u[r]=m}this.set(c,u,l,p.U)},_.prototype.addControlPoint=function(e,t){var i=this.getControlPoints(),o=this.getNumControlPoints(),n=this.getKnotVector(),a=this.getWeights(),c=this.getDegree(),u=this.getControlPointPosition(e),h=this.getControlPointPosition(e+1),d=new l.Line;d.setFromEndpoints(u,h);var p=d.closestToPointParam(t),f=d.evaluatePosition(p),v=r.Vector3.distance(f,u),m=r.Vector3.distance(f,h),y=a[e]*v+a[e+1]*m;if(Math.abs(y)<s.KERNEL_TOLERANCE)console.warn("numerical error in addControlPoints -- coincident control points / negative weights?");else{for(var _=a[e]*v/y,E=n[e+1]+_*(n[e+c+1]-n[e+1]),A=[],x=0;x<i.length/3;++x)A[4*x]=i[3*x]*a[x],A[4*x+1]=i[3*x+1]*a[x],A[4*x+2]=i[3*x+2]*a[x],A[4*x+3]=a[x];var C=g.SplineCurveHelper.findKnotMultiplicity(E,n),w=g.SplineCurveHelper.insertKnot(c,n,A,E,C+1),b=[];for(A.length=3*(o+1),b.length=o+1,x=0;x<=o;++x){var M=w.Pw[4*x+3];A[3*x]=w.Pw[4*x]/M,A[3*x+1]=w.Pw[4*x+1]/M,A[3*x+2]=w.Pw[4*x+2]/M,b[x]=M}this.set(A,b,c,w.U)}},_.prototype.addControlPointOnCurve=function(e){for(var t=this.getNumControlPoints(),i=Number.MAX_VALUE,o=-1,n=r.Vector3.createFloat64FromValues(0,0,0),s=r.Vector3.createFloat64FromValues(0,0,0),a=0;a<t-1;++a){n[0]=this._controlPoints[3*a+0],n[1]=this._controlPoints[3*a+1],s[0]=this._controlPoints[3*a+3],s[1]=this._controlPoints[3*a+4];var l=(0,c.distancePointToLineSegment)(n,s,e);l<i&&(i=l,o=a)}-1!==o&&this.addControlPoint(o,e)},_.prototype.makePeriodic=function(){if(!this.isPeriodicUnlimited()){for(var e=this.getControlPoints(),t=this.getKnotVector(),i=this.getWeights(),r=this.getDegree(),o=[],n=0;n<e.length/3;++n)o[4*n]=e[3*n]*i[n],o[4*n+1]=e[3*n+1]*i[n],o[4*n+2]=e[3*n+2]*i[n],o[4*n+3]=i[n];var s=t.slice();g.SplineCurveHelper.makePeriodic(r,s,o);var a=[],l=[],c=o.length/4;for(a.length=c,l.length=3*c,n=0;n<c;++n){var u=o[4*n+3];l[3*n]=o[4*n]/u,l[3*n+1]=o[4*n+1]/u,l[3*n+2]=o[4*n+2]/u,a[n]=u}this.set(l,a,r,s),this._isClosed=this._isPeriodic=!0}},_.prototype.suggestSplittingParam=function(e){var t,i=this.getKnotVector(),r=.5*(e[0]+e[1]),o=(0,c.sortedIndex)(i,r);if(0===o)t=i[o];else if(o===i.length)t=i[o-1];else{var n=i[o-1],s=i[o];t=r-n<s-r?n:s}return t>=e[0]&&t<=e[1]?t:void 0},_.prototype.toObject=function(){return{degree:this._degree,knots:this._knots,controlPoints:this._controlPoints,weights:this._weights,range:this.rangeToObject(this.getRange(),this.isLimited())}},t.BCurve=_},9984:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Body=void 0;var r=i(9547),o=i(2468),n=i(3344),s=i(7616),a=function(){r.BaseTopology.call(this),this._lumps=[]};(a.prototype=Object.create(r.BaseTopology.prototype)).getTopologyType=function(){return o.TOPOLOGY_TYPES.BODY},a.prototype.getLumps=function(){return this._lumps},a.prototype.setLumps=function(e){this._lumps=new Array(e.length);for(var t=0;t<e.length;++t)this._lumps[t]=e[t]},a.prototype.addLump=function(e){this._lumps?this._lumps.push(e):this._lumps=[e],e.setBody(this)},a.prototype.addLumps=function(e){this._lumps||(this._lumps=[]);for(var t=0;t<e.length;++t)e[t].setBody(this);this._lumps=this._lumps.concat(e)},a.prototype.removeLump=function(e){var t=this._lumps.indexOf(e);return t>-1&&(this._lumps.splice(t,1),e.getBody()===this&&e.setBody(void 0),!0)},a.prototype.getBody=function(){return this},a.prototype.collectFaces=function(e){e=e||new Set;for(var t=0;t<this._lumps.length;++t)this._lumps[t].collectFaces(e);return e},a.prototype.collectEdges=function(e){e=e||new Set;for(var t=0;t<this._lumps.length;++t)this._lumps[t].collectEdges(e);return e},a.prototype.collectVertices=function(e){e=e||new Set;for(var t=0;t<this._lumps.length;++t)this._lumps[t].collectVertices(e);return e},a.prototype.getBoundingBox=function(){for(var e=new n.BoundingBox,t=0;t<this._lumps.length;++t)e.include(this._lumps[t].getBoundingBox());return e},a.prototype.transform=function(e){(0,s.transformTopology)(this,e)},a.prototype.toObject=function(){return{lumps:this.refsToStrings(this._lumps),attributes:this.refsToStrings(this._attributes)}},a.prototype.addToModelObject=function(e){this.addAllToModelObject(e,[this._lumps,this._attributes])},t.Body=a},92:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BSurface=void 0;var r=i(1972),o=i(3344),n=i(2468),s=i(412),a=i(8796),l=i(5896),c=i(6824),u=i(6275),h=i(192),d=i(1288),p=i(880),g=i(4728),f=function(){s.Surface.call(this),this._uDegree=0,this._vDegree=0,this._uKnots=[],this._vKnots=[],this._controlPoints=[],this._weights=[],this._isClosedU=void 0,this._isClosedV=void 0,this._isPeriodicU=void 0,this._isPeriodicV=void 0,this._patches=void 0};(f.prototype=Object.create(s.Surface.prototype)).getGeometryType=function(){return n.GEOMETRY_TYPES.BSURFACE},f.prototype.clone=function(){var e=new f;return e.copy(this),e},f.prototype.copy=function(e){s.Surface.prototype.copy.call(this,e),this._uDegree=e._uDegree,this._vDegree=e._vDegree,this._uKnots=e._uKnots.slice(0),this._vKnots=e._vKnots.slice(0),this._controlPoints=e._controlPoints.slice(0),this._weights=e._weights.slice(0),this._clearCaches()},f.prototype.set=function(e,t,i,r,o,n){g.ConsoleUtils.assert(e>=1),this._uDegree=e,g.ConsoleUtils.assert(t>=1),this._vDegree=t,g.ConsoleUtils.assert(i.length>=2*(e+1)),this._uKnots=Array.prototype.slice.call(i),g.ConsoleUtils.assert(r.length>=2*(t+1)),this._vKnots=Array.prototype.slice.call(r);var s=i.length-e-1,a=r.length-t-1;g.ConsoleUtils.assert(o.length===3*s*a),this._controlPoints=Array.prototype.slice.call(o),n&&n.length>0?(g.ConsoleUtils.assert(n.length===s*a),this._weights=Array.prototype.slice.call(n)):this._weights=[],this._clearCaches()},f.prototype.getDegreeU=function(){return this._uDegree},f.prototype.getDegreeV=function(){return this._vDegree},f.prototype.setDegreeU=function(e){g.ConsoleUtils.assert(e>=1),this._uDegree=e,this._clearCaches()},f.prototype.setDegreeV=function(e){g.ConsoleUtils.assert(e>=1),this._vDegree=e,this._clearCaches()},f.prototype.getNumKnotsU=function(){return this._uKnots.length},f.prototype.getNumKnotsV=function(){return this._vKnots.length},f.prototype.getKnotsU=function(){return this._uKnots},f.prototype.getKnotsV=function(){return this._vKnots},f.prototype.setKnotsU=function(e){this._uKnots=e,this._clearCaches()},f.prototype.setKnotsV=function(e){this._vKnots=e,this._clearCaches()},f.prototype.getNumControlPointsU=function(){return this._uKnots.length-this._uDegree-1},f.prototype.getNumControlPointsV=function(){return this._vKnots.length-this._vDegree-1},f.prototype.getControlPoints=function(){return this._controlPoints},f.prototype.setControlPoints=function(e){this._controlPoints=e,this._clearCaches()},f.prototype.getWeights=function(){return this._weights},f.prototype.setWeights=function(e){e&&e.length>0?this._weights=e:this._weights=[],this._clearCaches()},f.prototype.isRational=function(){return this._weights.length>0},f.prototype.evaluate=function(e,t,i,r,o){g.ConsoleUtils.assert(i>=0),this.isPeriodicUnlimitedU()&&(e=(0,l.normalizeParameterToShiftedRange)(e,this.getRangeUnlimitedU())),this.isPeriodicUnlimitedV()&&(t=(0,l.normalizeParameterToShiftedRange)(t,this.getRangeUnlimitedV()));var n=(0,c.evaluateBSurfaceDerivs)(e,t,Math.min(i,3),this._uDegree,this._vDegree,this._uKnots,this._vKnots,this._controlPoints,this._weights),s={pos:n[0][0]};return i>=1&&(s.du=n[1][0],s.dv=n[0][1]),i>=2&&(s.duu=n[2][0],s.duv=n[1][1],s.dvv=n[0][2]),i>=3&&(s.duuu=n[3][0],s.duuv=n[2][1],s.duvv=n[1][2],s.dvvv=n[0][3]),s},f.prototype.evaluatePosition=function(e,t){return this.isPeriodicUnlimitedU()&&(e=(0,l.normalizeParameterToShiftedRange)(e,this.getRangeUnlimitedU())),this.isPeriodicUnlimitedV()&&(t=(0,l.normalizeParameterToShiftedRange)(t,this.getRangeUnlimitedV())),(0,c.evaluateBSurfacePoint)(e,t,this._uDegree,this._vDegree,this._uKnots,this._vKnots,this._controlPoints,this._weights)},f.prototype.evaluateNormal=function(e,t){return this.isPeriodicUnlimitedU()&&(e=(0,l.normalizeParameterToShiftedRange)(e,this.getRangeUnlimitedU())),this.isPeriodicUnlimitedV()&&(t=(0,l.normalizeParameterToShiftedRange)(t,this.getRangeUnlimitedV())),s.Surface.prototype.evaluateNormal.call(this,e,t)},f.prototype.evaluateDu=function(e,t){return this.isPeriodicUnlimitedU()&&(e=(0,l.normalizeParameterToShiftedRange)(e,this.getRangeUnlimitedU())),this.isPeriodicUnlimitedV()&&(t=(0,l.normalizeParameterToShiftedRange)(t,this.getRangeUnlimitedV())),(0,c.evaluateBSurfaceDerivs)(e,t,1,this._uDegree,this._vDegree,this._uKnots,this._vKnots,this._controlPoints,this._weights)[1][0]},f.prototype.evaluateDv=function(e,t){return this.isPeriodicUnlimitedU()&&(e=(0,l.normalizeParameterToShiftedRange)(e,this.getRangeUnlimitedU())),this.isPeriodicUnlimitedV()&&(t=(0,l.normalizeParameterToShiftedRange)(t,this.getRangeUnlimitedV())),(0,c.evaluateBSurfaceDerivs)(e,t,1,this._uDegree,this._vDegree,this._uKnots,this._vKnots,this._controlPoints,this._weights)[0][1]},f.prototype.insertKnotU=function(e,t){var i=(0,u.insertBSurfaceKnotU)(e,t,this._uDegree,this._vDegree,this._uKnots,this._vKnots,this._controlPoints,this._weights);this._uKnots=i.uknots,this._controlPoints=i.P,this._weights=i.weights||[],this._clearCaches()},f.prototype.insertKnotV=function(e,t){var i=(0,u.insertBSurfaceKnotV)(e,t,this._uDegree,this._vDegree,this._uKnots,this._vKnots,this._controlPoints,this._weights);this._vKnots=i.vknots,this._controlPoints=i.P,this._weights=i.weights||[],this._clearCaches()},f.prototype.relaxToPerpendicular=function(e,t,i,o,n,s,a){var l=this;o&&0!==o.length||(o=this.getRangeU()),n&&0!==n.length||(n=this.getRangeV());var c=(0,p.newtonRaphson2D)((function(t){var i=l.evaluate(t[0],t[1],2);r.Vector3.sub(i.pos,i.pos,e);var o=r.Vector3.dot(i.du,i.pos),n=r.Vector3.dot(i.dv,i.pos),s=r.Vector3.dot(i.duu,i.pos)+r.Vector3.dot(i.du,i.du),a=r.Vector3.dot(i.duv,i.pos)+r.Vector3.dot(i.du,i.dv);return{val:[o,n],deriv1:[s,a],deriv2:[a,r.Vector3.dot(i.dvv,i.pos)+r.Vector3.dot(i.dv,i.dv)]}}),[t,i],[o,n]);return{u:c.param[0],v:c.param[1],status:c.status}},f.prototype.closestParam=function(e){for(var t=r.FLOAT64_TOLERANCE,i=[[this.getRangeU(),this.getRangeV()]],o=this.getBezierPatches(),n=(0,d.closestBSurfacePatches)(e,o,i),s=Number.POSITIVE_INFINITY,a={u:void 0,v:void 0},c=0;c<n.length;++c)if(!(n[c].minDistSqr>s))for(var u=n[c].index,h=o[u[0]][u[1]],p=h.getRangeUnlimitedU(),g=h.getRangeUnlimitedV(),f=0;f<i.length;++f){var v=[Math.max(p[0],i[f][0][0]),Math.min(p[1],i[f][0][1])],m=[Math.max(g[0],i[f][1][0]),Math.min(g[1],i[f][1][1])];if(!(v[1]-v[0]<=r.FLOAT64_TOLERANCE||m[1]-m[0]<=r.FLOAT64_TOLERANCE)){var y=(0,d.closestBSurfacePointApprox)(e,h.getDegreeU(),h.getDegreeV(),h.getKnotsU(),h.getKnotsV(),h.getControlPoints(),h.isRational()?h.getWeights():void 0,v,m),_=this.relaxToPerpendicular(e,y.u,y.v,v,m,t,64),E=h.evaluatePosition(_.u,_.v),A=r.Vector3.squaredDistance(E,e);A<s&&(s=A,a.u=_.u,a.v=_.v)}}return this.isPeriodicUnlimitedU()&&(a.u=(0,l.foldNearTo)(a.u,.5*(this.getRangeU()[0]+this.getRangeU()[1]),this.getPeriodUnlimitedU())),this.isPeriodicUnlimitedV()&&(a.v=(0,l.foldNearTo)(a.v,.5*(this.getRangeV()[0]+this.getRangeV()[1]),this.getPeriodUnlimitedV())),a},f.prototype.vParamLine=function(e){var t=(0,u.extractBSurfaceParamLineV)(e,this._uDegree,this._vDegree,this._uKnots,this._vKnots,this._controlPoints,this._weights),i=t.ctrlPts.length/3;t.weights&&0!==t.weights.length||(t.weights=new Array(i),t.weights.fill(1));var r=new a.BCurve;return r.set(t.ctrlPts,t.weights,this._vDegree,this._vKnots),r},f.prototype.uParamLine=function(e){var t=(0,u.extractBSurfaceParamLineU)(e,this._uDegree,this._vDegree,this._uKnots,this._vKnots,this._controlPoints,this._weights),i=t.ctrlPts.length/3;t.weights&&0!==t.weights.length||(t.weights=new Array(i),t.weights.fill(1));var r=new a.BCurve;return r.set(t.ctrlPts,t.weights,this._uDegree,this._uKnots),r},f.prototype.getBoundingBox=function(e,t){for(var i=new o.BoundingBox,n=r.Vector3.createFloat64(),s=0;s<this._controlPoints.length;s+=3)r.Vector3.set(n,this._controlPoints[s],this._controlPoints[s+1],this._controlPoints[s+2]),i.includePoint(n);return i},f.prototype.transform=function(e){for(var t=r.Vector3.createFloat64(),i=0;i<this._controlPoints.length;i+=3)r.Vector3.set(t,this._controlPoints[i],this._controlPoints[i+1],this._controlPoints[i+2]),r.Vector3.transformMatrix44(t,t,e),this._controlPoints[i]=t[0],this._controlPoints[i+1]=t[1],this._controlPoints[i+2]=t[2];this._clearCaches()},f.prototype.getRangeUnlimitedU=function(){return[this._uKnots[0],this._uKnots[this._uKnots.length-1]]},f.prototype.getRangeUnlimitedV=function(){return[this._vKnots[0],this._vKnots[this._vKnots.length-1]]},f.prototype.isPeriodicUnlimitedU=function(){return this._checkClosure(),this._isPeriodicU},f.prototype.isPeriodicUnlimitedV=function(){return this._checkClosure(),this._isPeriodicV},f.prototype.isClosedUnlimitedU=function(){return this._checkClosure(),this._isClosedU},f.prototype.isClosedUnlimitedV=function(){return this._checkClosure(),this._isClosedV},f.prototype._checkClosure=function(){void 0!==this._isClosedU&&void 0!==this._isPeriodicU||(this._isClosedU=this._isPeriodicU=!1),void 0!==this._isClosedV&&void 0!==this._isPeriodicV||(this._isClosedV=this._isPeriodicV=!1)},f.prototype.isSimpleBezier=function(){return this._uKnots.length===2*this._uDegree+2&&this._vKnots.length===2*this._vDegree+2},f.prototype.getBezierPatches=function(){if(this.isSimpleBezier())return this._patches=void 0,[[this]];if(!this._patches){var e=(0,h.decomposeBSurfaceToBezier)(this._uDegree,this._vDegree,this._uKnots,this._vKnots,this._controlPoints,this._weights);this._patches=[];for(var t=0;t<e.U.length;++t){this._patches[t]=[];for(var i=0;i<e.V.length;++i){var r=new f;r.set(this._uDegree,this._vDegree,e.U[t],e.V[i],e.P[t][i],e.w?e.w[t][i]:void 0),this._patches[t][i]=r}}}return this._patches},f.prototype._clearCaches=function(){this._isClosedU=void 0,this._isClosedV=void 0,this._isPeriodicU=void 0,this._isPeriodicV=void 0,this._patches=void 0},f.prototype.toObject=function(){return{uDegree:this._uDegree,vDegree:this._vDegree,uKnots:this._uKnots,vKnots:this._vKnots,controlPoints:this._controlPoints,weights:this._weights,uRange:this.rangeToObject(this.getRangeU(),this.isLimitedU()),vRange:this.rangeToObject(this.getRangeV(),this.isLimitedV())}},t.BSurface=f},2236:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkValidity=void 0;var r=i(1972),o=i(2468),n=i(1472),s=i(3565),a=i(412),l=i(7616);function c(e){var t=[],i=e.getGuid();return i&&"string"==typeof i||t.push({error:"BaseTopology has invalid GUID",source:[e]}),t}function u(e){var t=c(e),i=0,r=0,n=0,s=e.getLumps();if(s.length>0){for(var a=new Set,l=0;l<s.length;++l){var u=s[l];a.add(u),u&&u.getTopologyType()===o.TOPOLOGY_TYPES.LUMP?u.getBody()!==e&&t.push({error:"Body is not the parent of child Lump",source:[e,u]}):t.push({error:"Body has invalid element in Lump array",source:[e,u]}),i+=u.collectFaces().size,r+=u.collectEdges().size,n+=u.collectVertices().size}a.size!==s.length&&t.push({error:"Body has non-unique Lumps",source:[e]})}return i!==e.collectFaces().size&&t.push({error:"Body has Lumps which share Faces",source:[e]}),r!==e.collectEdges().size&&t.push({error:"Body has Lumps which share Edges",source:[e]}),n!==e.collectVertices().size&&t.push({error:"Body has Lumps which share Vertices",source:[e]}),t}function h(e){var t=c(e),i=e.getBody();i&&i.getTopologyType()!==o.TOPOLOGY_TYPES.BODY&&t.push({error:"Lump has invalid parent Body",source:[e]});var r=0,n=0,s=0,a=e.getShells();if(a.length>0){for(var l=new Set,u=0;u<a.length;++u){var h=a[u];l.add(h),h&&h.getTopologyType()===o.TOPOLOGY_TYPES.SHELL?h.getLump()!==e&&t.push({error:"Lump is not the parent of child Shell",source:[e,h]}):t.push({error:"Lump has invalid element in Shell array",source:[e,h]}),r+=h.collectFaces().size,n+=h.collectEdges().size,s+=h.collectVertices().size}l.size!==a.length&&t.push({error:"Lump has non-unique Shells",source:[e]})}else t.push({error:"Lump has no Shells",source:[e]});return r!==e.collectFaces().size&&t.push({error:"Lump has Shells which share Faces",source:[e]}),n!==e.collectEdges().size&&t.push({error:"Lump has Shells which share Edges",source:[e]}),s!==e.collectVertices().size&&t.push({error:"Lump has Shells which share Vertices",source:[e]}),t}function d(e){var t=c(e),i=e.getLump();i&&i.getTopologyType()!==o.TOPOLOGY_TYPES.LUMP&&t.push({error:"Shell has invalid parent Lump",source:[e]});var r=e.getFaces();if(r.length>0){for(var n=new Set,s=0;s<r.length;++s){var a=r[s];n.add(a),a&&a.getTopologyType()===o.TOPOLOGY_TYPES.FACE?a.getShell()!==e&&t.push({error:"Shell is not the parent of child Face",source:[e,a]}):t.push({error:"Shell has invalid element in Face array",source:[e,a]})}n.size!==r.length&&t.push({error:"Shell has non-unique Faces",source:[e]})}else t.push({error:"Shell has no Faces",source:[e]});1!==(0,l.findConnectedFaces)(e.getFaces()).length&&t.push({error:"Shell is disconnected",source:[e]});var u=e.collectVertices(),h=e.collectEdges(),d=new Set,p=new Set;return u.forEach((function(e){e.collectEdges(d),e.collectFaces(p)})),d.size!==h.size&&t.push({error:"Shell has rogue edges",source:[e]}),u.size>0&&p.size!==e.getFaces().length&&t.push({error:"Shell has rogue faces",source:[e]}),t}function p(e){var t=c(e),i=e.getShell();i&&i.getTopologyType()!==o.TOPOLOGY_TYPES.SHELL&&t.push({error:"Face has invalid parent Shell",source:[e]});var r=0,n=0,s=e.getLoops(),l=e.getSurface();if(s.length>0){for(var u=new Set,h=0;h<s.length;++h){var d=s[h];u.add(d),d&&d.getTopologyType()===o.TOPOLOGY_TYPES.LOOP?d.getFace()!==e&&t.push({error:"Face is not the parent of child Loop",source:[e,d]}):t.push({error:"Face has invalid element in Loop array",source:[e,d]}),r+=d.collectEdges().size,n+=d.collectVertices().size}u.size!==s.length&&t.push({error:"Face has non-unique Loops",source:[e]})}else{var p=l.getGeometryType()===o.GEOMETRY_TYPES.SPHERE,g=l.getGeometryType()===o.GEOMETRY_TYPES.TORUS&&l.isDoughnut();p||g||t.push({error:"Face has no Loops",source:[e]})}return r!==e.collectEdges().size&&t.push({error:"Face has Loops which share Edges",source:[e]}),n!==e.collectVertices().size&&t.push({error:"Face has Loops which share Vertices",source:[e]}),l?l instanceof a.Surface||t.push({error:"Face has invalid Surface geometry",source:[e,l]}):t.push({error:"Face has no Surface geometry",source:[e]}),t}function g(e){var t=c(e),i=e.getFace();i&&i.getTopologyType()!==o.TOPOLOGY_TYPES.FACE&&t.push({error:"Loop has invalid parent Face",source:[e]});var r=e.getCoedges();if(r.length>0){for(var n=new Set,s=0;s<r.length;++s){var a=r[s];if(n.add(a),a&&a.getTopologyType()===o.TOPOLOGY_TYPES.COEDGE){a.getLoop()!==e&&t.push({error:"Loop is not the parent of child Coedge",source:[e,a]});var l=r[(s+1)%r.length];a.getEndVertex()!==l.getStartVertex()&&t.push({error:"Loop has disconnected Coedges",source:[e,a,l]})}else t.push({error:"Loop has invalid element in Coedge array",source:[e,a]})}n.size!==r.length&&t.push({error:"Loop has non-unique Coedges",source:[e]})}else t.push({error:"Loop has no Coedges",source:[e]});return t}function f(e){var t=c(e),i=e.getLoop();i&&i.getTopologyType()!==o.TOPOLOGY_TYPES.LOOP&&t.push({error:"Coedge has invalid parent Loop",source:[e]});var r=e.getBody(),n=new Set,s=e;do{if(n.has(s)){t.push({error:"Coedge partner list does not form a loop",source:[e]});break}if(n.add(s),!s.getPartner()){s!==e&&t.push({error:"Coedge has no partner",source:[e,s]});break}if((s=s.getPartner()).getTopologyType()!==o.TOPOLOGY_TYPES.COEDGE){t.push({error:"Coedge has invalid entry in partner list",source:[e,s]});break}s.getEdge()!==e.getEdge()&&t.push({error:"Coedge partner refers to a different Edge",source:[e,s]}),s.getBody()!==r&&t.push({error:"Coedge partner is part of a different Body",source:[e,s]})}while(s!==e);var a=e.getEdge();return a?a.getTopologyType()!==o.TOPOLOGY_TYPES.EDGE?t.push({error:"Coedge has invalid Edge",source:[e,a]}):(s=a.getCoedge())&&n.has(s)||t.push({error:"Coedge partner list does not include parent of Edge",source:[e,a]}):t.push({error:"Coedge has no Edge",source:[e]}),t}function v(e){var t=c(e),i=e.getCoedge(),s=e.getWire();s&&i?t.push({error:"Edge has too many parents, both Wire and Coedge",source:[e]}):s?s.getTopologyType()!==o.TOPOLOGY_TYPES.WIRE&&t.push({error:"Edge has invalid parent Wire",source:[e]}):i&&i.getTopologyType()!==o.TOPOLOGY_TYPES.COEDGE&&t.push({error:"Edge has invalid parent Coedge",source:[e]});for(var a=e.getVertices(),l=0;l<a.length;++l){var u=a[l];u&&u.getTopologyType()===o.TOPOLOGY_TYPES.VERTEX?u.isAdjacentEdge(e)||t.push({error:"Edge is not adjacent to own Vertex",source:[e,u]}):t.push({error:"Edge has invalid Vertex",source:[e,u]})}var h=e.getCurve();return h?h instanceof n.Curve?t=t.concat(function(e,t){var i=[],n=e.isReversed(),s=e.getRange();if(void 0===s||2!==s.length||void 0===s[0]||void 0===s[1]||s[1]<s[0])return i.push({error:"Edge range is not defined",source:[e,s]}),i;var a=e.getStartVertex(),l=n?-e.t0():e.t0(),c=t.evaluatePosition(l),u=Math.max(o.KERNEL_TOLERANCE,a.getPrecision());r.Vector3.equals(a.getPosition(),c,u)||i.push({error:"Edge start position not consistent with Vertex",source:[e,a,c]});var h=e.getEndVertex(),d=n?-e.t1():e.t1(),p=t.evaluatePosition(d),g=Math.max(o.KERNEL_TOLERANCE,h.getPrecision());return r.Vector3.equals(h.getPosition(),p,g)||i.push({error:"Edge end position not consistent with Vertex",source:[e,h,p]}),e.isClosed()?(a!==h&&i.push({error:"Edge is closed but has different start and end Vertices",source:[e]}),r.Vector3.equals(c,p,o.KERNEL_TOLERANCE)||i.push({error:"Edge is closed but has different start and end positions",source:[e,c,p]}),t.isClosed()||i.push({error:"Edge is closed but its curve is not",source:[e]})):(a===h&&i.push({error:"Edge is open but has same start and end Vertices",source:[e]}),r.Vector3.equals(c,p,o.KERNEL_TOLERANCE)&&i.push({error:"Edge is open but has same start and end positions",source:[e,c,p]})),t.isPeriodic()?Math.abs(d-l)>t.getPeriod()+o.PARAMETER_SPACE_TOLERANCE&&i.push({error:"Edge parameter range is longer than curve period",source:[e]}):((l+o.PARAMETER_SPACE_TOLERANCE<t.getRange()[0]||l-o.PARAMETER_SPACE_TOLERANCE>t.getRange()[1])&&i.push({error:"Edge start parameter is outside of curve range",source:[e]}),(d+o.PARAMETER_SPACE_TOLERANCE<t.getRange()[0]||d-o.PARAMETER_SPACE_TOLERANCE>t.getRange()[1])&&i.push({error:"Edge end parameter is outside of curve range",source:[e]})),i}(e,h)):t.push({error:"Edge has invalid Curve geometry",source:[e,h]}):t=t.concat(function(e){if(e.getWire())return[{error:"Degenerate Edge is part of a Wire",source:[e]}];if(e.getStartVertex()!==e.getEndVertex())return[{error:"Degenerate Edge has different start and end vertices",source:[e]}];var t=Array.from(e.collectFaces());if(0===t.length)return[];if(1!==t.length)return[{error:"Degenerate Edge is part of multiple Faces",source:[e]}];var i=e.getStartVertex().getPosition(),n=t[0].getSurface(),s=n.getGeometryType();if(s===o.GEOMETRY_TYPES.PLANE||s===o.GEOMETRY_TYPES.CYLINDER||s===o.GEOMETRY_TYPES.ELLIPTICAL_CYLINDER||s===o.GEOMETRY_TYPES.SPHERE)return[{error:"Degenerate Edge is on a surface with no singularities",source:[e,n]}];if(s===o.GEOMETRY_TYPES.CONE||s===o.GEOMETRY_TYPES.ELLIPTICAL_CONE){if(!(u=n.getApexPosition()))return[{error:"Degenerate Edge is on a surface with no singularities",source:[e,n]}];if(!r.Vector3.equals(i,u,o.KERNEL_TOLERANCE))return[{error:"Degenerate Edge is not at a surface singularity",source:[e,n]}]}else{if(s!==o.GEOMETRY_TYPES.TORUS)return[{error:"Degenerate Edge is not on an analytic surface",source:[e]}];for(var a=!1,l=n.getSingularUParams(),c=0;c<l.length;++c){var u=n.evaluatePosition(l[c],0);r.Vector3.equals(i,u,o.KERNEL_TOLERANCE)&&(a=!0)}if(!a)return[{error:"Degenerate Edge is not at a surface singularity",source:[e,n]}]}return[]}(e)),t}function m(e){var t=c(e),i=e.getEdges();if(i.length>0)for(var r=e.getBody(),n=0;n<i.length;++n){var a=i[n];a&&a.getTopologyType()===o.TOPOLOGY_TYPES.EDGE?a.getStartVertex()!==e&&a.getEndVertex()!==e?t.push({error:"Vertex is not an end-point of adjacent Edge",source:[e,a]}):a.getBody()!==r&&t.push({error:"Vertex has adjacent Edge from a different body",source:[e,a]}):t.push({error:"Vertex has invalid entry in Edge list",source:[e,a]})}else t.push({error:"Vertex has no adjacent Edges",source:[e]});var l=e.getPoint();return l?l instanceof s.Point||t.push({error:"Vertex has invalid Point geometry",source:[e,l]}):t.push({error:"Vertex has no Point geometry",source:[e]}),t}function y(e){var t=c(e),i=0,r=0,n=e.getWires();if(n.length>0){for(var s=new Set,a=0;a<n.length;++a){var l=n[a];s.add(l),l&&l.getTopologyType()===o.TOPOLOGY_TYPES.WIRE?l.getWireBody()!==e&&t.push({error:"WireBody is not the parent of child Wire",source:[e,l]}):t.push({error:"WireBody has invalid element in Wire array",source:[e,l]}),i+=l.collectEdges().size,r+=l.collectVertices().size}s.size!==n.length&&t.push({error:"WireBody has non-unique Wires",source:[e]})}else t.push({error:"WireBody has no Wires",source:[e]});return i!==e.collectEdges().size&&t.push({error:"WireBody has Wires which share Edges",source:[e]}),r!==e.collectVertices().size&&t.push({error:"WireBody has Wires which share Vertices",source:[e]}),t}function _(e){var t=c(e),i=e.getWireBody();i&&i.getTopologyType()!==o.TOPOLOGY_TYPES.WIREBODY&&t.push({error:"Wire has invalid parent WireBody",source:[e]});var r=e.getEdges();if(r.length>0){for(var n=new Set,s=0;s<r.length;++s){var a=r[s];n.add(a),a&&a.getTopologyType()===o.TOPOLOGY_TYPES.EDGE?a.getWire()!==e&&t.push({error:"Wire is not the parent of child Edge",source:[e,a]}):t.push({error:"Wire has invalid element in Edge array",source:[e,a]})}n.size!==r.length&&t.push({error:"Wire has non-unique Edges",source:[e]});var u=(0,l.findConnectedEdges)(r);1!==u.length?t.push({error:"Wire is not a connected set of Edges",source:[e]}):u[0].length!==r.length&&t.push({error:"Wire is connected to other unknown Edges",source:[e]})}else t.push({error:"Wire has no Edges",source:[e]});return t}t.checkValidity=function(e){for(var t,i,r,n=[],s=[e],a=new Set,l=new Map;s.length>0;){a.clear();var c=new Set;for(t=0;t<s.length;++t){switch((i=s[t]).getTopologyType()){case o.TOPOLOGY_TYPES.BODY:n=n.concat(u(i)),i.getLumps().forEach((function(e){a.add(e)}));break;case o.TOPOLOGY_TYPES.LUMP:n=n.concat(h(i)),i.getShells().forEach((function(e){a.add(e)}));break;case o.TOPOLOGY_TYPES.SHELL:n=n.concat(d(i)),i.getFaces().forEach((function(e){a.add(e)}));break;case o.TOPOLOGY_TYPES.FACE:n=n.concat(p(i)),i.getLoops().forEach((function(e){a.add(e)})),i.getSurface()&&c.add(i.getSurface());break;case o.TOPOLOGY_TYPES.LOOP:n=n.concat(g(i)),i.getCoedges().forEach((function(e){a.add(e)}));break;case o.TOPOLOGY_TYPES.COEDGE:n=n.concat(f(i)),a.add(i.getEdge());break;case o.TOPOLOGY_TYPES.EDGE:n=n.concat(v(i)),i.getVertices().forEach((function(e){e&&a.add(e)})),i.getCurve()&&c.add(i.getCurve());break;case o.TOPOLOGY_TYPES.VERTEX:n=n.concat(m(i)),i.getPoint()&&c.add(i.getPoint());break;case o.TOPOLOGY_TYPES.WIREBODY:n=n.concat(y(i)),i.getWires().forEach((function(e){a.add(e)}));break;case o.TOPOLOGY_TYPES.WIRE:n=n.concat(_(i)),i.getEdges().forEach((function(e){a.add(e)}))}r=i.getGuid(),l.has(r)?n.push({error:"Objects have clashing GUIDs",source:[i,l.get(r)]}):l.set(r,i)}for(c=Array.from(c),t=0;t<c.length;++t)r=(i=c[t]).getGuid(),l.has(r)?n.push({error:"Objects have clashing GUIDs",source:[i,l.get(r)]}):l.set(r,i);s=Array.from(a)}return n}},5512:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Circle=void 0;var r=i(1972),o=i(3344),n=i(2355),s=i(2468),a=i(1472),l=i(5896),c=i(4728),u=i(4336),h=function(){a.Curve.call(this),this._center=r.Vector3.createFloat64FromValues(0,0,0),this._normal=r.Vector3.createFloat64FromValues(0,0,1),this._xAxis=r.Vector3.createFloat64FromValues(1,0,0),this._yAxis=r.Vector3.createFloat64FromValues(0,1,0),this._radius=1};(h.prototype=Object.create(a.Curve.prototype)).getGeometryType=function(){return s.GEOMETRY_TYPES.CIRCLE},h.prototype.set=function(e,t,i){c.ConsoleUtils.assert(r.Vector3.squaredLength(t)>s.KERNEL_TOLERANCE*s.KERNEL_TOLERANCE),c.ConsoleUtils.assert(r.Vector3.squaredLength(i)>s.KERNEL_TOLERANCE*s.KERNEL_TOLERANCE),c.ConsoleUtils.assert(r.Vector3.isOrthogonal(t,i,s.KERNEL_ANGULAR_TOLERANCE)),r.Vector3.copy(this._center,e),r.Vector3.normalize(this._normal,t),r.Vector3.normalize(this._xAxis,i),this._radius=r.Vector3.length(i),this._computeYAxis()},h.prototype._computeYAxis=function(){r.Vector3.cross(this._yAxis,this._normal,this._xAxis)},h.prototype.clone=function(){var e=new h;return e.copy(this),e},h.prototype.getCenter=function(){return this._center},h.prototype.getNormal=function(){return this._normal},h.prototype.setNormal=function(e){c.ConsoleUtils.assert(r.Vector3.squaredLength(e)>s.KERNEL_TOLERANCE*s.KERNEL_TOLERANCE),this._normal!==e&&(r.Vector3.normalize(this._normal,e),r.Vector3.isOrthogonal(this._xAxis,this._normal)||(r.Vector3.computeOrthogonal(this._xAxis,this._normal),r.Vector3.normalize(this._xAxis,this._xAxis)),this._computeYAxis())},h.prototype.getRadius=function(){return this._radius},h.prototype.setRadius=function(e){c.ConsoleUtils.assert(e>s.KERNEL_TOLERANCE),this._radius=e},h.prototype.setCenter=function(e){r.Vector3.copy(this._center,e)},h.prototype.setOrigin=function(e){c.ConsoleUtils.assert(r.Vector3.squaredLength(e)>s.KERNEL_TOLERANCE*s.KERNEL_TOLERANCE),c.ConsoleUtils.assert(r.Vector3.isOrthogonal(e,this._normal,s.KERNEL_ANGULAR_TOLERANCE)),r.Vector3.normalize(this._xAxis,e),this._computeYAxis()},h.prototype.copy=function(e){a.Curve.prototype.copy.call(this,e),r.Vector3.copy(this._xAxis,e._xAxis),r.Vector3.copy(this._yAxis,e._yAxis),this._radius=e._radius,r.Vector3.copy(this._center,e._center),r.Vector3.copy(this._normal,e._normal)},h.prototype.getRangeUnlimited=function(){return[-Math.PI,Math.PI]},h.prototype.isPeriodicUnlimited=function(){return!0},h.prototype.isClosedUnlimited=function(){return!0},h.prototype._computeRadiusVector=function(){return r.Vector3.scale(r.Vector3.createFloat64(),this._xAxis,this._radius)},h.prototype.tessellate=function(e,t){t=t||s.TESSELLATION.LINEAR_PRECISION;var i={positions:[],offsets:[],tolerance:0};i.offsets.push(0);for(var r=e[0],o=1;o<e.length;++o){var n=e[o],a=u.CurveTessellator.getCircularArcRenderPoints(this,[r,n],t,1===o,i.positions);i.offsets.push(i.positions.length-1),r=n,i.tolerance=Math.max(i.tolerance,a)}return i},h.prototype.evaluatePosition=function(e){var t=r.Vector3.createFloat64FromValues(0,0,0);return r.Vector3.scaleAndAdd(t,t,this._xAxis,Math.cos(e)*this._radius),r.Vector3.scaleAndAdd(t,t,this._yAxis,Math.sin(e)*this._radius),r.Vector3.add(t,t,this._center),t},h.prototype.evaluateDt=function(e){var t=r.Vector3.createFloat64FromValues(0,0,0);return r.Vector3.scaleAndAdd(t,t,this._xAxis,-Math.sin(e)*this._radius),r.Vector3.scaleAndAdd(t,t,this._yAxis,Math.cos(e)*this._radius),t},h.prototype.evaluateDtt=function(e){var t=r.Vector3.createFloat64FromValues(0,0,0);return r.Vector3.scaleAndAdd(t,t,this._xAxis,-Math.cos(e)*this._radius),r.Vector3.scaleAndAdd(t,t,this._yAxis,-Math.sin(e)*this._radius),t},h.prototype.tangentLength=function(e){return this.getRadius()},h.prototype.getArcLength=function(e){return void 0===e?e=this.getRange():0===e.length&&(e=this.getRangeUnlimited()),this.getRadius()*(e[1]-e[0])},h.prototype.getParameterFromArcLength=function(e,t){void 0===t?t=this.getRange():0===t.length&&(t=this.getRangeUnlimited());var i=t[0]+e/this.getRadius();return(0,l.clamp)(i,t[0],t[1])},h.prototype.getBoundingBox=function(e){void 0===e?e=this.getRange():0===e.length&&(e=this.getRangeUnlimited());var t=(0,l.minMaxCosSinFunc)(this._xAxis[0]*this._radius,this._yAxis[0]*this._radius,this._center[0],e),i=(0,l.minMaxCosSinFunc)(this._xAxis[1]*this._radius,this._yAxis[1]*this._radius,this._center[1],e),r=(0,l.minMaxCosSinFunc)(this._xAxis[2]*this._radius,this._yAxis[2]*this._radius,this._center[2],e),n=new o.BoundingBox;return n.min[0]=t[0],n.max[0]=t[1],n.min[1]=i[0],n.max[1]=i[1],n.min[2]=r[0],n.max[2]=r[1],n},h.prototype.getTangentCone=function(e){void 0===e?e=this.getRange():0===e.length&&(e=this.getRangeUnlimited());var t=.5*(e[0]+e[1]),i=r.Vector3.createFloat64FromValues(0,0,0);r.Vector3.scaleAndAdd(i,i,this._xAxis,-Math.sin(t)),r.Vector3.scaleAndAdd(i,i,this._yAxis,Math.cos(t));var o=Math.min(Math.PI,.5*(e[1]-e[0]));return new n.TangentCone(i,o)},h.prototype.closestToRayParam=function(e,t,i){var o=r.Vector3.createFloat64();r.Vector3.sub(o,this._center,e);var n=r.Vector3.dot(o,this._normal)/r.Vector3.dot(t,this._normal);if(isFinite(n)){var s=r.Vector3.createFloat64();return r.Vector3.scaleAndAdd(s,e,t,n),this.closestToPointParam(s,i)}},h.prototype.getRadiusAndRangeFromEndpoints=function(e,t,i){var o=r.Vector3.createFloat64();r.Vector3.sub(o,e,this._center);var n=r.Vector3.createFloat64();r.Vector3.sub(n,t,this._center);var a,c=.5*(r.Vector3.length(o)+r.Vector3.length(n)),u=r.Vector3.dot(o,this._xAxis),h=r.Vector3.dot(o,this._yAxis),d=(0,l.normalizeAngle)(Math.atan2(h,u));if(e===t||r.Vector3.squaredDistance(e,t)<s.KERNEL_TOLERANCE*s.KERNEL_TOLERANCE)a=d+l.PI2;else{var p=r.Vector3.dot(n,this._xAxis),g=r.Vector3.dot(n,this._yAxis);if((a=(0,l.normalizeAngle)(Math.atan2(g,p)))<d&&(a+=l.PI2),i){var f=a;a=d,d=f-l.PI2}}return{radius:c,range:[d,a]}},h.prototype.closestToPointParam=function(e,t){void 0===t?t=this.getRange():0===t.length&&(t=this.getRangeUnlimited());var i=r.Vector3.createFloat64();r.Vector3.sub(i,e,this._center);var o,n=r.Vector3.dot(i,this._xAxis),a=r.Vector3.dot(i,this._yAxis);return o=n*n+a*a<s.KERNEL_TOLERANCE*s.KERNEL_TOLERANCE?.5*Math.PI:Math.atan2(a,n),o=(0,l.foldNearTo)(o,.5*(t[0]+t[1]),2*Math.PI),(0,l.clamp)(o,t[0],t[1])},h.prototype.transform=function(e){r.Vector3.transformMatrix44(this._center,this._center,e),r.Vector3.transformAsDirectionMatrix44(this._normal,this._normal,e),r.Vector3.scale(this._xAxis,this._xAxis,this._radius),r.Vector3.transformAsDirectionMatrix44(this._xAxis,this._xAxis,e),this._radius=r.Vector3.length(this._xAxis),r.Vector3.normalize(this._normal,this._normal),r.Vector3.normalize(this._xAxis,this._xAxis),this._computeYAxis()},h.prototype.suggestSplittingParam=function(e){},h.prototype.toObject=function(){const e=this.evaluatePosition(0);return r.Vector3.sub(e,e,this.getCenter()),{center:this.vectorToObject(this._center),radius:this.vectorToObject(e),normal:this.vectorToObject(this._normal),range:this.rangeToObject(this.getRange(),this.isLimited())}},t.Circle=h},672:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Coedge=void 0;var r=i(1972),o=i(9547),n=i(2468),s=i(4728),a=i(5896),l=i(5416),c=function(e){o.BaseTopology.call(this),this._reversed=!1,this._edge=e,this._loop=void 0,this._partner=void 0,this._uvCurve=void 0};(c.prototype=Object.create(o.BaseTopology.prototype)).getTopologyType=function(){return n.TOPOLOGY_TYPES.COEDGE},c.prototype.getEdge=function(){return this._edge},c.prototype.getLoop=function(){return this._loop},c.prototype.getPartner=function(){return this._partner},c.prototype.setEdge=function(e){this._edge=e},c.prototype.setLoop=function(e){this._loop=e},c.prototype.setPartner=function(e){this._partner=e},c.prototype.getStartVertex=function(){return this._reversed?this._edge.getEndVertex():this._edge.getStartVertex()},c.prototype.getEndVertex=function(){return this._reversed?this._edge.getStartVertex():this._edge.getEndVertex()},c.prototype.getFace=function(){return this._loop?this._loop.getFace():void 0},c.prototype.getNext=function(){if(this._loop){var e=this._loop.getCoedges(),t=e.indexOf(this);return s.ConsoleUtils.assert(t>=0),e[(t+1)%e.length]}},c.prototype.getPrevious=function(){if(this._loop){var e=this._loop.getCoedges(),t=e.indexOf(this);return s.ConsoleUtils.assert(t>=0),e[(0,a.modulus)(t-1,e.length)]}},c.prototype.isReversed=function(){return this._reversed},c.prototype.setReversed=function(e){this._reversed=e},c.prototype.getRange=function(){if(this._edge)return this._reversed?[-this._edge.t1(),-this._edge.t0()]:[this._edge.t0(),this._edge.t1()]},c.prototype.t0=function(){if(this._edge)return this._reversed?-this._edge.t1():this._edge.t0()},c.prototype.t1=function(){if(this._edge)return this._reversed?-this._edge.t0():this._edge.t1()},c.prototype.evaluatePosition=function(e){if(this._edge)return this.isReversed()&&(e=-e),this._edge.evaluatePosition(e)},c.prototype.evaluateDt=function(e){if(this._edge){this.isReversed()&&(e=-e);var t=this._edge.evaluateDt(e);return this.isReversed()&&r.Vector3.negate(t,t),t}},c.prototype.evaluateCurvature=function(e,t){if(this._edge)return this.isReversed()&&(e=-e),this._edge.evaluateCurvature(e,t)},c.prototype.evaluateFaceUV=function(e){var t=this.getFace();if(t){var i=this.evaluatePosition(e);return t.closestParam(i)}},c.prototype.evaluateInwardDirection=function(e){var t=this.getFace();if(t){var i=this.evaluateDt(e),o=this.evaluateFaceUV(e),n=t.evaluateNormal(o.u,o.v),s=[0,0,0];return r.Vector3.cross(s,n,i),r.Vector3.normalize(s,s),s}},c.prototype.getBoundingBox=function(){if(this._edge)return this._edge.getBoundingBox()},c.prototype.generateUVCurve=function(e){if(!this._uvCurve&&this._edge){var t=this._edge.getCurve();if(t&&this._loop&&this._loop.getFace()){var i=this._loop.getFace().getSurface();i&&i.getGeometryType()===n.GEOMETRY_TYPES.PLANE&&(e||(e=(0,a.getPlaneTransforms)(i).threeSpaceToUV),e?(this._uvCurve=t.clone(),this._uvCurve.transform(e)):this._uvCurve=t)}}},c.prototype.resetUVCurve=function(){this._uvCurve=void 0},c.prototype.uvAngleSubtended=function(e){var t=this._loop.getFace().getSurface().closestParam(e),i=[t.u,t.v,0];this.generateUVCurve(),s.ConsoleUtils.assert(this._uvCurve);var o=this.getRange(),c=1;this.isReversed()!==this._edge.isReversed()&&(o=[-o[1],-o[0]],c=-1),this._loop&&this._loop.getFace()&&this._loop.getFace().isReversed()&&(c*=-1);var u=!1,h=this._uvCurve.getRange();this._uvCurve.isClosed()&&o[1]-o[0]>=h[1]-h[0]-2*n.PARAMETER_SPACE_TOLERANCE&&(u=!0);var d=this._uvCurve.evaluatePosition(o[0]),p=this._uvCurve.evaluatePosition(o[1]),g=r.Vector3.createFloat64();r.Vector3.sub(g,d,i),r.Vector3.normalize(g,g);var f=r.Vector3.createFloat64();r.Vector3.sub(f,p,i),r.Vector3.normalize(f,f);var v=(0,a.getSignedAngle)(g,f),m=v<0,y=!1,_=!1;switch(this._edge.getCurveType()){case n.GEOMETRY_TYPES.LINE:break;case n.GEOMETRY_TYPES.CIRCLE:_=this._uvCurve.getNormal()[2]>0,y=r.Vector3.distance(i,this._uvCurve.getCenter())<this._uvCurve.getRadius(),u||(y=y&&m!==_);break;case n.GEOMETRY_TYPES.ELLIPSE:_=this._uvCurve.getNormal()[2]>0;var E=r.Vector3.sub([0,0,0],i,this._uvCurve.getCenter()),A=r.Vector3.dot(E,this._uvCurve.getMajorAxis())/this._uvCurve.getMajorRadius(),x=r.Vector3.dot(E,this._uvCurve.getMinorAxis())/this._uvCurve.getMinorRadius();y=A*A+x*x<=1,u||(y=y&&m!==_);break;case n.GEOMETRY_TYPES.BCURVE:this._uvCurve.isPlanarXY()||console.warn("Unsupported non-planar curve for uvAngleSubtended");var C=[i[0],i[1]];y=l.SplineCurveHelper.isPointInsideSplineRegionXYPlanar3D(C,this._uvCurve,o),_=!0;break;default:throw new Error("Unsupported curve type for uvAngleSubtended")}return u?v=y?2*Math.PI*(_?-1:1):0:y&&(v<0?v=2*Math.PI+v:v-=2*Math.PI),v*c},c.prototype.getBody=function(){return this._loop?this._loop.getBody():void 0},c.prototype.collectFaces=function(e){return e=e||new Set,this._loop&&this._loop.collectFaces(e),e},c.prototype.collectEdges=function(e){return e=e||new Set,this._edge&&e.add(this._edge),e},c.prototype.collectVertices=function(e){return e=e||new Set,this._edge&&this._edge.collectVertices(e),e},c.prototype.toString=function(){return"Coedge"},c.prototype.toObject=function(){return{edge:this.refToString(this._edge),partner:this.refToString(this._partner),reversed:this._reversed,attributes:this.refsToStrings(this._attributes)}},c.prototype.addToModelObject=function(e){this.addAllToModelObject(e,[this._edge,this._attributes])},t.Coedge=c},2984:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Cone=void 0;var r=i(1972),o=i(3344),n=i(2468),s=i(412),a=i(3565),l=i(1096),c=i(5512),u=i(4728),h=function(){s.Surface.call(this),this._center=r.Vector3.createFloat64(),this._radius=0,this._angle=0,this._uScale=1,this._xAxis=r.Vector3.createFloat64(),this._yAxis=r.Vector3.createFloat64(),this._zAxis=r.Vector3.createFloat64()};(h.prototype=Object.create(s.Surface.prototype)).getGeometryType=function(){return n.GEOMETRY_TYPES.CONE},h.prototype.clone=function(){var e=new h;return e.copy(this),e},h.prototype.copy=function(e){s.Surface.prototype.copy.call(this,e),this._radius=e._radius,this._angle=e._angle,this._uScale=e._uScale,r.Vector3.copy(this._center,e._center),r.Vector3.copy(this._xAxis,e._xAxis),r.Vector3.copy(this._yAxis,e._yAxis),r.Vector3.copy(this._zAxis,e._zAxis)},h.prototype._computeYAxis=function(){r.Vector3.cross(this._yAxis,this._xAxis,this._zAxis)},h.prototype.set=function(e,t,i,o,s,a){r.Vector3.copy(this._center,e),u.ConsoleUtils.assert(t>n.KERNEL_TOLERANCE),this._radius=t,u.ConsoleUtils.assert(r.Vector3.squaredLength(i)>n.KERNEL_TOLERANCE*n.KERNEL_TOLERANCE),r.Vector3.normalize(this._zAxis,i),u.ConsoleUtils.assert(Math.abs(o)<Math.PI/2),this._angle=o,void 0!==s&&r.Vector3.squaredLength(s)>n.KERNEL_TOLERANCE*n.KERNEL_TOLERANCE?(u.ConsoleUtils.assert(r.Vector3.isOrthogonal(i,s,n.KERNEL_ANGULAR_TOLERANCE)),r.Vector3.normalize(this._xAxis,s)):(r.Vector3.computeOrthogonal(this._xAxis,this._zAxis),r.Vector3.normalize(this._xAxis,this._xAxis)),this._uScale=a||1,u.ConsoleUtils.assert(this._uScale>n.PARAMETER_SPACE_TOLERANCE),this._computeYAxis()},h.prototype.getRadius=function(){return this._radius},h.prototype.setRadius=function(e){u.ConsoleUtils.assert(e>n.KERNEL_TOLERANCE),this._radius=e},h.prototype.getCenter=function(){return this._center},h.prototype.setCenter=function(e){r.Vector3.copy(this._center,e)},h.prototype.getAxisDir=function(){return this._zAxis},h.prototype.setAxisDir=function(e){u.ConsoleUtils.assert(r.Vector3.squaredLength(e)>n.KERNEL_TOLERANCE*n.KERNEL_TOLERANCE),r.Vector3.normalize(this._zAxis,e),(r.Vector3.squaredLength(this._xAxis)<=n.KERNEL_TOLERANCE*n.KERNEL_TOLERANCE||!r.Vector3.isOrthogonal(this._xAxis,this._zAxis,n.KERNEL_ANGULAR_TOLERANCE))&&(r.Vector3.computeOrthogonal(this._xAxis,this._zAxis),r.Vector3.normalize(this._xAxis,this._xAxis)),this._computeYAxis()},h.prototype.getUvOriginDir=function(){return this._xAxis},h.prototype.setUvOriginDir=function(e){u.ConsoleUtils.assert(r.Vector3.squaredLength(e)>n.KERNEL_TOLERANCE*n.KERNEL_TOLERANCE),r.Vector3.normalize(this._xAxis,e),this._computeYAxis()},h.prototype.getUScale=function(){return this._uScale},h.prototype.setUScale=function(e){u.ConsoleUtils.assert(e>n.PARAMETER_SPACE_TOLERANCE),this._uScale=e},h.prototype.getAngle=function(){return this._angle},h.prototype.setAngle=function(e){u.ConsoleUtils.assert(Math.abs(e)<Math.PI/2-n.KERNEL_ANGULAR_TOLERANCE),this._angle=e},h.prototype.isCylinder=function(){return Math.abs(this._angle)<n.KERNEL_ANGULAR_TOLERANCE},h.prototype.getApexParam=function(){return this.isCylinder()?void 0:-this._radius/(this._uScale*Math.sin(this._angle))},h.prototype.getApexPosition=function(){if(!this.isCylinder()){var e=-this._radius/Math.tan(this._angle),t=r.Vector3.clone(this._center);return r.Vector3.scaleAndAdd(t,t,this._zAxis,e),t}},h.prototype.evaluatePosition=function(e,t){var i=this._radius+e*this._uScale*Math.sin(this._angle),o=i*Math.cos(t),n=i*Math.sin(t),s=e*this._uScale*Math.cos(this._angle),a=r.Vector3.clone(this._center);return r.Vector3.scaleAndAdd(a,a,this._xAxis,o),r.Vector3.scaleAndAdd(a,a,this._yAxis,n),r.Vector3.scaleAndAdd(a,a,this._zAxis,s),a},h.prototype.evaluateNormal=function(e,t){var i=Math.sin(this._angle),o=Math.cos(this._angle),n=o*Math.cos(t),s=o*Math.sin(t),a=-i,l=r.Vector3.createFloat64();return r.Vector3.scale(l,this._xAxis,n),r.Vector3.scaleAndAdd(l,l,this._yAxis,s),r.Vector3.scaleAndAdd(l,l,this._zAxis,a),l},h.prototype.evaluateDu=function(e,t){var i=this._uScale*Math.sin(this._angle),o=i*Math.cos(t),n=i*Math.sin(t),s=this._uScale*Math.cos(this._angle),a=r.Vector3.createFloat64();return r.Vector3.scale(a,this._xAxis,o),r.Vector3.scaleAndAdd(a,a,this._yAxis,n),r.Vector3.scaleAndAdd(a,a,this._zAxis,s),a},h.prototype.evaluateDv=function(e,t){var i=this._radius+e*this._uScale*Math.sin(this._angle),o=-i*Math.sin(t),n=i*Math.cos(t),s=r.Vector3.createFloat64();return r.Vector3.scale(s,this._xAxis,o),r.Vector3.scaleAndAdd(s,s,this._yAxis,n),s},h.prototype.closestParam=function(e){var t=Math.sin(this._angle),i=Math.cos(this._angle),o=r.Vector3.createFloat64();r.Vector3.sub(o,e,this._center);var s=r.Vector3.dot(o,this._xAxis),a=r.Vector3.dot(o,this._yAxis),l=r.Vector3.dot(o,this._zAxis),c=Math.sqrt(s*s+a*a),u=this.getApexParam();if(void 0!==u){var h=u*this._uScale*i;(h>0&&l>h||h<0&&l<h)&&(s=-s,a=-a,c=-c)}return{u:((c-this._radius)*t+l*i)/this._uScale,v:Math.abs(c)>n.KERNEL_TOLERANCE?Math.atan2(a,s):0}},h.prototype.vParamLine=function(e){var t=this._radius+e*this._uScale*Math.sin(this._angle);if(Math.abs(t)>n.KERNEL_TOLERANCE){var i=new c.Circle,o=r.Vector3.clone(this._center),s=e*this._uScale*Math.cos(this._angle);r.Vector3.scaleAndAdd(o,o,this._zAxis,s);var l=r.Vector3.clone(this._xAxis);r.Vector3.scale(l,l,t);var u=r.Vector3.clone(this._zAxis);return r.Vector3.negate(u,u),i.set(o,u,l),i}return new a.Point(this.getApexPosition())},h.prototype.uParamLine=function(e){var t=new l.Line,i=r.Vector3.clone(this._center),o=this._radius*Math.cos(e),n=this._radius*Math.sin(e);return r.Vector3.scaleAndAdd(i,i,this._xAxis,o),r.Vector3.scaleAndAdd(i,i,this._yAxis,n),t.set(i,this.evaluateDu(0,e)),t},h.prototype.getBoundingBox=function(e,t){if(e){var i=e[0],r=e[1],n=this.vParamLine(i).getBoundingBox(t);return n.include(this.vParamLine(r).getBoundingBox(t)),n}return new o.BoundingBox([-1/0,-1/0,-1/0],[1/0,1/0,1/0])},h.prototype.transform=function(e){r.Vector3.transformMatrix44(this._center,this._center,e),r.Vector3.transformAsDirectionMatrix44(this._xAxis,this._xAxis,e),r.Vector3.transformAsDirectionMatrix44(this._yAxis,this._yAxis,e),r.Vector3.transformAsDirectionMatrix44(this._zAxis,this._zAxis,e);var t=r.Vector3.length(this._xAxis);this._radius*=t,this._uScale*=t,r.Vector3.normalize(this._xAxis,this._xAxis),r.Vector3.normalize(this._yAxis,this._yAxis),r.Vector3.normalize(this._zAxis,this._zAxis)},h.prototype.getRangeUnlimitedU=function(){return[-1/0,1/0]},h.prototype.getRangeUnlimitedV=function(){return[-Math.PI,Math.PI]},h.prototype.isPeriodicUnlimitedU=function(){return!1},h.prototype.isPeriodicUnlimitedV=function(){return!0},h.prototype.isClosedUnlimitedU=function(){return!1},h.prototype.isClosedUnlimitedV=function(){return!0},h.prototype.toObject=function(){const e=this.evaluatePosition(0,0);return r.Vector3.sub(e,e,this.getCenter()),{center:this.vectorToObject(this._center),radius:this.vectorToObject(e),axis:this.vectorToObject(this.getAxisDir()),uCoordScale:this.getUScale(),angle:this.getAngle(),uRange:this.rangeToObject(this.getRangeU(),this.isLimitedU()),vRange:this.rangeToObject(this.getRangeV(),this.isLimitedV())}},t.Cone=h},1472:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Curve=void 0;var r=i(1972),o=i(9024),n=i(2468),s=i(5896),a=i(4728),l=function(){o.BaseGeometry.call(this),this._subrange=[]};(l.prototype=Object.create(o.BaseGeometry.prototype)).copy=function(e){o.BaseGeometry.prototype.copy.call(this,e),this._subrange=e.isLimited()?[e._subrange[0],e._subrange[1]]:[]},l.prototype.isLimited=function(){return this._subrange.length>0},l.prototype.getRange=function(){return this.isLimited()?this._subrange:this.getRangeUnlimited()},l.prototype.getRangeUnlimited=function(){console.warn("Curve.getRangeUnlimited : abstract method invoked!")},l.prototype.limitRange=function(e){this._subrange=(0,s.limitRange)(this.getRange(),e,this.isPeriodic(),this.getPeriod())},l.prototype.unlimitRange=function(){this._subrange=[]},l.prototype.isPeriodic=function(){return this.isPeriodicUnlimited()&&!this.isLimited()},l.prototype.isPeriodicUnlimited=function(){console.warn("Curve.isPeriodicUnlimited : abstract method invoked!")},l.prototype.getPeriod=function(){return this.isLimited()?void 0:this.getPeriodUnlimited()},l.prototype.getPeriodUnlimited=function(){if(this.isPeriodicUnlimited()){var e=this.getRangeUnlimited();return e[1]-e[0]}},l.prototype.isClosed=function(){if(this.isClosedUnlimited()){if(this.isLimited()){var e=this.getRangeUnlimited(),t=e[1]-e[0];return this._subrange[1]-this._subrange[0]>t-n.PARAMETER_SPACE_TOLERANCE}return!0}return!1},l.prototype.isClosedUnlimited=function(){console.warn("Curve.isClosedUnlimited : abstract method invoked!")},l.prototype._restrictRangeToUnlimited=function(e){a.ConsoleUtils.assert(2===e.length),a.ConsoleUtils.assert(e[0]<=e[1]);var t=this.getRangeUnlimited(),i=[];if(this.isPeriodicUnlimited()){var o=t[1]-t[0];if(e[1]-e[0]>o-n.PARAMETER_SPACE_TOLERANCE)i.push([t[0],t[1]]);else{var l=(0,s.foldAbove)(e[0],t[0],o)-e[0];i.push([e[0]+l,e[1]+l]),i[0][1]>t[1]+n.PARAMETER_SPACE_TOLERANCE&&(i.push([t[0],i[0][1]-o]),i[0][1]=t[1])}}else{var c=Math.max(e[0],t[0]),u=Math.min(e[1],t[1]);c>t[1]?c<t[1]+r.FLOAT64_TOLERANCE&&i.push([t[1],t[1]]):u<t[0]?u>t[0]-r.FLOAT64_TOLERANCE&&i.push([t[0],t[0]]):i.push([c,u])}return i},l.prototype.transform=function(e){console.warn("Curve.transform : abstract method invoked! Doing nothing.")},l.prototype.evaluatePosition=function(e){console.warn("Curve.evaluatePosition : abstract method invoked! Returning undefined.")},l.prototype.evaluateDt=function(e){console.warn("Curve.evaluateDt : abstract method invoked! Returning undefined.")},l.prototype.evaluateCurvature=function(e,t){var i=this.evaluateDt(e),o=this.evaluateDt(e+n.KERNEL_TOLERANCE);r.Vector3.sub(o,o,i);var s=r.Vector3.createFloat64();r.Vector3.scale(s,o,1/n.KERNEL_TOLERANCE),t&&(r.Vector3.copy(t,s),r.Vector3.normalize(t,t));var a=r.Vector3.squaredLength(i);return r.Vector3.cross(s,i,s),r.Vector3.length(s)/Math.pow(a,1.5)},l.prototype.tangentLength=function(e){return r.Vector3.length(this.evaluateDt(e))},l.prototype.suggestSplittingParam=function(e){console.warn("Curve.suggestSplittingParam : abstract method invoked! Returning undefined.")},l.prototype.getTangentCone=function(e){console.warn("Curve.getTangentCone : abstract method invoked! Returning undefined.")},l.prototype.closestToRayParam=function(e,t,i){console.warn("Curve.closestToRayParam : abstract method invoked! Returning undefined.")},l.prototype.closestToPointParam=function(e,t){console.warn("Curve.closestToPointParam : abstract method invoked! Returning undefined.")},l.prototype.getArcLength=function(e){console.warn("Curve.getArcLength : abstract method invoked!")},l.prototype.getParameterFromArcLength=function(e,t){console.warn("Curve.getParameterFromArcLength : abstract method invoked!")},l.prototype.getBoundingBox=function(e){console.warn("Curve.getBoundingBox : abstract method invoked! Returning undefined.")},l.prototype.tessellate=function(e,t){console.warn("Curve.tessellate : abstract method invoked! Returning undefined.")},t.Curve=l},3440:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Cylinder=void 0;var r=i(1972),o=i(3344),n=i(2468),s=i(412),a=i(1096),l=i(5512),c=i(4728),u=function(){s.Surface.call(this),this._center=r.Vector3.createFloat64(),this._radius=0,this._uScale=1,this._xAxis=r.Vector3.createFloat64(),this._yAxis=r.Vector3.createFloat64(),this._zAxis=r.Vector3.createFloat64()};(u.prototype=Object.create(s.Surface.prototype)).getGeometryType=function(){return n.GEOMETRY_TYPES.CYLINDER},u.prototype.clone=function(){var e=new u;return e.copy(this),e},u.prototype.copy=function(e){s.Surface.prototype.copy.call(this,e),this._radius=e._radius,this._uScale=e._uScale,r.Vector3.copy(this._center,e._center),r.Vector3.copy(this._xAxis,e._xAxis),r.Vector3.copy(this._yAxis,e._yAxis),r.Vector3.copy(this._zAxis,e._zAxis)},u.prototype._computeYAxis=function(){r.Vector3.cross(this._yAxis,this._xAxis,this._zAxis)},u.prototype.set=function(e,t,i,o,s){r.Vector3.copy(this._center,e),c.ConsoleUtils.assert(t>n.KERNEL_TOLERANCE),this._radius=t,c.ConsoleUtils.assert(r.Vector3.squaredLength(i)>n.KERNEL_TOLERANCE*n.KERNEL_TOLERANCE),r.Vector3.normalize(this._zAxis,i),void 0!==o&&r.Vector3.squaredLength(o)>n.KERNEL_TOLERANCE*n.KERNEL_TOLERANCE?(c.ConsoleUtils.assert(r.Vector3.isOrthogonal(i,o,n.KERNEL_ANGULAR_TOLERANCE)),r.Vector3.normalize(this._xAxis,o)):(r.Vector3.computeOrthogonal(this._xAxis,this._zAxis),r.Vector3.normalize(this._xAxis,this._xAxis)),this._uScale=s||1,c.ConsoleUtils.assert(this._uScale>n.PARAMETER_SPACE_TOLERANCE),this._computeYAxis()},u.prototype.getRadius=function(){return this._radius},u.prototype.setRadius=function(e){c.ConsoleUtils.assert(e>n.KERNEL_TOLERANCE),this._radius=e},u.prototype.getCenter=function(){return this._center},u.prototype.setCenter=function(e){r.Vector3.copy(this._center,e)},u.prototype.getAxisDir=function(){return this._zAxis},u.prototype.setAxisDir=function(e){c.ConsoleUtils.assert(r.Vector3.squaredLength(e)>n.KERNEL_TOLERANCE*n.KERNEL_TOLERANCE),r.Vector3.normalize(this._zAxis,e),(r.Vector3.squaredLength(this._xAxis)<=n.KERNEL_TOLERANCE*n.KERNEL_TOLERANCE||!r.Vector3.isOrthogonal(this._xAxis,this._zAxis,n.KERNEL_ANGULAR_TOLERANCE))&&(r.Vector3.computeOrthogonal(this._xAxis,this._zAxis),r.Vector3.normalize(this._xAxis,this._xAxis)),this._computeYAxis()},u.prototype.getUvOriginDir=function(){return this._xAxis},u.prototype.setUvOriginDir=function(e){c.ConsoleUtils.assert(r.Vector3.squaredLength(e)>n.KERNEL_TOLERANCE*n.KERNEL_TOLERANCE),r.Vector3.normalize(this._xAxis,e),this._computeYAxis()},u.prototype.getUScale=function(){return this._uScale},u.prototype.setUScale=function(e){c.ConsoleUtils.assert(e>n.PARAMETER_SPACE_TOLERANCE),this._uScale=e},u.prototype.evaluatePosition=function(e,t){var i=this._radius*Math.cos(t),o=this._radius*Math.sin(t),n=this._uScale*e,s=r.Vector3.clone(this._center);return r.Vector3.scaleAndAdd(s,s,this._xAxis,i),r.Vector3.scaleAndAdd(s,s,this._yAxis,o),r.Vector3.scaleAndAdd(s,s,this._zAxis,n),s},u.prototype.evaluateNormal=function(e,t){var i=Math.cos(t),o=Math.sin(t),n=r.Vector3.createFloat64();return r.Vector3.scale(n,this._xAxis,i),r.Vector3.scaleAndAdd(n,n,this._yAxis,o),n},u.prototype.evaluateDu=function(e,t){var i=r.Vector3.createFloat64();return r.Vector3.scale(i,this._zAxis,this._uScale),i},u.prototype.evaluateDv=function(e,t){var i=-this._radius*Math.sin(t),o=this._radius*Math.cos(t),n=r.Vector3.createFloat64();return r.Vector3.scale(n,this._xAxis,i),r.Vector3.scaleAndAdd(n,n,this._yAxis,o),n},u.prototype.closestParam=function(e){var t=r.Vector3.createFloat64();r.Vector3.sub(t,e,this._center);var i=r.Vector3.dot(t,this._xAxis),o=r.Vector3.dot(t,this._yAxis),s=r.Vector3.dot(t,this._zAxis)/this._uScale,a=0;return i*i+o*o>n.KERNEL_TOLERANCE*n.KERNEL_TOLERANCE&&(a=Math.atan2(o,i)),{u:s,v:a}},u.prototype.vParamLine=function(e){var t=new l.Circle,i=r.Vector3.clone(this._center),o=e*this._uScale;r.Vector3.scaleAndAdd(i,i,this._zAxis,o);var n=r.Vector3.clone(this._xAxis);r.Vector3.scale(n,n,this._radius);var s=r.Vector3.clone(this._zAxis);return r.Vector3.negate(s,s),t.set(i,s,n),t},u.prototype.uParamLine=function(e){var t=new a.Line,i=r.Vector3.clone(this._center),o=this._radius*Math.cos(e),n=this._radius*Math.sin(e);return r.Vector3.scaleAndAdd(i,i,this._xAxis,o),r.Vector3.scaleAndAdd(i,i,this._yAxis,n),t.set(i,this.evaluateDu(0,e)),t},u.prototype.getBoundingBox=function(e,t){if(e){var i=e[0],r=e[1],n=this.vParamLine(i).getBoundingBox(t);return n.include(this.vParamLine(r).getBoundingBox(t)),n}return new o.BoundingBox([-1/0,-1/0,-1/0],[1/0,1/0,1/0])},u.prototype.transform=function(e){r.Vector3.transformMatrix44(this._center,this._center,e),r.Vector3.transformAsDirectionMatrix44(this._xAxis,this._xAxis,e),r.Vector3.transformAsDirectionMatrix44(this._yAxis,this._yAxis,e),r.Vector3.transformAsDirectionMatrix44(this._zAxis,this._zAxis,e);var t=r.Vector3.length(this._xAxis);this._radius*=t,this._uScale*=t,r.Vector3.normalize(this._xAxis,this._xAxis),r.Vector3.normalize(this._yAxis,this._yAxis),r.Vector3.normalize(this._zAxis,this._zAxis)},u.prototype.getRangeUnlimitedU=function(){return[-1/0,1/0]},u.prototype.getRangeUnlimitedV=function(){return[-Math.PI,Math.PI]},u.prototype.isPeriodicUnlimitedU=function(){return!1},u.prototype.isPeriodicUnlimitedV=function(){return!0},u.prototype.isClosedUnlimitedU=function(){return!1},u.prototype.isClosedUnlimitedV=function(){return!0},u.prototype.toObject=function(){const e=this.evaluatePosition(0,0);return r.Vector3.sub(e,e,this.getCenter()),{center:this.vectorToObject(this._center),radius:this.vectorToObject(e),axis:this.vectorToObject(this.getAxisDir()),uCoordScale:this.getUScale(),uRange:this.rangeToObject(this.getRangeU(),this.isLimitedU()),vRange:this.rangeToObject(this.getRangeV(),this.isLimitedV())}},t.Cylinder=u},7580:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Edge=void 0;var r=i(1972),o=i(9547),n=i(2468),s=i(4728),a=function(e){o.BaseTopology.call(this),this._curve=e,this._reversed=!1,this._vertices=[null,null],this._range=[0,0],this._precision=0,this._coedge=void 0,this._wire=void 0,this._tessellationPoints=[]};(a.prototype=Object.create(o.BaseTopology.prototype)).getTopologyType=function(){return n.TOPOLOGY_TYPES.EDGE},a.prototype.getCurveType=function(){return this._curve?this._curve.getGeometryType():void 0},a.prototype.clone=function(){var e=new a;return e._curve=this._curve?this._curve.clone():void 0,e._reversed=this._reversed,e._vertices[0]=this._vertices[0],e._vertices[1]=this._vertices[1],e._range[0]=this._range[0],e._range[1]=this._range[1],e._precision=this._precision,e._coedge=this._coedge,e._wire=this._wire,e._tessellationPoints=[],e},a.prototype.getCurve=function(){return this._curve},a.prototype.setCurve=function(e){this._curve=e},a.prototype.getArcLength=function(){var e=this.getRange();return this.isReversed()&&(e=[-e[1],-e[0]]),this._curve.getArcLength(e)},a.prototype.getVertices=function(){return this._vertices},a.prototype.getVertex=function(e){return s.ConsoleUtils.assert(0===e||1===e),this._vertices[e]},a.prototype.getStartVertex=function(){return this._vertices[0]},a.prototype.getEndVertex=function(){return this._vertices[1]},a.prototype.setCoedge=function(e){this._coedge=e},a.prototype.getCoedge=function(){return this._coedge},a.prototype.getCoedges=function(){for(var e=[],t=this._coedge;t;)e.push(t),(t=t.getPartner())===this._coedge&&(t=void 0);return e},a.prototype.setWire=function(e){this._wire=e},a.prototype.getWire=function(){return this._wire},a.prototype.getRange=function(){return this._range},a.prototype.setRange=function(e){s.ConsoleUtils.assert(2===e.length),this._range[0]=e[0],this._range[1]=e[1]},a.prototype.t0=function(){return this._range[0]},a.prototype.sett0=function(e){this._range[0]=e},a.prototype.t1=function(){return this._range[1]},a.prototype.sett1=function(e){this._range[1]=e},a.prototype.isClosed=function(){return this._curve&&this._vertices[0]&&this._vertices[0]===this._vertices[1]},a.prototype.getOtherVertex=function(e){return s.ConsoleUtils.assert(this._vertices[0]===e||this._vertices[1]===e),this._vertices[0]===e?this._vertices[1]:this._vertices[0]},a.prototype.getCommonVertex=function(e){var t=this.getStartVertex(),i=this.getEndVertex(),r=e.getStartVertex(),o=e.getEndVertex();return t===r||t===o?t:i===r||i===o?i:null},a.prototype.setVertex=function(e,t){s.ConsoleUtils.assert(0===e||1===e),t!==this._vertices[e]&&(this._vertices[e]&&this._vertices[0]!==this._vertices[1]&&this._vertices[e].removeEdge(this),this._vertices[e]=t,t&&this._vertices[e].addEdge(this))},a.prototype.setStartVertex=function(e){this.setVertex(0,e)},a.prototype.setEndVertex=function(e){this.setVertex(1,e)},a.prototype.getCoedgeForFace=function(e){for(var t=this._coedge;t;){if(t.getFace()===e)return t;if((t=t.getPartner())===this._coedge)break}},a.prototype.getOtherFace=function(e){var t=this.getCoedgeForFace(e);s.ConsoleUtils.assert(t);var i=t.getPartner();if(i&&i!==t)return i.getFace()},a.prototype.isReversed=function(){return this._reversed},a.prototype.setReversed=function(e){this._reversed=e},a.prototype.getPrecision=function(){return this._precision},a.prototype.setPrecision=function(e){s.ConsoleUtils.assert(e>=0),this._precision=e},a.prototype.evaluatePosition=function(e){return this.isReversed()&&(e=-e),this._curve.evaluatePosition(e)},a.prototype.evaluateDt=function(e){this.isReversed()&&(e=-e);var t=this._curve.evaluateDt(e);return this.isReversed()&&r.Vector3.negate(t,t),t},a.prototype.evaluateCurvature=function(e,t){return this.isReversed()&&(e=-e),this._curve.evaluateCurvature(e,t)},a.prototype.closestToPointParam=function(e,t){if(this._curve){var i=t||this.getRange();this.isReversed()&&(i=[-i[1],-i[0]]);var r=this._curve.closestToPointParam(e,i);return this.isReversed()?-r:r}},a.prototype.includesPoint=function(e){var t=Math.max(this.getPrecision(),n.KERNEL_TOLERANCE),i=this.closestToPointParam(e),o=this.evaluatePosition(i);return r.Vector3.squaredDistance(o,e)<t*t},a.prototype.distanceToPoint=function(e){var t=this.closestToPointParam(e),i=this.evaluatePosition(t);return r.Vector3.distance(i,e)},a.prototype.tessellate=function(e,t){var i,o;if(!1===this.isReversed())i=e||[this._range[0],this._range[1]];else if(e){i=new Array(e.length);for(var n=0;n<e.length;++n)i[n]=-e[e.length-1-n]}else i=[-this._range[1],-this._range[0]];var s,a=this._curve.tessellate(i,t);if(this._tessellationPoints.length!==a.positions.length)for(this._tessellationPoints=new Array(a.positions.length),n=0;n<a.positions.length;n++)this._tessellationPoints[n]=r.Vector3.createFloat64();if(!1===this.isReversed())for(s=a.offsets,o=0;o<a.positions.length;++o)r.Vector3.copy(this._tessellationPoints[o],a.positions[o]);else{for(o=0;o<a.positions.length;++o)r.Vector3.copy(this._tessellationPoints[o],a.positions[a.positions.length-1-o]);for(s=new Array(a.offsets.length),o=0;o<a.offsets.length;++o)s[o]=a.positions.length-1-a.offsets[a.offsets.length-1-o]}return{positions:this._tessellationPoints,offsets:s,tolerance:a.tolerance}},a.prototype.getBody=function(){return s.ConsoleUtils.assert(void 0===this._coedge||void 0===this._wire),this._coedge?this._coedge.getBody():this._wire?this._wire.getBody():void 0},a.prototype.collectFaces=function(e){e=e||new Set;for(var t=this._coedge;t;)t.collectFaces(e),(t=t.getPartner())===this._coedge&&(t=void 0);return e},a.prototype.collectEdges=function(e){return(e=e||new Set).add(this),e},a.prototype.collectVertices=function(e){e=e||new Set;for(var t=0;t<this._vertices.length;++t)this._vertices[t]&&e.add(this._vertices[t]);return e},a.prototype.getBoundingBox=function(){var e=this.getRange();return!0===this.isReversed()&&(e=[-e[1],-e[0]]),this._curve.getBoundingBox(e)},a.prototype.closestToRayParam=function(e,t,i){var r=this.getRange();!0===this.isReversed()&&(r=[-r[1],-r[0]]);var o=this._curve.closestToRayParam(e,t,r,i);return!0===this.isReversed()?-o:o},a.prototype.toString=function(){return n.GEOMETRY_TYPES.toString(this.getCurveType())+" "+String(this.getStartVertex())+" -> "+String(this.getEndVertex())},a.prototype.getLoops=function(){const e=this.getCoedges(),t=new Set;for(let i=0;i<e.length;i++)t.add(e[i].getLoop());return Array.from(t)},a.prototype.toObject=function(){return{vertex0:this.refToString(this._vertices[0]),vertex1:this.refToString(this._vertices[1]),precision:this._precision,range:this.rangeToObject(this._range,!0),reversed:this._reversed,geometry:this.refToString(this._curve),attributes:this.refsToStrings(this._attributes)}},a.prototype.addToModelObject=function(e){this.addAllToModelObject(e,[this._vertices[0],this._vertices[1],this._curve,this._attributes])},t.Edge=a},8972:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Ellipse=void 0;var r=i(1972),o=i(3344),n=i(2355),s=i(2468),a=i(1472),l=i(5896),c=i(1e3),u=i(4728),h=i(4336),d=function(){a.Curve.call(this),this._center=r.Vector3.createFloat64FromValues(0,0,0),this._normal=r.Vector3.createFloat64FromValues(0,0,1),this._xAxis=r.Vector3.createFloat64FromValues(1,0,0),this._yAxis=r.Vector3.createFloat64FromValues(0,1,0),this._majorRadius=0,this._minorRadius=0,this._tessellationCache=new h.TessellationCache};(d.prototype=Object.create(a.Curve.prototype)).getGeometryType=function(){return s.GEOMETRY_TYPES.ELLIPSE},d.prototype.set=function(e,t,i,o){u.ConsoleUtils.assert(r.Vector3.squaredLength(t)>s.KERNEL_TOLERANCE*s.KERNEL_TOLERANCE),u.ConsoleUtils.assert(r.Vector3.squaredLength(i)>s.KERNEL_TOLERANCE*s.KERNEL_TOLERANCE),u.ConsoleUtils.assert(r.Vector3.isOrthogonal(t,i,s.KERNEL_ANGULAR_TOLERANCE)),u.ConsoleUtils.assert(o>r.FLOAT64_TOLERANCE&&o<=1,"Invalid radius ratio"),r.Vector3.copy(this._center,e),r.Vector3.normalize(this._normal,t),r.Vector3.normalize(this._xAxis,i),this._majorRadius=r.Vector3.length(i),this._minorRadius=this._majorRadius*o,this._computeYAxis(),this._dirtyTessellation()},d.prototype._computeYAxis=function(){r.Vector3.cross(this._yAxis,this._normal,this._xAxis)},d.prototype.getCenter=function(){return this._center},d.prototype.getNormal=function(){return this._normal},d.prototype.setCenter=function(e){r.Vector3.copy(this._center,e),this._dirtyTessellation()},d.prototype.setNormal=function(e){u.ConsoleUtils.assert(r.Vector3.squaredLength(e)>s.KERNEL_TOLERANCE*s.KERNEL_TOLERANCE),this._normal!==e&&(r.Vector3.normalize(this._normal,e),r.Vector3.isOrthogonal(this._xAxis,this._normal)||(r.Vector3.computeOrthogonal(this._xAxis,this._normal),r.Vector3.normalize(this._xAxis,this._xAxis)),this._computeYAxis(),this._dirtyTessellation())},d.prototype.setMajorAxis=function(e){u.ConsoleUtils.assert(r.Vector3.squaredLength(e)>s.KERNEL_TOLERANCE*s.KERNEL_TOLERANCE),u.ConsoleUtils.assert(r.Vector3.isOrthogonal(e,this._normal,s.KERNEL_ANGULAR_TOLERANCE)),r.Vector3.normalize(this._xAxis,e),this._computeYAxis(),this._dirtyTessellation()},d.prototype.getMajorAxis=function(){return this._xAxis},d.prototype.getMinorAxis=function(){return this._yAxis},d.prototype.clone=function(){var e=new d;return e.copy(this),e},d.prototype.copy=function(e){a.Curve.prototype.copy.call(this,e),r.Vector3.copy(this._xAxis,e._xAxis),r.Vector3.copy(this._yAxis,e._yAxis),this._majorRadius=e._majorRadius,this._minorRadius=e._minorRadius,r.Vector3.copy(this._center,e._center),r.Vector3.copy(this._normal,e._normal)},d.prototype.getMajorRadius=function(){return this._majorRadius},d.prototype.getMinorRadius=function(){return this._minorRadius},d.prototype.setMajorRadius=function(e){u.ConsoleUtils.assert(e>s.KERNEL_TOLERANCE),this._majorRadius=e,this._dirtyTessellation()},d.prototype.setMinorRadius=function(e){u.ConsoleUtils.assert(e>s.KERNEL_TOLERANCE),this._minorRadius=e,this._dirtyTessellation()},d.prototype.getRangeUnlimited=function(){return[-Math.PI,Math.PI]},d.prototype.isPeriodicUnlimited=function(){return!0},d.prototype.isClosedUnlimited=function(){return!0},d.prototype._dirtyTessellation=function(){this._tessellationCache.setDirty(!0)},d.prototype._evaluateArcLengthIntegrand=function(e){var t=this._majorRadius*Math.sin(e),i=this._minorRadius*Math.cos(e);return Math.sqrt(t*t+i*i)},d.prototype.getArcLength=function(e){void 0===e?e=this.getRange():0===e.length&&(e=this.getRangeUnlimited());for(var t=e[0],i=0;t<e[1]+s.PARAMETER_SPACE_TOLERANCE;){for(var r=t,o=[this._evaluateArcLengthIntegrand(t)];o.length<5&&t<e[1]+s.PARAMETER_SPACE_TOLERANCE;)t+=.01,o.push(this._evaluateArcLengthIntegrand(t));switch(r=t-r,o.length){case 1:break;case 2:i+=(o[0]+o[1])*r/2;break;case 3:i+=(o[0]+4*o[1]+o[2])*r/6;break;case 4:i+=(o[0]+3*o[1]+3*o[2]+o[3])*r/8;break;default:i+=(7*o[0]+32*o[1]+12*o[2]+32*o[3]+7*o[4])*r/90}(r=t-e[1])>s.PARAMETER_SPACE_TOLERANCE&&(i-=this._evaluateArcLengthIntegrand(e[1])*r)}return i},d.prototype.getParameterFromArcLength=function(e,t){return void 0===t?t=this.getRange():0===t.length&&(t=this.getRangeUnlimited()),(0,c.invertIntegral1D)(this._evaluateArcLengthIntegrand.bind(this),e,t)},d.prototype.evaluatePosition=function(e){var t=r.Vector3.createFloat64FromValues(0,0,0);return r.Vector3.scaleAndAdd(t,t,this._xAxis,Math.cos(e)*this._majorRadius),r.Vector3.scaleAndAdd(t,t,this._yAxis,Math.sin(e)*this._minorRadius),r.Vector3.add(t,t,this._center),t},d.prototype.evaluateDt=function(e){var t=r.Vector3.createFloat64FromValues(0,0,0);return r.Vector3.scaleAndAdd(t,t,this._xAxis,-Math.sin(e)*this._majorRadius),r.Vector3.scaleAndAdd(t,t,this._yAxis,Math.cos(e)*this._minorRadius),t},d.prototype.evaluateDtt=function(e){var t=r.Vector3.createFloat64FromValues(0,0,0);return r.Vector3.scaleAndAdd(t,t,this._xAxis,-Math.cos(e)*this._majorRadius),r.Vector3.scaleAndAdd(t,t,this._yAxis,-Math.sin(e)*this._minorRadius),t},d.prototype._getFullTessellation=function(e){var t=[-Math.PI,-Math.PI/2,0,Math.PI/2,Math.PI],i=h.CurveTessellator.getAdaptiveRenderPoints(this,e,[-Math.PI,Math.PI],t);return i.didRetessellate=!0,i},d.prototype.tessellate=function(e,t){return t=t||s.TESSELLATION.LINEAR_PRECISION,this._tessellationCache.getTessellation(e,this,t,this._getFullTessellation.bind(this))},d.prototype.getBoundingBox=function(e){void 0===e?e=this.getRange():0===e.length&&(e=this.getRangeUnlimited());var t=(0,l.minMaxCosSinFunc)(this._xAxis[0]*this._majorRadius,this._yAxis[0]*this._minorRadius,this._center[0],e),i=(0,l.minMaxCosSinFunc)(this._xAxis[1]*this._majorRadius,this._yAxis[1]*this._minorRadius,this._center[1],e),r=(0,l.minMaxCosSinFunc)(this._xAxis[2]*this._majorRadius,this._yAxis[2]*this._minorRadius,this._center[2],e),n=new o.BoundingBox;return n.min[0]=t[0],n.max[0]=t[1],n.min[1]=i[0],n.max[1]=i[1],n.min[2]=r[0],n.max[2]=r[1],n},d.prototype.getTangentCone=function(e){void 0===e?e=this.getRange():0===e.length&&(e=this.getRangeUnlimited());var t=this.evaluateDt(e[0]);r.Vector3.normalize(t,t);var i=this.evaluateDt(e[1]);r.Vector3.normalize(i,i);var o=r.Vector3.createFloat64(),a=r.Vector3.dot(t,i),c=r.Vector3.dot(r.Vector3.cross(o,t,i),this._normal),u=Math.atan2(c,a);u<0?u+=l.PI2:e[1]-e[0]>l.PI2-s.PARAMETER_SPACE_TOLERANCE&&(u=l.PI2),u*=.5,a=Math.cos(u),c=Math.sin(u);var h=r.Vector3.clone(t);return r.Vector3.scale(h,h,a),r.Vector3.cross(o,this._normal,t),r.Vector3.scaleAndAdd(h,h,o,c),new n.TangentCone(h,u)},d.prototype.transform=function(e){r.Vector3.transformMatrix44(this._center,this._center,e),r.Vector3.transformAsDirectionMatrix44(this._normal,this._normal,e),r.Vector3.scale(this._xAxis,this._xAxis,this._majorRadius),r.Vector3.scale(this._yAxis,this._yAxis,this._minorRadius),r.Vector3.transformAsDirectionMatrix44(this._xAxis,this._xAxis,e),r.Vector3.transformAsDirectionMatrix44(this._yAxis,this._yAxis,e),this._majorRadius=r.Vector3.length(this._xAxis),this._minorRadius=r.Vector3.length(this._yAxis),r.Vector3.normalize(this._normal,this._normal),r.Vector3.normalize(this._xAxis,this._xAxis),this._computeYAxis(),this._dirtyTessellation()},d.prototype.closestToRayParam=function(e,t,i){var o=r.Vector3.createFloat64();r.Vector3.sub(o,this._center,e);var n=r.Vector3.dot(o,this._normal)/r.Vector3.dot(t,this._normal);if(isFinite(n)){var s=r.Vector3.createFloat64();return r.Vector3.scaleAndAdd(s,e,t,n),this.closestToPointParam(s,i)}},d.prototype.isCircular=function(){return Math.abs(this._majorRadius-this._minorRadius)<s.KERNEL_TOLERANCE},d.prototype.closestToPointParam=function(e,t){void 0===t?t=this.getRange():0===t.length&&(t=this.getRangeUnlimited());var i=r.Vector3.createFloat64();r.Vector3.sub(i,e,this._center);var o=r.Vector3.dot(i,this._xAxis),n=r.Vector3.dot(i,this._yAxis);if(o*o+n*n<s.KERNEL_TOLERANCE*s.KERNEL_TOLERANCE){var a=.5*Math.PI;if(((a=(0,l.adjustParameterToPeriodicRange)(a,t,l.PI2))<t[0]||a>t[1])&&(a=(0,l.adjustParameterToPeriodicRange)(.5*-Math.PI,t,l.PI2)),a<t[0]||a>t[1]){var u=this.evaluatePosition(t[0]),h=this.evaluatePosition(t[1]);a=r.Vector3.squaredDistance(this._center,u)<r.Vector3.squaredDistance(this._center,h)?t[0]:t[1]}return a}var d=this._majorRadius,p=this._minorRadius,g=Math.atan2(d*n,p*o),f=this.evaluatePosition(g);r.Vector3.sub(f,f,this._center),o*o+n*n<r.Vector3.squaredLength(f)&&(g=(n<s.KERNEL_TOLERANCE?-1:1)*Math.acos(o/d));var v,m=r.FLOAT64_TOLERANCE,y=function(t){var i=this.evaluatePosition(t),r=this.evaluateDt(t),o=this.evaluateDtt(t),n=[i[0]-e[0],i[1]-e[1],i[2]-e[2]];return{val:2*(n[0]*r[0]+n[1]*r[1]+n[2]*r[2]),deriv:2*(n[0]*o[0]+n[1]*o[1]+n[2]*o[2]+(r[0]*r[0]+r[1]*r[1]+r[2]*r[2]))}},_=(0,c.newtonRaphson1D)(y.bind(this),void 0,g,m,32);(_=(0,l.adjustParameterToPeriodicRange)(_,t,l.PI2))<t[0]||_>t[1]?(_=(0,c.newtonRaphson1D)(y.bind(this),void 0,-_,m,32),v=(_=(0,l.adjustParameterToPeriodicRange)(_,t,l.PI2))<t[0]||_>t[1]?1/0:r.Vector3.squaredDistance(e,this.evaluatePosition(_))):v=r.Vector3.squaredDistance(e,this.evaluatePosition(_));var E=r.Vector3.squaredDistance(e,this.evaluatePosition(t[0])),A=r.Vector3.squaredDistance(e,this.evaluatePosition(t[1]));return E<v&&(v=E,_=t[0]),A<v&&(_=t[1]),_},d.prototype.suggestSplittingParam=function(e){},d.prototype.toObject=function(){const e=this.evaluatePosition(0);return r.Vector3.sub(e,e,this.getCenter()),{center:this.vectorToObject(this._center),majorRadius:this.vectorToObject(e),normal:this.vectorToObject(this._normal),radiusRatio:this.getMinorRadius()/this.getMajorRadius(),range:this.rangeToObject(this.getRange(),this.isLimited())}},t.Ellipse=d},2956:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EllipticalCone=void 0;var r=i(1972),o=i(3344),n=i(1e3),s=i(2468),a=i(412),l=i(3565),c=i(1096),u=i(8972),h=i(4728),d=function(){a.Surface.call(this),this._center=r.Vector3.createFloat64(),this._majorRadius=0,this._minorRadius=0,this._angle=0,this._uScale=1,this._xAxis=r.Vector3.createFloat64(),this._yAxis=r.Vector3.createFloat64(),this._zAxis=r.Vector3.createFloat64()};(d.prototype=Object.create(a.Surface.prototype)).getGeometryType=function(){return s.GEOMETRY_TYPES.ELLIPTICAL_CONE},d.prototype.clone=function(){var e=new d;return e.copy(this),e},d.prototype.copy=function(e){a.Surface.prototype.copy.call(this,e),this._majorRadius=e._majorRadius,this._minorRadius=e._minorRadius,this._angle=e._angle,this._uScale=e._uScale,r.Vector3.copy(this._center,e._center),r.Vector3.copy(this._xAxis,e._xAxis),r.Vector3.copy(this._yAxis,e._yAxis),r.Vector3.copy(this._zAxis,e._zAxis)},d.prototype._computeYAxis=function(){r.Vector3.cross(this._yAxis,this._xAxis,this._zAxis)},d.prototype.set=function(e,t,i,o,n,a){r.Vector3.copy(this._center,e),this._majorRadius=r.Vector3.length(t),h.ConsoleUtils.assert(this._majorRadius>s.KERNEL_TOLERANCE),r.Vector3.normalize(this._xAxis,t),h.ConsoleUtils.assert(i<=1),this._minorRadius=i*this._majorRadius,h.ConsoleUtils.assert(this._minorRadius>s.KERNEL_TOLERANCE),h.ConsoleUtils.assert(r.Vector3.squaredLength(o)>s.KERNEL_TOLERANCE*s.KERNEL_TOLERANCE),h.ConsoleUtils.assert(r.Vector3.isOrthogonal(o,t,s.KERNEL_ANGULAR_TOLERANCE)),r.Vector3.normalize(this._zAxis,o),h.ConsoleUtils.assert(Math.abs(n)<Math.PI/2),this._angle=n,this._uScale=a||1,h.ConsoleUtils.assert(this._uScale>s.PARAMETER_SPACE_TOLERANCE),this._computeYAxis()},d.prototype.getMajorRadius=function(){return this._majorRadius},d.prototype.setMajorRadius=function(e){h.ConsoleUtils.assert(e>s.KERNEL_TOLERANCE),this._majorRadius=e},d.prototype.getMinorRadius=function(){return this._minorRadius},d.prototype.setMinorRadius=function(e){h.ConsoleUtils.assert(e>s.KERNEL_TOLERANCE),this._minorRadius=e},d.prototype.getMajorAxis=function(){return this._xAxis},d.prototype.setMajorAxis=function(e){h.ConsoleUtils.assert(r.Vector3.squaredLength(e)>s.KERNEL_TOLERANCE*s.KERNEL_TOLERANCE),r.Vector3.normalize(this._xAxis,e),this._computeYAxis()},d.prototype.getCenter=function(){return this._center},d.prototype.setCenter=function(e){r.Vector3.copy(this._center,e)},d.prototype.getAxisDir=function(){return this._zAxis},d.prototype.setAxisDir=function(e){h.ConsoleUtils.assert(r.Vector3.squaredLength(e)>s.KERNEL_TOLERANCE*s.KERNEL_TOLERANCE),r.Vector3.normalize(this._zAxis,e),this._computeYAxis()},d.prototype.getUScale=function(){return this._uScale},d.prototype.setUScale=function(e){h.ConsoleUtils.assert(e>s.PARAMETER_SPACE_TOLERANCE),this._uScale=e},d.prototype.getAngle=function(){return this._angle},d.prototype.setAngle=function(e){h.ConsoleUtils.assert(Math.abs(e)<Math.PI/2-s.KERNEL_ANGULAR_TOLERANCE),this._angle=e},d.prototype.isCylinder=function(){return Math.abs(this._angle)<s.KERNEL_ANGULAR_TOLERANCE},d.prototype.getApexParam=function(){return this.isCylinder()?void 0:-this._majorRadius/(this._uScale*Math.sin(this._angle))},d.prototype.getApexPosition=function(){if(!this.isCylinder()){var e=-this._majorRadius/Math.tan(this._angle),t=r.Vector3.clone(this._center);return r.Vector3.scaleAndAdd(t,t,this._zAxis,e),t}},d.prototype.evaluatePosition=function(e,t){var i=1+e*this._uScale*Math.sin(this._angle)/this._majorRadius,o=i*this._majorRadius*Math.cos(t),n=i*this._minorRadius*Math.sin(t),s=e*this._uScale*Math.cos(this._angle),a=r.Vector3.clone(this._center);return r.Vector3.scaleAndAdd(a,a,this._xAxis,o),r.Vector3.scaleAndAdd(a,a,this._yAxis,n),r.Vector3.scaleAndAdd(a,a,this._zAxis,s),a},d.prototype.evaluateNormal=function(e,t){var i=Math.cos(this._angle),o=i*this._minorRadius*Math.cos(t),n=i*this._majorRadius*Math.sin(t),s=-Math.sin(this._angle)*this._minorRadius,a=r.Vector3.createFloat64();return r.Vector3.scale(a,this._xAxis,o),r.Vector3.scaleAndAdd(a,a,this._yAxis,n),r.Vector3.scaleAndAdd(a,a,this._zAxis,s),r.Vector3.normalize(a,a),a},d.prototype.evaluateDu=function(e,t){var i=this._uScale*Math.sin(this._angle)/this._majorRadius,o=i*this._majorRadius*Math.cos(t),n=i*this._minorRadius*Math.sin(t),s=this._uScale*Math.cos(this._angle),a=r.Vector3.createFloat64();return r.Vector3.scale(a,this._xAxis,o),r.Vector3.scaleAndAdd(a,a,this._yAxis,n),r.Vector3.scaleAndAdd(a,a,this._zAxis,s),a},d.prototype.evaluateDv=function(e,t){var i=1+e*this._uScale*Math.sin(this._angle)/this._majorRadius,o=-i*this._majorRadius*Math.sin(t),n=i*this._minorRadius*Math.cos(t),s=r.Vector3.createFloat64();return r.Vector3.scale(s,this._xAxis,o),r.Vector3.scaleAndAdd(s,s,this._yAxis,n),s},d.prototype.closestParam=function(e){var t,i;if(this.isCylinder()){var o=r.Vector3.createFloat64();r.Vector3.sub(o,e,this._center),t=r.Vector3.dot(o,this._zAxis)/this._uScale,i=this.vParamLine(t).closestToPointParam(e)}else{var a=r.Vector3.createFloat64();r.Vector3.sub(a,e,this.getApexPosition());var l=r.Vector3.dot(a,this._xAxis),c=r.Vector3.dot(a,this._yAxis),u=r.Vector3.dot(a,this._zAxis),h=this._uScale*Math.sin(this._angle),d=h*this._minorRadius/this._majorRadius,p=this._uScale*Math.cos(this._angle),g=this._majorRadius/h,f=function(e,t,i,o,a,l){if(o*o+a*a+l*l<s.KERNEL_TOLERANCE*s.KERNEL_TOLERANCE)return{u:0,v:0};var c=r.FLOAT64_TOLERANCE,u=l*e>=0?1:-1,h=(o*u>=0?.25:.75)*(a*u>=0?1:-1),d=h*Math.PI,p=[(h-.25)*Math.PI,(h+.25)*Math.PI],g=(0,n.newtonRaphson1D)((function(r){var n=Math.sin(r),s=Math.cos(r),c=e*(t*t+i*i)*o,u=t*(e*e+i*i)*a,h=i*(e*e-t*t)*l;return{val:c*n-u*s-h*n*s,deriv:c*s+u*n-h*(s*s-n*n)}}),p,d,c,32),f=e*Math.cos(g),v=t*Math.sin(g);return{u:(f*o+v*a+i*l)/(f*f+v*v+i*i),v:g}}(h,d,p,l,c,u);t=f.u-g,i=f.v}return{u:t,v:i}},d.prototype.vParamLine=function(e){var t=this._majorRadius+e*this._uScale*Math.sin(this._angle);if(Math.abs(t)>s.KERNEL_TOLERANCE){var i=new u.Ellipse,o=r.Vector3.clone(this._center),n=e*this._uScale*Math.cos(this._angle);r.Vector3.scaleAndAdd(o,o,this._zAxis,n);var a=r.Vector3.clone(this._xAxis);r.Vector3.scale(a,a,t);var c=r.Vector3.clone(this._zAxis);return r.Vector3.negate(c,c),i.set(o,c,a,this._minorRadius/this._majorRadius),i}return new l.Point(this.getApexPosition())},d.prototype.uParamLine=function(e){var t=new c.Line,i=r.Vector3.clone(this._center),o=this._majorRadius*Math.cos(e),n=this._minorRadius*Math.sin(e);return r.Vector3.scaleAndAdd(i,i,this._xAxis,o),r.Vector3.scaleAndAdd(i,i,this._yAxis,n),t.set(i,this.evaluateDu(0,e)),t},d.prototype.getBoundingBox=function(e,t){if(e){var i=e[0],r=e[1],n=this.vParamLine(i).getBoundingBox(t);return n.include(this.vParamLine(r).getBoundingBox(t)),n}return new o.BoundingBox([-1/0,-1/0,-1/0],[1/0,1/0,1/0])},d.prototype.transform=function(e){r.Vector3.transformMatrix44(this._center,this._center,e),r.Vector3.transformAsDirectionMatrix44(this._xAxis,this._xAxis,e),r.Vector3.transformAsDirectionMatrix44(this._yAxis,this._yAxis,e),r.Vector3.transformAsDirectionMatrix44(this._zAxis,this._zAxis,e);var t=r.Vector3.length(this._xAxis);this._majorRadius*=t,this._minorRadius*=t,this._uScale*=t,r.Vector3.normalize(this._xAxis,this._xAxis),r.Vector3.normalize(this._yAxis,this._yAxis),r.Vector3.normalize(this._zAxis,this._zAxis)},d.prototype.getRangeUnlimitedU=function(){return[-1/0,1/0]},d.prototype.getRangeUnlimitedV=function(){return[-Math.PI,Math.PI]},d.prototype.isPeriodicUnlimitedU=function(){return!1},d.prototype.isPeriodicUnlimitedV=function(){return!0},d.prototype.isClosedUnlimitedU=function(){return!1},d.prototype.isClosedUnlimitedV=function(){return!0},d.prototype.toObject=function(){const e=this.evaluatePosition(0,0);return r.Vector3.sub(e,e,this.getCenter()),{center:this.vectorToObject(this._center),majorRadius:this.vectorToObject(e),axis:this.vectorToObject(this.getAxisDir()),uCoordScale:this.getUScale(),radiusRatio:this.getMinorRadius()/this.getMajorRadius(),angle:this.getAngle(),uRange:this.rangeToObject(this.getRangeU(),this.isLimitedU()),vRange:this.rangeToObject(this.getRangeV(),this.isLimitedV())}},t.EllipticalCone=d},8360:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EllipticalCylinder=void 0;var r=i(1972),o=i(3344),n=i(2468),s=i(412),a=i(1096),l=i(8972),c=i(4728),u=function(){s.Surface.call(this),this._center=r.Vector3.createFloat64(),this._majorRadius=0,this._minorRadius=0,this._uScale=1,this._xAxis=r.Vector3.createFloat64(),this._yAxis=r.Vector3.createFloat64(),this._zAxis=r.Vector3.createFloat64()};(u.prototype=Object.create(s.Surface.prototype)).getGeometryType=function(){return n.GEOMETRY_TYPES.ELLIPTICAL_CYLINDER},u.prototype.clone=function(){var e=new u;return e.copy(this),e},u.prototype.copy=function(e){s.Surface.prototype.copy.call(this,e),this._majorRadius=e._majorRadius,this._minorRadius=e._minorRadius,this._uScale=e._uScale,r.Vector3.copy(this._center,e._center),r.Vector3.copy(this._xAxis,e._xAxis),r.Vector3.copy(this._yAxis,e._yAxis),r.Vector3.copy(this._zAxis,e._zAxis)},u.prototype._computeYAxis=function(){r.Vector3.cross(this._yAxis,this._xAxis,this._zAxis)},u.prototype.set=function(e,t,i,o,s){r.Vector3.copy(this._center,e),this._majorRadius=r.Vector3.length(t),c.ConsoleUtils.assert(this._majorRadius>n.KERNEL_TOLERANCE),r.Vector3.normalize(this._xAxis,t),c.ConsoleUtils.assert(i<=1),this._minorRadius=i*this._majorRadius,c.ConsoleUtils.assert(this._minorRadius>n.KERNEL_TOLERANCE),c.ConsoleUtils.assert(r.Vector3.squaredLength(o)>n.KERNEL_TOLERANCE*n.KERNEL_TOLERANCE),c.ConsoleUtils.assert(r.Vector3.isOrthogonal(o,t,n.KERNEL_ANGULAR_TOLERANCE)),r.Vector3.normalize(this._zAxis,o),this._uScale=s||1,c.ConsoleUtils.assert(this._uScale>n.PARAMETER_SPACE_TOLERANCE),this._computeYAxis()},u.prototype.getMajorRadius=function(){return this._majorRadius},u.prototype.setMajorRadius=function(e){c.ConsoleUtils.assert(e>n.KERNEL_TOLERANCE),this._majorRadius=e},u.prototype.getMinorRadius=function(){return this._minorRadius},u.prototype.setMinorRadius=function(e){c.ConsoleUtils.assert(e>n.KERNEL_TOLERANCE),this._minorRadius=e},u.prototype.getMajorAxis=function(){return this._xAxis},u.prototype.setMajorAxis=function(e){c.ConsoleUtils.assert(r.Vector3.squaredLength(e)>n.KERNEL_TOLERANCE*n.KERNEL_TOLERANCE),r.Vector3.normalize(this._xAxis,e),this._computeYAxis()},u.prototype.getCenter=function(){return this._center},u.prototype.setCenter=function(e){r.Vector3.copy(this._center,e)},u.prototype.getAxisDir=function(){return this._zAxis},u.prototype.setAxisDir=function(e){c.ConsoleUtils.assert(r.Vector3.squaredLength(e)>n.KERNEL_TOLERANCE*n.KERNEL_TOLERANCE),r.Vector3.normalize(this._zAxis,e),this._computeYAxis()},u.prototype.getUScale=function(){return this._uScale},u.prototype.setUScale=function(e){c.ConsoleUtils.assert(e>n.PARAMETER_SPACE_TOLERANCE),this._uScale=e},u.prototype.evaluatePosition=function(e,t){var i=this._majorRadius*Math.cos(t),o=this._minorRadius*Math.sin(t),n=this._uScale*e,s=r.Vector3.clone(this._center);return r.Vector3.scaleAndAdd(s,s,this._xAxis,i),r.Vector3.scaleAndAdd(s,s,this._yAxis,o),r.Vector3.scaleAndAdd(s,s,this._zAxis,n),s},u.prototype.evaluateNormal=function(e,t){var i=this._minorRadius*Math.cos(t),o=this._majorRadius*Math.sin(t),n=Math.sqrt(i*i+o*o),s=r.Vector3.createFloat64();return r.Vector3.scale(s,this._xAxis,i/n),r.Vector3.scaleAndAdd(s,s,this._yAxis,o/n),s},u.prototype.evaluateDu=function(e,t){var i=r.Vector3.createFloat64();return r.Vector3.scale(i,this._zAxis,this._uScale),i},u.prototype.evaluateDv=function(e,t){var i=-this._majorRadius*Math.sin(t),o=this._minorRadius*Math.cos(t),n=r.Vector3.createFloat64();return r.Vector3.scale(n,this._xAxis,i),r.Vector3.scaleAndAdd(n,n,this._yAxis,o),n},u.prototype.closestParam=function(e){var t=r.Vector3.createFloat64();r.Vector3.sub(t,e,this._center);var i=r.Vector3.dot(t,this._zAxis)/this._uScale;return{u:i,v:this.vParamLine(i).closestToPointParam(e)}},u.prototype.vParamLine=function(e){var t=new l.Ellipse,i=r.Vector3.clone(this._center),o=e*this._uScale;r.Vector3.scaleAndAdd(i,i,this._zAxis,o);var n=r.Vector3.clone(this._xAxis);r.Vector3.scale(n,n,this._majorRadius);var s=r.Vector3.clone(this._zAxis);return r.Vector3.negate(s,s),t.set(i,s,n,this._minorRadius/this._majorRadius),t},u.prototype.uParamLine=function(e){var t=new a.Line,i=r.Vector3.clone(this._center),o=this._majorRadius*Math.cos(e),n=this._minorRadius*Math.sin(e);return r.Vector3.scaleAndAdd(i,i,this._xAxis,o),r.Vector3.scaleAndAdd(i,i,this._yAxis,n),t.set(i,this.evaluateDu(0,e)),t},u.prototype.getBoundingBox=function(e,t){if(e){var i=e[0],r=e[1],n=this.vParamLine(i).getBoundingBox(t);return n.include(this.vParamLine(r).getBoundingBox(t)),n}return new o.BoundingBox([-1/0,-1/0,-1/0],[1/0,1/0,1/0])},u.prototype.transform=function(e){r.Vector3.transformMatrix44(this._center,this._center,e),r.Vector3.transformAsDirectionMatrix44(this._xAxis,this._xAxis,e),r.Vector3.transformAsDirectionMatrix44(this._yAxis,this._yAxis,e),r.Vector3.transformAsDirectionMatrix44(this._zAxis,this._zAxis,e);var t=r.Vector3.length(this._xAxis);this._majorRadius*=t,this._minorRadius*=t,this._uScale*=t,r.Vector3.normalize(this._xAxis,this._xAxis),r.Vector3.normalize(this._yAxis,this._yAxis),r.Vector3.normalize(this._zAxis,this._zAxis)},u.prototype.getRangeUnlimitedU=function(){return[-1/0,1/0]},u.prototype.getRangeUnlimitedV=function(){return[-Math.PI,Math.PI]},u.prototype.isPeriodicUnlimitedU=function(){return!1},u.prototype.isPeriodicUnlimitedV=function(){return!0},u.prototype.isClosedUnlimitedU=function(){return!1},u.prototype.isClosedUnlimitedV=function(){return!0},u.prototype.toObject=function(){const e=this.evaluatePosition(0,0);return r.Vector3.sub(e,e,this.getCenter()),{center:this.vectorToObject(this._center),majorRadius:this.vectorToObject(e),axis:this.vectorToObject(this.getAxisDir()),uCoordScale:this.getUScale(),radiusRatio:this.getMinorRadius()/this.getMajorRadius(),uRange:this.rangeToObject(this.getRangeU(),this.isLimitedU()),vRange:this.rangeToObject(this.getRangeV(),this.isLimitedV())}},t.EllipticalCylinder=u},6776:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Face=void 0;var r=i(1972),o=i(9547),n=i(2468),s=i(6120),a=function(e){o.BaseTopology.call(this),this._surface=e,this._reversed=!1,this._loops=[],this._shell=void 0};(a.prototype=Object.create(o.BaseTopology.prototype)).getTopologyType=function(){return n.TOPOLOGY_TYPES.FACE},a.prototype.getSurfaceType=function(){return this._surface?this._surface.getGeometryType():void 0},a.prototype.clone=function(){var e=new a;return e._surface=this._surface?this._surface.clone():void 0,e._reversed=this._reversed,e.setLoops(this._loops),e._shell=this._shell,e._vertexUvData=void 0,e},a.prototype.getSurface=function(){return this._surface},a.prototype.setSurface=function(e){this._surface=e},a.prototype.getShell=function(){return this._shell},a.prototype.setShell=function(e){this._shell=e},a.prototype.getLoops=function(){return this._loops},a.prototype.setLoops=function(e){this._loops=new Array(e.length);for(var t=0;t<e.length;++t)this._loops[t]=e[t]},a.prototype.addLoop=function(e){this._loops?this._loops.push(e):this._loops=[e],e.setFace(this)},a.prototype.addLoops=function(e){this._loops||(this._loops=[]);for(var t=0;t<e.length;++t)e[t].setFace(this);this._loops=this._loops.concat(e)},a.prototype.removeLoop=function(e){var t=this._loops.indexOf(e);return t>-1&&(this._loops.splice(t,1),e.getFace()===this&&e.setFace(void 0),!0)},a.prototype.isReversed=function(){return this._reversed},a.prototype.setReversed=function(e){this._reversed=e},a.prototype.getVertices=function(){return Array.from(this.collectVertices())},a.prototype.evaluatePosition=function(e,t){return this._surface.evaluatePosition(e,t)},a.prototype.evaluateNormal=function(e,t){var i=this._surface.evaluateNormal(e,t);return!0===this.isReversed()&&r.Vector3.negate(i,i),i},a.prototype.getBody=function(){return this._shell?this._shell.getBody():void 0},a.prototype.collectFaces=function(e){return(e=e||new Set).add(this),e},a.prototype.collectEdges=function(e){e=e||new Set;for(var t=0;t<this._loops.length;++t)this._loops[t].collectEdges(e);return e},a.prototype.collectVertices=function(e){e=e||new Set;for(var t=0;t<this._loops.length;++t)this._loops[t].collectVertices(e);return e},a.prototype.getBoundingBox=function(){var e=this._surface.getRangeU(),t=this._surface.getRangeV();return isFinite(e[0])&&isFinite(e[1])||(s.DebugUtils.warn("Face.getBoundingBox: Surface is unbounded in u."),e=[0,1]),isFinite(t[0])&&isFinite(t[1])||(s.DebugUtils.warn("Face.getBoundingBox: Surface is unbounded in v."),t=[0,1]),this._surface.getBoundingBox(e,t)},a.prototype.closestParam=function(e){return this._surface.closestParam(e)},a.prototype.isPlanarFace=function(){return this.getSurfaceType()===n.GEOMETRY_TYPES.PLANE},a.prototype.toObject=function(){return{loops:this.refsToStrings(this._loops),reversed:this._reversed,geometry:this.refToString(this._surface),attributes:this.refsToStrings(this._attributes)}},a.prototype.addToModelObject=function(e){this.addAllToModelObject(e,[this._loops,this._surface,this._attributes])},t.Face=a},1096:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Line=void 0;var r=i(1972),o=i(3344),n=i(2355),s=i(2468),a=i(1472),l=i(5896),c=i(4728),u=function(){a.Curve.call(this),this._position=r.Vector3.createFloat64FromValues(0,0,0),this._direction=r.Vector3.createFloat64FromValues(1,0,0)};(u.prototype=Object.create(a.Curve.prototype)).getGeometryType=function(){return s.GEOMETRY_TYPES.LINE},u.prototype.set=function(e,t){c.ConsoleUtils.assert(r.Vector3.squaredLength(t)>s.KERNEL_TOLERANCE*s.KERNEL_TOLERANCE),r.Vector3.copy(this._position,e),r.Vector3.copy(this._direction,t)},u.prototype.clone=function(){var e=new u;return e.copy(this),e},u.prototype.tessellate=function(e,t){var i={positions:[],offsets:[],tolerance:0};i.offsets.push(0);var r=e[0];i.positions.push(this.evaluatePosition(r));for(var o=1;o<e.length;++o){var n=e[o];i.positions.push(this.evaluatePosition(n)),i.offsets.push(i.positions.length-1),r=n}return i},u.prototype.copy=function(e){a.Curve.prototype.copy.call(this,e),r.Vector3.copy(this._position,e._position),r.Vector3.copy(this._direction,e._direction)},u.prototype.getRangeUnlimited=function(){return[-1/0,1/0]},u.prototype.isPeriodicUnlimited=function(){return!1},u.prototype.isClosedUnlimited=function(){return!1},u.prototype.evaluatePosition=function(e){var t=r.Vector3.createFloat64();return r.Vector3.scaleAndAdd(t,this._position,this._direction,e)},u.prototype.evaluateDt=function(e){return r.Vector3.clone(this._direction)},u.prototype.tangentLength=function(e){return r.Vector3.length(this._direction)},u.prototype.getTangentCone=function(e){var t=r.Vector3.createFloat64();return new n.TangentCone(r.Vector3.normalize(t,this.evaluateDt(0)),0)},u.prototype.getArcLength=function(e){return void 0===e?e=this.getRange():0===e.length&&(e=this.getRangeUnlimited()),isFinite(e[0])&&isFinite(e[1])?(e[1]-e[0])*r.Vector3.length(this._direction):1/0},u.prototype.getParameterFromArcLength=function(e,t){if(void 0===t?t=this.getRange():0===t.length&&(t=this.getRangeUnlimited()),isFinite(t[0])&&isFinite(t[1])){var i=t[0]+e/r.Vector3.length(this._direction);return(0,l.clamp)(i,t[0],t[1])}return NaN},u.prototype.getBoundingBox=function(e){void 0===e?e=this.getRange():0===e.length&&(e=this.getRangeUnlimited());var t=new o.BoundingBox;return isFinite(e[0])&&isFinite(e[1])?(t.includePoint(this.evaluatePosition(e[0])),t.includePoint(this.evaluatePosition(e[1]))):(t.includePoint([1/0,1/0,1/0]),t.includePoint([-1/0,-1/0,-1/0])),t},u.prototype.closestToRayParam=function(e,t,i,o){var n=r.Vector3.createFloat64();r.Vector3.sub(n,this._position,e);var s=r.Vector3.squaredLength(this._direction),a=r.Vector3.squaredLength(t),l=r.Vector3.dot(this._direction,t),c=r.Vector3.dot(n,this._direction),u=r.Vector3.dot(n,t),h=s*a-l*l,d=(l*u-a*c)/h,p=(l*c-s*u)/h;if(isFinite(d)&&isFinite(p)){if(i)if(d<i[0]){if(d=i[0],void 0!==o){var g=this.evaluatePosition(i[0]),f=r.Vector3.createFloat64();r.Vector3.sub(f,g,e),p=r.Vector3.dot(f,t)/a}}else if(d>i[1]&&(d=i[1],void 0!==o)){var v=this.evaluatePosition(i[1]);f=r.Vector3.createFloat64(),r.Vector3.sub(f,v,e),p=r.Vector3.dot(f,t)/a}if(void 0!==o){var m=this.evaluatePosition(d),y=r.Vector3.createFloat64();if(r.Vector3.scaleAndAdd(y,e,t,p),r.Vector3.squaredDistance(m,y)>o*o)return}return d}},u.prototype.setFromEndpoints=function(e,t){c.ConsoleUtils.assert(r.Vector3.squaredDistance(e,t)>s.KERNEL_TOLERANCE*s.KERNEL_TOLERANCE),this._position=r.Vector3.clone(e),r.Vector3.normalize(this._direction,r.Vector3.sub(this._direction,t,e)),this.unlimitRange()},u.prototype.transform=function(e){r.Vector3.transformMatrix44(this._position,this._position,e),r.Vector3.transformAsDirectionMatrix44(this._direction,this._direction,e)},u.prototype.closestToPointParam=function(e,t){void 0===t?t=this.getRange():0===t.length&&(t=this.getRangeUnlimited());var i=r.Vector3.createFloat64();r.Vector3.sub(i,e,this._position);var o=this._direction,n=r.Vector3.dot(i,o)/r.Vector3.squaredLength(o);return isFinite(t[0])&&isFinite(t[1])?(0,l.clamp)(n,t[0],t[1]):n},u.prototype.suggestSplittingParam=function(e){},u.prototype.toObject=function(){return{position:this.vectorToObject(this._position),direction:this.vectorToObject(this._direction),range:this.rangeToObject(this.getRange(),this.isLimited())}},t.Line=u},4524:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Loop=void 0;var r=i(9547),o=i(2468),n=function(){r.BaseTopology.call(this),this._coedges=[],this._face=void 0};(n.prototype=Object.create(r.BaseTopology.prototype)).getTopologyType=function(){return o.TOPOLOGY_TYPES.LOOP},n.prototype.getFace=function(){return this._face},n.prototype.setFace=function(e){this._face=e},n.prototype.getCoedges=function(){return this._coedges},n.prototype.setCoedges=function(e){this._coedges=new Array(e.length);for(var t=0;t<e.length;++t)this._coedges[t]=e[t]},n.prototype.addCoedge=function(e){this._coedges?this._coedges.push(e):this._coedges=[e],e.setLoop(this)},n.prototype.addCoedges=function(e){this._coedges||(this._coedges=[]);for(var t=0;t<e.length;++t)e[t].setLoop(this);this._coedges=this._coedges.concat(e)},n.prototype.removeCoedge=function(e){var t=this._coedges.indexOf(e);return t>-1&&(this._coedges.splice(t,1),e.getLoop()===this&&e.setLoop(void 0),!0)},n.prototype.getBody=function(){return this._face?this._face.getBody():void 0},n.prototype.collectFaces=function(e){return e=e||new Set,this._face&&e.add(this._face),e},n.prototype.collectEdges=function(e){e=e||new Set;for(var t=0;t<this._coedges.length;++t)this._coedges[t].collectEdges(e);return e},n.prototype.collectVertices=function(e){e=e||new Set;for(var t=0;t<this._coedges.length;++t)this._coedges[t].collectVertices(e);return e},n.prototype.toString=function(){return"Loop"},n.prototype.toObject=function(){return{coedges:this.refsToStrings(this._coedges),attributes:this.refsToStrings(this._attributes)}},n.prototype.addToModelObject=function(e){this.addAllToModelObject(e,[this._coedges,this._attributes])},t.Loop=n},5837:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Lump=void 0;var r=i(9547),o=i(2468),n=i(3344),s=function(){r.BaseTopology.call(this),this._shells=[],this._body=void 0};(s.prototype=Object.create(r.BaseTopology.prototype)).getTopologyType=function(){return o.TOPOLOGY_TYPES.LUMP},s.prototype.getBody=function(){return this._body},s.prototype.setBody=function(e){this._body=e},s.prototype.getShells=function(){return this._shells},s.prototype.setShells=function(e){this._shells=new Array(e.length);for(var t=0;t<e.length;++t)this._shells[t]=e[t]},s.prototype.addShell=function(e){this._shells?this._shells.push(e):this._shells=[e],e.setLump(this)},s.prototype.addShells=function(e){this._shells||(this._shells=[]);for(var t=0;t<e.length;++t)e[t].setLump(this);this._shells=this._shells.concat(e)},s.prototype.removeShell=function(e){var t=this._shells.indexOf(e);return t>-1&&(this._shells.splice(t,1),e.getLump()===this&&e.setLump(void 0),!0)},s.prototype.collectFaces=function(e){e=e||new Set;for(var t=0;t<this._shells.length;++t)this._shells[t].collectFaces(e);return e},s.prototype.collectEdges=function(e){e=e||new Set;for(var t=0;t<this._shells.length;++t)this._shells[t].collectEdges(e);return e},s.prototype.collectVertices=function(e){e=e||new Set;for(var t=0;t<this._shells.length;++t)this._shells[t].collectVertices(e);return e},s.prototype.getBoundingBox=function(){for(var e=new n.BoundingBox,t=0;t<this._shells.length;++t)e.include(this._shells[t].getBoundingBox());return e},s.prototype.toString=function(){return"Lump"},s.prototype.toObject=function(){return{shells:this.refsToStrings(this._shells),attributes:this.refsToStrings(this._attributes)}},s.prototype.addToModelObject=function(e){this.addAllToModelObject(e,[this._shells,this._attributes])},t.Lump=s},8292:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Plane=void 0;var r=i(1972),o=i(3344),n=i(2468),s=i(412),a=i(1096),l=i(4728),c=function(){s.Surface.call(this),this._origin=r.Vector3.createFloat64(),this._normal=r.Vector3.createFloat64(),this._uAxis=r.Vector3.createFloat64(),this._vAxis=r.Vector3.createFloat64()};(c.prototype=Object.create(s.Surface.prototype)).getGeometryType=function(){return n.GEOMETRY_TYPES.PLANE},c.prototype.clone=function(){var e=new c;return e.copy(this),e},c.prototype.copy=function(e){s.Surface.prototype.copy.call(this,e),r.Vector3.copy(this._origin,e._origin),r.Vector3.copy(this._normal,e._normal),r.Vector3.copy(this._uAxis,e._uAxis),r.Vector3.copy(this._vAxis,e._vAxis)},c.prototype._computeVAxis=function(){r.Vector3.cross(this._vAxis,this._normal,this._uAxis)},c.prototype.set=function(e,t,i){r.Vector3.copy(this._origin,e),l.ConsoleUtils.assert(r.Vector3.squaredLength(t)>n.KERNEL_TOLERANCE*n.KERNEL_TOLERANCE),r.Vector3.normalize(this._normal,t),void 0===i||r.Vector3.squaredLength(i)<n.KERNEL_TOLERANCE*n.KERNEL_TOLERANCE?(r.Vector3.computeOrthogonal(this._uAxis,this._normal),r.Vector3.normalize(this._uAxis,this._uAxis)):(l.ConsoleUtils.assert(r.Vector3.isOrthogonal(i,t,n.KERNEL_ANGULAR_TOLERANCE)),r.Vector3.copy(this._uAxis,i)),this._computeVAxis()},c.prototype.getOrigin=function(){return this._origin},c.prototype.setOrigin=function(e){r.Vector3.copy(this._origin,e)},c.prototype.getNormal=function(){return this._normal},c.prototype.setNormal=function(e){l.ConsoleUtils.assert(r.Vector3.squaredLength(e)>n.KERNEL_TOLERANCE*n.KERNEL_TOLERANCE),r.Vector3.normalize(this._normal,e),(r.Vector3.squaredLength(this._uAxis)<=n.KERNEL_TOLERANCE*n.KERNEL_TOLERANCE||!r.Vector3.isOrthogonal(this._uAxis,this._normal,n.KERNEL_ANGULAR_TOLERANCE))&&(r.Vector3.computeOrthogonal(this._uAxis,this._normal),r.Vector3.normalize(this._uAxis,this._uAxis)),this._computeVAxis()},c.prototype.getUAxis=function(){return this._uAxis},c.prototype.setUAxis=function(e){l.ConsoleUtils.assert(r.Vector3.squaredLength(e)>n.KERNEL_TOLERANCE*n.KERNEL_TOLERANCE),r.Vector3.copy(this._uAxis,e),this._computeVAxis()},c.prototype.evaluatePosition=function(e,t){var i=r.Vector3.clone(this._origin);return r.Vector3.scaleAndAdd(i,i,this._uAxis,e),r.Vector3.scaleAndAdd(i,i,this._vAxis,t),i},c.prototype.evaluateNormal=function(e,t){return r.Vector3.clone(this._normal)},c.prototype.evaluateDu=function(e,t){return r.Vector3.clone(this._uAxis)},c.prototype.evaluateDv=function(e,t){return r.Vector3.clone(this._vAxis)},c.prototype.closestParam=function(e){var t=r.Vector3.createFloat64();return r.Vector3.sub(t,e,this._origin),{u:r.Vector3.dot(t,this._uAxis)/r.Vector3.squaredLength(this._uAxis),v:r.Vector3.dot(t,this._vAxis)/r.Vector3.squaredLength(this._vAxis)}},c.prototype.vParamLine=function(e){var t=new a.Line;return t.set(this.evaluatePosition(e,0),this._vAxis),t},c.prototype.uParamLine=function(e){var t=new a.Line;return t.set(this.evaluatePosition(0,e),this._uAxis),t},c.prototype.getBoundingBox=function(e,t){var i=new o.BoundingBox;return e&&t?(i.includePoint(this.evaluatePosition(e[0],t[0])),i.includePoint(this.evaluatePosition(e[0],t[1])),i.includePoint(this.evaluatePosition(e[1],t[1])),i.includePoint(this.evaluatePosition(e[1],t[0]))):(i.includePoint([-1/0,-1/0,-1/0]),i.includePoint([1/0,1/0,1/0])),i},c.prototype.transform=function(e){r.Vector3.transformMatrix44(this._origin,this._origin,e),r.Vector3.transformAsDirectionMatrix44(this._uAxis,this._uAxis,e),r.Vector3.transformAsDirectionMatrix44(this._vAxis,this._vAxis,e),r.Vector3.transformAsDirectionMatrix44(this._normal,this._normal,e),r.Vector3.normalize(this._normal,this._normal)},c.prototype.getRangeUnlimitedU=function(){return[-1/0,1/0]},c.prototype.getRangeUnlimitedV=function(){return[-1/0,1/0]},c.prototype.isPeriodicUnlimitedU=function(){return!1},c.prototype.isPeriodicUnlimitedV=function(){return!1},c.prototype.isClosedUnlimitedU=function(){return!1},c.prototype.isClosedUnlimitedV=function(){return!1},c.prototype.toObject=function(){return{origin:this.vectorToObject(this._origin),normal:this.vectorToObject(this._normal),uAxis:this.vectorToObject(this._uAxis),uRange:this.rangeToObject(this.getRangeU(),this.isLimitedU()),vRange:this.rangeToObject(this.getRangeV(),this.isLimitedV())}},t.Plane=c},3565:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Point=void 0;var r=i(1972),o=i(9024),n=i(3344),s=i(2468),a=function(e){o.BaseGeometry.call(this),this._position=r.Vector3.createFloat64(),e&&r.Vector3.copy(this._position,e)};(a.prototype=Object.create(o.BaseGeometry.prototype)).getGeometryType=function(){return s.GEOMETRY_TYPES.POINT},a.prototype.clone=function(){var e=new a;return e.copy(this),e},a.prototype.copy=function(e){o.BaseGeometry.prototype.copy.call(this,e),this.copyPosition(e.getPosition())},a.prototype.getPosition=function(){return this._position},a.prototype.copyPosition=function(e){r.Vector3.copy(this._position,e)},a.prototype.setPosition=function(e,t,i){r.Vector3.set(this._position,e,t,i)},a.prototype.getBoundingBox=function(){var e=new n.BoundingBox;return e.includePoint(this.getPosition()),e},a.prototype.transform=function(e){r.Vector3.transformMatrix44(this._position,this._position,e)},a.prototype.toObject=function(){return{position:this.vectorToObject(this._position)}},t.Point=a},6508:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Shell=void 0;var r=i(9547),o=i(2468),n=i(3344),s=function(){r.BaseTopology.call(this),this._faces=[],this._lump=void 0};(s.prototype=Object.create(r.BaseTopology.prototype)).getTopologyType=function(){return o.TOPOLOGY_TYPES.SHELL},s.prototype.getLump=function(){return this._lump},s.prototype.setLump=function(e){this._lump=e},s.prototype.getFaces=function(){return this._faces},s.prototype.setFaces=function(e){this._faces=new Array(e.length);for(var t=0;t<e.length;++t)this._faces[t]=e[t]},s.prototype.addFace=function(e){this._faces?this._faces.push(e):this._faces=[e],e.setShell(this)},s.prototype.addFaces=function(e){this._faces||(this._faces=[]);for(var t=0;t<e.length;++t)e[t].setShell(this);this._faces=this._faces.concat(e)},s.prototype.removeFace=function(e){var t=this._faces.indexOf(e);return t>-1&&(this._faces.splice(t,1),e.getShell()===this&&e.setShell(void 0),!0)},s.prototype.getBody=function(){return this._lump?this._lump.getBody():void 0},s.prototype.collectFaces=function(e){e=e||new Set;for(var t=0;t<this._faces.length;++t)e.add(this._faces[t]);return e},s.prototype.collectEdges=function(e){e=e||new Set;for(var t=0;t<this._faces.length;++t)this._faces[t].collectEdges(e);return e},s.prototype.collectVertices=function(e){e=e||new Set;for(var t=0;t<this._faces.length;++t)this._faces[t].collectVertices(e);return e},s.prototype.getBoundingBox=function(){for(var e=new n.BoundingBox,t=0;t<this._faces.length;++t)e.include(this._faces[t].getBoundingBox());return e},s.prototype.toString=function(){return"Shell"},s.prototype.toObject=function(){return{faces:this.refsToStrings(this._faces),attributes:this.refsToStrings(this._attributes)}},s.prototype.addToModelObject=function(e){this.addAllToModelObject(e,[this._faces,this._attributes])},t.Shell=s},2468:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=!1;"undefined"!=typeof window&&window.isJaguar&&(t.isSceneComposerEnv=i=!0);var r=!1;i&&(t.USE_LEGACY_LEIDS=r=window.isJaguar&&window.isJaguar()||!!JSON.parse(localStorage.getItem("USE_LEGACY_LEIDS"))),t.KERNEL_TOLERANCE=1e-6,t.KERNEL_ANGULAR_TOLERANCE=1e-10,t.PARAMETER_SPACE_TOLERANCE=1e-10,t.SPLINE_TANGENT_HANDLE_SCALE=1,t.SPLINE_DISTANCE_TOLERANCE=1e-4,t.DEFAULT_CURVE_RESOLUTION=64,t.isSceneComposerEnv=i,t.NO_ID="",t.USE_LEGACY_LEIDS=r,t.TESSELLATION={LINEAR_PRECISION:1e-4,ANGULAR_PRECISION:1e-5},t.GEOMETRY_TYPES={POINT:1,BCURVE:2,CIRCLE:3,ELLIPSE:4,HAPCURVE:5,LINE:6,BSURFACE:7,CONE:8,CYLINDER:9,ELLIPTICAL_CONE:10,ELLIPTICAL_CYLINDER:11,PLANE:12,SPHERE:13,TORUS:14,toString:function(e){switch(e){case this.POINT:return"Point";case this.BCURVE:return"BCurve";case this.CIRCLE:return"Circle";case this.ELLIPSE:return"Ellipse";case this.HAPCURVE:return"HapCurve";case this.LINE:return"Line";case this.BSURFACE:return"BSurface";case this.CONE:return"Cone";case this.CYLINDER:return"Cylinder";case this.ELLIPTICAL_CONE:return"EllipticalCone";case this.ELLIPTICAL_CYLINDER:return"EllipticalCylinder";case this.PLANE:return"Plane";case this.SPHERE:return"Sphere";case this.TORUS:return"Torus";default:return"unknown"}}},t.TOPOLOGY_TYPES={VERTEX:1,EDGE:2,COEDGE:3,LOOP:4,FACE:5,SHELL:6,LUMP:7,BODY:8,WIRE:9,WIREBODY:10,toString:function(e){switch(e){case this.VERTEX:return"Vertex";case this.EDGE:return"Edge";case this.COEDGE:return"Coedge";case this.LOOP:return"Loop";case this.FACE:return"Face";case this.SHELL:return"Shell";case this.LUMP:return"Lump";case this.BODY:return"Body";case this.WIRE:return"Wire";case this.WIREBODY:return"WireBody";default:return"unknown"}}}},4372:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Sphere=void 0;var r=i(1972),o=i(5896),n=i(2468),s=i(412),a=i(3565),l=i(5512),c=i(4728),u=function(){s.Surface.call(this),this._center=r.Vector3.createFloat64(),this._radius=0,this._xAxis=r.Vector3.createFloat64(),this._yAxis=r.Vector3.createFloat64(),this._zAxis=r.Vector3.createFloat64()};(u.prototype=Object.create(s.Surface.prototype)).getGeometryType=function(){return n.GEOMETRY_TYPES.SPHERE},u.prototype.clone=function(){var e=new u;return e.copy(this),e},u.prototype.copy=function(e){s.Surface.prototype.copy.call(this,e),this._radius=e._radius,r.Vector3.copy(this._center,e._center),r.Vector3.copy(this._xAxis,e._xAxis),r.Vector3.copy(this._yAxis,e._yAxis),r.Vector3.copy(this._zAxis,e._zAxis)},u.prototype._computeYAxis=function(){r.Vector3.cross(this._yAxis,this._xAxis,this._zAxis)},u.prototype.set=function(e,t,i,o){r.Vector3.copy(this._center,e),c.ConsoleUtils.assert(t>n.KERNEL_TOLERANCE),this._radius=t;var s=void 0===i||r.Vector3.squaredLength(i)<n.KERNEL_TOLERANCE*n.KERNEL_TOLERANCE,a=void 0===o||r.Vector3.squaredLength(o)<n.KERNEL_TOLERANCE*n.KERNEL_TOLERANCE;s&&a?(r.Vector3.set(this._xAxis,1,0,0),r.Vector3.set(this._zAxis,0,0,1)):s?(r.Vector3.normalize(this._xAxis,o),r.Vector3.computeOrthogonal(this._zAxis,this._xAxis),r.Vector3.normalize(this._zAxis,this._zAxis)):a?(r.Vector3.normalize(this._zAxis,i),r.Vector3.computeOrthogonal(this._xAxis,this._zAxis),r.Vector3.normalize(this._xAxis,this._xAxis)):(c.ConsoleUtils.assert(r.Vector3.isOrthogonal(i,o,n.KERNEL_ANGULAR_TOLERANCE)),r.Vector3.normalize(this._xAxis,o),r.Vector3.normalize(this._zAxis,i)),this._computeYAxis()},u.prototype.getRadius=function(){return this._radius},u.prototype.setRadius=function(e){c.ConsoleUtils.assert(e>n.KERNEL_TOLERANCE),this._radius=e},u.prototype.getCenter=function(){return this._center},u.prototype.setCenter=function(e){r.Vector3.copy(this._center,e)},u.prototype.getAxisDir=function(){return this._zAxis},u.prototype.setAxisDir=function(e){c.ConsoleUtils.assert(r.Vector3.squaredLength(e)>n.KERNEL_TOLERANCE*n.KERNEL_TOLERANCE),r.Vector3.normalize(this._zAxis,e),(r.Vector3.squaredLength(this._xAxis)<=n.KERNEL_TOLERANCE*n.KERNEL_TOLERANCE||!r.Vector3.isOrthogonal(this._xAxis,this._zAxis,n.KERNEL_ANGULAR_TOLERANCE))&&(r.Vector3.computeOrthogonal(this._xAxis,this._zAxis),r.Vector3.normalize(this._xAxis,this._xAxis)),this._computeYAxis()},u.prototype.getUvOriginDir=function(){return this._xAxis},u.prototype.setUvOriginDir=function(e){c.ConsoleUtils.assert(r.Vector3.squaredLength(e)>n.KERNEL_TOLERANCE*n.KERNEL_TOLERANCE),r.Vector3.normalize(this._xAxis,e),(r.Vector3.squaredLength(this._zAxis)<=n.KERNEL_TOLERANCE*n.KERNEL_TOLERANCE||!r.Vector3.isOrthogonal(this._xAxis,this._zAxis,n.KERNEL_ANGULAR_TOLERANCE))&&(r.Vector3.computeOrthogonal(this._zAxis,this._xAxis),r.Vector3.normalize(this._zAxis,this._zAxis)),this._computeYAxis()},u.prototype.evaluatePosition=function(e,t){var i=Math.sin(e),o=Math.cos(e),n=Math.sin(t),s=Math.cos(t),a=this._radius*o*s,l=this._radius*o*n,c=this._radius*i,u=r.Vector3.clone(this._center);return r.Vector3.scaleAndAdd(u,u,this._xAxis,a),r.Vector3.scaleAndAdd(u,u,this._yAxis,l),r.Vector3.scaleAndAdd(u,u,this._zAxis,c),u},u.prototype.evaluateNormal=function(e,t){var i=Math.sin(e),o=Math.cos(e),n=Math.sin(t),s=o*Math.cos(t),a=o*n,l=i,c=r.Vector3.createFloat64();return r.Vector3.scale(c,this._xAxis,s),r.Vector3.scaleAndAdd(c,c,this._yAxis,a),r.Vector3.scaleAndAdd(c,c,this._zAxis,l),c},u.prototype.evaluateDu=function(e,t){var i=Math.sin(e),o=Math.cos(e),n=Math.sin(t),s=Math.cos(t),a=-this._radius*i*s,l=-this._radius*i*n,c=this._radius*o,u=r.Vector3.createFloat64();return r.Vector3.scale(u,this._xAxis,a),r.Vector3.scaleAndAdd(u,u,this._yAxis,l),r.Vector3.scaleAndAdd(u,u,this._zAxis,c),u},u.prototype.evaluateDv=function(e,t){var i=Math.cos(e),o=Math.sin(t),n=Math.cos(t),s=-this._radius*i*o,a=this._radius*i*n,l=r.Vector3.createFloat64();return r.Vector3.scale(l,this._xAxis,s),r.Vector3.scaleAndAdd(l,l,this._yAxis,a),l},u.prototype.closestParam=function(e){var t=r.Vector3.createFloat64();r.Vector3.sub(t,e,this._center);var i=r.Vector3.length(t);if(i<n.KERNEL_TOLERANCE)return{u:0,v:0};var s=r.Vector3.dot(t,this._xAxis),a=r.Vector3.dot(t,this._yAxis),l=r.Vector3.dot(t,this._zAxis);return{u:Math.asin((0,o.clamp)(l/i,-1,1)),v:Math.atan2(a,s)}},u.prototype.vParamLine=function(e){var t=Math.cos(e),i=Math.sin(e),o=this._radius*t,s=this._radius*i;if(Math.abs(o)>n.KERNEL_TOLERANCE){var c=new l.Circle,u=r.Vector3.clone(this._center);r.Vector3.scaleAndAdd(u,u,this._zAxis,s);var h=r.Vector3.clone(this._xAxis);r.Vector3.scale(h,h,o);var d=r.Vector3.clone(this._zAxis);return r.Vector3.negate(d,d),c.set(u,d,h),c}var p=r.Vector3.clone(this._center);return s=s<0?-this._radius:this._radius,r.Vector3.scaleAndAdd(p,p,this._zAxis,s),new a.Point(p)},u.prototype.uParamLine=function(e){var t=new l.Circle,i=Math.sin(e),o=Math.cos(e),n=this._radius*o,s=this._radius*i,a=r.Vector3.clone(this._xAxis);r.Vector3.scale(a,a,-s),r.Vector3.scaleAndAdd(a,a,this._yAxis,n),r.Vector3.normalize(a,a);var c=r.Vector3.clone(this._xAxis);return r.Vector3.scale(c,c,n),r.Vector3.scaleAndAdd(c,c,this._yAxis,s),t.set(this._center,a,c),t},u.prototype.getBoundingBox=function(e,t){e=e||[-Math.PI/2,Math.PI/2],t=t||[-Math.PI,Math.PI];var i=e[0],n=e[1],s=t[0],a=t[1],l=this.vParamLine(i).getBoundingBox(t);l.include(this.vParamLine(n).getBoundingBox(t)),l.include(this.uParamLine(s).getBoundingBox(e)),l.include(this.uParamLine(a).getBoundingBox(e));for(var c=r.Vector3.createFloat64(),u=0;u<3;++u)for(var h=0;h<2;++h){var d=0===h?1:-1,p=Math.atan2(d*this._yAxis[u],d*this._xAxis[u]),g=Math.asin(d*this._zAxis[u]);p=(0,o.adjustParameterToPeriodicRange)(p,t,o.PI2),g>i&&g<n&&p>s&&p<a&&(r.Vector3.set(c,0,0,0),c[u]=d*this._radius,l.includePoint(r.Vector3.add(c,this._center,c)))}return l},u.prototype.transform=function(e){r.Vector3.transformMatrix44(this._center,this._center,e),r.Vector3.transformAsDirectionMatrix44(this._xAxis,this._xAxis,e),r.Vector3.transformAsDirectionMatrix44(this._yAxis,this._yAxis,e),r.Vector3.transformAsDirectionMatrix44(this._zAxis,this._zAxis,e);var t=r.Vector3.length(this._xAxis);this._radius*=t,r.Vector3.normalize(this._xAxis,this._xAxis),r.Vector3.normalize(this._yAxis,this._yAxis),r.Vector3.normalize(this._zAxis,this._zAxis)},u.prototype.getRangeUnlimitedU=function(){return[-Math.PI/2,Math.PI/2]},u.prototype.getRangeUnlimitedV=function(){return[-Math.PI,Math.PI]},u.prototype.isPeriodicUnlimitedU=function(){return!1},u.prototype.isPeriodicUnlimitedV=function(){return!0},u.prototype.isClosedUnlimitedU=function(){return!1},u.prototype.isClosedUnlimitedV=function(){return!0},u.prototype.toObject=function(){const e=this.evaluatePosition(0,0);return r.Vector3.sub(e,e,this.getCenter()),{center:this.vectorToObject(this.getCenter()),radius:this.vectorToObject(e),axis:this.vectorToObject(this.getAxisDir()),uRange:this.rangeToObject(this.getRangeU(),this.isLimitedU()),vRange:this.rangeToObject(this.getRangeV(),this.isLimitedV())}},t.Sphere=u},412:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Surface=void 0;var r=i(1972),o=i(9024),n=i(2468),s=i(5896),a=function(){o.BaseGeometry.call(this),this._subrangeU=[],this._subrangeV=[]};(a.prototype=Object.create(o.BaseGeometry.prototype)).copy=function(e){o.BaseGeometry.prototype.copy.call(this,e),this._subrangeU=e.isLimitedU()?[e._subrangeU[0],e._subrangeU[1]]:[],this._subrangeV=e.isLimitedV()?[e._subrangeV[0],e._subrangeV[1]]:[]},a.prototype.isLimitedU=function(){return this._subrangeU.length>0},a.prototype.isLimitedV=function(){return this._subrangeV.length>0},a.prototype.getRangeU=function(){return this.isLimitedU()?this._subrangeU:this.getRangeUnlimitedU()},a.prototype.getRangeV=function(){return this.isLimitedV()?this._subrangeV:this.getRangeUnlimitedV()},a.prototype.getRangeUnlimitedU=function(){console.warn("Surface.getRangeUnlimitedU : abstract method invoked!")},a.prototype.getRangeUnlimitedV=function(){console.warn("Surface.getRangeUnlimitedV : abstract method invoked!")},a.prototype.limitRangeU=function(e){var t=this.getRangeU();this._subrangeU=(0,s.limitRange)(t,e,this.isPeriodicU(),this.getPeriodU())},a.prototype.limitRangeV=function(e){var t=this.getRangeV();this._subrangeV=(0,s.limitRange)(t,e,this.isPeriodicV(),this.getPeriodV())},a.prototype.unlimitRangeU=function(){this._subrangeU=[]},a.prototype.unlimitRangeV=function(){this._subrangeV=[]},a.prototype.isPeriodicU=function(){return this.isPeriodicUnlimitedU()&&!this.isLimitedU()},a.prototype.isPeriodicV=function(){return this.isPeriodicUnlimitedV()&&!this.isLimitedV()},a.prototype.isPeriodicUnlimitedU=function(){console.warn("Surface.isPeriodicUnlimitedU : abstract method invoked!")},a.prototype.isPeriodicUnlimitedV=function(){console.warn("Surface.isPeriodicUnlimitedV : abstract method invoked!")},a.prototype.getPeriodU=function(){return this.isLimitedU()?void 0:this.getPeriodUnlimitedU()},a.prototype.getPeriodV=function(){return this.isLimitedV()?void 0:this.getPeriodUnlimitedV()},a.prototype.getPeriodUnlimitedU=function(){if(this.isPeriodicUnlimitedU()){var e=this.getRangeUnlimitedU();return e[1]-e[0]}},a.prototype.getPeriodUnlimitedV=function(){if(this.isPeriodicUnlimitedV()){var e=this.getRangeUnlimitedV();return e[1]-e[0]}},a.prototype.isClosedU=function(){if(this.isClosedUnlimitedU()){if(this.isLimitedU()){var e=this.getRangeUnlimitedU(),t=e[1]-e[0];return this._subrangeU[1]-this._subrangeU[0]>t-n.PARAMETER_SPACE_TOLERANCE}return!0}return!1},a.prototype.isClosedV=function(){if(this.isClosedUnlimitedV()){if(this.isLimitedV()){var e=this.getRangeUnlimitedV(),t=e[1]-e[0];return this._subrangeV[1]-this._subrangeV[0]>t-n.PARAMETER_SPACE_TOLERANCE}return!0}return!1},a.prototype.isClosedUnlimitedU=function(){console.warn("Surface.isClosedUnlimitedU : abstract method invoked!")},a.prototype.isClosedUnlimitedV=function(){console.warn("Surface.isClosedUnlimitedV : abstract method invoked!")},a.prototype.evaluatePosition=function(e,t){console.warn("Surface.evaluatePosition : abstract method invoked")},a.prototype.evaluateDu=function(e,t){console.warn("Surface.evaluateDu : abstract method invoked")},a.prototype.evaluateDv=function(e,t){console.warn("Surface.evaluateDv : abstract method invoked")},a.prototype.evaluateNormal=function(e,t){var i=this.evaluateDu(e,t);return r.Vector3.cross(i,i,this.evaluateDv(e,t)),r.Vector3.normalize(i,i),i},a.prototype.closestParam=function(e){console.warn("Surface.closestParam : abstract method invoked")},a.prototype.vParamLine=function(e){console.warn("Surface.vParamLine : abstract method invoked, returning undefined")},a.prototype.uParamLine=function(e){console.warn("Surface.uParamLine : abstract method invoked, returning undefined")},a.prototype.getBoundingBox=function(e,t){console.warn("Surface.getBoundingBox : abstract method invoked, returning undefined")},a.prototype.transform=function(e){console.warn("Surface.transform : abstract method invoked")},t.Surface=a},1408:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Torus=void 0;var r=i(1972),o=i(5896),n=i(2468),s=i(412),a=i(3565),l=i(5512),c=i(4728),u=function(){s.Surface.call(this),this._center=r.Vector3.createFloat64(),this._majorRadius=0,this._minorRadius=0,this._lemon=!1,this._xAxis=r.Vector3.createFloat64(),this._yAxis=r.Vector3.createFloat64(),this._zAxis=r.Vector3.createFloat64()};(u.prototype=Object.create(s.Surface.prototype)).getGeometryType=function(){return n.GEOMETRY_TYPES.TORUS},u.prototype.clone=function(){var e=new u;return e.copy(this),e},u.prototype.copy=function(e){s.Surface.prototype.copy.call(this,e),this._majorRadius=e._majorRadius,this._minorRadius=e._minorRadius,this._lemon=e._lemon,r.Vector3.copy(this._center,e._center),r.Vector3.copy(this._xAxis,e._xAxis),r.Vector3.copy(this._yAxis,e._yAxis),r.Vector3.copy(this._zAxis,e._zAxis)},u.prototype._computeYAxis=function(){r.Vector3.cross(this._yAxis,this._xAxis,this._zAxis)},u.prototype.set=function(e,t,i,o,s,a){r.Vector3.copy(this._center,e),c.ConsoleUtils.assert(t>n.KERNEL_TOLERANCE),this._majorRadius=t,c.ConsoleUtils.assert(i>n.KERNEL_TOLERANCE),this._minorRadius=i,c.ConsoleUtils.assert(r.Vector3.squaredLength(o)>n.KERNEL_TOLERANCE*n.KERNEL_TOLERANCE),r.Vector3.normalize(this._zAxis,o),void 0!==s&&r.Vector3.squaredLength(s)>n.KERNEL_TOLERANCE*n.KERNEL_TOLERANCE?(c.ConsoleUtils.assert(r.Vector3.isOrthogonal(o,s,n.KERNEL_ANGULAR_TOLERANCE)),r.Vector3.normalize(this._xAxis,s)):(r.Vector3.computeOrthogonal(this._xAxis,this._zAxis),r.Vector3.normalize(this._xAxis,this._xAxis)),this._lemon=!0===a,this._computeYAxis()},u.prototype.getMajorRadius=function(){return this._majorRadius},u.prototype.setMajorRadius=function(e){c.ConsoleUtils.assert(e>n.KERNEL_TOLERANCE),this._majorRadius=e},u.prototype.getMinorRadius=function(){return this._minorRadius},u.prototype.setMinorRadius=function(e){c.ConsoleUtils.assert(e>n.KERNEL_TOLERANCE),this._minorRadius=e},u.prototype.getCenter=function(){return this._center},u.prototype.setCenter=function(e){r.Vector3.copy(this._center,e)},u.prototype.getAxisDir=function(){return this._zAxis},u.prototype.setAxisDir=function(e){c.ConsoleUtils.assert(r.Vector3.squaredLength(e)>n.KERNEL_TOLERANCE*n.KERNEL_TOLERANCE),r.Vector3.normalize(this._zAxis,e),(r.Vector3.squaredLength(this._xAxis)<=n.KERNEL_TOLERANCE*n.KERNEL_TOLERANCE||!r.Vector3.isOrthogonal(this._xAxis,this._zAxis,n.KERNEL_ANGULAR_TOLERANCE))&&(r.Vector3.computeOrthogonal(this._xAxis,this._zAxis),r.Vector3.normalize(this._xAxis,this._xAxis)),this._computeYAxis()},u.prototype.getUvOriginDir=function(){return this._xAxis},u.prototype.setUvOriginDir=function(e){c.ConsoleUtils.assert(r.Vector3.squaredLength(e)>n.KERNEL_TOLERANCE*n.KERNEL_TOLERANCE),r.Vector3.normalize(this._xAxis,e),this._computeYAxis()},u.prototype.isDoughnut=function(){return this._majorRadius>this._minorRadius+n.KERNEL_TOLERANCE},u.prototype.isVortex=function(){return Math.abs(this._majorRadius-this._minorRadius)<=n.KERNEL_TOLERANCE},u.prototype.isApple=function(){return this._majorRadius<this._minorRadius-n.KERNEL_TOLERANCE&&!this._lemon},u.prototype.isLemon=function(){return this._majorRadius<this._minorRadius-n.KERNEL_TOLERANCE&&this._lemon},u.prototype.setLemon=function(e){this._lemon=e},u.prototype.getSingularUParams=function(){var e,t,i;return this.isDoughnut()?[]:this.isApple()?(e=-this._majorRadius,t=this._minorRadius,[-(i=Math.acos(e/t)),i]):this.isLemon()?(e=this._minorRadius-this._majorRadius,t=this._minorRadius,[-(i=Math.acos(e/t)),i]):[-Math.PI,Math.PI]},u.prototype.evaluatePosition=function(e,t){var i=this._minorRadius*Math.cos(e);this.isLemon()?i-=this._majorRadius:i+=this._majorRadius;var o=i*Math.cos(t),n=i*Math.sin(t),s=this._minorRadius*Math.sin(e),a=r.Vector3.clone(this._center);return r.Vector3.scaleAndAdd(a,a,this._xAxis,o),r.Vector3.scaleAndAdd(a,a,this._yAxis,n),r.Vector3.scaleAndAdd(a,a,this._zAxis,s),a},u.prototype.evaluateNormal=function(e,t){var i=Math.sin(e),o=Math.cos(e),n=Math.sin(t),s=o*Math.cos(t),a=o*n,l=i,c=r.Vector3.createFloat64();return r.Vector3.scale(c,this._xAxis,s),r.Vector3.scaleAndAdd(c,c,this._yAxis,a),r.Vector3.scaleAndAdd(c,c,this._zAxis,l),c},u.prototype.evaluateDu=function(e,t){var i=-this._minorRadius*Math.sin(e),o=i*Math.cos(t),n=i*Math.sin(t),s=this._minorRadius*Math.cos(e),a=r.Vector3.createFloat64();return r.Vector3.scale(a,this._xAxis,o),r.Vector3.scaleAndAdd(a,a,this._yAxis,n),r.Vector3.scaleAndAdd(a,a,this._zAxis,s),a},u.prototype.evaluateDv=function(e,t){var i=this._minorRadius*Math.cos(e);this.isLemon()?i-=this._majorRadius:i+=this._majorRadius;var o=-i*Math.sin(t),n=i*Math.cos(t),s=r.Vector3.createFloat64();return r.Vector3.scale(s,this._xAxis,o),r.Vector3.scaleAndAdd(s,s,this._yAxis,n),s},u.prototype.closestParam=function(e){var t=r.Vector3.createFloat64();r.Vector3.sub(t,e,this._center);var i=r.Vector3.dot(t,this._xAxis),o=r.Vector3.dot(t,this._yAxis),s=r.Vector3.dot(t,this._zAxis),a=Math.sqrt(i*i+o*o);return this.isLemon()?a+=this._majorRadius:a-=this._majorRadius,{u:s*s+a*a>n.KERNEL_TOLERANCE*n.KERNEL_TOLERANCE?Math.atan2(s,a):0,v:i*i+o*o>n.KERNEL_TOLERANCE*n.KERNEL_TOLERANCE?Math.atan2(o,i):0}},u.prototype.vParamLine=function(e){var t=this._minorRadius*Math.cos(e);this.isLemon()?t-=this._majorRadius:t+=this._majorRadius;var i=this._minorRadius*Math.sin(e);if(Math.abs(t)>n.KERNEL_TOLERANCE){var o=new l.Circle,s=r.Vector3.clone(this._center);r.Vector3.scaleAndAdd(s,s,this._zAxis,i);var c=r.Vector3.clone(this._xAxis);r.Vector3.scale(c,c,t);var u=r.Vector3.clone(this._zAxis);return r.Vector3.negate(u,u),o.set(s,u,c),o}var h=r.Vector3.clone(this._center),d=this.getSingularUParams();return d[0]&&i<0?i=this._minorRadius*Math.sin(d[0]):d[1]&&i>0&&(i=this._minorRadius*Math.sin(d[1])),r.Vector3.scaleAndAdd(h,h,this._zAxis,i),new a.Point(h)},u.prototype.uParamLine=function(e){var t=new l.Circle,i=Math.sin(e),o=Math.cos(e),n=this._majorRadius*o,s=this._majorRadius*i;this.isLemon()&&(n=-n,s=-s);var a=r.Vector3.clone(this._center);r.Vector3.scaleAndAdd(a,a,this._xAxis,n),r.Vector3.scaleAndAdd(a,a,this._yAxis,s);var c=this._minorRadius*o,u=this._minorRadius*i,h=r.Vector3.clone(this._xAxis);r.Vector3.scale(h,h,-u),r.Vector3.scaleAndAdd(h,h,this._yAxis,c),r.Vector3.normalize(h,h);var d=r.Vector3.clone(this._xAxis);return r.Vector3.scale(d,d,c),r.Vector3.scaleAndAdd(d,d,this._yAxis,u),t.set(a,h,d),t},u.prototype.getBoundingBox=function(e,t){e=e||(this.isDoughnut()?[-Math.PI,Math.PI]:this.getSingularUParams()),t=t||[-Math.PI,Math.PI];var i=e[0],n=e[1],s=t[0],a=t[1],l=this.vParamLine(i).getBoundingBox(t);l.include(this.vParamLine(n).getBoundingBox(t)),l.include(this.uParamLine(s).getBoundingBox(e)),l.include(this.uParamLine(a).getBoundingBox(e));for(var c=r.Vector3.createFloat64(),u=r.Vector3.createFloat64(),h=0;h<3;++h)for(var d=0;d<2;++d){var p=0===d?-1:1,g=Math.atan2(p*this._yAxis[h],p*this._xAxis[h]);if((g=(0,o.adjustParameterToPeriodicRange)(g,t,o.PI2))>s&&g<a){var f=this.uParamLine(g);c=f.evaluatePosition(0),r.Vector3.sub(c,c,f.getCenter()),u=f.evaluatePosition(Math.PI/2),r.Vector3.sub(u,u,f.getCenter());var v=(0,o.minMaxCosSinFunc)(c[h],u[h],f.getCenter()[h],e);0===h?l.includeX(v[d]):1===h?l.includeY(v[d]):l.includeZ(v[d])}}return l},u.prototype.transform=function(e){r.Vector3.transformMatrix44(this._center,this._center,e),r.Vector3.transformAsDirectionMatrix44(this._xAxis,this._xAxis,e),r.Vector3.transformAsDirectionMatrix44(this._yAxis,this._yAxis,e),r.Vector3.transformAsDirectionMatrix44(this._zAxis,this._zAxis,e);var t=r.Vector3.length(this._xAxis);this._majorRadius*=t,this._minorRadius*=t,r.Vector3.normalize(this._xAxis,this._xAxis),r.Vector3.normalize(this._yAxis,this._yAxis),r.Vector3.normalize(this._zAxis,this._zAxis)},u.prototype.getRangeUnlimitedU=function(){return this.isDoughnut()?[-Math.PI,Math.PI]:this.getSingularUParams()},u.prototype.getRangeUnlimitedV=function(){return[-Math.PI,Math.PI]},u.prototype.isPeriodicUnlimitedU=function(){return this.isDoughnut()},u.prototype.isPeriodicUnlimitedV=function(){return!0},u.prototype.isClosedUnlimitedU=function(){return this.isDoughnut()||this.isVortex()},u.prototype.isClosedUnlimitedV=function(){return!0},u.prototype.toObject=function(){const e=this.evaluatePosition(0,0);return r.Vector3.sub(e,e,this.getCenter()),{center:this.vectorToObject(this.getCenter()),coordAxis:this.vectorToObject(this.getUvOriginDir()),axis:this.vectorToObject(this.getAxisDir()),majorRadius:this.getMajorRadius(),minorRadius:this.getMinorRadius(),lemon:this.isLemon(),uRange:this.rangeToObject(this.getRangeU(),this.isLimitedU()),vRange:this.rangeToObject(this.getRangeV(),this.isLimitedV())}},t.Torus=u},6940:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Vertex=void 0;var r=i(9547),o=i(2468),n=i(4728),s=i(9608),a=function(e){r.BaseTopology.call(this),this._point=e,this._precision=0,this._edges=[]};(a.prototype=Object.create(r.BaseTopology.prototype)).getTopologyType=function(){return o.TOPOLOGY_TYPES.VERTEX},a.prototype.getPoint=function(){return this._point},a.prototype.setPoint=function(e){this._point=e},a.prototype.getPrecision=function(){return this._precision},a.prototype.setPrecision=function(e){n.ConsoleUtils.assert(e>=0),this._precision=e},a.prototype.getEdges=function(){return this._edges},a.prototype.isAdjacentEdge=function(e){return-1!==this._edges.indexOf(e)},a.prototype.getOtherEdge=function(e){for(var t=0;t<this._edges.length;t++){var i=this._edges[t];if(i!==e)return i}return null},a.prototype.getOtherEdges=function(e){for(var t=[],i=0;i<this._edges.length;i++){var r=this._edges[i];r!==e&&t.push(r)}return t},a.prototype.getAdjacentVertices=function(){for(var e=[],t=0;t<this._edges.length;t++){var i=this._edges[t].getOtherVertex(this);i!==this&&e.indexOf(i)<0&&e.push(i)}return e},a.prototype.getCommonEdges=function(e){for(var t=[],i=0;i<this._edges.length;i++){var r=this._edges[i],o=r.getStartVertex(),n=r.getEndVertex();(o===this&&n===e||n===this&&o===e)&&t.push(r)}return t},a.prototype.addEdge=function(e){-1===this._edges.indexOf(e)&&this._edges.push(e)},a.prototype.removeEdge=function(e){var t=this._edges.indexOf(e);return t>=0&&(this._edges.splice(t,1),!0)},a.prototype.getPosition=function(){return this._point.getPosition()},a.prototype.getBody=function(){return this._edges.length>0?this._edges[0].getBody():void 0},a.prototype.collectFaces=function(e){e=e||new Set;for(var t=0;t<this._edges.length;++t)this._edges[t].collectFaces(e);return e},a.prototype.collectEdges=function(e){e=e||new Set;for(var t=0;t<this._edges.length;++t)e.add(this._edges[t]);return e},a.prototype.collectVertices=function(e){return(e=e||new Set).add(this),e},a.prototype.getBoundingBox=function(){return this._point.getBoundingBox()},a.prototype.toString=function(){return String(this._point.getPosition())},a.prototype.getOrderedFaces=function(){const e=[],t=(0,s.getOrderedFacesOnVertex)(this);for(let i=0;i<t.length;i++)t[i].faces.forEach((t=>{e.push(t)}));return e},a.prototype.toObject=function(){return{geometry:this.refToString(this._point),precision:this.getPrecision(),attributes:this.refsToStrings(this._attributes)}},a.prototype.addToModelObject=function(e){this.addAllToModelObject(e,[this._point,this._attributes])},t.Vertex=a},7575:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Wire=void 0;var r=i(9547),o=i(3344),n=i(2468),s=function(){r.BaseTopology.call(this),this._wireBody=void 0,this._edges=[]};(s.prototype=Object.create(r.BaseTopology.prototype)).getTopologyType=function(){return n.TOPOLOGY_TYPES.WIRE},s.prototype.getWireBody=function(){return this._wireBody},s.prototype.setWireBody=function(e){this._wireBody=e},s.prototype.getEdges=function(){return this._edges},s.prototype.setEdges=function(e){this._edges=new Array(e.length);for(var t=0;t<e.length;++t)this._edges[t]=e[t]},s.prototype.addEdge=function(e){this._edges?this._edges.push(e):this._edges=[e],e.setWire(this),e.setCoedge(void 0)},s.prototype.addEdges=function(e){this._edges||(this._edges=[]);for(var t=0;t<e.length;++t)e[t].setWire(this),e[t].setCoedge(void 0);this._edges=this._edges.concat(e)},s.prototype.removeEdge=function(e){var t=this._edges.indexOf(e);return t>-1&&(this._edges.splice(t,1),e.getWire()===this&&e.setWire(void 0),!0)},s.prototype.getBody=function(){return this._wireBody},s.prototype.collectFaces=function(e){return e||new Set},s.prototype.collectEdges=function(e){e=e||new Set;for(var t=0;t<this._edges.length;++t)e.add(this._edges[t]);return e},s.prototype.collectVertices=function(e){e=e||new Set;for(var t=0;t<this._edges.length;++t)this._edges[t].collectVertices(e);return e},s.prototype.isBranched=function(){for(var e=0;e<this._edges.length;++e){var t=this._edges[e],i=t.getStartVertex(),r=t.getEndVertex();if(i===r&&i.getOtherEdge(t))return!0;if(i.getEdges().length>2||r.getEdges().length>2)return!0}return!1},s.prototype.getOrderedEdges=function(){if(0===this._edges.length)return{edges:[],start:void 0,end:void 0};var e=[];e.push(this._edges[0]);for(var t=new Set(this._edges.slice(1)),i=e[0].getStartVertex(),r=e[0].getEndVertex();t.size>0;){var o=t.size;if(t.forEach((function(o){o.getEndVertex()===i?(e.unshift(o),i=o.getStartVertex(),t.delete(o)):o.getStartVertex()===i?(e.unshift(o),i=o.getEndVertex(),t.delete(o)):o.getEndVertex()===r?(e.push(o),r=o.getStartVertex(),t.delete(o)):o.getStartVertex()===r&&(e.push(o),r=o.getEndVertex(),t.delete(o))})),o===t.size){console.warn("Wire is disconnected or branching.");break}}return{edges:e,start:i,end:r}},s.prototype.isClosed=function(){if(1===this._edges.length)return this._edges[0].getStartVertex()===this._edges[0].getEndVertex();for(var e=this._edges[0],t=void 0,i=0;i<this._edges.length;++i){var r,o=e.getStartVertex(),n=e.getEndVertex();if(o===n||2!==o.getEdges().length||2!==n.getEdges().length)return!1;if(t&&o.getOtherEdge(e)!==t){if(n.getOtherEdge(e)!==t)return!1;r=o.getOtherEdge(e)}else r=n.getOtherEdge(e);t=e,e=r}return e===this._edges[0]},s.prototype.getBoundingBox=function(){for(var e=new o.BoundingBox,t=0;t<this._edges.length;++t)e.include(this._edges[t].getBoundingBox());return e},s.prototype.toString=function(){return"Wire"},s.prototype.toObject=function(){return{edges:this.refsToStrings(this._edges),attributes:this.refsToStrings(this._attributes)}},s.prototype.addToModelObject=function(e){this.addAllToModelObject(e,[this._edges,this._attributes])},t.Wire=s},6500:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WireBody=void 0;var r=i(9547),o=i(2468),n=i(3344),s=i(7616),a=function(){r.BaseTopology.call(this),this._wires=[]};(a.prototype=Object.create(r.BaseTopology.prototype)).getTopologyType=function(){return o.TOPOLOGY_TYPES.WIREBODY},a.prototype.getWires=function(){return this._wires},a.prototype.setWires=function(e){this._wires=new Array(e.length);for(var t=0;t<e.length;++t)this._wires[t]=e[t]},a.prototype.addWire=function(e){this._wires?this._wires.push(e):this._wires=[e],e.setWireBody(this)},a.prototype.addWires=function(e){this._wires||(this._wires=[]);for(var t=0;t<e.length;++t)e[t].setWireBody(this);this._wires=this._wires.concat(e)},a.prototype.removeWire=function(e){var t=this._wires.indexOf(e);return t>-1&&(this._wires.splice(t,1),e.getWireBody()===this&&e.setWireBody(void 0),!0)},a.prototype.getBody=function(){return this},a.prototype.collectFaces=function(e){return e||new Set},a.prototype.collectEdges=function(e){e=e||new Set;for(var t=0;t<this._wires.length;++t)this._wires[t].collectEdges(e);return e},a.prototype.collectVertices=function(e){e=e||new Set;for(var t=0;t<this._wires.length;++t)this._wires[t].collectVertices(e);return e},a.prototype.getBoundingBox=function(){for(var e=new n.BoundingBox,t=0;t<this._wires.length;++t)e.include(this._wires[t].getBoundingBox());return e},a.prototype.transform=function(e){(0,s.transformTopology)(this,e)},a.prototype.toString=function(){return"WireBody"},a.prototype.toObject=function(){return{wires:this.refsToStrings(this._wires),attributes:this.refsToStrings(this._attributes)}},a.prototype.addToModelObject=function(e){this.addAllToModelObject(e,[this._wires,this._attributes])},t.WireBody=a},7392:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MatchFinder=void 0;var r=i(1972),o=i(2468),n=i(7808),s=i(6344),a=i(2208),l=i(4728),c=function(){this._edges1=[],this._edges2=[],this._verts1=[],this._verts2=[],this._vertexMatchMap=new Map,this._edgeMatchMap=new Map,this._sameEdgeLists=!1,this._newVertices=new Set,this._edgeProgenitors=new a.ProgenitorMap};c.prototype.addMergeToMap=function(e,t,i){var r=i.get(e),o=i.get(t);if(r&&!o)r.push(t),i.set(t,r);else if(!r&&o)o.push(e),i.set(e,o);else if(r||o){if(r&&o&&r!==o)for(var n=0;n<o.length;++n)r.push(o[n]),i.set(o[n],r)}else{var s=[e,t];i.set(e,s),i.set(t,s)}},c.prototype.addVertexMerge=function(e,t){this.addMergeToMap(e,t,this._vertexMatchMap)},c.prototype.addEdgeMerge=function(e,t){this.addMergeToMap(e,t,this._edgeMatchMap)},c.prototype.verticesMatch=function(e,t){var i=Math.max(e.getPrecision(),t.getPrecision(),o.KERNEL_TOLERANCE);return r.Vector3.squaredDistance(e.getPosition(),t.getPosition())<i*i},c.prototype.findEdgeSplitParam=function(e,t){var i=e.getStartVertex();if(i!==t){var n=e.getEndVertex();if(n!==t){var s=this._vertexMatchMap.get(i);if(!s||-1===s.indexOf(t)){var a=this._vertexMatchMap.get(n);if(!a||-1===a.indexOf(t)){var l=t.getPosition(),c=Math.max(t.getPrecision(),o.KERNEL_TOLERANCE),u=e.closestToPointParam(l);if(void 0!==u){var h=e.evaluatePosition(u);if(!(r.Vector3.squaredDistance(l,h)>c*c))return{param:u,position:h}}}}}}},c.prototype.matchVertices=function(){for(var e=new Set,t=0;t<this._edges1.length;++t)this._edges1[t].collectVertices(e);this._verts1=Array.from(e);var i=new Set;for(t=0;t<this._edges2.length;++t)this._edges2[t].collectVertices(i);this._verts2=Array.from(i);var r=this;e.forEach((function(e){i.forEach((function(t){e!==t&&r.verticesMatch(e,t)&&r.addVertexMerge(e,t)}))}))},c.prototype.findVertexOnEdgeSplits=function(e,t){for(var i=t.length,r=0;r<i;++r){for(var o=t[r],n=[],s=0;s<e.length;++s){var a=e[s],l=this.findEdgeSplitParam(o,a);l&&n.push({vertex:a,param:l.param,position:l.position})}if(n.length>0){var c=this.splitEdgeAtParams(o,n);if(c.length>0){t[r]=c[0];for(var u=1;u<c.length;++u)t.push(c[u])}}}},c.prototype.doEdgeSplits=function(){this.findVertexOnEdgeSplits(this._verts1,this._edges2),this._sameEdgeLists||this.findVertexOnEdgeSplits(this._verts2,this._edges1)},c.prototype.splitEdgeAtParams=function(e,t){t.sort((function(e,t){return e.param-t.param}));for(var i=[],s=e,a=0;a<t.length;++a){var l=t[a].vertex,c=t[a].param,u=t[a].position,h=s.getStartVertex().getPosition();if(r.Vector3.squaredDistance(u,h)<o.KERNEL_TOLERANCE*o.KERNEL_TOLERANCE)this.addVertexMerge(l,s.getStartVertex());else{0===i.length&&(s=(0,n.replaceEdge)(s),i.push(s),this._edgeProgenitors.addEntry(s,[e]));var d=(0,n.splitEdge)(s,c,u);i.push(d),this._edgeProgenitors.addEntry(d,[e]);var p=d.getStartVertex();this.addVertexMerge(l,p),this._newVertices.add(p),s=d}}return i},c.prototype.edgesMatch=function(e,t){return(0,s.edgesAreCoincident)(e,t)},c.prototype.matchEdges=function(){for(var e=this,t=0;t<this._edges1.length;++t)for(var i=this._edges1[t],r=i.getStartVertex(),o=i.getEndVertex(),n=0;n<this._edges2.length;++n){var s=this._edges2[n],a=s.getStartVertex(),l=s.getEndVertex();if(!(this._sameEdgeLists&&n<=t)&&i!==s){var c,u=r===a||r===l;if(!u){var h=e._vertexMatchMap.get(r);h&&(u=h===e._vertexMatchMap.get(a)||h===e._vertexMatchMap.get(l))}if(u&&!(c=o===a||o===l)){var d=e._vertexMatchMap.get(o);d&&(c=d===e._vertexMatchMap.get(a)||d===e._vertexMatchMap.get(l))}u&&c&&this.edgesMatch(i,s)&&this.addEdgeMerge(i,s)}}},c.prototype.setEdges=function(e,t){e instanceof Set?this._edges1=Array.from(e):e instanceof Array&&(this._edges1=e),t&&t!==e?t instanceof Set?this._edges2=Array.from(t):t instanceof Array&&(this._edges2=t):this._edges2=this._edges1,this._sameEdgeLists=this._edges1===this._edges2,l.ConsoleUtils.assert(this._edges1&&this._edges2)},c.prototype.compute=function(){this.matchVertices(),this.doEdgeSplits(),this.matchEdges()},c.prototype.getVertexMatches=function(){var e=new Set;return this._vertexMatchMap.forEach((function(t,i){e.add(t)})),Array.from(e)},c.prototype.getEdgeMatches=function(){var e=new Set;return this._edgeMatchMap.forEach((function(t,i){e.add(t)})),Array.from(e)},c.prototype.getNewVertices=function(){return this._newVertices},c.prototype.getEdgeProgenitors=function(){return this._edgeProgenitors},t.MatchFinder=c},7808:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.replaceEdge=t.splitEdge=void 0;var r=i(6940),o=i(7580),n=i(672),s=i(3565),a=function(e,t){var i=new n.Coedge;i.setEdge(t),e.getEdge().getCoedge()===e&&t.setCoedge(i),i.setReversed(e.isReversed()),i.setLoop(e.getLoop());var r=e.getLoop().getCoedges(),o=r.indexOf(e);return i.isReversed()?r.splice(o,0,i):r.splice((o+1)%r.length,0,i),i};t.splitEdge=function(e,t,i){var n=new r.Vertex(new s.Point(i)),l=[e.getRange()[0],e.getRange()[1]],c=e.getEndVertex();e.setRange([l[0],t]),e.setEndVertex(n);var u=new o.Edge;u.setCurve(e.getCurve()),u.setReversed(e.isReversed()),u.setRange([t,l[1]]),u.setStartVertex(n),u.setEndVertex(c),u.setPrecision(e.getPrecision()),u.setWire(e.getWire());for(var h=[],d=e.getCoedge();d;)h.push(a(d,u)),(d=d.getPartner())===e.getCoedge()&&(d=void 0);for(var p=0;p<h.length;++p){var g=(p+1)%h.length;h[p].setPartner(h[g])}if(u.getWire()){var f=u.getWire().getEdges().slice(),v=f.indexOf(e);f.splice(v+1,0,u),u.getWire().setEdges(f)}return u},t.replaceEdge=function(e){var t=new o.Edge;t.setCurve(e.getCurve()),t.setReversed(e.isReversed()),t.setRange([e.getRange()[0],e.getRange()[1]]),t.setStartVertex(e.getStartVertex()),t.setEndVertex(e.getEndVertex()),t.setPrecision(e.getPrecision()),t.setCoedge(e.getCoedge()),t.setWire(e.getWire()),e.setStartVertex(null),e.setEndVertex(null),e.setCoedge(void 0),e.setWire(void 0);for(var i=t.getCoedge();i;)i.setEdge(t),(i=i.getPartner())===t.getCoedge()&&(i=void 0);if(t.getWire()){var r=t.getWire().getEdges().slice(),n=r.indexOf(e);r[n]=t,t.getWire().setEdges(r)}return t}},1008:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TopologyStitcher=void 0;var r=i(1972),o=i(7392),n=i(2208),s=i(4728),a=function(){this._shellSet=new Set,this._lumpSet=new Set,this._bodySet=new Set,this._wireSet=new Set,this._progenitorMap=new n.ProgenitorMap};a.prototype.initMerge=function(){this._shellSet.clear(),this._lumpSet.clear(),this._bodySet.clear(),this._wireSet.clear()},a.prototype.getEdgeOwnerToMerge=function(e){var t=e.getWire();if(t)this._wireSet.add(t);else{var i=function(e){var t=e.getCoedge();if(t){var i=t.getFace();if(i)return i.getShell()}}(e);i&&this._shellSet.add(i)}},a.prototype.getVertexOwnerToMerge=function(e){var t=e.getEdges();t.length>0&&this.getEdgeOwnerToMerge(t[0])},a.prototype.stitchVertices=function(e,t){var i;this.initMerge();var r=void 0;for(i=0;i<e.length;++i)if(!t||!t.has(e[i])){r=e[i];break}s.ConsoleUtils.assert(r);var o=[];for(i=0;i<e.length;++i)if(this.getVertexOwnerToMerge(e[i]),e[i]!==r){for(var n=e[i],a=n.getEdges().slice(0),l=0;l<a.length;++l){var c=a[l];c.getStartVertex()===n&&c.setStartVertex(r),c.getEndVertex()===n&&c.setEndVertex(r)}s.ConsoleUtils.assert(0===n.getEdges().length),t&&t.has(n)||o.push(n)}o.length>0&&this._progenitorMap.addEntry(r,o),this.mergeTopology()},a.prototype.stitchEdges=function(e,t){var i,o=e[0];for(i=0;i<e.length;++i)if(!t||!t.has(e[i])){o=e[i];break}var n=[],s=[];for(i=0;i<e.length;++i){var a=e[i],l=!1;if(a.getStartVertex()!==o.getStartVertex()&&a.getStartVertex()===o.getEndVertex()){var c=a.evaluateDt(a.t0()),u=o.evaluateDt(o.t1());r.Vector3.dot(c,u)<0&&(l=!0)}for(var h=a.getCoedge();h;)n.push(h),l&&h.setReversed(!h.isReversed()),(h=h.getPartner())===a.getCoedge()&&(h=void 0);a!==o&&(a.setStartVertex(null),a.setEndVertex(null),s.push(a))}for(this.initMerge(),i=0;i<n.length;++i){var d=n[i];this.getEdgeOwnerToMerge(d.getEdge()),d.setEdge(o);var p=(i+1)%n.length;d.setPartner(n[p])}this.mergeTopology(),this._progenitorMap.addEntry(o,s)},a.prototype.mergeTopology=function(){if(this._shellSet.size>1&&this.mergeShells(),this._wireSet.size>1)throw new Error("Merging wires in TopologyStitcher is not yet supported.")},a.prototype.mergeShells=function(){var e=new n.ProgenitorMap;if(this._shellSet.size>1){var t=Array.from(this._shellSet),i=t[0],r=i.getLump();r&&this._lumpSet.add(r);for(var o=1;o<t.length;++o){var s=t[o];i.addFaces(s.getFaces()),s.setFaces([]),(r=s.getLump())&&(r.removeShell(s),this._lumpSet.add(r))}e.addEntry(i,t.slice(1))}if(this._lumpSet.size>1){var a=Array.from(this._lumpSet),l=a[0],c=l.getBody();for(c&&this._bodySet.add(c),o=1;o<a.length;++o){var u=a[o];l.addShells(u.getShells()),u.setShells([]),(c=u.getBody())&&(c.removeLump(u),this._bodySet.add(c))}e.addEntry(l,a.slice(1))}if(this._bodySet.size>1){var h=Array.from(this._bodySet),d=h[0];for(o=1;o<h.length;++o){for(var p=h[o],g=p.getLumps().slice(0),f=0;f<g.length;++f)g[f].getShells().length>0&&d.addLump(g[f]);p.setLumps([])}e.addEntry(d,h.slice(1))}e.size()>0&&(this._progenitorMap=e.collapseMaps(this._progenitorMap,{keepIntermediates:!0,keepAllDescendants:!0}))},a.prototype.getProgenitorMap=function(){return this._progenitorMap},a.prototype.stitchTwoEdgeSets=function(e,t){var i=new o.MatchFinder;i.setEdges(e,t),i.compute();for(var r=i.getVertexMatches(),n=i.getEdgeMatches(),s=i.getNewVertices(),a=new Set(i.getEdgeProgenitors().getAllNewTopology()),l=0;l<r.length;++l)this.stitchVertices(r[l],s);for(l=0;l<n.length;++l)this.stitchEdges(n[l],a);this._progenitorMap=this._progenitorMap.collapseMaps(i.getEdgeProgenitors(),{keepIntermediates:!1,keepAllDescendants:!0})},a.prototype.stitchTwoTopology=function(e,t){s.ConsoleUtils.assert("function"==typeof e.collectEdges),s.ConsoleUtils.assert("function"==typeof t.collectEdges);var i=e.collectEdges(),r=t.collectEdges();this.stitchTwoEdgeSets(i,r)},a.prototype.stitchEdgeSet=function(e){this.stitchTwoEdgeSets(e,e)},t.TopologyStitcher=a},4883:(e,t,i)=>{"use strict";e.exports=i(4392)},3056:(e,t,i)=>{"use strict";var r=t,o=i(1376),n=i(32);function s(e,t,i,r){var n=!1;if(t.resolvedType)if(t.resolvedType instanceof o){e("switch(d%s){",r);for(var s=t.resolvedType.values,a=Object.keys(s),l=0;l<a.length;++l)s[a[l]]!==t.typeDefault||n||(e("default:")('if(typeof(d%s)==="number"){m%s=d%s;break}',r,r,r),t.repeated||e("break"),n=!0),e("case%j:",a[l])("case %i:",s[a[l]])("m%s=%j",r,s[a[l]])("break");e("}")}else e('if(typeof d%s!=="object")',r)("throw TypeError(%j)",t.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",r,i,r);else{var c=!1;switch(t.type){case"double":case"float":e("m%s=Number(d%s)",r,r);break;case"uint32":case"fixed32":e("m%s=d%s>>>0",r,r);break;case"int32":case"sint32":case"sfixed32":e("m%s=d%s|0",r,r);break;case"uint64":c=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":e("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",r,r,c)('else if(typeof d%s==="string")',r)("m%s=parseInt(d%s,10)",r,r)('else if(typeof d%s==="number")',r)("m%s=d%s",r,r)('else if(typeof d%s==="object")',r)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",r,r,r,c?"true":"");break;case"bytes":e('if(typeof d%s==="string")',r)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",r,r,r)("else if(d%s.length >= 0)",r)("m%s=d%s",r,r);break;case"string":e("m%s=String(d%s)",r,r);break;case"bool":e("m%s=Boolean(d%s)",r,r)}}return e}function a(e,t,i,r){if(t.resolvedType)t.resolvedType instanceof o?e("d%s=o.enums===String?(types[%i].values[m%s]===undefined?m%s:types[%i].values[m%s]):m%s",r,i,r,r,i,r,r):e("d%s=types[%i].toObject(m%s,o)",r,i,r);else{var n=!1;switch(t.type){case"double":case"float":e("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",r,r,r,r);break;case"uint64":n=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":e('if(typeof m%s==="number")',r)("d%s=o.longs===String?String(m%s):m%s",r,r,r)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",r,r,r,r,n?"true":"",r);break;case"bytes":e("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",r,r,r,r,r);break;default:e("d%s=m%s",r,r)}}return e}r.fromObject=function(e){var t=e.fieldsArray,i=n.codegen(["d"],e.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!t.length)return i("return new this.ctor");i("var m=new this.ctor");for(var r=0;r<t.length;++r){var a=t[r].resolve(),l=n.safeProp(a.name);a.map?(i("if(d%s){",l)('if(typeof d%s!=="object")',l)("throw TypeError(%j)",a.fullName+": object expected")("m%s={}",l)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",l),s(i,a,r,l+"[ks[i]]")("}")("}")):a.repeated?(i("if(d%s){",l)("if(!Array.isArray(d%s))",l)("throw TypeError(%j)",a.fullName+": array expected")("m%s=[]",l)("for(var i=0;i<d%s.length;++i){",l),s(i,a,r,l+"[i]")("}")("}")):(a.resolvedType instanceof o||i("if(d%s!=null){",l),s(i,a,r,l),a.resolvedType instanceof o||i("}"))}return i("return m")},r.toObject=function(e){var t=e.fieldsArray.slice().sort(n.compareFieldsById);if(!t.length)return n.codegen()("return {}");for(var i=n.codegen(["m","o"],e.name+"$toObject")("if(!o)")("o={}")("var d={}"),r=[],s=[],l=[],c=0;c<t.length;++c)t[c].partOf||(t[c].resolve().repeated?r:t[c].map?s:l).push(t[c]);if(r.length){for(i("if(o.arrays||o.defaults){"),c=0;c<r.length;++c)i("d%s=[]",n.safeProp(r[c].name));i("}")}if(s.length){for(i("if(o.objects||o.defaults){"),c=0;c<s.length;++c)i("d%s={}",n.safeProp(s[c].name));i("}")}if(l.length){for(i("if(o.defaults){"),c=0;c<l.length;++c){var u=l[c],h=n.safeProp(u.name);if(u.resolvedType instanceof o)i("d%s=o.enums===String?%j:%j",h,u.resolvedType.valuesById[u.typeDefault],u.typeDefault);else if(u.long)i("if(util.Long){")("var n=new util.Long(%i,%i,%j)",u.typeDefault.low,u.typeDefault.high,u.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",h)("}else")("d%s=o.longs===String?%j:%i",h,u.typeDefault.toString(),u.typeDefault.toNumber());else if(u.bytes){var d="["+Array.prototype.slice.call(u.typeDefault).join(",")+"]";i("if(o.bytes===String)d%s=%j",h,String.fromCharCode.apply(String,u.typeDefault))("else{")("d%s=%s",h,d)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",h,h)("}")}else i("d%s=%j",h,u.typeDefault)}i("}")}var p=!1;for(c=0;c<t.length;++c){u=t[c];var g=e._fieldsArray.indexOf(u);h=n.safeProp(u.name),u.map?(p||(p=!0,i("var ks2")),i("if(m%s&&(ks2=Object.keys(m%s)).length){",h,h)("d%s={}",h)("for(var j=0;j<ks2.length;++j){"),a(i,u,g,h+"[ks2[j]]")("}")):u.repeated?(i("if(m%s&&m%s.length){",h,h)("d%s=[]",h)("for(var j=0;j<m%s.length;++j){",h),a(i,u,g,h+"[j]")("}")):(i("if(m%s!=null&&m.hasOwnProperty(%j)){",h,u.name),a(i,u,g,h),u.partOf&&i("if(o.oneofs)")("d%s=%j",n.safeProp(u.partOf.name),u.name)),i("}")}return i("return d")}},9708:(e,t,i)=>{"use strict";e.exports=function(e){var t=n.codegen(["r","l"],e.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(e.fieldsArray.filter((function(e){return e.map})).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()");e.group&&t("if((t&7)===4)")("break"),t("switch(t>>>3){");for(var i=0;i<e.fieldsArray.length;++i){var a=e._fieldsArray[i].resolve(),l=a.resolvedType instanceof r?"int32":a.type,c="m"+n.safeProp(a.name);t("case %i: {",a.id),a.map?(t("if(%s===util.emptyObject)",c)("%s={}",c)("var c2 = r.uint32()+r.pos"),void 0!==o.defaults[a.keyType]?t("k=%j",o.defaults[a.keyType]):t("k=null"),void 0!==o.defaults[l]?t("value=%j",o.defaults[l]):t("value=null"),t("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",a.keyType)("case 2:"),void 0===o.basic[l]?t("value=types[%i].decode(r,r.uint32())",i):t("value=r.%s()",l),t("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),void 0!==o.long[a.keyType]?t('%s[typeof k==="object"?util.longToHash(k):k]=value',c):t("%s[k]=value",c)):a.repeated?(t("if(!(%s&&%s.length))",c,c)("%s=[]",c),void 0!==o.packed[l]&&t("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",c,l)("}else"),void 0===o.basic[l]?t(a.resolvedType.group?"%s.push(types[%i].decode(r))":"%s.push(types[%i].decode(r,r.uint32()))",c,i):t("%s.push(r.%s())",c,l)):void 0===o.basic[l]?t(a.resolvedType.group?"%s=types[%i].decode(r)":"%s=types[%i].decode(r,r.uint32())",c,i):t("%s=r.%s()",c,l),t("break")("}")}for(t("default:")("r.skipType(t&7)")("break")("}")("}"),i=0;i<e._fieldsArray.length;++i){var u=e._fieldsArray[i];u.required&&t("if(!m.hasOwnProperty(%j))",u.name)("throw util.ProtocolError(%j,{instance:m})",s(u))}return t("return m")};var r=i(1376),o=i(1908),n=i(32);function s(e){return"missing required '"+e.name+"'"}},4752:(e,t,i)=>{"use strict";e.exports=function(e){for(var t,i=n.codegen(["m","w"],e.name+"$encode")("if(!w)")("w=Writer.create()"),a=e.fieldsArray.slice().sort(n.compareFieldsById),l=0;l<a.length;++l){var c=a[l].resolve(),u=e._fieldsArray.indexOf(c),h=c.resolvedType instanceof r?"int32":c.type,d=o.basic[h];t="m"+n.safeProp(c.name),c.map?(i("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",t,c.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",t)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(c.id<<3|2)>>>0,8|o.mapKey[c.keyType],c.keyType),void 0===d?i("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",u,t):i(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|d,h,t),i("}")("}")):c.repeated?(i("if(%s!=null&&%s.length){",t,t),c.packed&&void 0!==o.packed[h]?i("w.uint32(%i).fork()",(c.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",t)("w.%s(%s[i])",h,t)("w.ldelim()"):(i("for(var i=0;i<%s.length;++i)",t),void 0===d?s(i,c,u,t+"[i]"):i("w.uint32(%i).%s(%s[i])",(c.id<<3|d)>>>0,h,t)),i("}")):(c.optional&&i("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",t,c.name),void 0===d?s(i,c,u,t):i("w.uint32(%i).%s(%s)",(c.id<<3|d)>>>0,h,t))}return i("return w")};var r=i(1376),o=i(1908),n=i(32);function s(e,t,i,r){return t.resolvedType.group?e("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",i,r,(t.id<<3|3)>>>0,(t.id<<3|4)>>>0):e("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",i,r,(t.id<<3|2)>>>0)}},1376:(e,t,i)=>{"use strict";e.exports=s;var r=i(5392);((s.prototype=Object.create(r.prototype)).constructor=s).className="Enum";var o=i(2088),n=i(32);function s(e,t,i,o,n,s){if(r.call(this,e,i),t&&"object"!=typeof t)throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=o,this.comments=n||{},this.valuesOptions=s,this.reserved=void 0,t)for(var a=Object.keys(t),l=0;l<a.length;++l)"number"==typeof t[a[l]]&&(this.valuesById[this.values[a[l]]=t[a[l]]]=a[l])}s.fromJSON=function(e,t){var i=new s(e,t.values,t.options,t.comment,t.comments);return i.reserved=t.reserved,i},s.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return n.toObject(["options",this.options,"valuesOptions",this.valuesOptions,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",t?this.comment:void 0,"comments",t?this.comments:void 0])},s.prototype.add=function(e,t,i,r){if(!n.isString(e))throw TypeError("name must be a string");if(!n.isInteger(t))throw TypeError("id must be an integer");if(void 0!==this.values[e])throw Error("duplicate name '"+e+"' in "+this);if(this.isReservedId(t))throw Error("id "+t+" is reserved in "+this);if(this.isReservedName(e))throw Error("name '"+e+"' is reserved in "+this);if(void 0!==this.valuesById[t]){if(!this.options||!this.options.allow_alias)throw Error("duplicate id "+t+" in "+this);this.values[e]=t}else this.valuesById[this.values[e]=t]=e;return r&&(void 0===this.valuesOptions&&(this.valuesOptions={}),this.valuesOptions[e]=r||null),this.comments[e]=i||null,this},s.prototype.remove=function(e){if(!n.isString(e))throw TypeError("name must be a string");var t=this.values[e];if(null==t)throw Error("name '"+e+"' does not exist in "+this);return delete this.valuesById[t],delete this.values[e],delete this.comments[e],this.valuesOptions&&delete this.valuesOptions[e],this},s.prototype.isReservedId=function(e){return o.isReservedId(this.reserved,e)},s.prototype.isReservedName=function(e){return o.isReservedName(this.reserved,e)}},8376:(e,t,i)=>{"use strict";e.exports=c;var r=i(5392);((c.prototype=Object.create(r.prototype)).constructor=c).className="Field";var o,n=i(1376),s=i(1908),a=i(32),l=/^required|optional|repeated$/;function c(e,t,i,o,n,c,u){if(a.isObject(o)?(u=n,c=o,o=n=void 0):a.isObject(n)&&(u=c,c=n,n=void 0),r.call(this,e,c),!a.isInteger(t)||t<0)throw TypeError("id must be a non-negative integer");if(!a.isString(i))throw TypeError("type must be a string");if(void 0!==o&&!l.test(o=o.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(void 0!==n&&!a.isString(n))throw TypeError("extend must be a string");"proto3_optional"===o&&(o="optional"),this.rule=o&&"optional"!==o?o:void 0,this.type=i,this.id=t,this.extend=n||void 0,this.required="required"===o,this.optional=!this.required,this.repeated="repeated"===o,this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=!!a.Long&&void 0!==s.long[i],this.bytes="bytes"===i,this.resolvedType=null,this.extensionField=null,this.declaringField=null,this._packed=null,this.comment=u}c.fromJSON=function(e,t){return new c(e,t.id,t.type,t.rule,t.extend,t.options,t.comment)},Object.defineProperty(c.prototype,"packed",{get:function(){return null===this._packed&&(this._packed=!1!==this.getOption("packed")),this._packed}}),c.prototype.setOption=function(e,t,i){return"packed"===e&&(this._packed=null),r.prototype.setOption.call(this,e,t,i)},c.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return a.toObject(["rule","optional"!==this.rule&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])},c.prototype.resolve=function(){if(this.resolved)return this;if(void 0===(this.typeDefault=s.defaults[this.type])?(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof o?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]):this.options&&this.options.proto3_optional&&(this.typeDefault=null),this.options&&null!=this.options.default&&(this.typeDefault=this.options.default,this.resolvedType instanceof n&&"string"==typeof this.typeDefault&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&(!0!==this.options.packed&&(void 0===this.options.packed||!this.resolvedType||this.resolvedType instanceof n)||delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=a.Long.fromNumber(this.typeDefault,"u"===this.type.charAt(0)),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&"string"==typeof this.typeDefault){var e;a.base64.test(this.typeDefault)?a.base64.decode(this.typeDefault,e=a.newBuffer(a.base64.length(this.typeDefault)),0):a.utf8.write(this.typeDefault,e=a.newBuffer(a.utf8.length(this.typeDefault)),0),this.typeDefault=e}return this.map?this.defaultValue=a.emptyObject:this.repeated?this.defaultValue=a.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof o&&(this.parent.ctor.prototype[this.name]=this.defaultValue),r.prototype.resolve.call(this)},c.d=function(e,t,i,r){return"function"==typeof t?t=a.decorateType(t).name:t&&"object"==typeof t&&(t=a.decorateEnum(t).name),function(o,n){a.decorateType(o.constructor).add(new c(n,e,t,i,{default:r}))}},c._configure=function(e){o=e}},4392:(e,t,i)=>{"use strict";var r=e.exports=i(8040);r.build="light",r.load=function(e,t,i){return"function"==typeof t?(i=t,t=new r.Root):t||(t=new r.Root),t.load(e,i)},r.loadSync=function(e,t){return t||(t=new r.Root),t.loadSync(e)},r.encoder=i(4752),r.decoder=i(9708),r.verifier=i(1688),r.converter=i(3056),r.ReflectionObject=i(5392),r.Namespace=i(2088),r.Root=i(968),r.Enum=i(1376),r.Type=i(9288),r.Field=i(8376),r.OneOf=i(8232),r.MapField=i(188),r.Service=i(8616),r.Method=i(4208),r.Message=i(8700),r.wrappers=i(1508),r.types=i(1908),r.util=i(32),r.ReflectionObject._configure(r.Root),r.Namespace._configure(r.Type,r.Service,r.Enum),r.Root._configure(r.Type),r.Field._configure(r.Type)},8040:(e,t,i)=>{"use strict";var r=t;function o(){r.util._configure(),r.Writer._configure(r.BufferWriter),r.Reader._configure(r.BufferReader)}r.build="minimal",r.Writer=i(2664),r.BufferWriter=i(8135),r.Reader=i(4064),r.BufferReader=i(6388),r.util=i(9712),r.rpc=i(1164),r.roots=i(6696),r.configure=o,o()},188:(e,t,i)=>{"use strict";e.exports=s;var r=i(8376);((s.prototype=Object.create(r.prototype)).constructor=s).className="MapField";var o=i(1908),n=i(32);function s(e,t,i,o,s,a){if(r.call(this,e,t,o,void 0,void 0,s,a),!n.isString(i))throw TypeError("keyType must be a string");this.keyType=i,this.resolvedKeyType=null,this.map=!0}s.fromJSON=function(e,t){return new s(e,t.id,t.keyType,t.type,t.options,t.comment)},s.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return n.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])},s.prototype.resolve=function(){if(this.resolved)return this;if(void 0===o.mapKey[this.keyType])throw Error("invalid key type: "+this.keyType);return r.prototype.resolve.call(this)},s.d=function(e,t,i){return"function"==typeof i?i=n.decorateType(i).name:i&&"object"==typeof i&&(i=n.decorateEnum(i).name),function(r,o){n.decorateType(r.constructor).add(new s(o,e,t,i))}}},8700:(e,t,i)=>{"use strict";e.exports=o;var r=i(9712);function o(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)this[t[i]]=e[t[i]]}o.create=function(e){return this.$type.create(e)},o.encode=function(e,t){return this.$type.encode(e,t)},o.encodeDelimited=function(e,t){return this.$type.encodeDelimited(e,t)},o.decode=function(e){return this.$type.decode(e)},o.decodeDelimited=function(e){return this.$type.decodeDelimited(e)},o.verify=function(e){return this.$type.verify(e)},o.fromObject=function(e){return this.$type.fromObject(e)},o.toObject=function(e,t){return this.$type.toObject(e,t)},o.prototype.toJSON=function(){return this.$type.toObject(this,r.toJSONOptions)}},4208:(e,t,i)=>{"use strict";e.exports=n;var r=i(5392);((n.prototype=Object.create(r.prototype)).constructor=n).className="Method";var o=i(32);function n(e,t,i,n,s,a,l,c,u){if(o.isObject(s)?(l=s,s=a=void 0):o.isObject(a)&&(l=a,a=void 0),void 0!==t&&!o.isString(t))throw TypeError("type must be a string");if(!o.isString(i))throw TypeError("requestType must be a string");if(!o.isString(n))throw TypeError("responseType must be a string");r.call(this,e,l),this.type=t||"rpc",this.requestType=i,this.requestStream=!!s||void 0,this.responseType=n,this.responseStream=!!a||void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=c,this.parsedOptions=u}n.fromJSON=function(e,t){return new n(e,t.type,t.requestType,t.responseType,t.requestStream,t.responseStream,t.options,t.comment,t.parsedOptions)},n.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return o.toObject(["type","rpc"!==this.type&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",t?this.comment:void 0,"parsedOptions",this.parsedOptions])},n.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),r.prototype.resolve.call(this))}},2088:(e,t,i)=>{"use strict";e.exports=h;var r=i(5392);((h.prototype=Object.create(r.prototype)).constructor=h).className="Namespace";var o,n,s,a=i(8376),l=i(32),c=i(8232);function u(e,t){if(e&&e.length){for(var i={},r=0;r<e.length;++r)i[e[r].name]=e[r].toJSON(t);return i}}function h(e,t){r.call(this,e,t),this.nested=void 0,this._nestedArray=null}function d(e){return e._nestedArray=null,e}h.fromJSON=function(e,t){return new h(e,t.options).addJSON(t.nested)},h.arrayToJSON=u,h.isReservedId=function(e,t){if(e)for(var i=0;i<e.length;++i)if("string"!=typeof e[i]&&e[i][0]<=t&&e[i][1]>t)return!0;return!1},h.isReservedName=function(e,t){if(e)for(var i=0;i<e.length;++i)if(e[i]===t)return!0;return!1},Object.defineProperty(h.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=l.toArray(this.nested))}}),h.prototype.toJSON=function(e){return l.toObject(["options",this.options,"nested",u(this.nestedArray,e)])},h.prototype.addJSON=function(e){if(e)for(var t,i=Object.keys(e),r=0;r<i.length;++r)t=e[i[r]],this.add((void 0!==t.fields?o.fromJSON:void 0!==t.values?s.fromJSON:void 0!==t.methods?n.fromJSON:void 0!==t.id?a.fromJSON:h.fromJSON)(i[r],t));return this},h.prototype.get=function(e){return this.nested&&this.nested[e]||null},h.prototype.getEnum=function(e){if(this.nested&&this.nested[e]instanceof s)return this.nested[e].values;throw Error("no such enum: "+e)},h.prototype.add=function(e){if(!(e instanceof a&&void 0!==e.extend||e instanceof o||e instanceof c||e instanceof s||e instanceof n||e instanceof h))throw TypeError("object must be a valid nested object");if(this.nested){var t=this.get(e.name);if(t){if(!(t instanceof h&&e instanceof h)||t instanceof o||t instanceof n)throw Error("duplicate name '"+e.name+"' in "+this);for(var i=t.nestedArray,r=0;r<i.length;++r)e.add(i[r]);this.remove(t),this.nested||(this.nested={}),e.setOptions(t.options,!0)}}else this.nested={};return this.nested[e.name]=e,e.onAdd(this),d(this)},h.prototype.remove=function(e){if(!(e instanceof r))throw TypeError("object must be a ReflectionObject");if(e.parent!==this)throw Error(e+" is not a member of "+this);return delete this.nested[e.name],Object.keys(this.nested).length||(this.nested=void 0),e.onRemove(this),d(this)},h.prototype.define=function(e,t){if(l.isString(e))e=e.split(".");else if(!Array.isArray(e))throw TypeError("illegal path");if(e&&e.length&&""===e[0])throw Error("path must be relative");for(var i=this;e.length>0;){var r=e.shift();if(i.nested&&i.nested[r]){if(!((i=i.nested[r])instanceof h))throw Error("path conflicts with non-namespace objects")}else i.add(i=new h(r))}return t&&i.addJSON(t),i},h.prototype.resolveAll=function(){for(var e=this.nestedArray,t=0;t<e.length;)e[t]instanceof h?e[t++].resolveAll():e[t++].resolve();return this.resolve()},h.prototype.lookup=function(e,t,i){if("boolean"==typeof t?(i=t,t=void 0):t&&!Array.isArray(t)&&(t=[t]),l.isString(e)&&e.length){if("."===e)return this.root;e=e.split(".")}else if(!e.length)return this;if(""===e[0])return this.root.lookup(e.slice(1),t);var r=this.get(e[0]);if(r){if(1===e.length){if(!t||t.indexOf(r.constructor)>-1)return r}else if(r instanceof h&&(r=r.lookup(e.slice(1),t,!0)))return r}else for(var o=0;o<this.nestedArray.length;++o)if(this._nestedArray[o]instanceof h&&(r=this._nestedArray[o].lookup(e,t,!0)))return r;return null===this.parent||i?null:this.parent.lookup(e,t)},h.prototype.lookupType=function(e){var t=this.lookup(e,[o]);if(!t)throw Error("no such type: "+e);return t},h.prototype.lookupEnum=function(e){var t=this.lookup(e,[s]);if(!t)throw Error("no such Enum '"+e+"' in "+this);return t},h.prototype.lookupTypeOrEnum=function(e){var t=this.lookup(e,[o,s]);if(!t)throw Error("no such Type or Enum '"+e+"' in "+this);return t},h.prototype.lookupService=function(e){var t=this.lookup(e,[n]);if(!t)throw Error("no such Service '"+e+"' in "+this);return t},h._configure=function(e,t,i){o=e,n=t,s=i}},5392:(e,t,i)=>{"use strict";e.exports=n,n.className="ReflectionObject";var r,o=i(32);function n(e,t){if(!o.isString(e))throw TypeError("name must be a string");if(t&&!o.isObject(t))throw TypeError("options must be an object");this.options=t,this.parsedOptions=null,this.name=e,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(n.prototype,{root:{get:function(){for(var e=this;null!==e.parent;)e=e.parent;return e}},fullName:{get:function(){for(var e=[this.name],t=this.parent;t;)e.unshift(t.name),t=t.parent;return e.join(".")}}}),n.prototype.toJSON=function(){throw Error()},n.prototype.onAdd=function(e){this.parent&&this.parent!==e&&this.parent.remove(this),this.parent=e,this.resolved=!1;var t=e.root;t instanceof r&&t._handleAdd(this)},n.prototype.onRemove=function(e){var t=e.root;t instanceof r&&t._handleRemove(this),this.parent=null,this.resolved=!1},n.prototype.resolve=function(){return this.resolved||this.root instanceof r&&(this.resolved=!0),this},n.prototype.getOption=function(e){if(this.options)return this.options[e]},n.prototype.setOption=function(e,t,i){return i&&this.options&&void 0!==this.options[e]||((this.options||(this.options={}))[e]=t),this},n.prototype.setParsedOption=function(e,t,i){this.parsedOptions||(this.parsedOptions=[]);var r=this.parsedOptions;if(i){var n=r.find((function(t){return Object.prototype.hasOwnProperty.call(t,e)}));if(n){var s=n[e];o.setProperty(s,i,t)}else(n={})[e]=o.setProperty({},i,t),r.push(n)}else{var a={};a[e]=t,r.push(a)}return this},n.prototype.setOptions=function(e,t){if(e)for(var i=Object.keys(e),r=0;r<i.length;++r)this.setOption(i[r],e[i[r]],t);return this},n.prototype.toString=function(){var e=this.constructor.className,t=this.fullName;return t.length?e+" "+t:e},n._configure=function(e){r=e}},8232:(e,t,i)=>{"use strict";e.exports=s;var r=i(5392);((s.prototype=Object.create(r.prototype)).constructor=s).className="OneOf";var o=i(8376),n=i(32);function s(e,t,i,o){if(Array.isArray(t)||(i=t,t=void 0),r.call(this,e,i),void 0!==t&&!Array.isArray(t))throw TypeError("fieldNames must be an Array");this.oneof=t||[],this.fieldsArray=[],this.comment=o}function a(e){if(e.parent)for(var t=0;t<e.fieldsArray.length;++t)e.fieldsArray[t].parent||e.parent.add(e.fieldsArray[t])}s.fromJSON=function(e,t){return new s(e,t.oneof,t.options,t.comment)},s.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return n.toObject(["options",this.options,"oneof",this.oneof,"comment",t?this.comment:void 0])},s.prototype.add=function(e){if(!(e instanceof o))throw TypeError("field must be a Field");return e.parent&&e.parent!==this.parent&&e.parent.remove(e),this.oneof.push(e.name),this.fieldsArray.push(e),e.partOf=this,a(this),this},s.prototype.remove=function(e){if(!(e instanceof o))throw TypeError("field must be a Field");var t=this.fieldsArray.indexOf(e);if(t<0)throw Error(e+" is not a member of "+this);return this.fieldsArray.splice(t,1),(t=this.oneof.indexOf(e.name))>-1&&this.oneof.splice(t,1),e.partOf=null,this},s.prototype.onAdd=function(e){r.prototype.onAdd.call(this,e);for(var t=0;t<this.oneof.length;++t){var i=e.get(this.oneof[t]);i&&!i.partOf&&(i.partOf=this,this.fieldsArray.push(i))}a(this)},s.prototype.onRemove=function(e){for(var t,i=0;i<this.fieldsArray.length;++i)(t=this.fieldsArray[i]).parent&&t.parent.remove(t);r.prototype.onRemove.call(this,e)},s.d=function(){for(var e=new Array(arguments.length),t=0;t<arguments.length;)e[t]=arguments[t++];return function(t,i){n.decorateType(t.constructor).add(new s(i,e)),Object.defineProperty(t,i,{get:n.oneOfGetter(e),set:n.oneOfSetter(e)})}}},4064:(e,t,i)=>{"use strict";e.exports=l;var r,o=i(9712),n=o.LongBits,s=o.utf8;function a(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function l(e){this.buf=e,this.pos=0,this.len=e.length}var c,u="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new l(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new l(e);throw Error("illegal buffer")},h=function(){return o.Buffer?function(e){return(l.create=function(e){return o.Buffer.isBuffer(e)?new r(e):u(e)})(e)}:u};function d(){var e=new n(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw a(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw a(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function p(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function g(){if(this.pos+8>this.len)throw a(this,8);return new n(p(this.buf,this.pos+=4),p(this.buf,this.pos+=4))}l.create=h(),l.prototype._slice=o.Array.prototype.subarray||o.Array.prototype.slice,l.prototype.uint32=(c=4294967295,function(){if(c=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return c;if((this.pos+=5)>this.len)throw this.pos=this.len,a(this,10);return c}),l.prototype.int32=function(){return 0|this.uint32()},l.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)},l.prototype.bool=function(){return 0!==this.uint32()},l.prototype.fixed32=function(){if(this.pos+4>this.len)throw a(this,4);return p(this.buf,this.pos+=4)},l.prototype.sfixed32=function(){if(this.pos+4>this.len)throw a(this,4);return 0|p(this.buf,this.pos+=4)},l.prototype.float=function(){if(this.pos+4>this.len)throw a(this,4);var e=o.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},l.prototype.double=function(){if(this.pos+8>this.len)throw a(this,4);var e=o.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},l.prototype.bytes=function(){var e=this.uint32(),t=this.pos,i=this.pos+e;if(i>this.len)throw a(this,e);if(this.pos+=e,Array.isArray(this.buf))return this.buf.slice(t,i);if(t===i){var r=o.Buffer;return r?r.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,t,i)},l.prototype.string=function(){var e=this.bytes();return s.read(e,0,e.length)},l.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw a(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw a(this)}while(128&this.buf[this.pos++]);return this},l.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},l._configure=function(e){r=e,l.create=h(),r._configure();var t=o.Long?"toLong":"toNumber";o.merge(l.prototype,{int64:function(){return d.call(this)[t](!1)},uint64:function(){return d.call(this)[t](!0)},sint64:function(){return d.call(this).zzDecode()[t](!1)},fixed64:function(){return g.call(this)[t](!0)},sfixed64:function(){return g.call(this)[t](!1)}})}},6388:(e,t,i)=>{"use strict";e.exports=n;var r=i(4064);(n.prototype=Object.create(r.prototype)).constructor=n;var o=i(9712);function n(e){r.call(this,e)}n._configure=function(){o.Buffer&&(n.prototype._slice=o.Buffer.prototype.slice)},n.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},n._configure()},968:(e,t,i)=>{"use strict";e.exports=h;var r=i(2088);((h.prototype=Object.create(r.prototype)).constructor=h).className="Root";var o,n,s,a=i(8376),l=i(1376),c=i(8232),u=i(32);function h(e){r.call(this,"",e),this.deferred=[],this.files=[]}function d(){}h.fromJSON=function(e,t){return t||(t=new h),e.options&&t.setOptions(e.options),t.addJSON(e.nested)},h.prototype.resolvePath=u.path.resolve,h.prototype.fetch=u.fetch,h.prototype.load=function e(t,i,r){"function"==typeof i&&(r=i,i=void 0);var o=this;if(!r)return u.asPromise(e,o,t,i);var a=r===d;function l(e,t){if(r){if(a)throw e;var i=r;r=null,i(e,t)}}function c(e){var t=e.lastIndexOf("google/protobuf/");if(t>-1){var i=e.substring(t);if(i in s)return i}return null}function h(e,t){try{if(u.isString(t)&&"{"===t.charAt(0)&&(t=JSON.parse(t)),u.isString(t)){n.filename=e;var r,s=n(t,o,i),h=0;if(s.imports)for(;h<s.imports.length;++h)(r=c(s.imports[h])||o.resolvePath(e,s.imports[h]))&&p(r);if(s.weakImports)for(h=0;h<s.weakImports.length;++h)(r=c(s.weakImports[h])||o.resolvePath(e,s.weakImports[h]))&&p(r,!0)}else o.setOptions(t.options).addJSON(t.nested)}catch(e){l(e)}a||g||l(null,o)}function p(e,t){if(e=c(e)||e,!(o.files.indexOf(e)>-1))if(o.files.push(e),e in s)a?h(e,s[e]):(++g,setTimeout((function(){--g,h(e,s[e])})));else if(a){var i;try{i=u.fs.readFileSync(e).toString("utf8")}catch(e){return void(t||l(e))}h(e,i)}else++g,o.fetch(e,(function(i,n){--g,r&&(i?t?g||l(null,o):l(i):h(e,n))}))}var g=0;u.isString(t)&&(t=[t]);for(var f,v=0;v<t.length;++v)(f=o.resolvePath("",t[v]))&&p(f);if(a)return o;g||l(null,o)},h.prototype.loadSync=function(e,t){if(!u.isNode)throw Error("not supported");return this.load(e,t,d)},h.prototype.resolveAll=function(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map((function(e){return"'extend "+e.extend+"' in "+e.parent.fullName})).join(", "));return r.prototype.resolveAll.call(this)};var p=/^[A-Z]/;function g(e,t){var i=t.parent.lookup(t.extend);if(i){var r=new a(t.fullName,t.id,t.type,t.rule,void 0,t.options);return i.get(r.name)||(r.declaringField=t,t.extensionField=r,i.add(r)),!0}return!1}h.prototype._handleAdd=function(e){if(e instanceof a)void 0===e.extend||e.extensionField||g(0,e)||this.deferred.push(e);else if(e instanceof l)p.test(e.name)&&(e.parent[e.name]=e.values);else if(!(e instanceof c)){if(e instanceof o)for(var t=0;t<this.deferred.length;)g(0,this.deferred[t])?this.deferred.splice(t,1):++t;for(var i=0;i<e.nestedArray.length;++i)this._handleAdd(e._nestedArray[i]);p.test(e.name)&&(e.parent[e.name]=e)}},h.prototype._handleRemove=function(e){if(e instanceof a){if(void 0!==e.extend)if(e.extensionField)e.extensionField.parent.remove(e.extensionField),e.extensionField=null;else{var t=this.deferred.indexOf(e);t>-1&&this.deferred.splice(t,1)}}else if(e instanceof l)p.test(e.name)&&delete e.parent[e.name];else if(e instanceof r){for(var i=0;i<e.nestedArray.length;++i)this._handleRemove(e._nestedArray[i]);p.test(e.name)&&delete e.parent[e.name]}},h._configure=function(e,t,i){o=e,n=t,s=i}},6696:e=>{"use strict";e.exports={}},1164:(e,t,i)=>{"use strict";t.Service=i(44)},44:(e,t,i)=>{"use strict";e.exports=o;var r=i(9712);function o(e,t,i){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");r.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(i)}(o.prototype=Object.create(r.EventEmitter.prototype)).constructor=o,o.prototype.rpcCall=function e(t,i,o,n,s){if(!n)throw TypeError("request must be specified");var a=this;if(!s)return r.asPromise(e,a,t,i,o,n);if(a.rpcImpl)try{return a.rpcImpl(t,i[a.requestDelimited?"encodeDelimited":"encode"](n).finish(),(function(e,i){if(e)return a.emit("error",e,t),s(e);if(null!==i){if(!(i instanceof o))try{i=o[a.responseDelimited?"decodeDelimited":"decode"](i)}catch(e){return a.emit("error",e,t),s(e)}return a.emit("data",i,t),s(null,i)}a.end(!0)}))}catch(e){return a.emit("error",e,t),void setTimeout((function(){s(e)}),0)}else setTimeout((function(){s(Error("already ended"))}),0)},o.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},8616:(e,t,i)=>{"use strict";e.exports=a;var r=i(2088);((a.prototype=Object.create(r.prototype)).constructor=a).className="Service";var o=i(4208),n=i(32),s=i(1164);function a(e,t){r.call(this,e,t),this.methods={},this._methodsArray=null}function l(e){return e._methodsArray=null,e}a.fromJSON=function(e,t){var i=new a(e,t.options);if(t.methods)for(var r=Object.keys(t.methods),n=0;n<r.length;++n)i.add(o.fromJSON(r[n],t.methods[r[n]]));return t.nested&&i.addJSON(t.nested),i.comment=t.comment,i},a.prototype.toJSON=function(e){var t=r.prototype.toJSON.call(this,e),i=!!e&&Boolean(e.keepComments);return n.toObject(["options",t&&t.options||void 0,"methods",r.arrayToJSON(this.methodsArray,e)||{},"nested",t&&t.nested||void 0,"comment",i?this.comment:void 0])},Object.defineProperty(a.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=n.toArray(this.methods))}}),a.prototype.get=function(e){return this.methods[e]||r.prototype.get.call(this,e)},a.prototype.resolveAll=function(){for(var e=this.methodsArray,t=0;t<e.length;++t)e[t].resolve();return r.prototype.resolve.call(this)},a.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);return e instanceof o?(this.methods[e.name]=e,e.parent=this,l(this)):r.prototype.add.call(this,e)},a.prototype.remove=function(e){if(e instanceof o){if(this.methods[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.methods[e.name],e.parent=null,l(this)}return r.prototype.remove.call(this,e)},a.prototype.create=function(e,t,i){for(var r,o=new s.Service(e,t,i),a=0;a<this.methodsArray.length;++a){var l=n.lcFirst((r=this._methodsArray[a]).resolve().name).replace(/[^$\w_]/g,"");o[l]=n.codegen(["r","c"],n.isReserved(l)?l+"_":l)("return this.rpcCall(m,q,s,r,c)")({m:r,q:r.resolvedRequestType.ctor,s:r.resolvedResponseType.ctor})}return o}},9288:(e,t,i)=>{"use strict";e.exports=y;var r=i(2088);((y.prototype=Object.create(r.prototype)).constructor=y).className="Type";var o=i(1376),n=i(8232),s=i(8376),a=i(188),l=i(8616),c=i(8700),u=i(4064),h=i(2664),d=i(32),p=i(4752),g=i(9708),f=i(1688),v=i(3056),m=i(1508);function y(e,t){r.call(this,e,t),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}function _(e){return e._fieldsById=e._fieldsArray=e._oneofsArray=null,delete e.encode,delete e.decode,delete e.verify,e}Object.defineProperties(y.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var e=Object.keys(this.fields),t=0;t<e.length;++t){var i=this.fields[e[t]],r=i.id;if(this._fieldsById[r])throw Error("duplicate id "+r+" in "+this);this._fieldsById[r]=i}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=d.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=d.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=y.generateConstructor(this)())},set:function(e){var t=e.prototype;t instanceof c||((e.prototype=new c).constructor=e,d.merge(e.prototype,t)),e.$type=e.prototype.$type=this,d.merge(e,c,!0),this._ctor=e;for(var i=0;i<this.fieldsArray.length;++i)this._fieldsArray[i].resolve();var r={};for(i=0;i<this.oneofsArray.length;++i)r[this._oneofsArray[i].resolve().name]={get:d.oneOfGetter(this._oneofsArray[i].oneof),set:d.oneOfSetter(this._oneofsArray[i].oneof)};i&&Object.defineProperties(e.prototype,r)}}}),y.generateConstructor=function(e){for(var t,i=d.codegen(["p"],e.name),r=0;r<e.fieldsArray.length;++r)(t=e._fieldsArray[r]).map?i("this%s={}",d.safeProp(t.name)):t.repeated&&i("this%s=[]",d.safeProp(t.name));return i("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")},y.fromJSON=function(e,t){var i=new y(e,t.options);i.extensions=t.extensions,i.reserved=t.reserved;for(var c=Object.keys(t.fields),u=0;u<c.length;++u)i.add((void 0!==t.fields[c[u]].keyType?a.fromJSON:s.fromJSON)(c[u],t.fields[c[u]]));if(t.oneofs)for(c=Object.keys(t.oneofs),u=0;u<c.length;++u)i.add(n.fromJSON(c[u],t.oneofs[c[u]]));if(t.nested)for(c=Object.keys(t.nested),u=0;u<c.length;++u){var h=t.nested[c[u]];i.add((void 0!==h.id?s.fromJSON:void 0!==h.fields?y.fromJSON:void 0!==h.values?o.fromJSON:void 0!==h.methods?l.fromJSON:r.fromJSON)(c[u],h))}return t.extensions&&t.extensions.length&&(i.extensions=t.extensions),t.reserved&&t.reserved.length&&(i.reserved=t.reserved),t.group&&(i.group=!0),t.comment&&(i.comment=t.comment),i},y.prototype.toJSON=function(e){var t=r.prototype.toJSON.call(this,e),i=!!e&&Boolean(e.keepComments);return d.toObject(["options",t&&t.options||void 0,"oneofs",r.arrayToJSON(this.oneofsArray,e),"fields",r.arrayToJSON(this.fieldsArray.filter((function(e){return!e.declaringField})),e)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",t&&t.nested||void 0,"comment",i?this.comment:void 0])},y.prototype.resolveAll=function(){for(var e=this.fieldsArray,t=0;t<e.length;)e[t++].resolve();var i=this.oneofsArray;for(t=0;t<i.length;)i[t++].resolve();return r.prototype.resolveAll.call(this)},y.prototype.get=function(e){return this.fields[e]||this.oneofs&&this.oneofs[e]||this.nested&&this.nested[e]||null},y.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);if(e instanceof s&&void 0===e.extend){if(this._fieldsById?this._fieldsById[e.id]:this.fieldsById[e.id])throw Error("duplicate id "+e.id+" in "+this);if(this.isReservedId(e.id))throw Error("id "+e.id+" is reserved in "+this);if(this.isReservedName(e.name))throw Error("name '"+e.name+"' is reserved in "+this);return e.parent&&e.parent.remove(e),this.fields[e.name]=e,e.message=this,e.onAdd(this),_(this)}return e instanceof n?(this.oneofs||(this.oneofs={}),this.oneofs[e.name]=e,e.onAdd(this),_(this)):r.prototype.add.call(this,e)},y.prototype.remove=function(e){if(e instanceof s&&void 0===e.extend){if(!this.fields||this.fields[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.fields[e.name],e.parent=null,e.onRemove(this),_(this)}if(e instanceof n){if(!this.oneofs||this.oneofs[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.oneofs[e.name],e.parent=null,e.onRemove(this),_(this)}return r.prototype.remove.call(this,e)},y.prototype.isReservedId=function(e){return r.isReservedId(this.reserved,e)},y.prototype.isReservedName=function(e){return r.isReservedName(this.reserved,e)},y.prototype.create=function(e){return new this.ctor(e)},y.prototype.setup=function(){for(var e=this.fullName,t=[],i=0;i<this.fieldsArray.length;++i)t.push(this._fieldsArray[i].resolve().resolvedType);this.encode=p(this)({Writer:h,types:t,util:d}),this.decode=g(this)({Reader:u,types:t,util:d}),this.verify=f(this)({types:t,util:d}),this.fromObject=v.fromObject(this)({types:t,util:d}),this.toObject=v.toObject(this)({types:t,util:d});var r=m[e];if(r){var o=Object.create(this);o.fromObject=this.fromObject,this.fromObject=r.fromObject.bind(o),o.toObject=this.toObject,this.toObject=r.toObject.bind(o)}return this},y.prototype.encode=function(e,t){return this.setup().encode(e,t)},y.prototype.encodeDelimited=function(e,t){return this.encode(e,t&&t.len?t.fork():t).ldelim()},y.prototype.decode=function(e,t){return this.setup().decode(e,t)},y.prototype.decodeDelimited=function(e){return e instanceof u||(e=u.create(e)),this.decode(e,e.uint32())},y.prototype.verify=function(e){return this.setup().verify(e)},y.prototype.fromObject=function(e){return this.setup().fromObject(e)},y.prototype.toObject=function(e,t){return this.setup().toObject(e,t)},y.d=function(e){return function(t){d.decorateType(t,e)}}},1908:(e,t,i)=>{"use strict";var r=t,o=i(32),n=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function s(e,t){var i=0,r={};for(t|=0;i<e.length;)r[n[i+t]]=e[i++];return r}r.basic=s([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]),r.defaults=s([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",o.emptyArray,null]),r.long=s([0,0,0,1,1],7),r.mapKey=s([0,0,0,5,5,0,0,0,1,1,0,2],2),r.packed=s([1,5,0,0,0,5,5,0,0,0,1,1,0])},32:(e,t,i)=>{"use strict";var r,o,n=e.exports=i(9712),s=i(6696);n.codegen=i(4824),n.fetch=i(1560),n.path=i(7256),n.fs=n.inquire("fs"),n.toArray=function(e){if(e){for(var t=Object.keys(e),i=new Array(t.length),r=0;r<t.length;)i[r]=e[t[r++]];return i}return[]},n.toObject=function(e){for(var t={},i=0;i<e.length;){var r=e[i++],o=e[i++];void 0!==o&&(t[r]=o)}return t};var a=/\\/g,l=/"/g;n.isReserved=function(e){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(e)},n.safeProp=function(e){return!/^[$\w_]+$/.test(e)||n.isReserved(e)?'["'+e.replace(a,"\\\\").replace(l,'\\"')+'"]':"."+e},n.ucFirst=function(e){return e.charAt(0).toUpperCase()+e.substring(1)};var c=/_([a-z])/g;n.camelCase=function(e){return e.substring(0,1)+e.substring(1).replace(c,(function(e,t){return t.toUpperCase()}))},n.compareFieldsById=function(e,t){return e.id-t.id},n.decorateType=function(e,t){if(e.$type)return t&&e.$type.name!==t&&(n.decorateRoot.remove(e.$type),e.$type.name=t,n.decorateRoot.add(e.$type)),e.$type;r||(r=i(9288));var o=new r(t||e.name);return n.decorateRoot.add(o),o.ctor=e,Object.defineProperty(e,"$type",{value:o,enumerable:!1}),Object.defineProperty(e.prototype,"$type",{value:o,enumerable:!1}),o};var u=0;n.decorateEnum=function(e){if(e.$type)return e.$type;o||(o=i(1376));var t=new o("Enum"+u++,e);return n.decorateRoot.add(t),Object.defineProperty(e,"$type",{value:t,enumerable:!1}),t},n.setProperty=function(e,t,i){if("object"!=typeof e)throw TypeError("dst must be an object");if(!t)throw TypeError("path must be specified");return function e(t,i,r){var o=i.shift();if("__proto__"===o||"prototype"===o)return t;if(i.length>0)t[o]=e(t[o]||{},i,r);else{var n=t[o];n&&(r=[].concat(n).concat(r)),t[o]=r}return t}(e,t=t.split("."),i)},Object.defineProperty(n,"decorateRoot",{get:function(){return s.decorated||(s.decorated=new(i(968)))}})},8864:(e,t,i)=>{"use strict";e.exports=o;var r=i(9712);function o(e,t){this.lo=e>>>0,this.hi=t>>>0}var n=o.zero=new o(0,0);n.toNumber=function(){return 0},n.zzEncode=n.zzDecode=function(){return this},n.length=function(){return 1};var s=o.zeroHash="\0\0\0\0\0\0\0\0";o.fromNumber=function(e){if(0===e)return n;var t=e<0;t&&(e=-e);var i=e>>>0,r=(e-i)/4294967296>>>0;return t&&(r=~r>>>0,i=~i>>>0,++i>4294967295&&(i=0,++r>4294967295&&(r=0))),new o(i,r)},o.from=function(e){if("number"==typeof e)return o.fromNumber(e);if(r.isString(e)){if(!r.Long)return o.fromNumber(parseInt(e,10));e=r.Long.fromString(e)}return e.low||e.high?new o(e.low>>>0,e.high>>>0):n},o.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,i=~this.hi>>>0;return t||(i=i+1>>>0),-(t+4294967296*i)}return this.lo+4294967296*this.hi},o.prototype.toLong=function(e){return r.Long?new r.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var a=String.prototype.charCodeAt;o.fromHash=function(e){return e===s?n:new o((a.call(e,0)|a.call(e,1)<<8|a.call(e,2)<<16|a.call(e,3)<<24)>>>0,(a.call(e,4)|a.call(e,5)<<8|a.call(e,6)<<16|a.call(e,7)<<24)>>>0)},o.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},o.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},o.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},o.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,i=this.hi>>>24;return 0===i?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:i<128?9:10}},9712:function(e,t,i){"use strict";var r=t;function o(e,t,i){for(var r=Object.keys(t),o=0;o<r.length;++o)void 0!==e[r[o]]&&i||(e[r[o]]=t[r[o]]);return e}function n(e){function t(e,i){if(!(this instanceof t))return new t(e,i);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),i&&o(this,i)}return t.prototype=Object.create(Error.prototype,{constructor:{value:t,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return e},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),t}r.asPromise=i(5320),r.base64=i(752),r.EventEmitter=i(3947),r.float=i(3732),r.inquire=i(1528),r.utf8=i(1888),r.pool=i(6264),r.LongBits=i(8864),r.isNode=Boolean(void 0!==i.g&&i.g&&i.g.process&&i.g.process.versions&&i.g.process.versions.node),r.global=r.isNode&&i.g||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,r.emptyArray=Object.freeze?Object.freeze([]):[],r.emptyObject=Object.freeze?Object.freeze({}):{},r.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},r.isString=function(e){return"string"==typeof e||e instanceof String},r.isObject=function(e){return e&&"object"==typeof e},r.isset=r.isSet=function(e,t){var i=e[t];return!(null==i||!e.hasOwnProperty(t))&&("object"!=typeof i||(Array.isArray(i)?i.length:Object.keys(i).length)>0)},r.Buffer=function(){try{var e=r.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),r._Buffer_from=null,r._Buffer_allocUnsafe=null,r.newBuffer=function(e){return"number"==typeof e?r.Buffer?r._Buffer_allocUnsafe(e):new r.Array(e):r.Buffer?r._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},r.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,r.Long=r.global.dcodeIO&&r.global.dcodeIO.Long||r.global.Long||r.inquire("long"),r.key2Re=/^true|false|0|1$/,r.key32Re=/^-?(?:0|[1-9][0-9]*)$/,r.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,r.longToHash=function(e){return e?r.LongBits.from(e).toHash():r.LongBits.zeroHash},r.longFromHash=function(e,t){var i=r.LongBits.fromHash(e);return r.Long?r.Long.fromBits(i.lo,i.hi,t):i.toNumber(Boolean(t))},r.merge=o,r.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},r.newError=n,r.ProtocolError=n("ProtocolError"),r.oneOfGetter=function(e){for(var t={},i=0;i<e.length;++i)t[e[i]]=1;return function(){for(var e=Object.keys(this),i=e.length-1;i>-1;--i)if(1===t[e[i]]&&void 0!==this[e[i]]&&null!==this[e[i]])return e[i]}},r.oneOfSetter=function(e){return function(t){for(var i=0;i<e.length;++i)e[i]!==t&&delete this[e[i]]}},r.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},r._configure=function(){var e=r.Buffer;e?(r._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,i){return new e(t,i)},r._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):r._Buffer_from=r._Buffer_allocUnsafe=null}},1688:(e,t,i)=>{"use strict";e.exports=function(e){var t=o.codegen(["m"],e.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),i={};e.oneofsArray.length&&t("var p={}");for(var r=0;r<e.fieldsArray.length;++r){var l=e._fieldsArray[r].resolve(),c="m"+o.safeProp(l.name);if(l.optional&&t("if(%s!=null&&m.hasOwnProperty(%j)){",c,l.name),l.map)t("if(!util.isObject(%s))",c)("return%j",n(l,"object"))("var k=Object.keys(%s)",c)("for(var i=0;i<k.length;++i){"),a(t,l,"k[i]"),s(t,l,r,c+"[k[i]]")("}");else if(l.repeated)t("if(!Array.isArray(%s))",c)("return%j",n(l,"array"))("for(var i=0;i<%s.length;++i){",c),s(t,l,r,c+"[i]")("}");else{if(l.partOf){var u=o.safeProp(l.partOf.name);1===i[l.partOf.name]&&t("if(p%s===1)",u)("return%j",l.partOf.name+": multiple values"),i[l.partOf.name]=1,t("p%s=1",u)}s(t,l,r,c)}l.optional&&t("}")}return t("return null")};var r=i(1376),o=i(32);function n(e,t){return e.name+": "+t+(e.repeated&&"array"!==t?"[]":e.map&&"object"!==t?"{k:"+e.keyType+"}":"")+" expected"}function s(e,t,i,o){if(t.resolvedType)if(t.resolvedType instanceof r){e("switch(%s){",o)("default:")("return%j",n(t,"enum value"));for(var s=Object.keys(t.resolvedType.values),a=0;a<s.length;++a)e("case %i:",t.resolvedType.values[s[a]]);e("break")("}")}else e("{")("var e=types[%i].verify(%s);",i,o)("if(e)")("return%j+e",t.name+".")("}");else switch(t.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":e("if(!util.isInteger(%s))",o)("return%j",n(t,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":e("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",o,o,o,o)("return%j",n(t,"integer|Long"));break;case"float":case"double":e('if(typeof %s!=="number")',o)("return%j",n(t,"number"));break;case"bool":e('if(typeof %s!=="boolean")',o)("return%j",n(t,"boolean"));break;case"string":e("if(!util.isString(%s))",o)("return%j",n(t,"string"));break;case"bytes":e('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',o,o,o)("return%j",n(t,"buffer"))}return e}function a(e,t,i){switch(t.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":e("if(!util.key32Re.test(%s))",i)("return%j",n(t,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":e("if(!util.key64Re.test(%s))",i)("return%j",n(t,"integer|Long key"));break;case"bool":e("if(!util.key2Re.test(%s))",i)("return%j",n(t,"boolean key"))}return e}},1508:(e,t,i)=>{"use strict";var r=t,o=i(8700);r[".google.protobuf.Any"]={fromObject:function(e){if(e&&e["@type"]){var t=e["@type"].substring(e["@type"].lastIndexOf("/")+1),i=this.lookup(t);if(i){var r="."===e["@type"].charAt(0)?e["@type"].slice(1):e["@type"];return-1===r.indexOf("/")&&(r="/"+r),this.create({type_url:r,value:i.encode(i.fromObject(e)).finish()})}}return this.fromObject(e)},toObject:function(e,t){var i="",r="";if(t&&t.json&&e.type_url&&e.value){r=e.type_url.substring(e.type_url.lastIndexOf("/")+1),i=e.type_url.substring(0,e.type_url.lastIndexOf("/")+1);var n=this.lookup(r);n&&(e=n.decode(e.value))}if(!(e instanceof this.ctor)&&e instanceof o){var s=e.$type.toObject(e,t);return""===i&&(i="type.googleapis.com/"),r=i+("."===e.$type.fullName[0]?e.$type.fullName.slice(1):e.$type.fullName),s["@type"]=r,s}return this.toObject(e,t)}}},2664:(e,t,i)=>{"use strict";e.exports=h;var r,o=i(9712),n=o.LongBits,s=o.base64,a=o.utf8;function l(e,t,i){this.fn=e,this.len=t,this.next=void 0,this.val=i}function c(){}function u(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function h(){this.len=0,this.head=new l(c,0,0),this.tail=this.head,this.states=null}var d=function(){return o.Buffer?function(){return(h.create=function(){return new r})()}:function(){return new h}};function p(e,t,i){t[i]=255&e}function g(e,t){this.len=e,this.next=void 0,this.val=t}function f(e,t,i){for(;e.hi;)t[i++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[i++]=127&e.lo|128,e.lo=e.lo>>>7;t[i++]=e.lo}function v(e,t,i){t[i]=255&e,t[i+1]=e>>>8&255,t[i+2]=e>>>16&255,t[i+3]=e>>>24}h.create=d(),h.alloc=function(e){return new o.Array(e)},o.Array!==Array&&(h.alloc=o.pool(h.alloc,o.Array.prototype.subarray)),h.prototype._push=function(e,t,i){return this.tail=this.tail.next=new l(e,t,i),this.len+=t,this},g.prototype=Object.create(l.prototype),g.prototype.fn=function(e,t,i){for(;e>127;)t[i++]=127&e|128,e>>>=7;t[i]=e},h.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new g((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},h.prototype.int32=function(e){return e<0?this._push(f,10,n.fromNumber(e)):this.uint32(e)},h.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},h.prototype.uint64=function(e){var t=n.from(e);return this._push(f,t.length(),t)},h.prototype.int64=h.prototype.uint64,h.prototype.sint64=function(e){var t=n.from(e).zzEncode();return this._push(f,t.length(),t)},h.prototype.bool=function(e){return this._push(p,1,e?1:0)},h.prototype.fixed32=function(e){return this._push(v,4,e>>>0)},h.prototype.sfixed32=h.prototype.fixed32,h.prototype.fixed64=function(e){var t=n.from(e);return this._push(v,4,t.lo)._push(v,4,t.hi)},h.prototype.sfixed64=h.prototype.fixed64,h.prototype.float=function(e){return this._push(o.float.writeFloatLE,4,e)},h.prototype.double=function(e){return this._push(o.float.writeDoubleLE,8,e)};var m=o.Array.prototype.set?function(e,t,i){t.set(e,i)}:function(e,t,i){for(var r=0;r<e.length;++r)t[i+r]=e[r]};h.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(p,1,0);if(o.isString(e)){var i=h.alloc(t=s.length(e));s.decode(e,i,0),e=i}return this.uint32(t)._push(m,t,e)},h.prototype.string=function(e){var t=a.length(e);return t?this.uint32(t)._push(a.write,t,e):this._push(p,1,0)},h.prototype.fork=function(){return this.states=new u(this),this.head=this.tail=new l(c,0,0),this.len=0,this},h.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new l(c,0,0),this.len=0),this},h.prototype.ldelim=function(){var e=this.head,t=this.tail,i=this.len;return this.reset().uint32(i),i&&(this.tail.next=e.next,this.tail=t,this.len+=i),this},h.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),i=0;e;)e.fn(e.val,t,i),i+=e.len,e=e.next;return t},h._configure=function(e){r=e,h.create=d(),r._configure()}},8135:(e,t,i)=>{"use strict";e.exports=n;var r=i(2664);(n.prototype=Object.create(r.prototype)).constructor=n;var o=i(9712);function n(){r.call(this)}function s(e,t,i){e.length<40?o.utf8.write(e,t,i):t.utf8Write?t.utf8Write(e,i):t.write(e,i)}n._configure=function(){n.alloc=o._Buffer_allocUnsafe,n.writeBytesBuffer=o.Buffer&&o.Buffer.prototype instanceof Uint8Array&&"set"===o.Buffer.prototype.set.name?function(e,t,i){t.set(e,i)}:function(e,t,i){if(e.copy)e.copy(t,i,0,e.length);else for(var r=0;r<e.length;)t[i++]=e[r++]}},n.prototype.bytes=function(e){o.isString(e)&&(e=o._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(n.writeBytesBuffer,t,e),this},n.prototype.string=function(e){var t=o.Buffer.byteLength(e);return this.uint32(t),t&&this._push(s,t,e),this},n._configure()},2856:(e,t,i)=>{"use strict";i.r(t),i.d(t,{VERSION:()=>o,after:()=>Ot,all:()=>ei,allKeys:()=>ve,any:()=>ti,assign:()=>Oe,before:()=>It,bind:()=>xt,bindAll:()=>bt,chain:()=>yt,chunk:()=>ki,clone:()=>Be,collect:()=>Kt,compact:()=>Mi,compose:()=>Dt,constant:()=>X,contains:()=>ii,countBy:()=>vi,create:()=>ke,debounce:()=>Lt,default:()=>Ui,defaults:()=>Ie,defer:()=>Vt,delay:()=>Tt,detect:()=>Yt,difference:()=>Vi,drop:()=>wi,each:()=>qt,escape:()=>st,every:()=>ei,extend:()=>De,extendOwn:()=>Oe,filter:()=>Xt,find:()=>Yt,findIndex:()=>Ft,findKey:()=>kt,findLastIndex:()=>zt,findWhere:()=>Ht,first:()=>Ci,flatten:()=>Ti,foldl:()=>Zt,foldr:()=>Jt,forEach:()=>qt,functions:()=>Re,get:()=>Ge,groupBy:()=>gi,has:()=>We,head:()=>Ci,identity:()=>Ye,include:()=>ii,includes:()=>ii,indexBy:()=>fi,indexOf:()=>Gt,initial:()=>xi,inject:()=>Zt,intersection:()=>Pi,invert:()=>Le,invoke:()=>ri,isArguments:()=>Q,isArray:()=>H,isArrayBuffer:()=>k,isBoolean:()=>V,isDataView:()=>Y,isDate:()=>D,isElement:()=>S,isEmpty:()=>le,isEqual:()=>fe,isError:()=>I,isFinite:()=>Z,isFunction:()=>z,isMap:()=>we,isMatch:()=>ce,isNaN:()=>J,isNull:()=>M,isNumber:()=>P,isObject:()=>b,isRegExp:()=>O,isSet:()=>Me,isString:()=>R,isSymbol:()=>N,isTypedArray:()=>oe,isUndefined:()=>T,isWeakMap:()=>be,isWeakSet:()=>Te,iteratee:()=>Ze,keys:()=>ae,last:()=>bi,lastIndexOf:()=>Wt,map:()=>Kt,mapObject:()=>Xe,matcher:()=>He,matches:()=>He,max:()=>si,memoize:()=>Mt,methods:()=>Re,min:()=>ai,mixin:()=>Fi,negate:()=>Pt,noop:()=>$e,now:()=>rt,object:()=>Ii,omit:()=>Ai,once:()=>Nt,pairs:()=>Se,partial:()=>At,partition:()=>mi,pick:()=>Ei,pluck:()=>oi,property:()=>qe,propertyOf:()=>et,random:()=>it,range:()=>Ni,reduce:()=>Zt,reduceRight:()=>Jt,reject:()=>$t,rest:()=>wi,restArguments:()=>w,result:()=>ft,sample:()=>ui,select:()=>Xt,shuffle:()=>hi,size:()=>yi,some:()=>ti,sortBy:()=>di,sortedIndex:()=>jt,tail:()=>wi,take:()=>Ci,tap:()=>Fe,template:()=>gt,templateSettings:()=>lt,throttle:()=>St,times:()=>tt,toArray:()=>ci,toPath:()=>ze,transpose:()=>Di,unescape:()=>at,union:()=>Ri,uniq:()=>Li,unique:()=>Li,uniqueId:()=>mt,unzip:()=>Di,values:()=>Ve,where:()=>ni,without:()=>Si,wrap:()=>Rt,zip:()=>Oi});var r={};i.r(r),i.d(r,{VERSION:()=>o,after:()=>Ot,all:()=>ei,allKeys:()=>ve,any:()=>ti,assign:()=>Oe,before:()=>It,bind:()=>xt,bindAll:()=>bt,chain:()=>yt,chunk:()=>ki,clone:()=>Be,collect:()=>Kt,compact:()=>Mi,compose:()=>Dt,constant:()=>X,contains:()=>ii,countBy:()=>vi,create:()=>ke,debounce:()=>Lt,default:()=>zi,defaults:()=>Ie,defer:()=>Vt,delay:()=>Tt,detect:()=>Yt,difference:()=>Vi,drop:()=>wi,each:()=>qt,escape:()=>st,every:()=>ei,extend:()=>De,extendOwn:()=>Oe,filter:()=>Xt,find:()=>Yt,findIndex:()=>Ft,findKey:()=>kt,findLastIndex:()=>zt,findWhere:()=>Ht,first:()=>Ci,flatten:()=>Ti,foldl:()=>Zt,foldr:()=>Jt,forEach:()=>qt,functions:()=>Re,get:()=>Ge,groupBy:()=>gi,has:()=>We,head:()=>Ci,identity:()=>Ye,include:()=>ii,includes:()=>ii,indexBy:()=>fi,indexOf:()=>Gt,initial:()=>xi,inject:()=>Zt,intersection:()=>Pi,invert:()=>Le,invoke:()=>ri,isArguments:()=>Q,isArray:()=>H,isArrayBuffer:()=>k,isBoolean:()=>V,isDataView:()=>Y,isDate:()=>D,isElement:()=>S,isEmpty:()=>le,isEqual:()=>fe,isError:()=>I,isFinite:()=>Z,isFunction:()=>z,isMap:()=>we,isMatch:()=>ce,isNaN:()=>J,isNull:()=>M,isNumber:()=>P,isObject:()=>b,isRegExp:()=>O,isSet:()=>Me,isString:()=>R,isSymbol:()=>N,isTypedArray:()=>oe,isUndefined:()=>T,isWeakMap:()=>be,isWeakSet:()=>Te,iteratee:()=>Ze,keys:()=>ae,last:()=>bi,lastIndexOf:()=>Wt,map:()=>Kt,mapObject:()=>Xe,matcher:()=>He,matches:()=>He,max:()=>si,memoize:()=>Mt,methods:()=>Re,min:()=>ai,mixin:()=>Fi,negate:()=>Pt,noop:()=>$e,now:()=>rt,object:()=>Ii,omit:()=>Ai,once:()=>Nt,pairs:()=>Se,partial:()=>At,partition:()=>mi,pick:()=>Ei,pluck:()=>oi,property:()=>qe,propertyOf:()=>et,random:()=>it,range:()=>Ni,reduce:()=>Zt,reduceRight:()=>Jt,reject:()=>$t,rest:()=>wi,restArguments:()=>w,result:()=>ft,sample:()=>ui,select:()=>Xt,shuffle:()=>hi,size:()=>yi,some:()=>ti,sortBy:()=>di,sortedIndex:()=>jt,tail:()=>wi,take:()=>Ci,tap:()=>Fe,template:()=>gt,templateSettings:()=>lt,throttle:()=>St,times:()=>tt,toArray:()=>ci,toPath:()=>ze,transpose:()=>Di,unescape:()=>at,union:()=>Ri,uniq:()=>Li,unique:()=>Li,uniqueId:()=>mt,unzip:()=>Di,values:()=>Ve,where:()=>ni,without:()=>Si,wrap:()=>Rt,zip:()=>Oi});var o="1.13.6",n="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||Function("return this")()||{},s=Array.prototype,a=Object.prototype,l="undefined"!=typeof Symbol?Symbol.prototype:null,c=s.push,u=s.slice,h=a.toString,d=a.hasOwnProperty,p="undefined"!=typeof ArrayBuffer,g="undefined"!=typeof DataView,f=Array.isArray,v=Object.keys,m=Object.create,y=p&&ArrayBuffer.isView,_=isNaN,E=isFinite,A=!{toString:null}.propertyIsEnumerable("toString"),x=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],C=Math.pow(2,53)-1;function w(e,t){return t=null==t?e.length-1:+t,function(){for(var i=Math.max(arguments.length-t,0),r=Array(i),o=0;o<i;o++)r[o]=arguments[o+t];switch(t){case 0:return e.call(this,r);case 1:return e.call(this,arguments[0],r);case 2:return e.call(this,arguments[0],arguments[1],r)}var n=Array(t+1);for(o=0;o<t;o++)n[o]=arguments[o];return n[t]=r,e.apply(this,n)}}function b(e){var t=typeof e;return"function"===t||"object"===t&&!!e}function M(e){return null===e}function T(e){return void 0===e}function V(e){return!0===e||!1===e||"[object Boolean]"===h.call(e)}function S(e){return!(!e||1!==e.nodeType)}function L(e){var t="[object "+e+"]";return function(e){return h.call(e)===t}}const R=L("String"),P=L("Number"),D=L("Date"),O=L("RegExp"),I=L("Error"),N=L("Symbol"),k=L("ArrayBuffer");var B=L("Function"),F=n.document&&n.document.childNodes;"object"!=typeof Int8Array&&"function"!=typeof F&&(B=function(e){return"function"==typeof e||!1});const z=B,j=L("Object");var U=g&&j(new DataView(new ArrayBuffer(8))),G="undefined"!=typeof Map&&j(new Map),W=L("DataView");const Y=U?function(e){return null!=e&&z(e.getInt8)&&k(e.buffer)}:W,H=f||L("Array");function q(e,t){return null!=e&&d.call(e,t)}var K=L("Arguments");!function(){K(arguments)||(K=function(e){return q(e,"callee")})}();const Q=K;function Z(e){return!N(e)&&E(e)&&!isNaN(parseFloat(e))}function J(e){return P(e)&&_(e)}function X(e){return function(){return e}}function $(e){return function(t){var i=e(t);return"number"==typeof i&&i>=0&&i<=C}}function ee(e){return function(t){return null==t?void 0:t[e]}}const te=ee("byteLength"),ie=$(te);var re=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;const oe=p?function(e){return y?y(e)&&!Y(e):ie(e)&&re.test(h.call(e))}:X(!1),ne=ee("length");function se(e,t){t=function(e){for(var t={},i=e.length,r=0;r<i;++r)t[e[r]]=!0;return{contains:function(e){return!0===t[e]},push:function(i){return t[i]=!0,e.push(i)}}}(t);var i=x.length,r=e.constructor,o=z(r)&&r.prototype||a,n="constructor";for(q(e,n)&&!t.contains(n)&&t.push(n);i--;)(n=x[i])in e&&e[n]!==o[n]&&!t.contains(n)&&t.push(n)}function ae(e){if(!b(e))return[];if(v)return v(e);var t=[];for(var i in e)q(e,i)&&t.push(i);return A&&se(e,t),t}function le(e){if(null==e)return!0;var t=ne(e);return"number"==typeof t&&(H(e)||R(e)||Q(e))?0===t:0===ne(ae(e))}function ce(e,t){var i=ae(t),r=i.length;if(null==e)return!r;for(var o=Object(e),n=0;n<r;n++){var s=i[n];if(t[s]!==o[s]||!(s in o))return!1}return!0}function ue(e){return e instanceof ue?e:this instanceof ue?void(this._wrapped=e):new ue(e)}function he(e){return new Uint8Array(e.buffer||e,e.byteOffset||0,te(e))}ue.VERSION=o,ue.prototype.value=function(){return this._wrapped},ue.prototype.valueOf=ue.prototype.toJSON=ue.prototype.value,ue.prototype.toString=function(){return String(this._wrapped)};var de="[object DataView]";function pe(e,t,i,r){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return!1;if(e!=e)return t!=t;var o=typeof e;return("function"===o||"object"===o||"object"==typeof t)&&ge(e,t,i,r)}function ge(e,t,i,r){e instanceof ue&&(e=e._wrapped),t instanceof ue&&(t=t._wrapped);var o=h.call(e);if(o!==h.call(t))return!1;if(U&&"[object Object]"==o&&Y(e)){if(!Y(t))return!1;o=de}switch(o){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:0==+e?1/+e==1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object Symbol]":return l.valueOf.call(e)===l.valueOf.call(t);case"[object ArrayBuffer]":case de:return ge(he(e),he(t),i,r)}var n="[object Array]"===o;if(!n&&oe(e)){if(te(e)!==te(t))return!1;if(e.buffer===t.buffer&&e.byteOffset===t.byteOffset)return!0;n=!0}if(!n){if("object"!=typeof e||"object"!=typeof t)return!1;var s=e.constructor,a=t.constructor;if(s!==a&&!(z(s)&&s instanceof s&&z(a)&&a instanceof a)&&"constructor"in e&&"constructor"in t)return!1}r=r||[];for(var c=(i=i||[]).length;c--;)if(i[c]===e)return r[c]===t;if(i.push(e),r.push(t),n){if((c=e.length)!==t.length)return!1;for(;c--;)if(!pe(e[c],t[c],i,r))return!1}else{var u,d=ae(e);if(c=d.length,ae(t).length!==c)return!1;for(;c--;)if(!q(t,u=d[c])||!pe(e[u],t[u],i,r))return!1}return i.pop(),r.pop(),!0}function fe(e,t){return pe(e,t)}function ve(e){if(!b(e))return[];var t=[];for(var i in e)t.push(i);return A&&se(e,t),t}function me(e){var t=ne(e);return function(i){if(null==i)return!1;var r=ve(i);if(ne(r))return!1;for(var o=0;o<t;o++)if(!z(i[e[o]]))return!1;return e!==xe||!z(i[ye])}}var ye="forEach",_e=["clear","delete"],Ee=["get","has","set"],Ae=_e.concat(ye,Ee),xe=_e.concat(Ee),Ce=["add"].concat(_e,ye,"has");const we=G?me(Ae):L("Map"),be=G?me(xe):L("WeakMap"),Me=G?me(Ce):L("Set"),Te=L("WeakSet");function Ve(e){for(var t=ae(e),i=t.length,r=Array(i),o=0;o<i;o++)r[o]=e[t[o]];return r}function Se(e){for(var t=ae(e),i=t.length,r=Array(i),o=0;o<i;o++)r[o]=[t[o],e[t[o]]];return r}function Le(e){for(var t={},i=ae(e),r=0,o=i.length;r<o;r++)t[e[i[r]]]=i[r];return t}function Re(e){var t=[];for(var i in e)z(e[i])&&t.push(i);return t.sort()}function Pe(e,t){return function(i){var r=arguments.length;if(t&&(i=Object(i)),r<2||null==i)return i;for(var o=1;o<r;o++)for(var n=arguments[o],s=e(n),a=s.length,l=0;l<a;l++){var c=s[l];t&&void 0!==i[c]||(i[c]=n[c])}return i}}const De=Pe(ve),Oe=Pe(ae),Ie=Pe(ve,!0);function Ne(e){if(!b(e))return{};if(m)return m(e);var t=function(){};t.prototype=e;var i=new t;return t.prototype=null,i}function ke(e,t){var i=Ne(e);return t&&Oe(i,t),i}function Be(e){return b(e)?H(e)?e.slice():De({},e):e}function Fe(e,t){return t(e),e}function ze(e){return H(e)?e:[e]}function je(e){return ue.toPath(e)}function Ue(e,t){for(var i=t.length,r=0;r<i;r++){if(null==e)return;e=e[t[r]]}return i?e:void 0}function Ge(e,t,i){var r=Ue(e,je(t));return T(r)?i:r}function We(e,t){for(var i=(t=je(t)).length,r=0;r<i;r++){var o=t[r];if(!q(e,o))return!1;e=e[o]}return!!i}function Ye(e){return e}function He(e){return e=Oe({},e),function(t){return ce(t,e)}}function qe(e){return e=je(e),function(t){return Ue(t,e)}}function Ke(e,t,i){if(void 0===t)return e;switch(null==i?3:i){case 1:return function(i){return e.call(t,i)};case 3:return function(i,r,o){return e.call(t,i,r,o)};case 4:return function(i,r,o,n){return e.call(t,i,r,o,n)}}return function(){return e.apply(t,arguments)}}function Qe(e,t,i){return null==e?Ye:z(e)?Ke(e,t,i):b(e)&&!H(e)?He(e):qe(e)}function Ze(e,t){return Qe(e,t,1/0)}function Je(e,t,i){return ue.iteratee!==Ze?ue.iteratee(e,t):Qe(e,t,i)}function Xe(e,t,i){t=Je(t,i);for(var r=ae(e),o=r.length,n={},s=0;s<o;s++){var a=r[s];n[a]=t(e[a],a,e)}return n}function $e(){}function et(e){return null==e?$e:function(t){return Ge(e,t)}}function tt(e,t,i){var r=Array(Math.max(0,e));t=Ke(t,i,1);for(var o=0;o<e;o++)r[o]=t(o);return r}function it(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))}ue.toPath=ze,ue.iteratee=Ze;const rt=Date.now||function(){return(new Date).getTime()};function ot(e){var t=function(t){return e[t]},i="(?:"+ae(e).join("|")+")",r=RegExp(i),o=RegExp(i,"g");return function(e){return e=null==e?"":""+e,r.test(e)?e.replace(o,t):e}}const nt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},st=ot(nt),at=ot(Le(nt)),lt=ue.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var ct=/(.)^/,ut={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},ht=/\\|'|\r|\n|\u2028|\u2029/g;function dt(e){return"\\"+ut[e]}var pt=/^\s*(\w|\$)+\s*$/;function gt(e,t,i){!t&&i&&(t=i),t=Ie({},t,ue.templateSettings);var r=RegExp([(t.escape||ct).source,(t.interpolate||ct).source,(t.evaluate||ct).source].join("|")+"|$","g"),o=0,n="__p+='";e.replace(r,(function(t,i,r,s,a){return n+=e.slice(o,a).replace(ht,dt),o=a+t.length,i?n+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'":r?n+="'+\n((__t=("+r+"))==null?'':__t)+\n'":s&&(n+="';\n"+s+"\n__p+='"),t})),n+="';\n";var s,a=t.variable;if(a){if(!pt.test(a))throw new Error("variable is not a bare identifier: "+a)}else n="with(obj||{}){\n"+n+"}\n",a="obj";n="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+n+"return __p;\n";try{s=new Function(a,"_",n)}catch(e){throw e.source=n,e}var l=function(e){return s.call(this,e,ue)};return l.source="function("+a+"){\n"+n+"}",l}function ft(e,t,i){var r=(t=je(t)).length;if(!r)return z(i)?i.call(e):i;for(var o=0;o<r;o++){var n=null==e?void 0:e[t[o]];void 0===n&&(n=i,o=r),e=z(n)?n.call(e):n}return e}var vt=0;function mt(e){var t=++vt+"";return e?e+t:t}function yt(e){var t=ue(e);return t._chain=!0,t}function _t(e,t,i,r,o){if(!(r instanceof t))return e.apply(i,o);var n=Ne(e.prototype),s=e.apply(n,o);return b(s)?s:n}var Et=w((function(e,t){var i=Et.placeholder,r=function(){for(var o=0,n=t.length,s=Array(n),a=0;a<n;a++)s[a]=t[a]===i?arguments[o++]:t[a];for(;o<arguments.length;)s.push(arguments[o++]);return _t(e,r,this,this,s)};return r}));Et.placeholder=ue;const At=Et,xt=w((function(e,t,i){if(!z(e))throw new TypeError("Bind must be called on a function");var r=w((function(o){return _t(e,r,t,this,i.concat(o))}));return r})),Ct=$(ne);function wt(e,t,i,r){if(r=r||[],t||0===t){if(t<=0)return r.concat(e)}else t=1/0;for(var o=r.length,n=0,s=ne(e);n<s;n++){var a=e[n];if(Ct(a)&&(H(a)||Q(a)))if(t>1)wt(a,t-1,i,r),o=r.length;else for(var l=0,c=a.length;l<c;)r[o++]=a[l++];else i||(r[o++]=a)}return r}const bt=w((function(e,t){var i=(t=wt(t,!1,!1)).length;if(i<1)throw new Error("bindAll must be passed function names");for(;i--;){var r=t[i];e[r]=xt(e[r],e)}return e}));function Mt(e,t){var i=function(r){var o=i.cache,n=""+(t?t.apply(this,arguments):r);return q(o,n)||(o[n]=e.apply(this,arguments)),o[n]};return i.cache={},i}const Tt=w((function(e,t,i){return setTimeout((function(){return e.apply(null,i)}),t)})),Vt=At(Tt,ue,1);function St(e,t,i){var r,o,n,s,a=0;i||(i={});var l=function(){a=!1===i.leading?0:rt(),r=null,s=e.apply(o,n),r||(o=n=null)},c=function(){var c=rt();a||!1!==i.leading||(a=c);var u=t-(c-a);return o=this,n=arguments,u<=0||u>t?(r&&(clearTimeout(r),r=null),a=c,s=e.apply(o,n),r||(o=n=null)):r||!1===i.trailing||(r=setTimeout(l,u)),s};return c.cancel=function(){clearTimeout(r),a=0,r=o=n=null},c}function Lt(e,t,i){var r,o,n,s,a,l=function(){var c=rt()-o;t>c?r=setTimeout(l,t-c):(r=null,i||(s=e.apply(a,n)),r||(n=a=null))},c=w((function(c){return a=this,n=c,o=rt(),r||(r=setTimeout(l,t),i&&(s=e.apply(a,n))),s}));return c.cancel=function(){clearTimeout(r),r=n=a=null},c}function Rt(e,t){return At(t,e)}function Pt(e){return function(){return!e.apply(this,arguments)}}function Dt(){var e=arguments,t=e.length-1;return function(){for(var i=t,r=e[t].apply(this,arguments);i--;)r=e[i].call(this,r);return r}}function Ot(e,t){return function(){if(--e<1)return t.apply(this,arguments)}}function It(e,t){var i;return function(){return--e>0&&(i=t.apply(this,arguments)),e<=1&&(t=null),i}}const Nt=At(It,2);function kt(e,t,i){t=Je(t,i);for(var r,o=ae(e),n=0,s=o.length;n<s;n++)if(t(e[r=o[n]],r,e))return r}function Bt(e){return function(t,i,r){i=Je(i,r);for(var o=ne(t),n=e>0?0:o-1;n>=0&&n<o;n+=e)if(i(t[n],n,t))return n;return-1}}const Ft=Bt(1),zt=Bt(-1);function jt(e,t,i,r){for(var o=(i=Je(i,r,1))(t),n=0,s=ne(e);n<s;){var a=Math.floor((n+s)/2);i(e[a])<o?n=a+1:s=a}return n}function Ut(e,t,i){return function(r,o,n){var s=0,a=ne(r);if("number"==typeof n)e>0?s=n>=0?n:Math.max(n+a,s):a=n>=0?Math.min(n+1,a):n+a+1;else if(i&&n&&a)return r[n=i(r,o)]===o?n:-1;if(o!=o)return(n=t(u.call(r,s,a),J))>=0?n+s:-1;for(n=e>0?s:a-1;n>=0&&n<a;n+=e)if(r[n]===o)return n;return-1}}const Gt=Ut(1,Ft,jt),Wt=Ut(-1,zt);function Yt(e,t,i){var r=(Ct(e)?Ft:kt)(e,t,i);if(void 0!==r&&-1!==r)return e[r]}function Ht(e,t){return Yt(e,He(t))}function qt(e,t,i){var r,o;if(t=Ke(t,i),Ct(e))for(r=0,o=e.length;r<o;r++)t(e[r],r,e);else{var n=ae(e);for(r=0,o=n.length;r<o;r++)t(e[n[r]],n[r],e)}return e}function Kt(e,t,i){t=Je(t,i);for(var r=!Ct(e)&&ae(e),o=(r||e).length,n=Array(o),s=0;s<o;s++){var a=r?r[s]:s;n[s]=t(e[a],a,e)}return n}function Qt(e){return function(t,i,r,o){var n=arguments.length>=3;return function(t,i,r,o){var n=!Ct(t)&&ae(t),s=(n||t).length,a=e>0?0:s-1;for(o||(r=t[n?n[a]:a],a+=e);a>=0&&a<s;a+=e){var l=n?n[a]:a;r=i(r,t[l],l,t)}return r}(t,Ke(i,o,4),r,n)}}const Zt=Qt(1),Jt=Qt(-1);function Xt(e,t,i){var r=[];return t=Je(t,i),qt(e,(function(e,i,o){t(e,i,o)&&r.push(e)})),r}function $t(e,t,i){return Xt(e,Pt(Je(t)),i)}function ei(e,t,i){t=Je(t,i);for(var r=!Ct(e)&&ae(e),o=(r||e).length,n=0;n<o;n++){var s=r?r[n]:n;if(!t(e[s],s,e))return!1}return!0}function ti(e,t,i){t=Je(t,i);for(var r=!Ct(e)&&ae(e),o=(r||e).length,n=0;n<o;n++){var s=r?r[n]:n;if(t(e[s],s,e))return!0}return!1}function ii(e,t,i,r){return Ct(e)||(e=Ve(e)),("number"!=typeof i||r)&&(i=0),Gt(e,t,i)>=0}const ri=w((function(e,t,i){var r,o;return z(t)?o=t:(t=je(t),r=t.slice(0,-1),t=t[t.length-1]),Kt(e,(function(e){var n=o;if(!n){if(r&&r.length&&(e=Ue(e,r)),null==e)return;n=e[t]}return null==n?n:n.apply(e,i)}))}));function oi(e,t){return Kt(e,qe(t))}function ni(e,t){return Xt(e,He(t))}function si(e,t,i){var r,o,n=-1/0,s=-1/0;if(null==t||"number"==typeof t&&"object"!=typeof e[0]&&null!=e)for(var a=0,l=(e=Ct(e)?e:Ve(e)).length;a<l;a++)null!=(r=e[a])&&r>n&&(n=r);else t=Je(t,i),qt(e,(function(e,i,r){((o=t(e,i,r))>s||o===-1/0&&n===-1/0)&&(n=e,s=o)}));return n}function ai(e,t,i){var r,o,n=1/0,s=1/0;if(null==t||"number"==typeof t&&"object"!=typeof e[0]&&null!=e)for(var a=0,l=(e=Ct(e)?e:Ve(e)).length;a<l;a++)null!=(r=e[a])&&r<n&&(n=r);else t=Je(t,i),qt(e,(function(e,i,r){((o=t(e,i,r))<s||o===1/0&&n===1/0)&&(n=e,s=o)}));return n}var li=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function ci(e){return e?H(e)?u.call(e):R(e)?e.match(li):Ct(e)?Kt(e,Ye):Ve(e):[]}function ui(e,t,i){if(null==t||i)return Ct(e)||(e=Ve(e)),e[it(e.length-1)];var r=ci(e),o=ne(r);t=Math.max(Math.min(t,o),0);for(var n=o-1,s=0;s<t;s++){var a=it(s,n),l=r[s];r[s]=r[a],r[a]=l}return r.slice(0,t)}function hi(e){return ui(e,1/0)}function di(e,t,i){var r=0;return t=Je(t,i),oi(Kt(e,(function(e,i,o){return{value:e,index:r++,criteria:t(e,i,o)}})).sort((function(e,t){var i=e.criteria,r=t.criteria;if(i!==r){if(i>r||void 0===i)return 1;if(i<r||void 0===r)return-1}return e.index-t.index})),"value")}function pi(e,t){return function(i,r,o){var n=t?[[],[]]:{};return r=Je(r,o),qt(i,(function(t,o){var s=r(t,o,i);e(n,t,s)})),n}}const gi=pi((function(e,t,i){q(e,i)?e[i].push(t):e[i]=[t]})),fi=pi((function(e,t,i){e[i]=t})),vi=pi((function(e,t,i){q(e,i)?e[i]++:e[i]=1})),mi=pi((function(e,t,i){e[i?0:1].push(t)}),!0);function yi(e){return null==e?0:Ct(e)?e.length:ae(e).length}function _i(e,t,i){return t in i}const Ei=w((function(e,t){var i={},r=t[0];if(null==e)return i;z(r)?(t.length>1&&(r=Ke(r,t[1])),t=ve(e)):(r=_i,t=wt(t,!1,!1),e=Object(e));for(var o=0,n=t.length;o<n;o++){var s=t[o],a=e[s];r(a,s,e)&&(i[s]=a)}return i})),Ai=w((function(e,t){var i,r=t[0];return z(r)?(r=Pt(r),t.length>1&&(i=t[1])):(t=Kt(wt(t,!1,!1),String),r=function(e,i){return!ii(t,i)}),Ei(e,r,i)}));function xi(e,t,i){return u.call(e,0,Math.max(0,e.length-(null==t||i?1:t)))}function Ci(e,t,i){return null==e||e.length<1?null==t||i?void 0:[]:null==t||i?e[0]:xi(e,e.length-t)}function wi(e,t,i){return u.call(e,null==t||i?1:t)}function bi(e,t,i){return null==e||e.length<1?null==t||i?void 0:[]:null==t||i?e[e.length-1]:wi(e,Math.max(0,e.length-t))}function Mi(e){return Xt(e,Boolean)}function Ti(e,t){return wt(e,t,!1)}const Vi=w((function(e,t){return t=wt(t,!0,!0),Xt(e,(function(e){return!ii(t,e)}))})),Si=w((function(e,t){return Vi(e,t)}));function Li(e,t,i,r){V(t)||(r=i,i=t,t=!1),null!=i&&(i=Je(i,r));for(var o=[],n=[],s=0,a=ne(e);s<a;s++){var l=e[s],c=i?i(l,s,e):l;t&&!i?(s&&n===c||o.push(l),n=c):i?ii(n,c)||(n.push(c),o.push(l)):ii(o,l)||o.push(l)}return o}const Ri=w((function(e){return Li(wt(e,!0,!0))}));function Pi(e){for(var t=[],i=arguments.length,r=0,o=ne(e);r<o;r++){var n=e[r];if(!ii(t,n)){var s;for(s=1;s<i&&ii(arguments[s],n);s++);s===i&&t.push(n)}}return t}function Di(e){for(var t=e&&si(e,ne).length||0,i=Array(t),r=0;r<t;r++)i[r]=oi(e,r);return i}const Oi=w(Di);function Ii(e,t){for(var i={},r=0,o=ne(e);r<o;r++)t?i[e[r]]=t[r]:i[e[r][0]]=e[r][1];return i}function Ni(e,t,i){null==t&&(t=e||0,e=0),i||(i=t<e?-1:1);for(var r=Math.max(Math.ceil((t-e)/i),0),o=Array(r),n=0;n<r;n++,e+=i)o[n]=e;return o}function ki(e,t){if(null==t||t<1)return[];for(var i=[],r=0,o=e.length;r<o;)i.push(u.call(e,r,r+=t));return i}function Bi(e,t){return e._chain?ue(t).chain():t}function Fi(e){return qt(Re(e),(function(t){var i=ue[t]=e[t];ue.prototype[t]=function(){var e=[this._wrapped];return c.apply(e,arguments),Bi(this,i.apply(ue,e))}})),ue}qt(["pop","push","reverse","shift","sort","splice","unshift"],(function(e){var t=s[e];ue.prototype[e]=function(){var i=this._wrapped;return null!=i&&(t.apply(i,arguments),"shift"!==e&&"splice"!==e||0!==i.length||delete i[0]),Bi(this,i)}})),qt(["concat","join","slice"],(function(e){var t=s[e];ue.prototype[e]=function(){var e=this._wrapped;return null!=e&&(e=t.apply(e,arguments)),Bi(this,e)}}));const zi=ue;var ji=Fi(r);ji._=ji;const Ui=ji}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var i=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(i.exports,i,i.exports,__webpack_require__),i.exports}__webpack_require__.d=(e,t)=>{for(var i in t)__webpack_require__.o(t,i)&&!__webpack_require__.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__={};return(()=>{"use strict";var e=__webpack_exports__;Object.defineProperty(e,"__esModule",{value:!0}),e.getBoundedRegionFaces=e.getRegionEdges=e.mergeConnectedFaces=e.getOrderedFacesOnVertex=e.saveToProtoMessage=e.saveToProtoBinary=e.SolidDefSaver=e.SolidDefLoader=e.Path2D=e.DebugUtils=e.svgFromWire=e.transformTopology=e.TopologyStitcher=e.TopologyCloner=e.extrudeFace=e.createEdgeFromCurve=e.createFaceFromPolyline=e.createShellsFromFaces=e.createPolyhedron=e.createLineEdgeBetweenVertices=e.createLineEdge=e.createCylinder=e.createCone=e.createBlock=e.computeCurveCurveIntersections=e.SketchRegionSolver=e.facetPlanarFace=e.checkValidity=e.BoundingBox=e.Attribute=e.Wire=e.WireBody=e.Vertex=e.Edge=e.Coedge=e.Loop=e.Face=e.Shell=e.Lump=e.Body=e.BSurface=e.Torus=e.EllipticalCone=e.Cone=e.Sphere=e.EllipticalCylinder=e.Cylinder=e.Plane=e.BCurve=e.Ellipse=e.Circle=e.Line=e.Point=e.TOPOLOGY_TYPES=e.GEOMETRY_TYPES=e.KERNEL_TOLERANCE=void 0;var t=__webpack_require__(2468),i=__webpack_require__(3344),r=__webpack_require__(3565),o=__webpack_require__(1096),n=__webpack_require__(5512),s=__webpack_require__(8972),a=__webpack_require__(8796),l=__webpack_require__(8292),c=__webpack_require__(3440),u=__webpack_require__(8360),h=__webpack_require__(4372),d=__webpack_require__(2984),p=__webpack_require__(2956),g=__webpack_require__(1408),f=__webpack_require__(92),v=__webpack_require__(9984),m=__webpack_require__(5837),y=__webpack_require__(6508),_=__webpack_require__(6776),E=__webpack_require__(4524),A=__webpack_require__(672),x=__webpack_require__(7580),C=__webpack_require__(6940),w=__webpack_require__(6500),b=__webpack_require__(7575),M=__webpack_require__(9324),T=__webpack_require__(2236),V=__webpack_require__(3584),S=__webpack_require__(8768),L=__webpack_require__(8460),R=__webpack_require__(3332),P=__webpack_require__(9128),D=__webpack_require__(7620),O=__webpack_require__(64),I=__webpack_require__(2472),N=__webpack_require__(2536),k=__webpack_require__(1008),B=__webpack_require__(7616),F=__webpack_require__(4268),z=__webpack_require__(6120),j=__webpack_require__(268),U=__webpack_require__(6232),G=__webpack_require__(5316),W=__webpack_require__(8080),Y=__webpack_require__(9608);e.KERNEL_TOLERANCE=t.KERNEL_TOLERANCE,e.GEOMETRY_TYPES=t.GEOMETRY_TYPES,e.TOPOLOGY_TYPES=t.TOPOLOGY_TYPES,e.Point=r.Point,e.Line=o.Line,e.Circle=n.Circle,e.Ellipse=s.Ellipse,e.BCurve=a.BCurve,e.Plane=l.Plane,e.Cylinder=c.Cylinder,e.EllipticalCylinder=u.EllipticalCylinder,e.Sphere=h.Sphere,e.Cone=d.Cone,e.EllipticalCone=p.EllipticalCone,e.Torus=g.Torus,e.BSurface=f.BSurface,e.Body=v.Body,e.Lump=m.Lump,e.Shell=y.Shell,e.Face=_.Face,e.Loop=E.Loop,e.Coedge=A.Coedge,e.Edge=x.Edge,e.Vertex=C.Vertex,e.WireBody=w.WireBody,e.Wire=b.Wire,e.Attribute=M.Attribute,e.BoundingBox=i.BoundingBox,e.checkValidity=T.checkValidity,e.facetPlanarFace=V.facetPlanarFace,e.SketchRegionSolver=S.SketchRegionSolver,e.computeCurveCurveIntersections=L.computeCurveCurveIntersections,e.createBlock=R.createBlock,e.createCone=P.createCone,e.createCylinder=P.createCylinder,e.createLineEdge=O.createLineEdge,e.createLineEdgeBetweenVertices=O.createLineEdgeBetweenVertices,e.createPolyhedron=D.createPolyhedron,e.createShellsFromFaces=O.createShellsFromFaces,e.createFaceFromPolyline=O.createFaceFromPolyline,e.createEdgeFromCurve=O.createEdgeFromCurve,e.extrudeFace=I.extrudeFace,e.TopologyCloner=N.TopologyCloner,e.TopologyStitcher=k.TopologyStitcher,e.transformTopology=B.transformTopology,e.svgFromWire=F.svgFromWire,e.DebugUtils=z.DebugUtils,e.Path2D=j.Path2D,e.SolidDefLoader=U.SolidDefLoader,e.SolidDefSaver=G.SolidDefSaver,e.saveToProtoBinary=G.saveToProtoBinary,e.saveToProtoMessage=G.saveToProtoMessage,e.getOrderedFacesOnVertex=Y.getOrderedFacesOnVertex,e.mergeConnectedFaces=B.mergeConnectedFaces,e.getRegionEdges=W.getRegionEdges,e.getBoundedRegionFaces=W.getBoundedRegionFaces})(),__webpack_exports__})(),"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["solid-definition"]=t():e.SolidDefinition=t()},2215:(e,t,r)=>{"use strict";r.r(t),r.d(t,{getPointLocations:()=>he,parseLocationsMetadata:()=>de});const o=new THREE.Vector2,n=new THREE.Vector2,s=(e,t,i)=>(i=i||new THREE.Vector2).copy(t).sub(e).normalize(),a=(e,t)=>{const i=t.x-e.x,r=t.y-e.y;return Math.sqrt(i*i+r*r)},l=(e,t,i)=>{const r=(e.x-t.x)*i.x+(e.y-t.y)*i.y;e.set(t.x+r*i.x,t.y+r*i.y)},c=function(){let e=new THREE.Vector2;return(t,i,r)=>(l(e.copy(t),i,r),e.distanceTo(t))}(),u=(e,t,i,r)=>h(e,t,i,r,!1),h=function(e,t,i,r){let o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];const n=i.x-t.x,s=i.y-t.y,a=Math.sqrt(n*n+s*s);let l={v1:t,dx:n,dy:s,length:a,length2:a*a};return Autodesk.Extensions.CompGeom.pointOnLine(e.x,e.y,l,o,r)},d=(e,t,i)=>Math.abs(e-t)<i,p={getEdgeDirection:s,projectToLine:l,pointLineDistance:c,intersectLines:(e,t,i,r,o)=>{const n=r.y*t.x-r.x*t.y;if(Math.abs(n)<1e-8)return!1;const s=e.x-i.x,a=e.y-i.y,l=r.x*a-r.y*s;return o&&(o.x=e.x+l/n*t.x,o.y=e.y+l/n*t.y),!0},rotateAround:(e,t,i)=>{let r=Math.cos(t),o=Math.sin(t);i&&e.sub(i);let n=e.x,s=e.y;return e.x=n*r-s*o,e.y=n*o+s*r,i&&e.add(i),e},angleBetweenDirections:(e,t)=>{let i=Math.atan2(e.y,e.x)-Math.atan2(t.y,t.x);return i<0&&(i+=2*Math.PI),i},getEdgeCenter:(e,t,i)=>(i=i||new THREE.Vector2).set(.5*(e.x+t.x),.5*(e.y+t.y)),getEdgeLength:a,turnLeft:e=>{const t=e.x;return e.x=-e.y,e.y=t,e},isPointOnEdge:h,isPointOnLine:u,pointDelta:function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r={x:t.x-e.x,y:t.y-e.y};if(i){let e=Math.pow(10,i);r.x=Math.round(r.x*e)/e,r.y=Math.round(r.y*e)/e}if(r.x||r.y)return r},edgeIsDegenerated:function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-10;return e.distanceToSquared(t)<i},mirrorPointOnPoint:function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;return i=i||new THREE.Vector2,i.x=t.x-(e.x-t.x),i.y=t.y-(e.y-t.y),i},fuzzyEqual:d,collinear:(e,t,i,r,o)=>{const n=d(t.x,r.x,o)&&d(t.y,r.y,o),s=d(t.x,-r.x,o)&&d(t.y,-r.y,o);if(!n&&!s)return!1;const a=i.x-e.x,l=i.y-e.y;let c=a*t.x+l*t.y;return Math.abs(c)<o},distance2D:(e,t)=>{const i=t.x-e.x,r=t.y-e.y;return Math.sqrt(i*i+r*r)},changesOrientation:e=>e.determinant()<0,getFitToBoxTransform:function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new THREE.Matrix4;const s=e.size(o),a=t.size(n);let l=a.x/s.x,c=a.y/s.y;i.preserveAspect&&(l=Math.min(l,c),c=l);let u=e.min.x,h=e.min.y;i.flipY&&(c*=-1,h=e.max.y);let d=-l*u+t.min.x,p=-c*h+t.min.y;const g=r.makeScale(l,c,1);return g.elements[12]=d,g.elements[13]=p,g},pointOnMiterLineSegment:(e,t,i,r,n)=>{if(!u(e,t,i,.5*r+n))return!1;const l=((e,t,i)=>{const r=s(t,i,o);return(e.x-t.x)*r.x+(e.y-t.y)*r.y})(e,t,i),c=a(t,i);return l>=-n&&l<c+n},pointOnMiterLineJunction:function(e,t,i,r,l,u){let h=arguments.length>6&&void 0!==arguments[6]?arguments[6]:.985;const d=s(t,i,o),p=s(i,r,n);if(Math.abs(d.dot(p))>h)return!1;if(a(t,i)<l||a(i,r)<l)return!1;const g=c(e,t,d),f=c(e,i,p),v=.5*l+u;return g<=v&&f<v}};let g=null;const f="http://www.w3.org/2000/svg",v=Math.pow(10,4),m=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!e||null===t)return e;const i=4===t?v:Math.pow(10,t);return Math.round(e*i)/i},y=e=>{const t=e.split(/ (?=[a-zA-Z])/gi),i=new ae,r=new THREE.Vector2;let o=0;const n=new le;for(let e=0;e<t.length;e++){const s=t[e];if(-1==="MLHVCZA".indexOf(s[0]))throw`"${s[0]}" is not a supported or invalid glyph: ${s}`;const a=n.getVertexCount(o)-1;let l=s.substring(1);switch(s[0]){case"M":o=n.nextFreeLoop();case"L":let e=l.split(",");r.x=parseFloat(e[0]),r.y=parseFloat(e[1]);break;case"H":r.x=parseFloat(l);break;case"V":r.y=parseFloat(l);break;case"C":const t=l.split(",");r.x=parseFloat(t[4]),r.y=parseFloat(t[5]);const s=parseFloat(t[0]),c=parseFloat(t[1]),u=parseFloat(t[2]),h=parseFloat(t[3]);a>=0?n.setBezierArc(a,s,c,u,h,o):console.error('SVG Parse error: Path is not expected to start with "C" command');break;case"A":const d=l.split(",");r.x=parseFloat(d[5]),r.y=parseFloat(d[6]),i.rx=parseFloat(d[0]),i.ry=parseFloat(d[1]),i.rotation=parseFloat(d[2]),i.largeArcFlag=Boolean(parseFloat(d[3])),i.sweepFlag=Boolean(parseFloat(d[4])),a>=0?n.setEllipseArc(a,i,o):console.error('SVG Parse error: Path is not expected to start with "A" command');break;case"Z":n.isClosed=!0;continue}n.addPoint(r.x,r.y,o)}return(e=>{if(e.isClosed){let t=new THREE.Vector2,i=new THREE.Vector2;const r=e.loopCount;for(let o=0;o<r;o++){const r=e.getVertexCount(o)-1;r<1||(t=e.getPoint(0,o,t),i=e.getPoint(r,o,i),p.pointDelta(t,i,0)||e.removePoint(r,o))}}})(n),n},_=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e.vertexCount)return[];const r=e=>m(e,i);let o=[],n=new THREE.Vector2,s=new THREE.Vector2,a=new ae,l=new THREE.Vector2,c=new THREE.Vector2;const u=e.loopCount;for(let h=0;h<u;h++){const u=e.getEdgeCount(h);u>0&&(n=e.getPoint(0,h,n),o.push(`M ${r(n.x)},${r(n.y)}`));for(let d=0;d<u;d++){const u=d,g=e.isPath()?e.getEdgeType(u,h):$.Line,f=e.nextIndex(u,h);n=e.getPoint(f,h,n);let v="";switch(g){case $.Ellipse:a=e.getEllipseArcParams(u,h,a);const o=a.largeArcFlag?1:0,g=a.sweepFlag?1:0;v=`A ${a.rx},${a.ry},${a.rotation},${o},${g},${n.x},${n.y}`;break;case $.Bezier:l=e.getControlPoint(u,1,h,l),c=e.getControlPoint(u,2,h,c),v=`C ${r(l.x)},${r(l.y)},${r(c.x)},${r(c.y)},${r(n.x)},${r(n.y)}`;break;default:{s=e.getPoint(d,h,s);let o=p.pointDelta(s,n,i);if(!o)continue;v=Math.abs(o.x)<=t?`V ${r(n.y)}`:Math.abs(o.y)<=t?`H ${r(n.x)}`:`L ${r(n.x)},${r(n.y)}`}}0===f&&g===$.Line||o.push(v)}e.isClosed&&o.push("Z")}return o},E=e=>{const t={};return t.stroke=e.lineColor,t.fill=e.fillColor,t["stroke-width"]=e.lineWidth,1!=e.lineAlpha&&(t["stroke-opacity"]=e.lineAlpha),1!=e.fillAlpha&&(t["fill-opacity"]=e.fillAlpha),t},A=(e,t)=>{const i=t&&t.precision||0,r=t&&t.digits||0,o=t&&t.exportStyle||!0;if(!(e instanceof Z))return void console.error("SVG serialization not supported for this shape: ",e);const n=document.createElementNS(f,"path");if(n.setAttribute("d",_(e,i,r)),o){((e,t)=>{for(let i in t)e.setAttribute(i,t[i])})(n,E(e.style))}return n},x={toSvg:function(e,t){let i=t&&t.precision||0,r=t&&t.digits||null,o="";if(t&&t.exportStyle||!1){o=(e=>{let t="";for(let i in e)t+=` ${i}="${e[i]}"`;return t})(E(e.style))}return"object"!=typeof t&&("number"==typeof arguments[1]&&(i=arguments[1]),"number"==typeof arguments[2]&&(r=arguments[2])),e instanceof ce?function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return`<circle cx="${m(e.centerX,t)}" cy="${m(e.centerY,t)}" r="${m(e.radius,t)}${i}"/>`}(e,r,o):e instanceof Z?`<path d="${_(e,i,r).join(" ")}"${o}/>`:void console.error("SVG serialization not supported for this shape: ",e)},fromSvg:e=>{if(!e)return;g=g||new DOMParser;const t=g.parseFromString(e,"application/xml");if(1!==t.childNodes.length)throw"Function does only support svg with a single element: path, circle";const i=t.firstChild;if("circle"===i.nodeName)return(e=>{if(!e.hasAttributes||!e.hasAttributes())throw"No attributes available on the <circle/> node";const t=new ce;for(let i=e.attributes.length-1;i>=0;i--){let r=e.attributes[i];switch(r.name){case"cx":t.centerX=parseFloat(r.value);break;case"cy":t.centerY=parseFloat(r.value);break;case"r":t.radius=parseFloat(r.value)}}return t})(i);if("path"===i.nodeName)return(e=>{const t=e.getAttribute("d");if(t)return y(t)})(i);throw`Unsupported svg node type: ${i.nodeName}`},createSvgShape:A,createSvgElement:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=new THREE.Box2;e.forEach((e=>i.union(e.getBBox())));let r=t.srcBox||i,o=t.dstBox||i;const n=p.getFitToBoxTransform(r,o,{preserveAspect:!0,flipY:!0});let s=o.max.x-o.min.x,a=o.max.y-o.min.y;const l=document.createElementNS(f,"svg");return l.setAttribute("height",s),l.setAttribute("width",a),e.forEach((e=>{const i=e.clone().applyMatrix4(n),r=A(i,t);l.appendChild(r)})),l}};var C=r(9578);new THREE.Vector3,new THREE.Vector3;const w=e=>{const t=new C.Path2D;return oe(t,e),t},b=0,M=1,T=2,V=3,S=4,L=(e,t)=>{const i=e.getFaces(),r=(0,C.getRegionEdges)(e,t);return(0,C.getBoundedRegionFaces)(i,r)},R=e=>{for(let t=0;t<e.length;t++){const i=e[t];for(let r=t+1;r<e.length;r++){const t=e[r],o=(0,C.computeCurveCurveIntersections)(i,t,!1,!0);for(let e=0;e<o.length;e++){const r=o[e],n=r.cutInfo.param,s=r.cutByInfo.param,a=i.getRange(),l=t.getRange(),c=Math.min(Math.abs(n-a[0]),Math.abs(n-a[1])),u=Math.min(Math.abs(s-l[0]),Math.abs(s-l[1]));if(Math.max(c,u)>1e-5)return!0}}}return!1},P=(e,t)=>{let i=!1,r=!1,o=!1;const n=n=>{const s=e.has(n),a=t.has(n);s&&a?i=!0:s?r=!0:a&&(o=!0)};for(let t of e)n(t);for(let e of t)n(e);return i?r&&!o?b:o&&!r?M:r||o?V:S:T};function D(e,t){this.x=e||0,this.y=t||0}Object.defineProperties(D.prototype,{width:{get:function(){return this.x},set:function(e){this.x=e}},height:{get:function(){return this.y},set:function(e){this.y=e}}}),Object.assign(D.prototype,{isVector2:!0,set:function(e,t){return this.x=e,this.y=t,this},setScalar:function(e){return this.x=e,this.y=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){return this.multiplyScalar(1/e)},applyMatrix3:function(e){var t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this},clampLength:function(e,t){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},cross:function(e){return this.x*e.y-this.y*e.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var e=Math.atan2(this.y,this.x);return e<0&&(e+=2*Math.PI),e},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,i=this.y-e.y;return t*t+i*i},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},lerpVectors:function(e,t,i){return this.subVectors(t,e).multiplyScalar(i).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e},fromBufferAttribute:function(e,t,i){return void 0!==i&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this},rotateAround:function(e,t){var i=Math.cos(t),r=Math.sin(t),o=this.x-e.x,n=this.y-e.y;return this.x=o*i-n*r+e.x,this.y=o*r+n*i+e.y,this}}),D.prototype.isEmtpy=function(){return!this.x&&!this.y},D.prototype.getOrthogonal=function(e){return new D(e?-this.y:this.y,this.x)},D.prototype.getOrthonormal=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.length();if(0==i){let i=t?0:1;return new D(0,e?i:-i)}return e?new D(-this.y/i,this.x/i):new D(this.y/i,-this.x/i)},D.prototype.cross=function(e){return this.x*e.y-this.y*e.x},D.prototype.normalizeExt=function(e){let t=this.length();return Math.abs(t)<=1e-7?new D(0,e?0:1):new D(this.x/t,this.y/t)};let O=1;const I=Autodesk.Viewing,N=(e,t,i)=>"rgb("+e+","+t+","+i+")",k={numIterations:100,minSegLenFraction:.01},B=new THREE.Vector3,F=new THREE.Vector3,z=new THREE.Box2,j=new THREE.Vector2;class U{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.lineColor=e.lineColor||e.color||"rgb(0,0,128)",this.lineAlpha=void 0!==e.lineAlpha?e.lineAlpha:void 0!==e.alpha?e.alpha:1,this.lineWidth=void 0!==e.lineWidth?e.lineWidth:3,this.isMiterLine=void 0!==e.isMiterLine&&this.lineWidth>0&&e.isMiterLine,this.fillColor=e.fillColor||e.color||"rgb(0,0,128)",this.fillAlpha=void 0!==e.fillAlpha?e.fillAlpha:void 0!==e.alpha?e.alpha:.2,this.lineStyle=e.lineStyle||0,this.isScreenSpace=void 0===e.isScreenSpace||e.isScreenSpace,this.compositeOperation="source-over"}setFillColor(e,t,i){this.fillColor=N(e,t,i)}setLineColor(e,t,i){this.lineColor=N(e,t,i)}clone(){return(new U).copy(this)}copy(e){return this.lineColor=e.lineColor,this.lineAlpha=e.lineAlpha,this.lineWidth=e.lineWidth,this.isMiterLine=e.isMiterLine,this.fillColor=e.fillColor,this.fillAlpha=e.fillAlpha,this.lineStyle=e.lineStyle,this.isScreenSpace=e.isScreenSpace,this.compositeOperation=e.compositeOperation,this}}U.toColor=N;const G=new U,W=(e,t)=>{for(let i=0;i<e.length;i++)t.expandByPoint(e[i])};class Y extends I.EventDispatcher{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G.clone();super(),this.style=e,this.id=O++,this.bbox=new THREE.Box2,this.bboxDirty=!0,this.visible=!0,this.movable=!0,this.selectable=!0,this.name=this.id.toString()}draw(){}hitTest(){}move(){return this}applyMatrix4(e){return this}clone(){return(new Y).copy(this)}copy(e){return this.style=e.style.clone(),this}computeBBox(){console.error("Must be implemented by derived class.")}modified(){this.bboxDirty=!0,this.fireEvent({type:Y.Events.MODIFIED})}updateBBox(){this.bboxDirty&&(this.computeBBox(),this.bboxDirty=!1)}getBBox(){return this.updateBBox(),this.bbox}static fromSVG(e){return x.fromSvg(e)}toSVG(e,t){return x.toSvg(this,e,t)}createSvgShape(e){return x.toSvgElement(this,e)}setVisible(e){this.visible=e}}Y.Events={MODIFIED:"modified"},I.GlobalManagerMixin.call(Y.prototype);const H=0,q=1,K=2,Q=3;class Z extends Y{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;super(arguments.length>1&&void 0!==arguments[1]?arguments[1]:G.clone()),this._loops=e?[e]:[],this.isClosed=void 0,this._loopInfos=null}get points(){return this._loops[0]||(this._loops[0]=[])}get loopCount(){return this._loops.length}allocPoints(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let i=0;i<e;++i)this.addPoint(0,0,t);return this}isPolygon(){return this.isClosed}isPolyline(){return!this.isClosed}isPath(){return this instanceof le}addPoint(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r={x:e,y:t};return(this._loops[i]||(this._loops[i]=[])).push(r),this.modified(),r}getPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new THREE.Vector2;return"object"==typeof t&&(i=t,t=0),i.copy(this._loops[t][e])}removePoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._loops[t].splice(e,1)}updatePoint(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=this._loops[r][e];o.x=t,o.y=i,this.modified()}insertPoint(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this._loops[i].splice(e,0,t)}get length(){return console.warn("poly.length is deprecated and will be removed. Please use poly.vertexCount property instead."),this.points.length}get vertexCount(){return this.points.length}getVertexCount(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const t=this._loops[e];return t?t.length:0}clear(){this._loops=[],this.modified()}enumEdges(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const i=this.getEdgeCount(t);for(let r=0;r<i;r++){const i=r,o=this.nextIndex(r,t);if(e(this.getPoint(i,t),this.getPoint(o,t),i,o))return}}#e(e,t,i,r,o,n,s,a){if(p.pointOnMiterLineSegment(e,t,i,a,s))return!0;const l=this.prevIndex(r,n),c=this.nextIndex(o,n),u=-1!==c,h=-1!==l&&this.getPoint(l),d=u&&this.getPoint(c),g=h&&p.pointOnMiterLineJunction(e,h,t,i,a,s),f=d&&p.pointOnMiterLineJunction(e,t,i,d,a,s);return g||f}findEdgeIndex(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=-1,n=(i,r)=>p.isPointOnEdge(e,i,r,t);r>0&&(n=(o,n,s,a)=>this.#e(e,o,n,s,a,i,t,r));return this.enumEdges(((e,t,i,r)=>{const s=n(e,t,i,r);return s&&(o=i),s}),i),o}moveLoop(e,t,i){const r=this._loops[i];for(let i=0;i<r.length;i++)r[i].x+=e,r[i].y+=t;this.modified()}move(e,t){for(let i=0;i<this.loopCount;i++)this.moveLoop(e,t,i);return this}applyMatrix4(e){for(let t=0;t<this.loopCount;t++){const i=this._loops[t];for(let r=0;r<i.length;r++){const o=i[r],n=(t,i,r)=>{const o=B.set(t,i,0).applyMatrix4(e);return r.x=o.x,r.y=o.y,r};if(n(o.x,o.y,o),this.isBezierArc(r,t)){let e=n(o.cp1x,o.cp1y,B);o.cp1x=e.x,o.cp1y=e.y,e=n(o.cp2x,o.cp2y,B),o.cp2x=e.x,o.cp2y=e.y}this.isEllipseArc(r,t)&&o.ellipseArcParams.applyMatrix4(e)}}return this.modified(),this}addLoop(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;const r=e._loops[t],o=r.map((e=>({x:e.x,y:e.y})));let n;return-1===i?(n=this.nextFreeLoop(),this._loops[n]=o):(n=i,this._loops.splice(n,0,o)),this.modified(),n}copyGeometry(e){this.isClosed=e.isClosed,this._loops=[];for(let t=0;t<e.loopCount;t++)this.addLoop(e,t);return this}copy(e){return super.copy(e),this.copyGeometry(e)}computeBBox(){this.bbox.makeEmpty();for(let e=0;e<this.loopCount;e++){const t=this._loops[e];t&&W(t,this.bbox)}return this.bbox}indexValid(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e>=0&&e<this.getVertexCount(t)}nextIndex(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!this.indexValid(e,t))return-1;return e===this.getVertexCount(t)-1?this.isClosed?0:-1:e+1}prevIndex(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!this.indexValid(e,t))return-1;if(0===e){const e=this.getVertexCount(t);return this.isClosed?e-1:-1}return e-1}edgeBeforeVertex(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.prevIndex(e,t)}edgeAfterVertex(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.edgeIndexValid(e,t)?e:-1}nextEdgeIndex(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.edgeIndexValid(e,t)&&(this.isClosed||e!==this.getEdgeCount(t)-1)?this.nextIndex(e,t):-1}prevEdgeIndex(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.edgeIndexValid(e,t)&&(this.isClosed||0!==e)?this.prevIndex(e,t):-1}edgeIndexValid(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const i=this.getEdgeCount(t);return e>=0&&e<i}prevEdgeExists(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const i=this.getVertexCount(t);return this.edgeIndexValid(e,t)&&i>2&&(e>0||this.isClosed)}nextEdgeExists(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const i=this.getVertexCount(t),r=e===i-2;return this.edgeIndexValid(e,t)&&i>2&&(!r||this.isClosed)}getEdge(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const o=e,n=this.nextIndex(e,r);this.getPoint(o,r,t),this.getPoint(n,r,i)}getEdgeDirection(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new THREE.Vector2;const r=e,o=this.nextIndex(e,t),n=this._loops[t];return p.getEdgeDirection(n[r],n[o],i)}getEdgeLength(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const i=e,r=this.nextIndex(e,t),o=this._loops[t],n=o[i],s=o[r];return p.getEdgeLength(n,s)}getEdgeCount(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const t=this.getVertexCount(e);return this.isClosed?t:t-1}getLength(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const i=new THREE.Vector2,r=new THREE.Vector2;let o=0;for(let n=0;n<this.getEdgeCount(t);n++)this.getEdge(n,i,r,t),e&&(e.apply(i),e.apply(r)),o+=i.distanceTo(r);return o}fromBox2(e){return this.addPoint(e.min.x,e.min.y),this.addPoint(e.max.x,e.min.y),this.addPoint(e.max.x,e.max.y),this.addPoint(e.min.x,e.max.y),this}getPointOnEdge(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new THREE.Vector2;const o=this._loops[i],n=o[e],s=o[this.nextIndex(e,i)];return r.lerpVectors(n,s,t)}isCCW(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return Autodesk.Extensions.CompGeom.polygonArea(this._loops[e])>0}getLeftEdgeNormal(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new THREE.Vector2;const r=this._loops[t],o=e,n=(e+1)%r.length,s=r[o],a=r[n];i.subVectors(a,s).normalize();const l=i.x;return i.x=-i.y,i.y=l,i}getOuterNormal(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new THREE.Vector2;const r=this.getLeftEdgeNormal(e,t,i);return this.isCCW(t)?r.multiplyScalar(-1):r}nextFreeLoop(){const e=this._loops.findIndex((e=>!e||!e.length));return e>=0?e:this.loopCount}findVertex(e){for(let t=0;t<this.loopCount;t++){const i=this.getVertexCount(t);for(let r=0;r<i;r++)if(e(r,t))return{vertexIndex:r,loopIndex:t}}return null}empty(){return!this._loops.some((e=>e&&e.length>0))}modified(){super.modified(),this._loopInfos=null}isSelfIntersecting(){const e=this._getLoopInfos();return e&&e.some((e=>e.error))}_getLoopInfos(){if(this.isClosed&&!(this.loopCount<1))return this._loopInfos||(this._loopInfos=(e=>{const t=w(e).getWireBody(),r=t.getWires(),o=t.getEdges(),n=[];for(let e=0;e<r.length;e++){const t=r[e].getEdges();n[e]={containedLoops:[],rank:0,error:R(t)}}if(r.length<2)return n;const s=new C.SketchRegionSolver;s.compute(o),s.getFaces().forEach(((e,t)=>e.arrayIndex=t));const a=[];for(let e=0;e<r.length;e++){const t=r[e].getEdges();if(R(t)){n[e].error=!0,a[e]=new Set;continue}const i=new Set;L(s,t).forEach((e=>{i.add(e.arrayIndex)})),a[e]=i}for(let e=0;e<a.length;e++){const t=a[e];for(let i=e+1;i<a.length;i++){const r=a[i];switch(P(t,r)){case T:continue;case b:n[e].containedLoops.push(i),n[i].rank++;break;case M:n[i].containedLoops.push(i),n[e].rank++;break;default:n[e].error=!0,n[i].error=!0}}}if(r.length!==e.loopCount){const t=[],r=0;for(let o=0;o<e.loopCount;o++)e.getVertexCount(o)&&(t[i]=n[r++]);n=t}return n})(this)),this._loopInfos}getLoopType(e){if(!this.isClosed)return;if(!this.getVertexCount(e))return H;const t=this._getLoopInfos()[e];return t.error?Q:1&t.rank?q:K}getChildLoops(e){const t=this._getLoopInfos(),i=t&&t[e];return i?i.containedLoops.slice():[]}cleanupLoops(){this._loops=this._loops.filter((e=>e&&e.length>=0))}getMainLoops(){const e=this._getLoopInfos();if(!e)return[];const t=[];for(let i=0;i<e.length;i++){const r=e[i];this.getLoopType(i)===K&&(0===r.rank&&t.push(i))}return t}removeLoop(e){return this._loops.splice(e,1),this.modified(),this}removeLoops(e){this._loops=this._loops.filter(((t,i)=>!e.includes(i)))}isPointFinite(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!this.indexValid(e,t))return!1;let i=this._loops[t][e];return isFinite(i.x)&&isFinite(i.y)}isLoopFinite(e){const t=this._loops[e],i=t?t.length:0;for(let t=0;t<i;t++)if(!this.isPointFinite(t,e))return!1;return!0}}class J extends Z{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],arguments.length>1&&void 0!==arguments[1]?arguments[1]:G.clone()),this.isClosed=!0}draw(e,t){ne(e,this,t)}hitTest(e,t){if(!this.vertexCount)return!1;let i=0;for(let o=0;o<this.loopCount;o++){const n=this._loops[o];if(!n)continue;const s=new Autodesk.Extensions.CompGeom.ComplexPolygon(n);var r=[];for(let e=0;e<n.length;e++)r.push(e);s.pointInContour(e,t,r)&&i++}return Boolean(1&i)}clone(){return(new J).copy(this)}getArea(e){if(!this.isClosed)return;const t=this._getLoopInfos();let i=0;for(let r=0;r<this.loopCount;r++){if(this.points.length<3)continue;const o=t?t[r]:null,n=1&(o?o.rank:0)?-1:1;let s=0;this.enumEdges(((t,i)=>{e&&e.apply(t),e&&e.apply(i),s+=t.x*i.y-i.x*t.y}),r),i+=n*Math.abs(.5*s)}return i}}class X extends Z{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],arguments.length>1&&void 0!==arguments[1]?arguments[1]:G.clone()),this.isClosed=!1}makeLine(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return 2!==this.vertexCount?(this.clear(),this.addPoint(e,t),this.addPoint(i,r)):(this.updatePoint(0,e,t),this.updatePoint(1,i,r)),this}draw(e,t){ne(e,this,t)}clone(){return(new X).copy(this)}hitTest(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return-1!==this.findEdgeIndex({x:e,y:t},i,0,r)}}const $={Line:0,Bezier:1,Ellipse:2};let ee=null,te=()=>(ee=ee||new Autodesk.Extensions.CompGeom.EllipseArc,ee),ie=new THREE.Vector2;const re=(e,t,i)=>{const r=t._loops[i];if(!r||!r.length)return;if(!t.isLoopFinite(i))return void console.warn(`Skipped loop, because it contains Inf or NaN values. Shape ID: ${t.id}. LoopIndex: ${i}`);const o=r;e.moveTo(o[0].x,o[0].y);const n=(r,o,n)=>{switch(r.arcType){case $.Line:break;case $.Bezier:return void e.bezierCurveTo(r.cp1x,r.cp1y,r.cp2x,r.cp2y,o.x,o.y);case $.Ellipse:{const s=r.ellipseArcParams,a=t.exportEllipseArc(n,i,te());if(!a.isValid())break;return void(e.ellipseArcTo?e.ellipseArcTo(s.rx,s.ry,THREE.Math.degToRad(s.rotation),s.largeArcFlag,s.sweepFlag,o.x,o.y):e.ellipse(a.cx,a.cy,a.rx,a.ry,a.rotation,a.startAngle,a.endAngle,a.ccw))}}e.lineTo(o.x,o.y)};for(let e=1;e<o.length;e+=1){n(o[e-1],o[e],e-1)}if(t.isClosed){n(o[o.length-1],o[0],o.length-1),e.closePath()}},oe=(e,t)=>{for(let i=0;i<t.loopCount;i++)re(e,t,i)},ne=(e,t,i)=>{if(!t.vertexCount)return;let r=i||t.style;const o=e.canvasContext;e.dbId=t.id,e.lineStyle=r.lineStyle,e.isScreenSpace=r.isScreenSpace;const n=o.globalCompositeOperation;if(r.compositeOperation&&(o.globalCompositeOperation=r.compositeOperation,e.flushBuffer(0,!0)),e.beginPath(),!t.isClosed&&r.isMiterLine&&e.setMiterLine(!0),oe(e,t),t.isClosed){if(o.fillStyle=r.fillColor,r.fillColor.hasOwnProperty("colorStops")){const t=e.createGradientData(r.fillColor).getFillStyle(o);o.fillStyle=t}o.globalAlpha=r.fillAlpha,e.fill()}o.strokeStyle=r.lineColor,o.globalAlpha=r.lineAlpha,o.lineWidth=r.lineWidth,r.isScreenSpace&&(o.lineWidth*=window.devicePixelRatio),e.stroke(),e.dbId=-1,e.lineStyle=0,e.isScreenSpace=!1,o.globalCompositeOperation=n};class se{constructor(){this.cp1x=0,this.cp1y=0,this.cp2x=0,this.cp2y=0}copy(e){return this.cp1x=e.cp1x,this.cp1y=e.cp1y,this.cp2x=e.cp2x,this.cp2y=e.cp2y,this}clone(){return(new se).copy(this)}}class ae{constructor(){this.rx=0,this.ry=0,this.rotation=0,this.largeArcFlag=!1,this.sweepFlag=!1}copy(e){return this.rx=e.rx,this.ry=e.ry,this.rotation=e.rotation,this.largeArcFlag=e.largeArcFlag,this.sweepFlag=e.sweepFlag,this}clone(){return(new ae).copy(this)}rotate(e){this.rotation+=e,this.rotation-=360*Math.trunc(this.rotation/360)}scale(e){this.rx*=e,this.ry*=e}applyMatrix4(e){B.set(1,0,0).applyMatrix4(e),F.set(0,0,0).applyMatrix4(e);const t=B.sub(F),i=THREE.Math.radToDeg(Math.atan2(t.y,t.x)),r=t.length();this.rotate(i),this.scale(r),p.changesOrientation(e)&&(this.sweepFlag=!this.sweepFlag,this.rotation=360-this.rotation)}}class le extends Z{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:G.clone()),this.isClosed=t}_updateEllipseArcParams(e,t,i,r){const o=this._loops[t][e].ellipseArcParams,n=this.getEdgeDirection(e,t),s=p.getEdgeDirection(i,r),a=p.angleBetweenDirections(s,n);o.rotate(THREE.Math.radToDeg(a));const l=this.getEdgeLength(e,t),c=p.distance2D(i,r)/l;isFinite(c)&&c>0&&o.scale(c)}updatePoint(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const o=this._loops[r];let n=o[e],s=ie.set(t,i);const a=t-n.x,l=i-n.y;if(this.isBezierArc(e,r)&&(n.cp1x+=a,n.cp1y+=l),this.isEllipseArc(e,r)){const t=o[this.nextIndex(e,r)];this._updateEllipseArcParams(e,r,s,t)}const c=this.edgeBeforeVertex(e,r);if(this.edgeIndexValid(c,r)){const e=o[c];this.isBezierArc(c,r)&&(e.cp2x+=a,e.cp2y+=l),this.isEllipseArc(c,r)&&this._updateEllipseArcParams(c,r,e,s)}n.x=t,n.y=i,this.modified()}getEdgeType(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const i=this._loops[t][e].arcType;return i||$.Line}setBezierArc(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;"object"==typeof t||(t={cp1x:t,cp1y:i,cp2x:arguments.length<=3?void 0:arguments[3],cp2y:arguments.length<=4?void 0:arguments[4]},i=(arguments.length<=5?void 0:arguments[5])||0);const r=this._loops[i][e];r.arcType=$.Bezier,se.prototype.copy.call(r,t),this.modified()}getBezierArcParams(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new se;const r=this._loops[t][e],o=r&&r.arcType===$.Bezier&&r;return o&&i.copy(o)}setEllipseArc(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=this._loops[i][e];r.arcType=$.Ellipse,r.ellipseArcParams=t.clone(),this.modified()}getEllipseArcParams(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new ae;const r=this._loops[t][e],o=r&&r.arcType===$.Ellipse&&r.ellipseArcParams;return o&&i.copy(o)}exportEllipseArc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new EllipseArc;const r=this._loops[t],o=this.nextIndex(e,t),n=r[e],s=r[o],a=n.ellipseArcParams;return i.setFromSvgArc(a.rx,a.ry,a.rotation,a.largeArcFlag,a.sweepFlag,n,s),i}isBezierArc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.edgeIndexValid(e,t)&&this._loops[t][e].arcType===$.Bezier}isEllipseArc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.edgeIndexValid(e,t)&&this._loops[t][e].arcType===$.Ellipse}isArc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.isBezierArc(e,t)||this.isEllipseArc(e,t)}getStartTangent(e){const t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)||new THREE.Vector2,i=this.points[e];return t.x=i.cp1x-i.x,t.y=i.cp1y-i.y,t}getEndTangent(e){const t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)||new THREE.Vector2,i=this.nextIndex(e),r=this.points[e],o=this.points[i];return t.x=r.cp2x-o.x,t.y=r.cp2y-o.y,t}setStartTangent(e,t){const i=this.points[e];i.cp1x=i.x+t.x,i.cp1y=i.y+t.y,this.modified()}setEndTangent(e,t){const i=this.points[e],r=this.points[this.nextIndex(e)];i.cp2x=r.x+t.x,i.cp2y=r.y+t.y,this.modified()}removeArc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const i=this._loops[t][e];i.arcType===$.Bezier&&(i.cp1x=void 0,i.cp1y=void 0,i.cp2x=void 0,i.cp2y=void 0),i.ellipseArcParams&&(i.ellipseArcParams=void 0),i.arcType=$.Line,this.modified()}getControlPoint(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new THREE.Vector2;const o=this._loops[i][e];return 1===t?(r.x=o.cp1x,r.y=o.cp1y):(r.x=o.cp2x,r.y=o.cp2y),r}updateControlPoint(e,t,i,r){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,n=this._loops[o][e];1===t?(n.cp1x=i,n.cp1y=r):(n.cp2x=i,n.cp2y=r),this.modified()}draw(e,t){ne(e,this,t)}toPoly(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Autodesk.Extensions.CompGeom.DefaultTessParams;const t=this.isClosed?new J:new X;for(let i=0;i<this.loopCount;i++){const r={moveTo:(e,r)=>t.addPoint(e,r,i),lineTo:(e,r)=>t.addPoint(e,r,i),bezierCurveTo(o,n,s,a,l,c){const u=t._loops[i],h=u[u.length-1],d=z.makeEmpty();d.expandByPoint(h),d.expandByPoint(j.set(l,c)),d.expandByPoint(j.set(o,n)),d.expandByPoint(j.set(s,a));const p=d.getSize(ie).length();Autodesk.Extensions.CompGeom.TesselateCubic(r,h.x,h.y,o,n,s,a,l,c,p,e)},ellipse(t,i,o,n,s,a,l,c){const u=Math.max(o,n),h=e.numIterations,d=e.minSegLenFraction*u;te().set(t,i,o,n,s,a,l,c).tesselate(r,h,d)},closePath:()=>{}};re(r,this,i)}return t}computeBBox(){super.computeBBox();const e=new THREE.Vector2;for(let t=0;t<this.loopCount;t++)for(let i=0;i<this.getVertexCount(t);i++)if(this.isBezierArc(i,t))this.getControlPoint(i,1,t,e),this.bbox.expandByPoint(e),this.getControlPoint(i,2,t,e),this.bbox.expandByPoint(e);else if(this.isEllipseArc(i,t)){const e=this.exportEllipseArc(i,t,te());this.bbox.union(e.computeBBox(z))}}hitTest(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return this.toPoly().hitTest(e,t,i,r)}clone(){return(new le).copy(this)}addLoop(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;i=super.addLoop(e,t,i);const r=e._loops[t],o=this._loops[i];for(let i=0;i<r.length;i++){const n=e.getEdgeType(i,t);if(n===$.Line)continue;const s=r[i],a=o[i];switch(a.arcType=s.arcType,n){case $.Bezier:a.cp1x=s.cp1x,a.cp1y=s.cp1y,a.cp2x=s.cp2x,a.cp2y=s.cp2y;break;case $.Ellipse:a.ellipseArcParams=s.ellipseArcParams&&s.ellipseArcParams.clone()}}return this.modified(),this}moveLoop(e,t,i){super.moveLoop(e,t,i);const r=this._loops[i];for(let o=0;o<r.length;o++){if(!this.isBezierArc(o,i))continue;const n=r[o];n.cp1x+=e,n.cp1y+=t,n.cp2x+=e,n.cp2y+=t}}getArea(e){if(!this.isClosed)return;const t=this.toPoly(k);return t._loopInfos=this._getLoopInfos(),t.getArea(e)}getLength(e){return this.toPoly().getLength(e)}getPointOnEdge(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new THREE.Vector2;const o=this._loops[i];switch(this.getEdgeType(e,i)){case $.Line:break;case $.Bezier:{const i=o[e],n=o[this.nextIndex(e)];return Autodesk.Extensions.CompGeom.getCubeBezierPoint(t,i.x,i.y,i.cp1x,i.cp1y,i.cp2x,i.cp2y,n.x,n.y,r)}case $.Ellipse:{const o=this.exportEllipseArc(e,i,te());if(!o.isValid())break;return o.getPoint(t,r)}default:avp.logger.error("unexpected edge type")}return super.getPointOnEdge(e,t,i,r)}runPathCommands(e){oe(e,this)}hasArcs(){return Boolean(this.findVertex(((e,t)=>this.isArc(e,t))))}}class ce extends Y{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:G.clone(),o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:20;super(r),this.polygon=new J([],r),this.polygon.id=this.id,this.centerX=e,this.centerY=t,this.radius=i,this.tessSegments=o,this.needsUpdate=!0}draw(e,t){this.polygon.points.length=0;const i=360/this.tessSegments;for(let e=0;e<360;e+=i){let t=e*Math.PI/180,i=this.radius*Math.cos(t),r=this.radius*Math.sin(t);this.polygon.addPoint(this.centerX+i,this.centerY+r)}this.needsUpdate=!1,this.polygon.draw(e,t)}setCenter(e,t){this.centerX=e,this.centerY=t,this.modified()}move(e,t){return this.centerX+=e,this.centerY+=t,this.modified(),this}hitTest(e,t){const i=e-this.centerX,r=t-this.centerY;return i*i+r*r<this.radius*this.radius}clone(){return(new ce).copy(this)}copy(e){return super.copy(e),this.polygon=e.polygon.clone(),this.centerX=e.centerX,this.centerY=e.centerY,this.radius=e.radius,this.tessSegments=e.tessSegments,this.modified(),this}computeBBox(){this.bbox.min.set(this.centerX-this.radius,this.centerY-this.radius),this.bbox.max.set(this.centerX+this.radius,this.centerY+this.radius)}}function ue(e,t){return!(!e||!t)&&(e===t||ue(e.parent,t))}function he(e,t){let i=[];for(let r=0;r<t.length;r++){const o=t[r];o.polygon.hitTest(e.x,e.y)&&i.push(o)}for(let e=0;e<i.length-1;e++)for(let t=e+1;t<i.length;t++)ue(i[e],i[t])?i[t]=null:ue(i[t],i[e])&&(i[e]=null);return i=i.filter((e=>e)),i}function de(e){const t={},i=e.map((e=>{if(e.area&&"Svg"===e.area.format){const i=Y.fromSVG(e.area.geometry);i.name=e.name;const r=e.node&&e.node.id||e.id,o={id:r,metadata:e,polygon:i,parent:void 0};return t[r]=o,o}})).filter((e=>e));return i.forEach((e=>{const i=e.metadata.node&&e.metadata.node.parentId||e.metadata.parentId;e.parent=t[i]})),i}},7136:(e,t,i)=>{"use strict";function r(e,t,i,r,o){return new Promise(((n,s)=>{e((e=>{if(!e)return s("Invalid access token.");const a=function(e,t){switch(e){case"staging":case"qa":case"dev":case"local":return t?"https://api-stg.afg.us.autodesk.com":"https://developer-stg.api.autodesk.com";default:return t?"https://api.afg.us.autodesk.com":"https://developer.api.autodesk.com"}}(r,o),l=function(e){switch(e){case"qa":return"-qa";case"dev":case"local":return"-dev";default:return""}}(r);let c=[];!function t(r){const o=function(e,t,i,r,o,n){const s=new XMLHttpRequest;return s.open(e,t),i&&s.setRequestHeader("Content-Type",i),s.setRequestHeader("Access-Control-Allow-Origin","*"),s.setRequestHeader("Authorization","Bearer "+r),s.onload=e=>{201===e.currentTarget.status||200===e.currentTarget.status||204===e.currentTarget.status?o(e.currentTarget.responseText):n()},s.onerror=n,s.ontimeout=n,s.onabort=n,s}("POST",r,"application/json",e,(function(e){const i=JSON.parse(e);c=c.concat(i.results),i.pagination.next?t(a+i.pagination.next):n(c)}),s),l={documentUrns:[i]};o.send(JSON.stringify(l))}(`${a}/${`bim360/locations${l}/v2`}/containers/${t}/trees/default/nodes:search`)}))}))}i.r(t),i.d(t,{fetch2dLocations:()=>r})},8951:(e,t,i)=>{const r=Autodesk.Viewing,o=AutodeskNamespace("Autodesk.AEC.Locations");function n(t,i){for(let r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e.exports[r]=t[r],i[r]=t[r])}n(i(7136),o),n(i(2215),o);const s="locations-2d-context",a={fillColor:"rgb(205, 234, 247)",fillAlpha:.2,lineColor:"rgb(0, 110, 175)",lineWidth:2},l={background:"#FFFFFF",borderRadius:"17px",display:"flex",flexDirection:"row",padding:"5px 9px",boxShadow:"none",zIndex:0},c={color:"#006EAF",fontSize:"12px",lineHeight:"12px",alignSelf:"center"};class u extends r.Extension{constructor(e,t){super(e,t),this.onModelAdded=this.onModelAdded.bind(this)}async load(){this.locations=[],this.edit2dExtension=await this.viewer.loadExtension("Autodesk.Edit2D"),this.edit2dContext=this.edit2dExtension.registerTools(s);class e extends Autodesk.Edit2D.FadeOutStyleRule{apply(e,t,i){super.apply(e,t,i),e.styleInitialized||(e.styleInitialized=!0,Object.assign(e.container.style,l),Object.assign(e.textDiv.style,c)),e.hoverStyle^t.hover&&(e.hoverStyle=!!t.hover,e.container.style.boxShadow=t.hover?"0px 4px 14px rgba(12, 44, 84, 0.15), 0px 0px 2px rgba(12, 44, 84, 0.25)":"none")}}return this.shapeLabelRule=new Autodesk.Edit2D.ShapeLabelRule(this.edit2dContext.layer,(e=>e.name),void 0,new e),this.viewer.addEventListener(r.MODEL_ADDED_EVENT,this.onModelAdded),this.onModelAdded(),!0}unload(){return this.edit2dExtension&&this.edit2dExtension.unregisterTools(s),this.shapeLabelRule.dtor(),this.shapeLabelRule=null,this.edit2dExtension=null,this.edit2dContext=null,this.locations=[],this.viewer.removeEventListener(r.MODEL_ADDED_EVENT,this.onModelAdded),!0}onModelAdded(){const e=this.viewer.model;if(!e)return;if(e.isPageCoordinates())return;const t=Autodesk.Viewing.PDFUtils.getLeafletNormalizingMatrix(this.viewer);if(!t)return;const i=e.getMetadata("page_dimensions"),r=new THREE.Matrix4;r.makeScale(i.page_width,i.page_height,1);const o=new THREE.Matrix4;o.multiplyMatrices(r,t),o.invert(),this.edit2dContext.setMatrix(o)}setLocations(e){this.locations=e,this.allLocationsVisible&&this.showAllLocations()}getLocations(){return this.locations}getLocationById(e){const t=this.locations.find((t=>t.id===e));return t||console.warn("Cant find location: ",e),t}showLocationById(e){const t=this.getLocationById(e);this.showLocationItem(t)}hideLocationById(e){const t=this.getLocationById(e);this.hideLocationItem(t)}showLocationItem(e){if(e){const t=e.polygon;Object.assign(t.style,a),this.edit2dContext.layer.findShapeById(t.id)||this.edit2dContext.layer.addShape(t)}}hideLocationItem(e){if(e){const t=e.polygon;this.edit2dContext.layer.removeShape(t)}}showAllLocations(){this.edit2dContext.layer.autoUpdate=!1,this.locations.forEach((e=>{this.showLocationItem(e)})),this.edit2dContext.layer.autoUpdate=!0,this.edit2dContext.layer.update(),this.allLocationsVisible=!0}hideAllLocations(){this.edit2dContext.layer.autoUpdate=!1,this.locations.forEach((e=>{this.hideLocationItem(e)})),this.edit2dContext.layer.autoUpdate=!0,this.edit2dContext.layer.update(),this.allLocationsVisible=!1}getLocationIdsAtPoint(e){return Autodesk.AEC.Locations.getPointLocations(e,this.locations).map((e=>e.id))}onMouseMove(e){var t=this.viewer.impl.getCanvasBoundingClientRect();let i=this.viewer.clientToWorld(e.clientX-t.left,e.clientY-t.top,void 0,!0).point;if(!this.viewer.model.isPageCoordinates()&&(i=Autodesk.Viewing.PDFUtils.leafletToPdfWorld(this.viewer,i),!i))return;const r=this.getLocationIdsAtPoint(i).slice(0,1);this.hoverLocationsByIds(r)}hoverLocationsByIds(e){let t=!1;this.locations.forEach((i=>{const r=i.polygon;-1!==e.indexOf(i.id)?r.hover||(r.style.fillAlpha=.5,r.hover=!0,t=!0):r.hover&&(r.style.fillAlpha=.2,r.hover=!1,t=!0)})),t&&this.edit2dContext.layer.update()}}r.theExtensionManager.registerExtension("Autodesk.AEC.LocationsExtension",u)},6702:(e,t,i)=>{"use strict";i.d(t,{A:()=>o});const r="camera-near-far-overlay-scene";class o{constructor(e,t){this.topViewViewer=e,this.targetViewer=t,this.topViewViewer.impl.createOverlayScene(r),this.planeGeometry=new THREE.PlaneBufferGeometry(1,1),this.nearPlane=this.createMesh(23502),this.farPlane=this.createMesh(15249964),this.show(),this.update(),this.update=this.update.bind(this),this.targetViewer.addEventListener(Autodesk.Viewing.RENDER_PRESENTED_EVENT,this.update),this.topViewViewer.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.update)}createMesh(e){const t=new THREE.MeshBasicMaterial({color:e,opacity:1,transparent:!1,depthTest:!1,depthWrite:!1,side:THREE.DoubleSide});return new THREE.Mesh(this.planeGeometry,t)}show(){this.topViewViewer.impl.addOverlay(r,this.nearPlane),this.topViewViewer.impl.addOverlay(r,this.farPlane)}hide(){this.topViewViewer.impl.removeOverlay(r,this.nearPlane),this.topViewViewer.impl.removeOverlay(r,this.farPlane)}getScale(e){return e*this.topViewViewer.getCamera().orthoScale/this.topViewViewer.navigation.getScreenViewport().height}update(){const e=this.targetViewer.getCamera(),t=e.target.clone().sub(e.position).normalize(),i=Math.atan2(e.target.y-e.position.y,e.target.x-e.position.x)+THREE.Math.degToRad(90),r=this.getScale(1),o=this.topViewViewer.getCamera().position.z-.001,n=e.position.clone().add(t.clone().multiplyScalar(e.near));n.z=o,this.nearPlane.position.copy(n),this.nearPlane.scale.set(200*r,4*r,1),this.nearPlane.rotation.set(0,0,i);const s=e.position.clone().add(t.clone().multiplyScalar(e.far));s.z=o,this.farPlane.position.copy(s),this.farPlane.scale.set(200*r,4*r,1),this.farPlane.rotation.set(0,0,i),this.topViewViewer.impl.invalidate(!1,!1,!0)}destroy(){this.planeGeometry.dispose(),this.planeGeometry=null,this.topViewViewer.impl.removeOverlayScene(r),this.targetViewer.removeEventListener(Autodesk.Viewing.RENDER_PRESENTED_EVENT,this.update),this.topViewViewer.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.update),this.topViewViewer=null,this.targetViewer=null}}},3543:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(1354),o=i.n(r),n=i(6314),s=i.n(n)()(o());s.push([e.id,".avatar-widget{width:0px;height:0px;top:0px;left:0px;position:absolute;transition:opacity .7s;opacity:0;z-index:1;pointer-events:none;will-change:transform}.avatar-widget.visible{opacity:.7;pointer-events:all}.avatar-frustum{border-left:20px solid rgba(0,0,0,0);border-right:20px solid rgba(0,0,0,0);border-top:40px solid #3590e9;border-radius:49%;opacity:.4;width:0px;height:0px;position:absolute;transform-origin:bottom center;cursor:crosshair;will-change:transform}.avatar-frustum.touch{border-left:40px solid rgba(0,0,0,0);border-right:40px solid rgba(0,0,0,0);border-top:80px solid #3590e9}.avatar-position-fill{width:10px;height:10px;left:15px;top:35px;position:absolute;border-radius:50%;background-color:#3590e9;box-shadow:0px 0px 0px 2px #fff}.avatar-position-fill.touch{left:35px;top:75px}.avatar-position-hitarea{position:absolute;width:15px;height:15px;left:5px;top:5px;border-radius:50px;transform:translate(-50%, -50%);cursor:grab}.avatar-position-hitarea.touch{width:50px;height:50px}","",{version:3,sources:["webpack://./extensions/AEC/Avatar/Avatar.scss"],names:[],mappings:"AAAA,eAAe,SAAS,CAAC,UAAU,CAAC,OAAO,CAAC,QAAQ,CAAC,iBAAiB,CAAC,sBAAsB,CAAC,SAAS,CAAC,SAAS,CAAC,mBAAmB,CAAC,qBAAqB,CAAC,uBAAuB,UAAU,CAAC,kBAAkB,CAAC,gBAAgB,oCAAoC,CAAC,qCAAqC,CAAC,6BAA6B,CAAC,iBAAiB,CAAC,UAAU,CAAC,SAAS,CAAC,UAAU,CAAC,iBAAiB,CAAC,8BAA8B,CAAC,gBAAgB,CAAC,qBAAqB,CAAC,sBAAsB,oCAAoC,CAAC,qCAAqC,CAAC,6BAA6B,CAAC,sBAAsB,UAAU,CAAC,WAAW,CAAC,SAAS,CAAC,QAAQ,CAAC,iBAAiB,CAAC,iBAAiB,CAAC,wBAAwB,CAAC,+BAA+B,CAAC,4BAA4B,SAAS,CAAC,QAAQ,CAAC,yBAAyB,iBAAiB,CAAC,UAAU,CAAC,WAAW,CAAC,QAAQ,CAAC,OAAO,CAAC,kBAAkB,CAAC,+BAA+B,CAAC,WAAW,CAAC,+BAA+B,UAAU,CAAC,WAAW",sourcesContent:[".avatar-widget{width:0px;height:0px;top:0px;left:0px;position:absolute;transition:opacity .7s;opacity:0;z-index:1;pointer-events:none;will-change:transform}.avatar-widget.visible{opacity:.7;pointer-events:all}.avatar-frustum{border-left:20px solid rgba(0,0,0,0);border-right:20px solid rgba(0,0,0,0);border-top:40px solid #3590e9;border-radius:49%;opacity:.4;width:0px;height:0px;position:absolute;transform-origin:bottom center;cursor:crosshair;will-change:transform}.avatar-frustum.touch{border-left:40px solid rgba(0,0,0,0);border-right:40px solid rgba(0,0,0,0);border-top:80px solid #3590e9}.avatar-position-fill{width:10px;height:10px;left:15px;top:35px;position:absolute;border-radius:50%;background-color:#3590e9;box-shadow:0px 0px 0px 2px #fff}.avatar-position-fill.touch{left:35px;top:75px}.avatar-position-hitarea{position:absolute;width:15px;height:15px;left:5px;top:5px;border-radius:50px;transform:translate(-50%, -50%);cursor:grab}.avatar-position-hitarea.touch{width:50px;height:50px}"],sourceRoot:""}]);const a=s},4574:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(1354),o=i.n(r),n=i(6314),s=i.n(n)()(o());s.push([e.id,".canvas-bookmark.adsk-button,.clustered-canvas-bookmark.adsk-button,.declustered-canvas-bookmark.adsk-button{position:absolute;left:0px;top:0px;border-style:none !important;color:#fff;margin:none;padding:0px;transition:visibility .5s,opacity .5s;opacity:0;visibility:hidden}.canvas-bookmark.adsk-button{width:22px;height:22px}.clustered-canvas-bookmark.adsk-button{width:29px;height:29px}.declustered-canvas-bookmark.adsk-button{width:29px;height:29px;color:#d3d3d3}.canvas-bookmark.visible{opacity:1;visibility:visible}.clustered-canvas-bookmark.visible{opacity:1;visibility:visible}","",{version:3,sources:["webpack://./extensions/AEC/CanvasBookmark/CanvasBookmark.css"],names:[],mappings:"AAAA,6GAA6G,iBAAiB,CAAC,QAAQ,CAAC,OAAO,CAAC,4BAA4B,CAAC,UAAU,CAAC,WAAW,CAAC,WAAW,CAAC,qCAAqC,CAAC,SAAS,CAAC,iBAAiB,CAAC,6BAA6B,UAAU,CAAC,WAAW,CAAC,uCAAuC,UAAU,CAAC,WAAW,CAAC,yCAAyC,UAAU,CAAC,WAAW,CAAC,aAAa,CAAC,yBAAyB,SAAS,CAAC,kBAAkB,CAAC,mCAAmC,SAAS,CAAC,kBAAkB",sourcesContent:[".canvas-bookmark.adsk-button,.clustered-canvas-bookmark.adsk-button,.declustered-canvas-bookmark.adsk-button{position:absolute;left:0px;top:0px;border-style:none !important;color:#fff;margin:none;padding:0px;transition:visibility .5s,opacity .5s;opacity:0;visibility:hidden}.canvas-bookmark.adsk-button{width:22px;height:22px}.clustered-canvas-bookmark.adsk-button{width:29px;height:29px}.declustered-canvas-bookmark.adsk-button{width:29px;height:29px;color:#d3d3d3}.canvas-bookmark.visible{opacity:1;visibility:visible}.clustered-canvas-bookmark.visible{opacity:1;visibility:visible}"],sourceRoot:""}]);const a=s},9392:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(1354),o=i.n(r),n=i(6314),s=i.n(n)()(o());s.push([e.id,".camera-selector{width:0;height:0;border-left:50px solid rgba(0,0,0,0);border-right:50px solid rgba(0,0,0,0);border-top:100px solid #0696d7;border-radius:50%;transform-origin:bottom center;position:absolute;opacity:.8;pointer-events:none;z-index:1}.camera-selector-position{width:20px;height:20px;border-radius:50%;background-color:#0696d7;position:absolute;opacity:.8;pointer-events:none;z-index:1;transform:scale(1, 1);transition:transform 3s ease-in}.camera-selector-position--teleporting{transform:scale(0, 0)}.camera-selector-background{width:200px;height:200px;background-color:#0696d7;opacity:.2;position:absolute;pointer-events:none;z-index:0;transform:translate(-100px, -100px);border-radius:50%}.dropme-guidenace-ui{display:flex;position:absolute;left:50%;top:20px;padding:10px 20px;transform:translate(-50%, 0);align-items:center;border:1px solid #9ec8f6;border-radius:4px;background-color:#edf5fd;color:#039be5;font-size:12px;box-shadow:0 2px 4px 0 rgba(0,0,0,.25);opacity:1;z-index:999;overflow-y:hidden}","",{version:3,sources:["webpack://./extensions/AEC/DropMe/DropMe.css"],names:[],mappings:"AAAA,iBAAiB,OAAO,CAAC,QAAQ,CAAC,oCAAoC,CAAC,qCAAqC,CAAC,8BAA8B,CAAC,iBAAiB,CAAC,8BAA8B,CAAC,iBAAiB,CAAC,UAAU,CAAC,mBAAmB,CAAC,SAAS,CAAC,0BAA0B,UAAU,CAAC,WAAW,CAAC,iBAAiB,CAAC,wBAAwB,CAAC,iBAAiB,CAAC,UAAU,CAAC,mBAAmB,CAAC,SAAS,CAAC,qBAAqB,CAAC,+BAA+B,CAAC,uCAAuC,qBAAqB,CAAC,4BAA4B,WAAW,CAAC,YAAY,CAAC,wBAAwB,CAAC,UAAU,CAAC,iBAAiB,CAAC,mBAAmB,CAAC,SAAS,CAAC,mCAAmC,CAAC,iBAAiB,CAAC,qBAAqB,YAAY,CAAC,iBAAiB,CAAC,QAAQ,CAAC,QAAQ,CAAC,iBAAiB,CAAC,4BAA4B,CAAC,kBAAkB,CAAC,wBAAwB,CAAC,iBAAiB,CAAC,wBAAwB,CAAC,aAAa,CAAC,cAAc,CAAC,sCAAsC,CAAC,SAAS,CAAC,WAAW,CAAC,iBAAiB",sourcesContent:[".camera-selector{width:0;height:0;border-left:50px solid rgba(0,0,0,0);border-right:50px solid rgba(0,0,0,0);border-top:100px solid #0696d7;border-radius:50%;transform-origin:bottom center;position:absolute;opacity:.8;pointer-events:none;z-index:1}.camera-selector-position{width:20px;height:20px;border-radius:50%;background-color:#0696d7;position:absolute;opacity:.8;pointer-events:none;z-index:1;transform:scale(1, 1);transition:transform 3s ease-in}.camera-selector-position--teleporting{transform:scale(0, 0)}.camera-selector-background{width:200px;height:200px;background-color:#0696d7;opacity:.2;position:absolute;pointer-events:none;z-index:0;transform:translate(-100px, -100px);border-radius:50%}.dropme-guidenace-ui{display:flex;position:absolute;left:50%;top:20px;padding:10px 20px;transform:translate(-50%, 0);align-items:center;border:1px solid #9ec8f6;border-radius:4px;background-color:#edf5fd;color:#039be5;font-size:12px;box-shadow:0 2px 4px 0 rgba(0,0,0,.25);opacity:1;z-index:999;overflow-y:hidden}"],sourceRoot:""}]);const a=s},4676:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(1354),o=i.n(r),n=i(6314),s=i.n(n)()(o());s.push([e.id,'.minimap3D{width:0px;height:0px;position:absolute;display:flex;flex-direction:column;transition:visibility .7s,opacity .7s;opacity:0;visibility:hidden;background:rgba(255,255,255,.4);overflow:hidden;user-select:none;border-radius:4px;box-shadow:1px 1px 8px rgba(0,0,0,.4)}.minimap3D.paddedForToolbar{right:70px}.minimapScrollArea{width:100%;height:100%;position:relative}.minimap3D.side-by-side{box-sizing:border-box;box-shadow:0px 0px 3px rgba(0,0,0,.5);z-index:1;overflow-x:hidden}.minimap3D.side-by-side.left-2d-view{border-left:none;border-right:solid 2px #979797;left:0px}.minimap3D.visible{opacity:1;visibility:visible}.mapContainer{position:absolute;left:0px;top:0px;opacity:1}.mapImage{position:absolute;left:0px;top:0px;pointer-events:none}.floorNameLabel{z-index:2;position:absolute;top:0px;left:0px;opacity:.99;background-color:#f5f5f5;box-shadow:1px 3px 10px 0 rgba(0,0,0,.5);margin:4px;border-radius:5px}.floorNameLabel.dark{margin-top:10px;left:50%;transform:translate(-50%);border-radius:28px;background-color:rgba(50,50,50,.8)}.floorNameLabel.light{margin-top:10px;left:50%;transform:translate(-50%);border-radius:28px;background-color:rgba(255,255,255,.85);box-shadow:none}.floorText{margin:5px 5px 5px 5px;color:#000;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.floorText.dark{padding:0px 15px;color:#fff;font-family:"Artifakt Element",Helvetica,Arial;font-size:14px}.floorText.light{padding:0px 15px;color:#000;font-family:"Artifakt Element",Helvetica,Arial;font-size:14px}.minimap-placeholder{left:0px;top:0px;position:absolute;background-color:rgba(255,255,255,.5);opacity:1}.minimap-progressWidget{transform:translate(0, -50%);left:0px;top:50%;position:relative;height:fit-content;width:calc(100% - 60px);margin-left:30px;margin-right:30px}.minimap-progressText{color:#000;text-align:left;position:relative}.minimap-progress{z-index:10;width:100%}.map-button-bar{z-Index:2;right:0px;top:0px;position:absolute;right:100%;display:flex;flex-direction:column;background-color:#f5f5f5;box-shadow:1px 3px 10px 0 rgba(0,0,0,.5);margin-right:4px;margin-top:0px;border-radius:5px}.map-button-bar.side-by-side{margin-top:4px}.map-button-bar.side-by-side.left-2d-view{right:0px}.sheetmap-thumbnail{position:absolute;overflow:hidden}.side-by-side .minimap-header{border-radius:0}.minimap-header{background:#fff;display:flex;position:initial;align-items:center;justify-content:space-between;border-radius:4px 4px 0 0;width:100%;z-index:4;transform-origin:top;-moz-box-shadow:0px 2px 4px -2px rgba(0,0,0,.5);-webkit-box-shadow:0px 2px 4px -2px rgba(0,0,0,.5);box-shadow:0px 2px 4px -2px rgba(0,0,0,.5)}.adsk-viewing-viewer.light-theme .minimap-header,.adsk-viewing-viewer.bim-theme .minimap-header,.adsk-viewing-viewer.acs-theme .minimap-header{border-bottom:1px solid #dcdcdc}.minimap-title{font-size:14px;text-align:left;text-align-last:left;margin-right:12px;-webkit-appearance:none;-moz-appearance:none;appearance:none;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.minimap-dropdown-wrapper{cursor:pointer;outline:none;white-space:nowrap;flex-grow:1;display:flex;align-items:center;overflow:hidden;margin-right:auto}.minimap-dropdown-wrapper:after{content:"";border-width:6px 5px 0 5px;border-style:solid;border-color:#819099 rgba(0,0,0,0)}.minimap-dropdown-wrapper.no-levels{pointer-events:none}.minimap-dropdown-wrapper.no-levels:after{display:none}.minimap-dropdown{position:absolute;top:40px;left:5px;max-height:120px;margin:0;width:90%;background:#fff;list-style:none;opacity:0;pointer-events:none;overflow:scroll;overflow-x:hidden;border-radius:3px;z-index:10;box-shadow:0px 1px 7px rgba(0,0,0,.3)}.minimap-dropdown li{display:block;color:#222;text-decoration:none;border-left:5px;padding:8px 8px 8px 20px;font-size:14px;overflow:hidden;text-overflow:ellipsis}.minimap-dropdown li.active{background:#eef0f2}.minimap-dropdown li:hover{background:#f8f9fa}.minimap-dropdown.active{opacity:1;pointer-events:auto;padding:0 0 10px 0}',"",{version:3,sources:["webpack://./extensions/AEC/Minimap3D/Minimap3D.css"],names:[],mappings:"AAAA,WAAW,SAAS,CAAC,UAAU,CAAC,iBAAiB,CAAC,YAAY,CAAC,qBAAqB,CAAC,qCAAqC,CAAC,SAAS,CAAC,iBAAiB,CAAC,+BAA+B,CAAC,eAAe,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,qCAAqC,CAAC,4BAA4B,UAAU,CAAC,mBAAmB,UAAU,CAAC,WAAW,CAAC,iBAAiB,CAAC,wBAAwB,qBAAqB,CAAC,qCAAqC,CAAC,SAAS,CAAC,iBAAiB,CAAC,qCAAqC,gBAAgB,CAAC,8BAA8B,CAAC,QAAQ,CAAC,mBAAmB,SAAS,CAAC,kBAAkB,CAAC,cAAc,iBAAiB,CAAC,QAAQ,CAAC,OAAO,CAAC,SAAS,CAAC,UAAU,iBAAiB,CAAC,QAAQ,CAAC,OAAO,CAAC,mBAAmB,CAAC,gBAAgB,SAAS,CAAC,iBAAiB,CAAC,OAAO,CAAC,QAAQ,CAAC,WAAW,CAAC,wBAAwB,CAAC,wCAAwC,CAAC,UAAU,CAAC,iBAAiB,CAAC,qBAAqB,eAAe,CAAC,QAAQ,CAAC,yBAAyB,CAAC,kBAAkB,CAAC,kCAAkC,CAAC,sBAAsB,eAAe,CAAC,QAAQ,CAAC,yBAAyB,CAAC,kBAAkB,CAAC,sCAAsC,CAAC,eAAe,CAAC,WAAW,sBAAsB,CAAC,UAAU,CAAC,kBAAkB,CAAC,sBAAsB,CAAC,eAAe,CAAC,gBAAgB,gBAAgB,CAAC,UAAU,CAAC,8CAA8C,CAAC,cAAc,CAAC,iBAAiB,gBAAgB,CAAC,UAAU,CAAC,8CAA8C,CAAC,cAAc,CAAC,qBAAqB,QAAQ,CAAC,OAAO,CAAC,iBAAiB,CAAC,qCAAqC,CAAC,SAAS,CAAC,wBAAwB,4BAA4B,CAAC,QAAQ,CAAC,OAAO,CAAC,iBAAiB,CAAC,kBAAkB,CAAC,uBAAuB,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,sBAAsB,UAAU,CAAC,eAAe,CAAC,iBAAiB,CAAC,kBAAkB,UAAU,CAAC,UAAU,CAAC,gBAAgB,SAAS,CAAC,SAAS,CAAC,OAAO,CAAC,iBAAiB,CAAC,UAAU,CAAC,YAAY,CAAC,qBAAqB,CAAC,wBAAwB,CAAC,wCAAwC,CAAC,gBAAgB,CAAC,cAAc,CAAC,iBAAiB,CAAC,6BAA6B,cAAc,CAAC,0CAA0C,SAAS,CAAC,oBAAoB,iBAAiB,CAAC,eAAe,CAAC,8BAA8B,eAAe,CAAC,gBAAgB,eAAe,CAAC,YAAY,CAAC,gBAAgB,CAAC,kBAAkB,CAAC,6BAA6B,CAAC,yBAAyB,CAAC,UAAU,CAAC,SAAS,CAAC,oBAAoB,CAAC,+CAA+C,CAAC,kDAAkD,CAAC,0CAA0C,CAAC,+IAA+I,+BAA+B,CAAC,eAAe,cAAc,CAAC,eAAe,CAAC,oBAAoB,CAAC,iBAAiB,CAAC,uBAAuB,CAAC,oBAAoB,CAAC,eAAe,CAAC,kBAAkB,CAAC,eAAe,CAAC,sBAAsB,CAAC,0BAA0B,cAAc,CAAC,YAAY,CAAC,kBAAkB,CAAC,WAAW,CAAC,YAAY,CAAC,kBAAkB,CAAC,eAAe,CAAC,iBAAiB,CAAC,gCAAgC,UAAU,CAAC,0BAA0B,CAAC,kBAAkB,CAAC,kCAAkC,CAAC,oCAAoC,mBAAmB,CAAC,0CAA0C,YAAY,CAAC,kBAAkB,iBAAiB,CAAC,QAAQ,CAAC,QAAQ,CAAC,gBAAgB,CAAC,QAAQ,CAAC,SAAS,CAAC,eAAe,CAAC,eAAe,CAAC,SAAS,CAAC,mBAAmB,CAAC,eAAe,CAAC,iBAAiB,CAAC,iBAAiB,CAAC,UAAU,CAAC,qCAAqC,CAAC,qBAAqB,aAAa,CAAC,UAAU,CAAC,oBAAoB,CAAC,eAAe,CAAC,wBAAwB,CAAC,cAAc,CAAC,eAAe,CAAC,sBAAsB,CAAC,4BAA4B,kBAAkB,CAAC,2BAA2B,kBAAkB,CAAC,yBAAyB,SAAS,CAAC,mBAAmB,CAAC,kBAAkB",sourcesContent:['.minimap3D{width:0px;height:0px;position:absolute;display:flex;flex-direction:column;transition:visibility .7s,opacity .7s;opacity:0;visibility:hidden;background:rgba(255,255,255,.4);overflow:hidden;user-select:none;border-radius:4px;box-shadow:1px 1px 8px rgba(0,0,0,.4)}.minimap3D.paddedForToolbar{right:70px}.minimapScrollArea{width:100%;height:100%;position:relative}.minimap3D.side-by-side{box-sizing:border-box;box-shadow:0px 0px 3px rgba(0,0,0,.5);z-index:1;overflow-x:hidden}.minimap3D.side-by-side.left-2d-view{border-left:none;border-right:solid 2px #979797;left:0px}.minimap3D.visible{opacity:1;visibility:visible}.mapContainer{position:absolute;left:0px;top:0px;opacity:1}.mapImage{position:absolute;left:0px;top:0px;pointer-events:none}.floorNameLabel{z-index:2;position:absolute;top:0px;left:0px;opacity:.99;background-color:#f5f5f5;box-shadow:1px 3px 10px 0 rgba(0,0,0,.5);margin:4px;border-radius:5px}.floorNameLabel.dark{margin-top:10px;left:50%;transform:translate(-50%);border-radius:28px;background-color:rgba(50,50,50,.8)}.floorNameLabel.light{margin-top:10px;left:50%;transform:translate(-50%);border-radius:28px;background-color:rgba(255,255,255,.85);box-shadow:none}.floorText{margin:5px 5px 5px 5px;color:#000;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.floorText.dark{padding:0px 15px;color:#fff;font-family:"Artifakt Element",Helvetica,Arial;font-size:14px}.floorText.light{padding:0px 15px;color:#000;font-family:"Artifakt Element",Helvetica,Arial;font-size:14px}.minimap-placeholder{left:0px;top:0px;position:absolute;background-color:rgba(255,255,255,.5);opacity:1}.minimap-progressWidget{transform:translate(0, -50%);left:0px;top:50%;position:relative;height:fit-content;width:calc(100% - 60px);margin-left:30px;margin-right:30px}.minimap-progressText{color:#000;text-align:left;position:relative}.minimap-progress{z-index:10;width:100%}.map-button-bar{z-Index:2;right:0px;top:0px;position:absolute;right:100%;display:flex;flex-direction:column;background-color:#f5f5f5;box-shadow:1px 3px 10px 0 rgba(0,0,0,.5);margin-right:4px;margin-top:0px;border-radius:5px}.map-button-bar.side-by-side{margin-top:4px}.map-button-bar.side-by-side.left-2d-view{right:0px}.sheetmap-thumbnail{position:absolute;overflow:hidden}.side-by-side .minimap-header{border-radius:0}.minimap-header{background:#fff;display:flex;position:initial;align-items:center;justify-content:space-between;border-radius:4px 4px 0 0;width:100%;z-index:4;transform-origin:top;-moz-box-shadow:0px 2px 4px -2px rgba(0,0,0,.5);-webkit-box-shadow:0px 2px 4px -2px rgba(0,0,0,.5);box-shadow:0px 2px 4px -2px rgba(0,0,0,.5)}.adsk-viewing-viewer.light-theme .minimap-header,.adsk-viewing-viewer.bim-theme .minimap-header,.adsk-viewing-viewer.acs-theme .minimap-header{border-bottom:1px solid #dcdcdc}.minimap-title{font-size:14px;text-align:left;text-align-last:left;margin-right:12px;-webkit-appearance:none;-moz-appearance:none;appearance:none;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.minimap-dropdown-wrapper{cursor:pointer;outline:none;white-space:nowrap;flex-grow:1;display:flex;align-items:center;overflow:hidden;margin-right:auto}.minimap-dropdown-wrapper:after{content:"";border-width:6px 5px 0 5px;border-style:solid;border-color:#819099 rgba(0,0,0,0)}.minimap-dropdown-wrapper.no-levels{pointer-events:none}.minimap-dropdown-wrapper.no-levels:after{display:none}.minimap-dropdown{position:absolute;top:40px;left:5px;max-height:120px;margin:0;width:90%;background:#fff;list-style:none;opacity:0;pointer-events:none;overflow:scroll;overflow-x:hidden;border-radius:3px;z-index:10;box-shadow:0px 1px 7px rgba(0,0,0,.3)}.minimap-dropdown li{display:block;color:#222;text-decoration:none;border-left:5px;padding:8px 8px 8px 20px;font-size:14px;overflow:hidden;text-overflow:ellipsis}.minimap-dropdown li.active{background:#eef0f2}.minimap-dropdown li:hover{background:#f8f9fa}.minimap-dropdown.active{opacity:1;pointer-events:auto;padding:0 0 10px 0}'],sourceRoot:""}]);const a=s},1658:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(1354),o=i.n(r),n=i(6314),s=i.n(n)()(o());s.push([e.id,".minimap3D-mobile{width:0px;height:0px;position:absolute;display:flex;flex-direction:column;transition:visibility .7s,opacity .7s;opacity:0;visibility:hidden;background:rgba(255,255,255,.2);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);overflow:hidden;user-select:none;border-top-left-radius:20px;border-top-right-radius:20px;border-bottom-right-radius:20px;border-bottom-left-radius:20px;box-shadow:1px 1px 8px rgba(0,0,0,.4)}.minimap3D-mobile.dark-theme{background:rgba(0,0,0,.2)}.minimap3D-mobile.visible{opacity:1;visibility:visible}.minimap3D-mobile.phone{border-top-left-radius:0px;border-top-right-radius:20px;border-bottom-right-radius:20px;border-bottom-left-radius:0px}.minimap3D-mobile.phone.portrait{border-top-left-radius:0px;border-top-right-radius:0px;border-bottom-right-radius:20px;border-bottom-left-radius:20px}.minimap3D-mobile .buttons-container{display:flex;width:fit-content;height:fit-content;z-index:10;margin:10px;border-radius:8px;background:#fff;pointer-events:none;align-self:flex-end}.minimap3D-mobile.dark-theme .buttons-container{background:#323537}.minimap3D-mobile .buttons-container .adsk-button:hover{border-color:rgba(0,0,0,0)}.minimap3D-mobile .divider{display:block;position:relative;background-color:#bbb;width:1px;height:70%;top:50%;transform:translate(0px, -50%)}.minimap3D-mobile.dark-theme .divider{background-color:gray}","",{version:3,sources:["webpack://./extensions/AEC/Minimap3D/Minimap3DMobile.css"],names:[],mappings:"AAAA,kBAAkB,SAAS,CAAC,UAAU,CAAC,iBAAiB,CAAC,YAAY,CAAC,qBAAqB,CAAC,qCAAqC,CAAC,SAAS,CAAC,iBAAiB,CAAC,+BAA+B,CAAC,0BAA0B,CAAC,kCAAkC,CAAC,eAAe,CAAC,gBAAgB,CAAC,2BAA2B,CAAC,4BAA4B,CAAC,+BAA+B,CAAC,8BAA8B,CAAC,qCAAqC,CAAC,6BAA6B,yBAAyB,CAAC,0BAA0B,SAAS,CAAC,kBAAkB,CAAC,wBAAwB,0BAA0B,CAAC,4BAA4B,CAAC,+BAA+B,CAAC,6BAA6B,CAAC,iCAAiC,0BAA0B,CAAC,2BAA2B,CAAC,+BAA+B,CAAC,8BAA8B,CAAC,qCAAqC,YAAY,CAAC,iBAAiB,CAAC,kBAAkB,CAAC,UAAU,CAAC,WAAW,CAAC,iBAAiB,CAAC,eAAe,CAAC,mBAAmB,CAAC,mBAAmB,CAAC,gDAAgD,kBAAkB,CAAC,wDAAwD,0BAA0B,CAAC,2BAA2B,aAAa,CAAC,iBAAiB,CAAC,qBAAqB,CAAC,SAAS,CAAC,UAAU,CAAC,OAAO,CAAC,8BAA8B,CAAC,sCAAsC,qBAAqB",sourcesContent:[".minimap3D-mobile{width:0px;height:0px;position:absolute;display:flex;flex-direction:column;transition:visibility .7s,opacity .7s;opacity:0;visibility:hidden;background:rgba(255,255,255,.2);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);overflow:hidden;user-select:none;border-top-left-radius:20px;border-top-right-radius:20px;border-bottom-right-radius:20px;border-bottom-left-radius:20px;box-shadow:1px 1px 8px rgba(0,0,0,.4)}.minimap3D-mobile.dark-theme{background:rgba(0,0,0,.2)}.minimap3D-mobile.visible{opacity:1;visibility:visible}.minimap3D-mobile.phone{border-top-left-radius:0px;border-top-right-radius:20px;border-bottom-right-radius:20px;border-bottom-left-radius:0px}.minimap3D-mobile.phone.portrait{border-top-left-radius:0px;border-top-right-radius:0px;border-bottom-right-radius:20px;border-bottom-left-radius:20px}.minimap3D-mobile .buttons-container{display:flex;width:fit-content;height:fit-content;z-index:10;margin:10px;border-radius:8px;background:#fff;pointer-events:none;align-self:flex-end}.minimap3D-mobile.dark-theme .buttons-container{background:#323537}.minimap3D-mobile .buttons-container .adsk-button:hover{border-color:rgba(0,0,0,0)}.minimap3D-mobile .divider{display:block;position:relative;background-color:#bbb;width:1px;height:70%;top:50%;transform:translate(0px, -50%)}.minimap3D-mobile.dark-theme .divider{background-color:gray}"],sourceRoot:""}]);const a=s},5684:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var r=i(1354),o=i.n(r),n=i(6314),s=i.n(n)()(o());s.push([e.id,'.list-panel{width:260px;min-width:260px;height:260px;min-height:260px;top:180px;left:220px;border-color:rgba(0,0,0,0)}.list-panel .itemList{width:100%;display:flex;flex-direction:column}.list-panel .listItem{display:flex;justify-content:space-between;text-align:left;line-height:35px;background-color:rgba(0,0,0,0);border-style:none;font-family:"ArtifaktElement","Helvetica Neue","Segoe UI Semilight",sans-serif;padding:0 10px}.adsk-viewing-viewer.dark-theme .listItem{color:#f3f7fb}.adsk-viewing-viewer.light-theme .list-panel .listItem.hover{background-color:rgba(10,19,28,.2)}.adsk-viewing-viewer.dark-theme .list-panel .listItem.hover{background-color:#4a555b}.list-panel .listItem:focus{outline:none}.list-panel .listItem.selected{color:#00bfff;border-style:none}.list-panel .listItem .textContainer{-webkit-mask-image:linear-gradient(to left, transparent, black 1em);mask-image:linear-gradient(to left, transparent, black 1em);white-space:nowrap;overflow:hidden;width:100%}.list-panel .listItem .icon{width:24px}.list-panel .listItem.selected .icon::before{content:"\\2713";margin-left:8px}.list-panel-item-warning{background-image:url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScyNCcgaGVpZ2h0PScyNCcgdmlld0JveD0nMCAwIDggOCc+PHBhdGggZmlsbD0nIzZiNzg3ZicgZD0nTTMuMDkgMGMtLjA2IDAtLjEuMDQtLjEzLjA5bC0yLjk0IDYuODFjLS4wMi4wNS0uMDMuMTMtLjAzLjE5di44MWMwIC4wNS4wNC4wOS4wOS4wOWg2LjgxYy4wNSAwIC4wOS0uMDQuMDktLjA5di0uODFjMC0uMDUtLjAxLS4xNC0uMDMtLjE5bC0yLjk0LTYuODFjLS4wMi0uMDUtLjA3LS4wOS0uMTMtLjA5aC0uODF6bS0uMDkgM2gxdjJoLTF2LTJ6bTAgM2gxdjFoLTF2LTF6JyAvPjwvc3ZnPg==");width:24px;height:24px;margin-left:auto;margin-top:auto;margin-bottom:auto}.list-panel .visibility{right:0;top:0;width:35px;height:35px;border:none;outline:none;margin:0;padding:0;background-position:6px 12px;background-image:url("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+DQo8c3ZnIHdpZHRoPSIxN3B4IiBoZWlnaHQ9IjEwcHgiIHZpZXdCb3g9IjAgMCAxNyAxMCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4NCiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDQ2LjIgKDQ0NDk2KSAtIGh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaCAtLT4NCiAgICA8dGl0bGU+R3JvdXAgMjU8L3RpdGxlPg0KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPg0KICAgIDxkZWZzPjwvZGVmcz4NCiAgICA8ZyBpZD0iU2VsZWN0LSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+DQogICAgICAgIDxnIGlkPSJNb2RlbF9Ccm93c2VyX2hvdmVyIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMjYzLjAwMDAwMCwgLTE5NS4wMDAwMDApIj4NCiAgICAgICAgICAgIDxnIGlkPSJHcm91cC0yNiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjUzLjAwMDAwMCwgNzQuMDAwMDAwKSI+DQogICAgICAgICAgICAgICAgPGcgaWQ9Ikdyb3VwLTE2IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLjAwMDAwMCwgMzYuMDAwMDAwKSI+DQogICAgICAgICAgICAgICAgICAgIDxnIGlkPSJHcm91cC0yNSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMC4wMDAwMDAsIDcyLjAwMDAwMCkiPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGcgaWQ9Im1hcmt1cC1kaXNwbGF5LW9uIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZyBpZD0iR3JvdXAtMjIiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZyBpZD0iZ3VpZGUiIG9wYWNpdHk9IjAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE4LjAwMDAwMCwgMTguMDAwMDAwKSBzY2FsZSgxLCAtMSkgdHJhbnNsYXRlKC0xOC4wMDAwMDAsIC0xOC4wMDAwMDApICIgZmlsbD0iI0ZGOTg5OCI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cmVjdCBpZD0iUmVjdGFuZ2xlLTQiIHg9IjAiIHk9IjAiIHdpZHRoPSIzNiIgaGVpZ2h0PSIzNiI+PC9yZWN0Pg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2c+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxnIGlkPSJzaG93LW1hcmtlcnMtaWNvbiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTAuMDAwMDAwLCAxMy4wMDAwMDApIiBmaWxsLXJ1bGU9Im5vbnplcm8iIGZpbGw9IiNGRkZGRkYiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGcgaWQ9IkxheWVyXzEiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMi40NzQsMC44MjM0NjMwNTcgQzEzLjQwOTk4ODMsMS4yMTU3ODg4NiAxNC4yODMzMDE4LDEuNzQzNDE1NzQgMTUuMDY2LDIuMzg5NDYzMDYgQzE1Ljc3NjcxMTYsMy4wMjUzOTQ1MSAxNi4zNzg2NTM3LDMuNzczMjYxOTMgMTYuODQ4LDQuNjAzNDYzMDYgQzE2LjQ5NzQ1OTEsNS41MTE5MjQ3NyAxNS45NjQ0OTk5LDYuMzM4OTMwNDMgMTUuMjgyLDcuMDMzNDYzMDYgQzE0LjUzNjE5MjEsNy43MzAyNjE3MSAxMy42NzgxNDUsOC4yOTYyMDc2OSAxMi43NDQsOC43MDc0NjMwNiBDMTEuMzYxMDM2NSw5LjI5MzUzOTU4IDkuODcxOTM1NjEsOS41ODc2ODI5NyA4LjM3LDkuNTcxNDYzMDYgQzYuODk2MjcwMjEsOS42NTA4OTU4OCA1LjQyMjc0OTI5LDkuNDExNDQ4NzMgNC4wNSw4Ljg2OTQ2MzA2IEMzLjExMzAyOTI4LDguNDg3MzIwMTcgMi4yNTMxMTg1Niw3LjkzODQ0MDk5IDEuNTEyLDcuMjQ5NDYzMDYgQzAuODQyNjYxOTQ4LDYuNTM0MTYwMTUgMC4zMjc5NTI0MTksNS42ODg1NjU5MiAwLDQuNzY1NDYzMDYgQzAuNDU1MjQyNjA0LDMuODYyMzEzMjkgMS4wNTc0NTAzMSwzLjA0MTEyMDk2IDEuNzgyLDIuMzM1NDYzMDYgQzIuNTUyMzY1MDQsMS42NTgzODQzOSAzLjQyNzgxNDI3LDEuMTExMjI4NjIgNC4zNzQsMC43MTU0NjMwNTcgQzUuNjUzNTg1NzEsMC4xNzgzNTEzOTYgNy4wMzgyOTI4MywtMC4wNjE2NjQ1MDQ1IDguNDI0LDAuMDEzNDYzMDU3MyBDOS44MTM2NzUzNCwwLjAxOTA0NzQ5MjggMTEuMTg5MDc0OSwwLjI5NDEyNzQwNiAxMi40NzQsMC44MjM0NjMwNTcgWiBNOC41MzIsOC4wNTk0NjMwNiBDOC45NjAxMDIyOSw4LjA1NTI5NTM2IDkuMzgyODA0ODMsNy45NjM0MDM1IDkuNzc0LDcuNzg5NDYzMDYgQzEwLjE1NjgyNjIsNy42MjE1NjcyNCAxMC41MDQ4MjQyLDcuMzgzNDYzMyAxMC44LDcuMDg3NDYzMDYgQzExLjQwOTE4MDYsNi40NzA2MDIwNyAxMS43NDA2NzExLDUuNjMyMTI1ODggMTEuNzE4LDQuNzY1NDYzMDYgQzExLjcyNjA1ODMsMy45MTc0MTMzNSAxMS4zOTU2NjU0LDMuMTAxMTQ4NDMgMTAuOCwyLjQ5NzQ2MzA2IEMxMC41MDQ4MjQyLDIuMjAxNDYyODIgMTAuMTU2ODI2MiwxLjk2MzM1ODg3IDkuNzc0LDEuNzk1NDYzMDYgQzguOTYzMjAwODEsMS40NTAzMjYwNyA4LjA0Njc5OTE5LDEuNDUwMzI2MDcgNy4yMzYsMS43OTU0NjMwNiBDNi44NTMxNzM4NCwxLjk2MzM1ODg3IDYuNTA1MTc1NzYsMi4yMDE0NjI4MiA2LjIxLDIuNDk3NDYzMDYgQzUuNjAwODE5NDUsMy4xMTQzMjQwNSA1LjI2OTMyODg2LDMuOTUyODAwMjQgNS4yOTIsNC44MTk0NjMwNiBDNS4yOTc2Njg2Nyw1LjI0NzM5NTM2IDUuMzg5NDk1NjMsNS42Njk3OTkzOSA1LjU2Miw2LjA2MTQ2MzA2IEM1LjcyNzU3OTMsNi40NDU1NzAxMyA1Ljk2NTk2NjY2LDYuNzkzOTgyNDQgNi4yNjQsNy4wODc0NjMwNiBDNi41NTgzNDMzMyw3LjM4NDQ2MzMxIDYuOTA2NTQzMzEsNy42MjI3MDU0IDcuMjksNy43ODk0NjMwNiBDNy42ODExOTUxNyw3Ljk2MzQwMzUgOC4xMDM4OTc3MSw4LjA1NTI5NTM2IDguNTMyLDguMDU5NDYzMDYgTDguNTMyLDguMDU5NDYzMDYgWiBNMTAuNDIyLDQuNzY1NDYzMDYgQzEwLjQxNjM1ODgsNC41MjI4NzM5MiAxMC4zNjEyMzI0LDQuMjgzOTkyNjggMTAuMjYsNC4wNjM0NjMwNiBDMTAuMTcyMzE3OCwzLjg0MzUzNDU2IDEwLjA0NDA5MzQsMy42NDIwMzg5NiA5Ljg4MiwzLjQ2OTQ2MzA2IEM5LjcxMTEwOTY4LDMuMzA1MjEyNSA5LjUwOTE2ODc2LDMuMTc2NzA0NjUgOS4yODgsMy4wOTE0NjMwNiBMOC41ODYsMi45Mjk0NjMwNiBMNy44ODQsMy4wOTE0NjMwNiBDNy40NDYzNTgyNiwzLjI3NzM3MzU0IDcuMDk3OTEwNDgsMy42MjU4MjEzMSA2LjkxMiw0LjA2MzQ2MzA2IEM2LjcxMDc1NzY2LDQuNTI4NjMwNTEgNi43MTA3NTc2Niw1LjA1NjI5NTYxIDYuOTEyLDUuNTIxNDYzMDYgQzcuMDg0OTYzNjIsNS45NDkzMjI1NiA3LjQxMjcxNDA0LDYuMjk2MzUyNDMgNy44Myw2LjQ5MzQ2MzA2IEw4LjUzMiw2LjY1NTQ2MzA2IEw5LjIzNCw2LjQ5MzQ2MzA2IEM5LjQ1NDUzMTUzLDYuNDA2OTYzMjEgOS42NTYyMzk3Miw2LjI3ODYwMzQ1IDkuODI4LDYuMTE1NDYzMDYgQzkuOTg5MTA0MjEsNS45NDIxMjA5IDEwLjExNzIwNDgsNS43NDA4MjAwMiAxMC4yMDYsNS41MjE0NjMwNiBDMTAuMzE0Njc2MSw1LjI4NDM1NTU3IDEwLjM2OTk3NzYsNS4wMjYyODIwNCAxMC4zNjgsNC43NjU0NjMwNiBMMTAuNDIyLDQuNzY1NDYzMDYgWiIgaWQ9IlNoYXBlIj48L3BhdGg+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2c+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZz4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2c+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2c+DQogICAgICAgICAgICAgICAgICAgIDwvZz4NCiAgICAgICAgICAgICAgICA8L2c+DQogICAgICAgICAgICA8L2c+DQogICAgICAgIDwvZz4NCiAgICA8L2c+DQo8L3N2Zz4=");background-repeat:no-repeat;opacity:.7;position:relative}.list-panel .dim div.visibility{background-position:6px 9px;background-image:url("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+DQo8c3ZnIHdpZHRoPSIxNnB4IiBoZWlnaHQ9IjE1cHgiIHZpZXdCb3g9IjAgMCAxNiAxNSIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4NCiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDQ2ICg0NDQyMykgLSBodHRwOi8vd3d3LmJvaGVtaWFuY29kaW5nLmNvbS9za2V0Y2ggLS0+DQogICAgPHRpdGxlPm1hcmt1cF9kaXNwbGF5X3R1cm5fb2ZmPC90aXRsZT4NCiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4NCiAgICA8ZGVmcz48L2RlZnM+DQogICAgPGcgaWQ9IlBhZ2UtNiIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+DQogICAgICAgIDxnIGlkPSJDYW1lcmEtSW50ZXJhY3Rpb25zLS0tSG92ZXItQ29weSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTEwNTcuMDAwMDAwLCAtMTIzLjAwMDAwMCkiIGZpbGw9IiNGNEY0RjQiPg0KICAgICAgICAgICAgPGcgaWQ9Ikdyb3VwLTE5IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg4MTAuMDAwMDAwLCAxMTIuMDAwMDAwKSI+DQogICAgICAgICAgICAgICAgPGcgaWQ9Im1hcmt1cC1kaXNwbGF5LW9mZiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjM5LjAwMDAwMCwgMy4wMDAwMDApIj4NCiAgICAgICAgICAgICAgICAgICAgPGcgaWQ9Im1hcmt1cF9kaXNwbGF5X3R1cm5fb2ZmIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg4LjAwMDAwMCwgOC4wMDAwMDApIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xNC4zMjIsMC41OTQgQzE0LjA1OCwwLjMzIDEzLjY2MiwwLjMzIDEzLjM5OCwwLjU5NCBMMTAuMzYyLDMuNjMgQzkuNTcsMy40MzIgOC43NzgsMy4yMzQgNy45MiwzLjIzNCBDNC4zNTYsMy4yMzQgMS4zMiw1LjQxMiAwLDguMDUyIEwwLDguMDUyIEMwLjU5NCw5LjI0IDEuNTg0LDEwLjM2MiAyLjc3MiwxMS4yMiBMMC40NjIsMTMuNTMgQzAuMTk4LDEzLjc5NCAwLjE5OCwxNC4xOSAwLjQ2MiwxNC40NTQgQzAuNzI2LDE0LjcxOCAxLjEyMiwxNC43MTggMS4zODYsMTQuNDU0IEwxNC4zMjIsMS41MTggQzE0LjU4NiwxLjI1NCAxNC41ODYsMC44NTggMTQuMzIyLDAuNTk0IEwxNC4zMjIsMC41OTQgWiBNNC43NTIsOC4wNTIgQzQuNzUyLDYuMjcgNi4yMDQsNC44ODQgNy45Miw0Ljg4NCBDOC4yNSw0Ljg4NCA4LjY0Niw0Ljk1IDguOTEsNS4wODIgTDguMDUyLDUuOTQgTDcuODU0LDUuOTQgQzYuNjY2LDUuOTQgNS42NzYsNi45MyA1LjY3Niw4LjExOCBMNS42NzYsOC4zMTYgTDQuODE4LDkuMTc0IEM0LjgxOCw4Ljc3OCA0Ljc1Miw4LjM4MiA0Ljc1Miw4LjA1MiBMNC43NTIsOC4wNTIgWiBNNy45MiwxMC4yMyBDOS4xMDgsMTAuMjMgMTAuMDk4LDkuMjQgMTAuMDk4LDguMDUyIEMxMC4wOTgsNy44NTQgMTAuMDMyLDcuNjU2IDkuOTY2LDcuMzkyIEw3LjI2LDEwLjA5OCBDNy41MjQsMTAuMTY0IDcuNzIyLDEwLjIzIDcuOTIsMTAuMjMgTDcuOTIsMTAuMjMgWiBNMTUuODQsOC4wNTIgQzE1LjE4LDYuNzMyIDE0LjA1OCw1LjU0NCAxMi43MzgsNC42ODYgTDEwLjc1OCw2LjY2NiBDMTAuOTU2LDcuMDYyIDExLjA4OCw3LjU5IDExLjA4OCw4LjA1MiBDMTEuMDg4LDkuODM0IDkuNjM2LDExLjIyIDcuOTIsMTEuMjIgQzcuMzkyLDExLjIyIDYuOTMsMTEuMDg4IDYuNTM0LDEwLjg5IEw1LjA4MiwxMi4zNDIgQzUuOTQsMTIuNjcyIDYuOTMsMTIuODcgNy45MiwxMi44NyBDMTEuNDg0LDEyLjg3IDE0LjUyLDEwLjY5MiAxNS44NCw4LjA1MiBMMTUuODQsOC4wNTIgWiIgaWQ9IlNoYXBlIj48L3BhdGg+DQogICAgICAgICAgICAgICAgICAgIDwvZz4NCiAgICAgICAgICAgICAgICA8L2c+DQogICAgICAgICAgICA8L2c+DQogICAgICAgIDwvZz4NCiAgICA8L2c+DQo8L3N2Zz4=");opacity:.3}',"",{version:3,sources:["webpack://./extensions/AEC/ui/ListPanel.css"],names:[],mappings:"AAAA,YAAY,WAAW,CAAC,eAAe,CAAC,YAAY,CAAC,gBAAgB,CAAC,SAAS,CAAC,UAAU,CAAC,0BAA0B,CAAC,sBAAsB,UAAU,CAAC,YAAY,CAAC,qBAAqB,CAAC,sBAAsB,YAAY,CAAC,6BAA6B,CAAC,eAAe,CAAC,gBAAgB,CAAC,8BAA8B,CAAC,iBAAiB,CAAC,8EAA8E,CAAC,cAAc,CAAC,0CAA0C,aAAa,CAAC,6DAA6D,kCAAkC,CAAC,4DAA4D,wBAAwB,CAAC,4BAA4B,YAAY,CAAC,+BAA+B,aAAa,CAAC,iBAAiB,CAAC,qCAAqC,mEAAmE,CAAC,2DAA2D,CAAC,kBAAkB,CAAC,eAAe,CAAC,UAAU,CAAC,4BAA4B,UAAU,CAAC,6CAA6C,eAAe,CAAC,eAAe,CAAC,yBAAyB,seAAse,CAAC,UAAU,CAAC,WAAW,CAAC,gBAAgB,CAAC,eAAe,CAAC,kBAAkB,CAAC,wBAAwB,OAAO,CAAC,KAAK,CAAC,UAAU,CAAC,WAAW,CAAC,WAAW,CAAC,YAAY,CAAC,QAAQ,CAAC,SAAS,CAAC,4BAA4B,CAAC,kpKAAkpK,CAAC,2BAA2B,CAAC,UAAU,CAAC,iBAAiB,CAAC,gCAAgC,2BAA2B,CAAC,kpFAAkpF,CAAC,UAAU",sourcesContent:['.list-panel{width:260px;min-width:260px;height:260px;min-height:260px;top:180px;left:220px;border-color:rgba(0,0,0,0)}.list-panel .itemList{width:100%;display:flex;flex-direction:column}.list-panel .listItem{display:flex;justify-content:space-between;text-align:left;line-height:35px;background-color:rgba(0,0,0,0);border-style:none;font-family:"ArtifaktElement","Helvetica Neue","Segoe UI Semilight",sans-serif;padding:0 10px}.adsk-viewing-viewer.dark-theme .listItem{color:#f3f7fb}.adsk-viewing-viewer.light-theme .list-panel .listItem.hover{background-color:rgba(10,19,28,.2)}.adsk-viewing-viewer.dark-theme .list-panel .listItem.hover{background-color:#4a555b}.list-panel .listItem:focus{outline:none}.list-panel .listItem.selected{color:#00bfff;border-style:none}.list-panel .listItem .textContainer{-webkit-mask-image:linear-gradient(to left, transparent, black 1em);mask-image:linear-gradient(to left, transparent, black 1em);white-space:nowrap;overflow:hidden;width:100%}.list-panel .listItem .icon{width:24px}.list-panel .listItem.selected .icon::before{content:"\\2713";margin-left:8px}.list-panel-item-warning{background-image:url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScyNCcgaGVpZ2h0PScyNCcgdmlld0JveD0nMCAwIDggOCc+PHBhdGggZmlsbD0nIzZiNzg3ZicgZD0nTTMuMDkgMGMtLjA2IDAtLjEuMDQtLjEzLjA5bC0yLjk0IDYuODFjLS4wMi4wNS0uMDMuMTMtLjAzLjE5di44MWMwIC4wNS4wNC4wOS4wOS4wOWg2LjgxYy4wNSAwIC4wOS0uMDQuMDktLjA5di0uODFjMC0uMDUtLjAxLS4xNC0uMDMtLjE5bC0yLjk0LTYuODFjLS4wMi0uMDUtLjA3LS4wOS0uMTMtLjA5aC0uODF6bS0uMDkgM2gxdjJoLTF2LTJ6bTAgM2gxdjFoLTF2LTF6JyAvPjwvc3ZnPg==");width:24px;height:24px;margin-left:auto;margin-top:auto;margin-bottom:auto}.list-panel .visibility{right:0;top:0;width:35px;height:35px;border:none;outline:none;margin:0;padding:0;background-position:6px 12px;background-image:url("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+DQo8c3ZnIHdpZHRoPSIxN3B4IiBoZWlnaHQ9IjEwcHgiIHZpZXdCb3g9IjAgMCAxNyAxMCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4NCiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDQ2LjIgKDQ0NDk2KSAtIGh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaCAtLT4NCiAgICA8dGl0bGU+R3JvdXAgMjU8L3RpdGxlPg0KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPg0KICAgIDxkZWZzPjwvZGVmcz4NCiAgICA8ZyBpZD0iU2VsZWN0LSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+DQogICAgICAgIDxnIGlkPSJNb2RlbF9Ccm93c2VyX2hvdmVyIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMjYzLjAwMDAwMCwgLTE5NS4wMDAwMDApIj4NCiAgICAgICAgICAgIDxnIGlkPSJHcm91cC0yNiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjUzLjAwMDAwMCwgNzQuMDAwMDAwKSI+DQogICAgICAgICAgICAgICAgPGcgaWQ9Ikdyb3VwLTE2IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLjAwMDAwMCwgMzYuMDAwMDAwKSI+DQogICAgICAgICAgICAgICAgICAgIDxnIGlkPSJHcm91cC0yNSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMC4wMDAwMDAsIDcyLjAwMDAwMCkiPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGcgaWQ9Im1hcmt1cC1kaXNwbGF5LW9uIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZyBpZD0iR3JvdXAtMjIiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZyBpZD0iZ3VpZGUiIG9wYWNpdHk9IjAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE4LjAwMDAwMCwgMTguMDAwMDAwKSBzY2FsZSgxLCAtMSkgdHJhbnNsYXRlKC0xOC4wMDAwMDAsIC0xOC4wMDAwMDApICIgZmlsbD0iI0ZGOTg5OCI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cmVjdCBpZD0iUmVjdGFuZ2xlLTQiIHg9IjAiIHk9IjAiIHdpZHRoPSIzNiIgaGVpZ2h0PSIzNiI+PC9yZWN0Pg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2c+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxnIGlkPSJzaG93LW1hcmtlcnMtaWNvbiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTAuMDAwMDAwLCAxMy4wMDAwMDApIiBmaWxsLXJ1bGU9Im5vbnplcm8iIGZpbGw9IiNGRkZGRkYiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGcgaWQ9IkxheWVyXzEiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMi40NzQsMC44MjM0NjMwNTcgQzEzLjQwOTk4ODMsMS4yMTU3ODg4NiAxNC4yODMzMDE4LDEuNzQzNDE1NzQgMTUuMDY2LDIuMzg5NDYzMDYgQzE1Ljc3NjcxMTYsMy4wMjUzOTQ1MSAxNi4zNzg2NTM3LDMuNzczMjYxOTMgMTYuODQ4LDQuNjAzNDYzMDYgQzE2LjQ5NzQ1OTEsNS41MTE5MjQ3NyAxNS45NjQ0OTk5LDYuMzM4OTMwNDMgMTUuMjgyLDcuMDMzNDYzMDYgQzE0LjUzNjE5MjEsNy43MzAyNjE3MSAxMy42NzgxNDUsOC4yOTYyMDc2OSAxMi43NDQsOC43MDc0NjMwNiBDMTEuMzYxMDM2NSw5LjI5MzUzOTU4IDkuODcxOTM1NjEsOS41ODc2ODI5NyA4LjM3LDkuNTcxNDYzMDYgQzYuODk2MjcwMjEsOS42NTA4OTU4OCA1LjQyMjc0OTI5LDkuNDExNDQ4NzMgNC4wNSw4Ljg2OTQ2MzA2IEMzLjExMzAyOTI4LDguNDg3MzIwMTcgMi4yNTMxMTg1Niw3LjkzODQ0MDk5IDEuNTEyLDcuMjQ5NDYzMDYgQzAuODQyNjYxOTQ4LDYuNTM0MTYwMTUgMC4zMjc5NTI0MTksNS42ODg1NjU5MiAwLDQuNzY1NDYzMDYgQzAuNDU1MjQyNjA0LDMuODYyMzEzMjkgMS4wNTc0NTAzMSwzLjA0MTEyMDk2IDEuNzgyLDIuMzM1NDYzMDYgQzIuNTUyMzY1MDQsMS42NTgzODQzOSAzLjQyNzgxNDI3LDEuMTExMjI4NjIgNC4zNzQsMC43MTU0NjMwNTcgQzUuNjUzNTg1NzEsMC4xNzgzNTEzOTYgNy4wMzgyOTI4MywtMC4wNjE2NjQ1MDQ1IDguNDI0LDAuMDEzNDYzMDU3MyBDOS44MTM2NzUzNCwwLjAxOTA0NzQ5MjggMTEuMTg5MDc0OSwwLjI5NDEyNzQwNiAxMi40NzQsMC44MjM0NjMwNTcgWiBNOC41MzIsOC4wNTk0NjMwNiBDOC45NjAxMDIyOSw4LjA1NTI5NTM2IDkuMzgyODA0ODMsNy45NjM0MDM1IDkuNzc0LDcuNzg5NDYzMDYgQzEwLjE1NjgyNjIsNy42MjE1NjcyNCAxMC41MDQ4MjQyLDcuMzgzNDYzMyAxMC44LDcuMDg3NDYzMDYgQzExLjQwOTE4MDYsNi40NzA2MDIwNyAxMS43NDA2NzExLDUuNjMyMTI1ODggMTEuNzE4LDQuNzY1NDYzMDYgQzExLjcyNjA1ODMsMy45MTc0MTMzNSAxMS4zOTU2NjU0LDMuMTAxMTQ4NDMgMTAuOCwyLjQ5NzQ2MzA2IEMxMC41MDQ4MjQyLDIuMjAxNDYyODIgMTAuMTU2ODI2MiwxLjk2MzM1ODg3IDkuNzc0LDEuNzk1NDYzMDYgQzguOTYzMjAwODEsMS40NTAzMjYwNyA4LjA0Njc5OTE5LDEuNDUwMzI2MDcgNy4yMzYsMS43OTU0NjMwNiBDNi44NTMxNzM4NCwxLjk2MzM1ODg3IDYuNTA1MTc1NzYsMi4yMDE0NjI4MiA2LjIxLDIuNDk3NDYzMDYgQzUuNjAwODE5NDUsMy4xMTQzMjQwNSA1LjI2OTMyODg2LDMuOTUyODAwMjQgNS4yOTIsNC44MTk0NjMwNiBDNS4yOTc2Njg2Nyw1LjI0NzM5NTM2IDUuMzg5NDk1NjMsNS42Njk3OTkzOSA1LjU2Miw2LjA2MTQ2MzA2IEM1LjcyNzU3OTMsNi40NDU1NzAxMyA1Ljk2NTk2NjY2LDYuNzkzOTgyNDQgNi4yNjQsNy4wODc0NjMwNiBDNi41NTgzNDMzMyw3LjM4NDQ2MzMxIDYuOTA2NTQzMzEsNy42MjI3MDU0IDcuMjksNy43ODk0NjMwNiBDNy42ODExOTUxNyw3Ljk2MzQwMzUgOC4xMDM4OTc3MSw4LjA1NTI5NTM2IDguNTMyLDguMDU5NDYzMDYgTDguNTMyLDguMDU5NDYzMDYgWiBNMTAuNDIyLDQuNzY1NDYzMDYgQzEwLjQxNjM1ODgsNC41MjI4NzM5MiAxMC4zNjEyMzI0LDQuMjgzOTkyNjggMTAuMjYsNC4wNjM0NjMwNiBDMTAuMTcyMzE3OCwzLjg0MzUzNDU2IDEwLjA0NDA5MzQsMy42NDIwMzg5NiA5Ljg4MiwzLjQ2OTQ2MzA2IEM5LjcxMTEwOTY4LDMuMzA1MjEyNSA5LjUwOTE2ODc2LDMuMTc2NzA0NjUgOS4yODgsMy4wOTE0NjMwNiBMOC41ODYsMi45Mjk0NjMwNiBMNy44ODQsMy4wOTE0NjMwNiBDNy40NDYzNTgyNiwzLjI3NzM3MzU0IDcuMDk3OTEwNDgsMy42MjU4MjEzMSA2LjkxMiw0LjA2MzQ2MzA2IEM2LjcxMDc1NzY2LDQuNTI4NjMwNTEgNi43MTA3NTc2Niw1LjA1NjI5NTYxIDYuOTEyLDUuNTIxNDYzMDYgQzcuMDg0OTYzNjIsNS45NDkzMjI1NiA3LjQxMjcxNDA0LDYuMjk2MzUyNDMgNy44Myw2LjQ5MzQ2MzA2IEw4LjUzMiw2LjY1NTQ2MzA2IEw5LjIzNCw2LjQ5MzQ2MzA2IEM5LjQ1NDUzMTUzLDYuNDA2OTYzMjEgOS42NTYyMzk3Miw2LjI3ODYwMzQ1IDkuODI4LDYuMTE1NDYzMDYgQzkuOTg5MTA0MjEsNS45NDIxMjA5IDEwLjExNzIwNDgsNS43NDA4MjAwMiAxMC4yMDYsNS41MjE0NjMwNiBDMTAuMzE0Njc2MSw1LjI4NDM1NTU3IDEwLjM2OTk3NzYsNS4wMjYyODIwNCAxMC4zNjgsNC43NjU0NjMwNiBMMTAuNDIyLDQuNzY1NDYzMDYgWiIgaWQ9IlNoYXBlIj48L3BhdGg+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2c+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZz4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2c+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2c+DQogICAgICAgICAgICAgICAgICAgIDwvZz4NCiAgICAgICAgICAgICAgICA8L2c+DQogICAgICAgICAgICA8L2c+DQogICAgICAgIDwvZz4NCiAgICA8L2c+DQo8L3N2Zz4=");background-repeat:no-repeat;opacity:.7;position:relative}.list-panel .dim div.visibility{background-position:6px 9px;background-image:url("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+DQo8c3ZnIHdpZHRoPSIxNnB4IiBoZWlnaHQ9IjE1cHgiIHZpZXdCb3g9IjAgMCAxNiAxNSIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4NCiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDQ2ICg0NDQyMykgLSBodHRwOi8vd3d3LmJvaGVtaWFuY29kaW5nLmNvbS9za2V0Y2ggLS0+DQogICAgPHRpdGxlPm1hcmt1cF9kaXNwbGF5X3R1cm5fb2ZmPC90aXRsZT4NCiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4NCiAgICA8ZGVmcz48L2RlZnM+DQogICAgPGcgaWQ9IlBhZ2UtNiIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+DQogICAgICAgIDxnIGlkPSJDYW1lcmEtSW50ZXJhY3Rpb25zLS0tSG92ZXItQ29weSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTEwNTcuMDAwMDAwLCAtMTIzLjAwMDAwMCkiIGZpbGw9IiNGNEY0RjQiPg0KICAgICAgICAgICAgPGcgaWQ9Ikdyb3VwLTE5IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg4MTAuMDAwMDAwLCAxMTIuMDAwMDAwKSI+DQogICAgICAgICAgICAgICAgPGcgaWQ9Im1hcmt1cC1kaXNwbGF5LW9mZiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjM5LjAwMDAwMCwgMy4wMDAwMDApIj4NCiAgICAgICAgICAgICAgICAgICAgPGcgaWQ9Im1hcmt1cF9kaXNwbGF5X3R1cm5fb2ZmIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg4LjAwMDAwMCwgOC4wMDAwMDApIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xNC4zMjIsMC41OTQgQzE0LjA1OCwwLjMzIDEzLjY2MiwwLjMzIDEzLjM5OCwwLjU5NCBMMTAuMzYyLDMuNjMgQzkuNTcsMy40MzIgOC43NzgsMy4yMzQgNy45MiwzLjIzNCBDNC4zNTYsMy4yMzQgMS4zMiw1LjQxMiAwLDguMDUyIEwwLDguMDUyIEMwLjU5NCw5LjI0IDEuNTg0LDEwLjM2MiAyLjc3MiwxMS4yMiBMMC40NjIsMTMuNTMgQzAuMTk4LDEzLjc5NCAwLjE5OCwxNC4xOSAwLjQ2MiwxNC40NTQgQzAuNzI2LDE0LjcxOCAxLjEyMiwxNC43MTggMS4zODYsMTQuNDU0IEwxNC4zMjIsMS41MTggQzE0LjU4NiwxLjI1NCAxNC41ODYsMC44NTggMTQuMzIyLDAuNTk0IEwxNC4zMjIsMC41OTQgWiBNNC43NTIsOC4wNTIgQzQuNzUyLDYuMjcgNi4yMDQsNC44ODQgNy45Miw0Ljg4NCBDOC4yNSw0Ljg4NCA4LjY0Niw0Ljk1IDguOTEsNS4wODIgTDguMDUyLDUuOTQgTDcuODU0LDUuOTQgQzYuNjY2LDUuOTQgNS42NzYsNi45MyA1LjY3Niw4LjExOCBMNS42NzYsOC4zMTYgTDQuODE4LDkuMTc0IEM0LjgxOCw4Ljc3OCA0Ljc1Miw4LjM4MiA0Ljc1Miw4LjA1MiBMNC43NTIsOC4wNTIgWiBNNy45MiwxMC4yMyBDOS4xMDgsMTAuMjMgMTAuMDk4LDkuMjQgMTAuMDk4LDguMDUyIEMxMC4wOTgsNy44NTQgMTAuMDMyLDcuNjU2IDkuOTY2LDcuMzkyIEw3LjI2LDEwLjA5OCBDNy41MjQsMTAuMTY0IDcuNzIyLDEwLjIzIDcuOTIsMTAuMjMgTDcuOTIsMTAuMjMgWiBNMTUuODQsOC4wNTIgQzE1LjE4LDYuNzMyIDE0LjA1OCw1LjU0NCAxMi43MzgsNC42ODYgTDEwLjc1OCw2LjY2NiBDMTAuOTU2LDcuMDYyIDExLjA4OCw3LjU5IDExLjA4OCw4LjA1MiBDMTEuMDg4LDkuODM0IDkuNjM2LDExLjIyIDcuOTIsMTEuMjIgQzcuMzkyLDExLjIyIDYuOTMsMTEuMDg4IDYuNTM0LDEwLjg5IEw1LjA4MiwxMi4zNDIgQzUuOTQsMTIuNjcyIDYuOTMsMTIuODcgNy45MiwxMi44NyBDMTEuNDg0LDEyLjg3IDE0LjUyLDEwLjY5MiAxNS44NCw4LjA1MiBMMTUuODQsOC4wNTIgWiIgaWQ9IlNoYXBlIj48L3BhdGg+DQogICAgICAgICAgICAgICAgICAgIDwvZz4NCiAgICAgICAgICAgICAgICA8L2c+DQogICAgICAgICAgICA8L2c+DQogICAgICAgIDwvZz4NCiAgICA8L2c+DQo8L3N2Zz4=");opacity:.3}'],sourceRoot:""}]);const a=s},6314:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var i="",r=void 0!==t[5];return t[4]&&(i+="@supports (".concat(t[4],") {")),t[2]&&(i+="@media ".concat(t[2]," {")),r&&(i+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),i+=e(t),r&&(i+="}"),t[2]&&(i+="}"),t[4]&&(i+="}"),i})).join("")},t.i=function(e,i,r,o,n){"string"==typeof e&&(e=[[null,e,void 0]]);var s={};if(r)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(s[l]=!0)}for(var c=0;c<e.length;c++){var u=[].concat(e[c]);r&&s[u[0]]||(void 0!==n&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=n),i&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=i):u[2]=i),o&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=o):u[4]="".concat(o)),t.push(u))}},t}},1354:e=>{"use strict";e.exports=function(e){var t=e[1],i=e[3];if(!i)return t;if("function"==typeof btoa){var r=btoa(unescape(encodeURIComponent(JSON.stringify(i)))),o="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(r),n="/*# ".concat(o," */");return[t].concat([n]).join("\n")}return[t].join("\n")}},1549:(e,t,i)=>{var r=i(2032),o=i(3862),n=i(6721),s=i(2749),a=i(5749);function l(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}l.prototype.clear=r,l.prototype.delete=o,l.prototype.get=n,l.prototype.has=s,l.prototype.set=a,e.exports=l},79:(e,t,i)=>{var r=i(3702),o=i(80),n=i(4739),s=i(8655),a=i(1175);function l(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}l.prototype.clear=r,l.prototype.delete=o,l.prototype.get=n,l.prototype.has=s,l.prototype.set=a,e.exports=l},8223:(e,t,i)=>{var r=i(6110)(i(9325),"Map");e.exports=r},3661:(e,t,i)=>{var r=i(3040),o=i(7670),n=i(289),s=i(4509),a=i(2949);function l(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}l.prototype.clear=r,l.prototype.delete=o,l.prototype.get=n,l.prototype.has=s,l.prototype.set=a,e.exports=l},6545:(e,t,i)=>{var r=i(6110)(i(9325),"Set");e.exports=r},8859:(e,t,i)=>{var r=i(3661),o=i(1380),n=i(1459);function s(e){var t=-1,i=null==e?0:e.length;for(this.__data__=new r;++t<i;)this.add(e[t])}s.prototype.add=s.prototype.push=o,s.prototype.has=n,e.exports=s},1873:(e,t,i)=>{var r=i(9325).Symbol;e.exports=r},5325:(e,t,i)=>{var r=i(6131);e.exports=function(e,t){return!!(null==e?0:e.length)&&r(e,t,0)>-1}},9905:e=>{e.exports=function(e,t,i){for(var r=-1,o=null==e?0:e.length;++r<o;)if(i(t,e[r]))return!0;return!1}},6025:(e,t,i)=>{var r=i(5288);e.exports=function(e,t){for(var i=e.length;i--;)if(r(e[i][0],t))return i;return-1}},2523:e=>{e.exports=function(e,t,i,r){for(var o=e.length,n=i+(r?1:-1);r?n--:++n<o;)if(t(e[n],n,e))return n;return-1}},2552:(e,t,i)=>{var r=i(1873),o=i(659),n=i(9350),s=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":s&&s in Object(e)?o(e):n(e)}},6131:(e,t,i)=>{var r=i(2523),o=i(5463),n=i(6959);e.exports=function(e,t,i){return t==t?n(e,t,i):r(e,o,i)}},5463:e=>{e.exports=function(e){return e!=e}},5083:(e,t,i)=>{var r=i(1882),o=i(7296),n=i(3805),s=i(7473),a=/^\[object .+?Constructor\]$/,l=Function.prototype,c=Object.prototype,u=l.toString,h=c.hasOwnProperty,d=RegExp("^"+u.call(h).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!n(e)||o(e))&&(r(e)?d:a).test(s(e))}},5765:(e,t,i)=>{var r=i(8859),o=i(5325),n=i(9905),s=i(9219),a=i(4517),l=i(4247);e.exports=function(e,t,i){var c=-1,u=o,h=e.length,d=!0,p=[],g=p;if(i)d=!1,u=n;else if(h>=200){var f=t?null:a(e);if(f)return l(f);d=!1,u=s,g=new r}else g=t?[]:p;e:for(;++c<h;){var v=e[c],m=t?t(v):v;if(v=i||0!==v?v:0,d&&m==m){for(var y=g.length;y--;)if(g[y]===m)continue e;t&&g.push(m),p.push(v)}else u(g,m,i)||(g!==p&&g.push(m),p.push(v))}return p}},9219:e=>{e.exports=function(e,t){return e.has(t)}},5481:(e,t,i)=>{var r=i(9325)["__core-js_shared__"];e.exports=r},4517:(e,t,i)=>{var r=i(6545),o=i(3950),n=i(4247),s=r&&1/n(new r([,-0]))[1]==1/0?function(e){return new r(e)}:o;e.exports=s},4840:(e,t,i)=>{var r="object"==typeof i.g&&i.g&&i.g.Object===Object&&i.g;e.exports=r},2651:(e,t,i)=>{var r=i(4218);e.exports=function(e,t){var i=e.__data__;return r(t)?i["string"==typeof t?"string":"hash"]:i.map}},6110:(e,t,i)=>{var r=i(5083),o=i(392);e.exports=function(e,t){var i=o(e,t);return r(i)?i:void 0}},659:(e,t,i)=>{var r=i(1873),o=Object.prototype,n=o.hasOwnProperty,s=o.toString,a=r?r.toStringTag:void 0;e.exports=function(e){var t=n.call(e,a),i=e[a];try{e[a]=void 0;var r=!0}catch(e){}var o=s.call(e);return r&&(t?e[a]=i:delete e[a]),o}},392:e=>{e.exports=function(e,t){return null==e?void 0:e[t]}},2032:(e,t,i)=>{var r=i(1042);e.exports=function(){this.__data__=r?r(null):{},this.size=0}},3862:e=>{e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},6721:(e,t,i)=>{var r=i(1042),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(r){var i=t[e];return"__lodash_hash_undefined__"===i?void 0:i}return o.call(t,e)?t[e]:void 0}},2749:(e,t,i)=>{var r=i(1042),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return r?void 0!==t[e]:o.call(t,e)}},5749:(e,t,i)=>{var r=i(1042);e.exports=function(e,t){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=r&&void 0===t?"__lodash_hash_undefined__":t,this}},4218:e=>{e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},7296:(e,t,i)=>{var r,o=i(5481),n=(r=/[^.]+$/.exec(o&&o.keys&&o.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";e.exports=function(e){return!!n&&n in e}},3702:e=>{e.exports=function(){this.__data__=[],this.size=0}},80:(e,t,i)=>{var r=i(6025),o=Array.prototype.splice;e.exports=function(e){var t=this.__data__,i=r(t,e);return!(i<0)&&(i==t.length-1?t.pop():o.call(t,i,1),--this.size,!0)}},4739:(e,t,i)=>{var r=i(6025);e.exports=function(e){var t=this.__data__,i=r(t,e);return i<0?void 0:t[i][1]}},8655:(e,t,i)=>{var r=i(6025);e.exports=function(e){return r(this.__data__,e)>-1}},1175:(e,t,i)=>{var r=i(6025);e.exports=function(e,t){var i=this.__data__,o=r(i,e);return o<0?(++this.size,i.push([e,t])):i[o][1]=t,this}},3040:(e,t,i)=>{var r=i(1549),o=i(79),n=i(8223);e.exports=function(){this.size=0,this.__data__={hash:new r,map:new(n||o),string:new r}}},7670:(e,t,i)=>{var r=i(2651);e.exports=function(e){var t=r(this,e).delete(e);return this.size-=t?1:0,t}},289:(e,t,i)=>{var r=i(2651);e.exports=function(e){return r(this,e).get(e)}},4509:(e,t,i)=>{var r=i(2651);e.exports=function(e){return r(this,e).has(e)}},2949:(e,t,i)=>{var r=i(2651);e.exports=function(e,t){var i=r(this,e),o=i.size;return i.set(e,t),this.size+=i.size==o?0:1,this}},1042:(e,t,i)=>{var r=i(6110)(Object,"create");e.exports=r},9350:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},9325:(e,t,i)=>{var r=i(4840),o="object"==typeof self&&self&&self.Object===Object&&self,n=r||o||Function("return this")();e.exports=n},1380:e=>{e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},1459:e=>{e.exports=function(e){return this.__data__.has(e)}},4247:e=>{e.exports=function(e){var t=-1,i=Array(e.size);return e.forEach((function(e){i[++t]=e})),i}},6959:e=>{e.exports=function(e,t,i){for(var r=i-1,o=e.length;++r<o;)if(e[r]===t)return r;return-1}},7473:e=>{var t=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return t.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},5288:e=>{e.exports=function(e,t){return e===t||e!=e&&t!=t}},1882:(e,t,i)=>{var r=i(2552),o=i(3805);e.exports=function(e){if(!o(e))return!1;var t=r(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},3805:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},2543:function(e,t,i){var r;
/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */e=i.nmd(e),function(){var o,n="Expected a function",s="__lodash_hash_undefined__",a="__lodash_placeholder__",l=16,c=32,u=64,h=128,d=256,p=1/0,g=9007199254740991,f=NaN,v=4294967295,m=[["ary",h],["bind",1],["bindKey",2],["curry",8],["curryRight",l],["flip",512],["partial",c],["partialRight",u],["rearg",d]],y="[object Arguments]",_="[object Array]",E="[object Boolean]",A="[object Date]",x="[object Error]",C="[object Function]",w="[object GeneratorFunction]",b="[object Map]",M="[object Number]",T="[object Object]",V="[object Promise]",S="[object RegExp]",L="[object Set]",R="[object String]",P="[object Symbol]",D="[object WeakMap]",O="[object ArrayBuffer]",I="[object DataView]",N="[object Float32Array]",k="[object Float64Array]",B="[object Int8Array]",F="[object Int16Array]",z="[object Int32Array]",j="[object Uint8Array]",U="[object Uint8ClampedArray]",G="[object Uint16Array]",W="[object Uint32Array]",Y=/\b__p \+= '';/g,H=/\b(__p \+=) '' \+/g,q=/(__e\(.*?\)|\b__t\)) \+\n'';/g,K=/&(?:amp|lt|gt|quot|#39);/g,Q=/[&<>"']/g,Z=RegExp(K.source),J=RegExp(Q.source),X=/<%-([\s\S]+?)%>/g,$=/<%([\s\S]+?)%>/g,ee=/<%=([\s\S]+?)%>/g,te=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ie=/^\w*$/,re=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,oe=/[\\^$.*+?()[\]{}|]/g,ne=RegExp(oe.source),se=/^\s+/,ae=/\s/,le=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ce=/\{\n\/\* \[wrapped with (.+)\] \*/,ue=/,? & /,he=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,de=/[()=,{}\[\]\/\s]/,pe=/\\(\\)?/g,ge=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,fe=/\w*$/,ve=/^[-+]0x[0-9a-f]+$/i,me=/^0b[01]+$/i,ye=/^\[object .+?Constructor\]$/,_e=/^0o[0-7]+$/i,Ee=/^(?:0|[1-9]\d*)$/,Ae=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,xe=/($^)/,Ce=/['\n\r\u2028\u2029\\]/g,we="\\ud800-\\udfff",be="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Me="\\u2700-\\u27bf",Te="a-z\\xdf-\\xf6\\xf8-\\xff",Ve="A-Z\\xc0-\\xd6\\xd8-\\xde",Se="\\ufe0e\\ufe0f",Le="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Re="['’]",Pe="["+we+"]",De="["+Le+"]",Oe="["+be+"]",Ie="\\d+",Ne="["+Me+"]",ke="["+Te+"]",Be="[^"+we+Le+Ie+Me+Te+Ve+"]",Fe="\\ud83c[\\udffb-\\udfff]",ze="[^"+we+"]",je="(?:\\ud83c[\\udde6-\\uddff]){2}",Ue="[\\ud800-\\udbff][\\udc00-\\udfff]",Ge="["+Ve+"]",We="\\u200d",Ye="(?:"+ke+"|"+Be+")",He="(?:"+Ge+"|"+Be+")",qe="(?:['’](?:d|ll|m|re|s|t|ve))?",Ke="(?:['’](?:D|LL|M|RE|S|T|VE))?",Qe="(?:"+Oe+"|"+Fe+")"+"?",Ze="["+Se+"]?",Je=Ze+Qe+("(?:"+We+"(?:"+[ze,je,Ue].join("|")+")"+Ze+Qe+")*"),Xe="(?:"+[Ne,je,Ue].join("|")+")"+Je,$e="(?:"+[ze+Oe+"?",Oe,je,Ue,Pe].join("|")+")",et=RegExp(Re,"g"),tt=RegExp(Oe,"g"),it=RegExp(Fe+"(?="+Fe+")|"+$e+Je,"g"),rt=RegExp([Ge+"?"+ke+"+"+qe+"(?="+[De,Ge,"$"].join("|")+")",He+"+"+Ke+"(?="+[De,Ge+Ye,"$"].join("|")+")",Ge+"?"+Ye+"+"+qe,Ge+"+"+Ke,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ie,Xe].join("|"),"g"),ot=RegExp("["+We+we+be+Se+"]"),nt=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,st=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],at=-1,lt={};lt[N]=lt[k]=lt[B]=lt[F]=lt[z]=lt[j]=lt[U]=lt[G]=lt[W]=!0,lt[y]=lt[_]=lt[O]=lt[E]=lt[I]=lt[A]=lt[x]=lt[C]=lt[b]=lt[M]=lt[T]=lt[S]=lt[L]=lt[R]=lt[D]=!1;var ct={};ct[y]=ct[_]=ct[O]=ct[I]=ct[E]=ct[A]=ct[N]=ct[k]=ct[B]=ct[F]=ct[z]=ct[b]=ct[M]=ct[T]=ct[S]=ct[L]=ct[R]=ct[P]=ct[j]=ct[U]=ct[G]=ct[W]=!0,ct[x]=ct[C]=ct[D]=!1;var ut={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ht=parseFloat,dt=parseInt,pt="object"==typeof i.g&&i.g&&i.g.Object===Object&&i.g,gt="object"==typeof self&&self&&self.Object===Object&&self,ft=pt||gt||Function("return this")(),vt=t&&!t.nodeType&&t,mt=vt&&e&&!e.nodeType&&e,yt=mt&&mt.exports===vt,_t=yt&&pt.process,Et=function(){try{var e=mt&&mt.require&&mt.require("util").types;return e||_t&&_t.binding&&_t.binding("util")}catch(e){}}(),At=Et&&Et.isArrayBuffer,xt=Et&&Et.isDate,Ct=Et&&Et.isMap,wt=Et&&Et.isRegExp,bt=Et&&Et.isSet,Mt=Et&&Et.isTypedArray;function Tt(e,t,i){switch(i.length){case 0:return e.call(t);case 1:return e.call(t,i[0]);case 2:return e.call(t,i[0],i[1]);case 3:return e.call(t,i[0],i[1],i[2])}return e.apply(t,i)}function Vt(e,t,i,r){for(var o=-1,n=null==e?0:e.length;++o<n;){var s=e[o];t(r,s,i(s),e)}return r}function St(e,t){for(var i=-1,r=null==e?0:e.length;++i<r&&!1!==t(e[i],i,e););return e}function Lt(e,t){for(var i=null==e?0:e.length;i--&&!1!==t(e[i],i,e););return e}function Rt(e,t){for(var i=-1,r=null==e?0:e.length;++i<r;)if(!t(e[i],i,e))return!1;return!0}function Pt(e,t){for(var i=-1,r=null==e?0:e.length,o=0,n=[];++i<r;){var s=e[i];t(s,i,e)&&(n[o++]=s)}return n}function Dt(e,t){return!!(null==e?0:e.length)&&Gt(e,t,0)>-1}function Ot(e,t,i){for(var r=-1,o=null==e?0:e.length;++r<o;)if(i(t,e[r]))return!0;return!1}function It(e,t){for(var i=-1,r=null==e?0:e.length,o=Array(r);++i<r;)o[i]=t(e[i],i,e);return o}function Nt(e,t){for(var i=-1,r=t.length,o=e.length;++i<r;)e[o+i]=t[i];return e}function kt(e,t,i,r){var o=-1,n=null==e?0:e.length;for(r&&n&&(i=e[++o]);++o<n;)i=t(i,e[o],o,e);return i}function Bt(e,t,i,r){var o=null==e?0:e.length;for(r&&o&&(i=e[--o]);o--;)i=t(i,e[o],o,e);return i}function Ft(e,t){for(var i=-1,r=null==e?0:e.length;++i<r;)if(t(e[i],i,e))return!0;return!1}var zt=qt("length");function jt(e,t,i){var r;return i(e,(function(e,i,o){if(t(e,i,o))return r=i,!1})),r}function Ut(e,t,i,r){for(var o=e.length,n=i+(r?1:-1);r?n--:++n<o;)if(t(e[n],n,e))return n;return-1}function Gt(e,t,i){return t==t?function(e,t,i){var r=i-1,o=e.length;for(;++r<o;)if(e[r]===t)return r;return-1}(e,t,i):Ut(e,Yt,i)}function Wt(e,t,i,r){for(var o=i-1,n=e.length;++o<n;)if(r(e[o],t))return o;return-1}function Yt(e){return e!=e}function Ht(e,t){var i=null==e?0:e.length;return i?Zt(e,t)/i:f}function qt(e){return function(t){return null==t?o:t[e]}}function Kt(e){return function(t){return null==e?o:e[t]}}function Qt(e,t,i,r,o){return o(e,(function(e,o,n){i=r?(r=!1,e):t(i,e,o,n)})),i}function Zt(e,t){for(var i,r=-1,n=e.length;++r<n;){var s=t(e[r]);s!==o&&(i=i===o?s:i+s)}return i}function Jt(e,t){for(var i=-1,r=Array(e);++i<e;)r[i]=t(i);return r}function Xt(e){return e?e.slice(0,fi(e)+1).replace(se,""):e}function $t(e){return function(t){return e(t)}}function ei(e,t){return It(t,(function(t){return e[t]}))}function ti(e,t){return e.has(t)}function ii(e,t){for(var i=-1,r=e.length;++i<r&&Gt(t,e[i],0)>-1;);return i}function ri(e,t){for(var i=e.length;i--&&Gt(t,e[i],0)>-1;);return i}var oi=Kt({À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"}),ni=Kt({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function si(e){return"\\"+ut[e]}function ai(e){return ot.test(e)}function li(e){var t=-1,i=Array(e.size);return e.forEach((function(e,r){i[++t]=[r,e]})),i}function ci(e,t){return function(i){return e(t(i))}}function ui(e,t){for(var i=-1,r=e.length,o=0,n=[];++i<r;){var s=e[i];s!==t&&s!==a||(e[i]=a,n[o++]=i)}return n}function hi(e){var t=-1,i=Array(e.size);return e.forEach((function(e){i[++t]=e})),i}function di(e){var t=-1,i=Array(e.size);return e.forEach((function(e){i[++t]=[e,e]})),i}function pi(e){return ai(e)?function(e){var t=it.lastIndex=0;for(;it.test(e);)++t;return t}(e):zt(e)}function gi(e){return ai(e)?function(e){return e.match(it)||[]}(e):function(e){return e.split("")}(e)}function fi(e){for(var t=e.length;t--&&ae.test(e.charAt(t)););return t}var vi=Kt({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var mi=function e(t){var i,r=(t=null==t?ft:mi.defaults(ft.Object(),t,mi.pick(ft,st))).Array,ae=t.Date,we=t.Error,be=t.Function,Me=t.Math,Te=t.Object,Ve=t.RegExp,Se=t.String,Le=t.TypeError,Re=r.prototype,Pe=be.prototype,De=Te.prototype,Oe=t["__core-js_shared__"],Ie=Pe.toString,Ne=De.hasOwnProperty,ke=0,Be=(i=/[^.]+$/.exec(Oe&&Oe.keys&&Oe.keys.IE_PROTO||""))?"Symbol(src)_1."+i:"",Fe=De.toString,ze=Ie.call(Te),je=ft._,Ue=Ve("^"+Ie.call(Ne).replace(oe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ge=yt?t.Buffer:o,We=t.Symbol,Ye=t.Uint8Array,He=Ge?Ge.allocUnsafe:o,qe=ci(Te.getPrototypeOf,Te),Ke=Te.create,Qe=De.propertyIsEnumerable,Ze=Re.splice,Je=We?We.isConcatSpreadable:o,Xe=We?We.iterator:o,$e=We?We.toStringTag:o,it=function(){try{var e=pn(Te,"defineProperty");return e({},"",{}),e}catch(e){}}(),ot=t.clearTimeout!==ft.clearTimeout&&t.clearTimeout,ut=ae&&ae.now!==ft.Date.now&&ae.now,pt=t.setTimeout!==ft.setTimeout&&t.setTimeout,gt=Me.ceil,vt=Me.floor,mt=Te.getOwnPropertySymbols,_t=Ge?Ge.isBuffer:o,Et=t.isFinite,zt=Re.join,Kt=ci(Te.keys,Te),yi=Me.max,_i=Me.min,Ei=ae.now,Ai=t.parseInt,xi=Me.random,Ci=Re.reverse,wi=pn(t,"DataView"),bi=pn(t,"Map"),Mi=pn(t,"Promise"),Ti=pn(t,"Set"),Vi=pn(t,"WeakMap"),Si=pn(Te,"create"),Li=Vi&&new Vi,Ri={},Pi=Fn(wi),Di=Fn(bi),Oi=Fn(Mi),Ii=Fn(Ti),Ni=Fn(Vi),ki=We?We.prototype:o,Bi=ki?ki.valueOf:o,Fi=ki?ki.toString:o;function zi(e){if(ia(e)&&!Ys(e)&&!(e instanceof Wi)){if(e instanceof Gi)return e;if(Ne.call(e,"__wrapped__"))return zn(e)}return new Gi(e)}var ji=function(){function e(){}return function(t){if(!ta(t))return{};if(Ke)return Ke(t);e.prototype=t;var i=new e;return e.prototype=o,i}}();function Ui(){}function Gi(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=o}function Wi(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=v,this.__views__=[]}function Yi(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}function Hi(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}function qi(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}function Ki(e){var t=-1,i=null==e?0:e.length;for(this.__data__=new qi;++t<i;)this.add(e[t])}function Qi(e){var t=this.__data__=new Hi(e);this.size=t.size}function Zi(e,t){var i=Ys(e),r=!i&&Ws(e),o=!i&&!r&&Qs(e),n=!i&&!r&&!o&&ua(e),s=i||r||o||n,a=s?Jt(e.length,Se):[],l=a.length;for(var c in e)!t&&!Ne.call(e,c)||s&&("length"==c||o&&("offset"==c||"parent"==c)||n&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||En(c,l))||a.push(c);return a}function Ji(e){var t=e.length;return t?e[Kr(0,t-1)]:o}function Xi(e,t){return Nn(Lo(e),ar(t,0,e.length))}function $i(e){return Nn(Lo(e))}function er(e,t,i){(i!==o&&!js(e[t],i)||i===o&&!(t in e))&&nr(e,t,i)}function tr(e,t,i){var r=e[t];Ne.call(e,t)&&js(r,i)&&(i!==o||t in e)||nr(e,t,i)}function ir(e,t){for(var i=e.length;i--;)if(js(e[i][0],t))return i;return-1}function rr(e,t,i,r){return dr(e,(function(e,o,n){t(r,e,i(e),n)})),r}function or(e,t){return e&&Ro(t,Pa(t),e)}function nr(e,t,i){"__proto__"==t&&it?it(e,t,{configurable:!0,enumerable:!0,value:i,writable:!0}):e[t]=i}function sr(e,t){for(var i=-1,n=t.length,s=r(n),a=null==e;++i<n;)s[i]=a?o:Ta(e,t[i]);return s}function ar(e,t,i){return e==e&&(i!==o&&(e=e<=i?e:i),t!==o&&(e=e>=t?e:t)),e}function lr(e,t,i,r,n,s){var a,l=1&t,c=2&t,u=4&t;if(i&&(a=n?i(e,r,n,s):i(e)),a!==o)return a;if(!ta(e))return e;var h=Ys(e);if(h){if(a=function(e){var t=e.length,i=new e.constructor(t);t&&"string"==typeof e[0]&&Ne.call(e,"index")&&(i.index=e.index,i.input=e.input);return i}(e),!l)return Lo(e,a)}else{var d=vn(e),p=d==C||d==w;if(Qs(e))return wo(e,l);if(d==T||d==y||p&&!n){if(a=c||p?{}:yn(e),!l)return c?function(e,t){return Ro(e,fn(e),t)}(e,function(e,t){return e&&Ro(t,Da(t),e)}(a,e)):function(e,t){return Ro(e,gn(e),t)}(e,or(a,e))}else{if(!ct[d])return n?e:{};a=function(e,t,i){var r=e.constructor;switch(t){case O:return bo(e);case E:case A:return new r(+e);case I:return function(e,t){var i=t?bo(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.byteLength)}(e,i);case N:case k:case B:case F:case z:case j:case U:case G:case W:return Mo(e,i);case b:return new r;case M:case R:return new r(e);case S:return function(e){var t=new e.constructor(e.source,fe.exec(e));return t.lastIndex=e.lastIndex,t}(e);case L:return new r;case P:return o=e,Bi?Te(Bi.call(o)):{}}var o}(e,d,l)}}s||(s=new Qi);var g=s.get(e);if(g)return g;s.set(e,a),aa(e)?e.forEach((function(r){a.add(lr(r,t,i,r,e,s))})):ra(e)&&e.forEach((function(r,o){a.set(o,lr(r,t,i,o,e,s))}));var f=h?o:(u?c?sn:nn:c?Da:Pa)(e);return St(f||e,(function(r,o){f&&(r=e[o=r]),tr(a,o,lr(r,t,i,o,e,s))})),a}function cr(e,t,i){var r=i.length;if(null==e)return!r;for(e=Te(e);r--;){var n=i[r],s=t[n],a=e[n];if(a===o&&!(n in e)||!s(a))return!1}return!0}function ur(e,t,i){if("function"!=typeof e)throw new Le(n);return Pn((function(){e.apply(o,i)}),t)}function hr(e,t,i,r){var o=-1,n=Dt,s=!0,a=e.length,l=[],c=t.length;if(!a)return l;i&&(t=It(t,$t(i))),r?(n=Ot,s=!1):t.length>=200&&(n=ti,s=!1,t=new Ki(t));e:for(;++o<a;){var u=e[o],h=null==i?u:i(u);if(u=r||0!==u?u:0,s&&h==h){for(var d=c;d--;)if(t[d]===h)continue e;l.push(u)}else n(t,h,r)||l.push(u)}return l}zi.templateSettings={escape:X,evaluate:$,interpolate:ee,variable:"",imports:{_:zi}},zi.prototype=Ui.prototype,zi.prototype.constructor=zi,Gi.prototype=ji(Ui.prototype),Gi.prototype.constructor=Gi,Wi.prototype=ji(Ui.prototype),Wi.prototype.constructor=Wi,Yi.prototype.clear=function(){this.__data__=Si?Si(null):{},this.size=0},Yi.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Yi.prototype.get=function(e){var t=this.__data__;if(Si){var i=t[e];return i===s?o:i}return Ne.call(t,e)?t[e]:o},Yi.prototype.has=function(e){var t=this.__data__;return Si?t[e]!==o:Ne.call(t,e)},Yi.prototype.set=function(e,t){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=Si&&t===o?s:t,this},Hi.prototype.clear=function(){this.__data__=[],this.size=0},Hi.prototype.delete=function(e){var t=this.__data__,i=ir(t,e);return!(i<0)&&(i==t.length-1?t.pop():Ze.call(t,i,1),--this.size,!0)},Hi.prototype.get=function(e){var t=this.__data__,i=ir(t,e);return i<0?o:t[i][1]},Hi.prototype.has=function(e){return ir(this.__data__,e)>-1},Hi.prototype.set=function(e,t){var i=this.__data__,r=ir(i,e);return r<0?(++this.size,i.push([e,t])):i[r][1]=t,this},qi.prototype.clear=function(){this.size=0,this.__data__={hash:new Yi,map:new(bi||Hi),string:new Yi}},qi.prototype.delete=function(e){var t=hn(this,e).delete(e);return this.size-=t?1:0,t},qi.prototype.get=function(e){return hn(this,e).get(e)},qi.prototype.has=function(e){return hn(this,e).has(e)},qi.prototype.set=function(e,t){var i=hn(this,e),r=i.size;return i.set(e,t),this.size+=i.size==r?0:1,this},Ki.prototype.add=Ki.prototype.push=function(e){return this.__data__.set(e,s),this},Ki.prototype.has=function(e){return this.__data__.has(e)},Qi.prototype.clear=function(){this.__data__=new Hi,this.size=0},Qi.prototype.delete=function(e){var t=this.__data__,i=t.delete(e);return this.size=t.size,i},Qi.prototype.get=function(e){return this.__data__.get(e)},Qi.prototype.has=function(e){return this.__data__.has(e)},Qi.prototype.set=function(e,t){var i=this.__data__;if(i instanceof Hi){var r=i.__data__;if(!bi||r.length<199)return r.push([e,t]),this.size=++i.size,this;i=this.__data__=new qi(r)}return i.set(e,t),this.size=i.size,this};var dr=Oo(Er),pr=Oo(Ar,!0);function gr(e,t){var i=!0;return dr(e,(function(e,r,o){return i=!!t(e,r,o)})),i}function fr(e,t,i){for(var r=-1,n=e.length;++r<n;){var s=e[r],a=t(s);if(null!=a&&(l===o?a==a&&!ca(a):i(a,l)))var l=a,c=s}return c}function vr(e,t){var i=[];return dr(e,(function(e,r,o){t(e,r,o)&&i.push(e)})),i}function mr(e,t,i,r,o){var n=-1,s=e.length;for(i||(i=_n),o||(o=[]);++n<s;){var a=e[n];t>0&&i(a)?t>1?mr(a,t-1,i,r,o):Nt(o,a):r||(o[o.length]=a)}return o}var yr=Io(),_r=Io(!0);function Er(e,t){return e&&yr(e,t,Pa)}function Ar(e,t){return e&&_r(e,t,Pa)}function xr(e,t){return Pt(t,(function(t){return Xs(e[t])}))}function Cr(e,t){for(var i=0,r=(t=Eo(t,e)).length;null!=e&&i<r;)e=e[Bn(t[i++])];return i&&i==r?e:o}function wr(e,t,i){var r=t(e);return Ys(e)?r:Nt(r,i(e))}function br(e){return null==e?e===o?"[object Undefined]":"[object Null]":$e&&$e in Te(e)?function(e){var t=Ne.call(e,$e),i=e[$e];try{e[$e]=o;var r=!0}catch(e){}var n=Fe.call(e);r&&(t?e[$e]=i:delete e[$e]);return n}(e):function(e){return Fe.call(e)}(e)}function Mr(e,t){return e>t}function Tr(e,t){return null!=e&&Ne.call(e,t)}function Vr(e,t){return null!=e&&t in Te(e)}function Sr(e,t,i){for(var n=i?Ot:Dt,s=e[0].length,a=e.length,l=a,c=r(a),u=1/0,h=[];l--;){var d=e[l];l&&t&&(d=It(d,$t(t))),u=_i(d.length,u),c[l]=!i&&(t||s>=120&&d.length>=120)?new Ki(l&&d):o}d=e[0];var p=-1,g=c[0];e:for(;++p<s&&h.length<u;){var f=d[p],v=t?t(f):f;if(f=i||0!==f?f:0,!(g?ti(g,v):n(h,v,i))){for(l=a;--l;){var m=c[l];if(!(m?ti(m,v):n(e[l],v,i)))continue e}g&&g.push(v),h.push(f)}}return h}function Lr(e,t,i){var r=null==(e=Sn(e,t=Eo(t,e)))?e:e[Bn(Jn(t))];return null==r?o:Tt(r,e,i)}function Rr(e){return ia(e)&&br(e)==y}function Pr(e,t,i,r,n){return e===t||(null==e||null==t||!ia(e)&&!ia(t)?e!=e&&t!=t:function(e,t,i,r,n,s){var a=Ys(e),l=Ys(t),c=a?_:vn(e),u=l?_:vn(t),h=(c=c==y?T:c)==T,d=(u=u==y?T:u)==T,p=c==u;if(p&&Qs(e)){if(!Qs(t))return!1;a=!0,h=!1}if(p&&!h)return s||(s=new Qi),a||ua(e)?rn(e,t,i,r,n,s):function(e,t,i,r,o,n,s){switch(i){case I:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case O:return!(e.byteLength!=t.byteLength||!n(new Ye(e),new Ye(t)));case E:case A:case M:return js(+e,+t);case x:return e.name==t.name&&e.message==t.message;case S:case R:return e==t+"";case b:var a=li;case L:var l=1&r;if(a||(a=hi),e.size!=t.size&&!l)return!1;var c=s.get(e);if(c)return c==t;r|=2,s.set(e,t);var u=rn(a(e),a(t),r,o,n,s);return s.delete(e),u;case P:if(Bi)return Bi.call(e)==Bi.call(t)}return!1}(e,t,c,i,r,n,s);if(!(1&i)){var g=h&&Ne.call(e,"__wrapped__"),f=d&&Ne.call(t,"__wrapped__");if(g||f){var v=g?e.value():e,m=f?t.value():t;return s||(s=new Qi),n(v,m,i,r,s)}}if(!p)return!1;return s||(s=new Qi),function(e,t,i,r,n,s){var a=1&i,l=nn(e),c=l.length,u=nn(t),h=u.length;if(c!=h&&!a)return!1;var d=c;for(;d--;){var p=l[d];if(!(a?p in t:Ne.call(t,p)))return!1}var g=s.get(e),f=s.get(t);if(g&&f)return g==t&&f==e;var v=!0;s.set(e,t),s.set(t,e);var m=a;for(;++d<c;){var y=e[p=l[d]],_=t[p];if(r)var E=a?r(_,y,p,t,e,s):r(y,_,p,e,t,s);if(!(E===o?y===_||n(y,_,i,r,s):E)){v=!1;break}m||(m="constructor"==p)}if(v&&!m){var A=e.constructor,x=t.constructor;A==x||!("constructor"in e)||!("constructor"in t)||"function"==typeof A&&A instanceof A&&"function"==typeof x&&x instanceof x||(v=!1)}return s.delete(e),s.delete(t),v}(e,t,i,r,n,s)}(e,t,i,r,Pr,n))}function Dr(e,t,i,r){var n=i.length,s=n,a=!r;if(null==e)return!s;for(e=Te(e);n--;){var l=i[n];if(a&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++n<s;){var c=(l=i[n])[0],u=e[c],h=l[1];if(a&&l[2]){if(u===o&&!(c in e))return!1}else{var d=new Qi;if(r)var p=r(u,h,c,e,t,d);if(!(p===o?Pr(h,u,3,r,d):p))return!1}}return!0}function Or(e){return!(!ta(e)||(t=e,Be&&Be in t))&&(Xs(e)?Ue:ye).test(Fn(e));var t}function Ir(e){return"function"==typeof e?e:null==e?ol:"object"==typeof e?Ys(e)?jr(e[0],e[1]):zr(e):pl(e)}function Nr(e){if(!bn(e))return Kt(e);var t=[];for(var i in Te(e))Ne.call(e,i)&&"constructor"!=i&&t.push(i);return t}function kr(e){if(!ta(e))return function(e){var t=[];if(null!=e)for(var i in Te(e))t.push(i);return t}(e);var t=bn(e),i=[];for(var r in e)("constructor"!=r||!t&&Ne.call(e,r))&&i.push(r);return i}function Br(e,t){return e<t}function Fr(e,t){var i=-1,o=qs(e)?r(e.length):[];return dr(e,(function(e,r,n){o[++i]=t(e,r,n)})),o}function zr(e){var t=dn(e);return 1==t.length&&t[0][2]?Tn(t[0][0],t[0][1]):function(i){return i===e||Dr(i,e,t)}}function jr(e,t){return xn(e)&&Mn(t)?Tn(Bn(e),t):function(i){var r=Ta(i,e);return r===o&&r===t?Va(i,e):Pr(t,r,3)}}function Ur(e,t,i,r,n){e!==t&&yr(t,(function(s,a){if(n||(n=new Qi),ta(s))!function(e,t,i,r,n,s,a){var l=Ln(e,i),c=Ln(t,i),u=a.get(c);if(u)return void er(e,i,u);var h=s?s(l,c,i+"",e,t,a):o,d=h===o;if(d){var p=Ys(c),g=!p&&Qs(c),f=!p&&!g&&ua(c);h=c,p||g||f?Ys(l)?h=l:Ks(l)?h=Lo(l):g?(d=!1,h=wo(c,!0)):f?(d=!1,h=Mo(c,!0)):h=[]:na(c)||Ws(c)?(h=l,Ws(l)?h=ya(l):ta(l)&&!Xs(l)||(h=yn(c))):d=!1}d&&(a.set(c,h),n(h,c,r,s,a),a.delete(c));er(e,i,h)}(e,t,a,i,Ur,r,n);else{var l=r?r(Ln(e,a),s,a+"",e,t,n):o;l===o&&(l=s),er(e,a,l)}}),Da)}function Gr(e,t){var i=e.length;if(i)return En(t+=t<0?i:0,i)?e[t]:o}function Wr(e,t,i){t=t.length?It(t,(function(e){return Ys(e)?function(t){return Cr(t,1===e.length?e[0]:e)}:e})):[ol];var r=-1;t=It(t,$t(un()));var o=Fr(e,(function(e,i,o){var n=It(t,(function(t){return t(e)}));return{criteria:n,index:++r,value:e}}));return function(e,t){var i=e.length;for(e.sort(t);i--;)e[i]=e[i].value;return e}(o,(function(e,t){return function(e,t,i){var r=-1,o=e.criteria,n=t.criteria,s=o.length,a=i.length;for(;++r<s;){var l=To(o[r],n[r]);if(l)return r>=a?l:l*("desc"==i[r]?-1:1)}return e.index-t.index}(e,t,i)}))}function Yr(e,t,i){for(var r=-1,o=t.length,n={};++r<o;){var s=t[r],a=Cr(e,s);i(a,s)&&$r(n,Eo(s,e),a)}return n}function Hr(e,t,i,r){var o=r?Wt:Gt,n=-1,s=t.length,a=e;for(e===t&&(t=Lo(t)),i&&(a=It(e,$t(i)));++n<s;)for(var l=0,c=t[n],u=i?i(c):c;(l=o(a,u,l,r))>-1;)a!==e&&Ze.call(a,l,1),Ze.call(e,l,1);return e}function qr(e,t){for(var i=e?t.length:0,r=i-1;i--;){var o=t[i];if(i==r||o!==n){var n=o;En(o)?Ze.call(e,o,1):ho(e,o)}}return e}function Kr(e,t){return e+vt(xi()*(t-e+1))}function Qr(e,t){var i="";if(!e||t<1||t>g)return i;do{t%2&&(i+=e),(t=vt(t/2))&&(e+=e)}while(t);return i}function Zr(e,t){return Dn(Vn(e,t,ol),e+"")}function Jr(e){return Ji(ja(e))}function Xr(e,t){var i=ja(e);return Nn(i,ar(t,0,i.length))}function $r(e,t,i,r){if(!ta(e))return e;for(var n=-1,s=(t=Eo(t,e)).length,a=s-1,l=e;null!=l&&++n<s;){var c=Bn(t[n]),u=i;if("__proto__"===c||"constructor"===c||"prototype"===c)return e;if(n!=a){var h=l[c];(u=r?r(h,c,l):o)===o&&(u=ta(h)?h:En(t[n+1])?[]:{})}tr(l,c,u),l=l[c]}return e}var eo=Li?function(e,t){return Li.set(e,t),e}:ol,to=it?function(e,t){return it(e,"toString",{configurable:!0,enumerable:!1,value:tl(t),writable:!0})}:ol;function io(e){return Nn(ja(e))}function ro(e,t,i){var o=-1,n=e.length;t<0&&(t=-t>n?0:n+t),(i=i>n?n:i)<0&&(i+=n),n=t>i?0:i-t>>>0,t>>>=0;for(var s=r(n);++o<n;)s[o]=e[o+t];return s}function oo(e,t){var i;return dr(e,(function(e,r,o){return!(i=t(e,r,o))})),!!i}function no(e,t,i){var r=0,o=null==e?r:e.length;if("number"==typeof t&&t==t&&o<=2147483647){for(;r<o;){var n=r+o>>>1,s=e[n];null!==s&&!ca(s)&&(i?s<=t:s<t)?r=n+1:o=n}return o}return so(e,t,ol,i)}function so(e,t,i,r){var n=0,s=null==e?0:e.length;if(0===s)return 0;for(var a=(t=i(t))!=t,l=null===t,c=ca(t),u=t===o;n<s;){var h=vt((n+s)/2),d=i(e[h]),p=d!==o,g=null===d,f=d==d,v=ca(d);if(a)var m=r||f;else m=u?f&&(r||p):l?f&&p&&(r||!g):c?f&&p&&!g&&(r||!v):!g&&!v&&(r?d<=t:d<t);m?n=h+1:s=h}return _i(s,4294967294)}function ao(e,t){for(var i=-1,r=e.length,o=0,n=[];++i<r;){var s=e[i],a=t?t(s):s;if(!i||!js(a,l)){var l=a;n[o++]=0===s?0:s}}return n}function lo(e){return"number"==typeof e?e:ca(e)?f:+e}function co(e){if("string"==typeof e)return e;if(Ys(e))return It(e,co)+"";if(ca(e))return Fi?Fi.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function uo(e,t,i){var r=-1,o=Dt,n=e.length,s=!0,a=[],l=a;if(i)s=!1,o=Ot;else if(n>=200){var c=t?null:Zo(e);if(c)return hi(c);s=!1,o=ti,l=new Ki}else l=t?[]:a;e:for(;++r<n;){var u=e[r],h=t?t(u):u;if(u=i||0!==u?u:0,s&&h==h){for(var d=l.length;d--;)if(l[d]===h)continue e;t&&l.push(h),a.push(u)}else o(l,h,i)||(l!==a&&l.push(h),a.push(u))}return a}function ho(e,t){return null==(e=Sn(e,t=Eo(t,e)))||delete e[Bn(Jn(t))]}function po(e,t,i,r){return $r(e,t,i(Cr(e,t)),r)}function go(e,t,i,r){for(var o=e.length,n=r?o:-1;(r?n--:++n<o)&&t(e[n],n,e););return i?ro(e,r?0:n,r?n+1:o):ro(e,r?n+1:0,r?o:n)}function fo(e,t){var i=e;return i instanceof Wi&&(i=i.value()),kt(t,(function(e,t){return t.func.apply(t.thisArg,Nt([e],t.args))}),i)}function vo(e,t,i){var o=e.length;if(o<2)return o?uo(e[0]):[];for(var n=-1,s=r(o);++n<o;)for(var a=e[n],l=-1;++l<o;)l!=n&&(s[n]=hr(s[n]||a,e[l],t,i));return uo(mr(s,1),t,i)}function mo(e,t,i){for(var r=-1,n=e.length,s=t.length,a={};++r<n;){var l=r<s?t[r]:o;i(a,e[r],l)}return a}function yo(e){return Ks(e)?e:[]}function _o(e){return"function"==typeof e?e:ol}function Eo(e,t){return Ys(e)?e:xn(e,t)?[e]:kn(_a(e))}var Ao=Zr;function xo(e,t,i){var r=e.length;return i=i===o?r:i,!t&&i>=r?e:ro(e,t,i)}var Co=ot||function(e){return ft.clearTimeout(e)};function wo(e,t){if(t)return e.slice();var i=e.length,r=He?He(i):new e.constructor(i);return e.copy(r),r}function bo(e){var t=new e.constructor(e.byteLength);return new Ye(t).set(new Ye(e)),t}function Mo(e,t){var i=t?bo(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.length)}function To(e,t){if(e!==t){var i=e!==o,r=null===e,n=e==e,s=ca(e),a=t!==o,l=null===t,c=t==t,u=ca(t);if(!l&&!u&&!s&&e>t||s&&a&&c&&!l&&!u||r&&a&&c||!i&&c||!n)return 1;if(!r&&!s&&!u&&e<t||u&&i&&n&&!r&&!s||l&&i&&n||!a&&n||!c)return-1}return 0}function Vo(e,t,i,o){for(var n=-1,s=e.length,a=i.length,l=-1,c=t.length,u=yi(s-a,0),h=r(c+u),d=!o;++l<c;)h[l]=t[l];for(;++n<a;)(d||n<s)&&(h[i[n]]=e[n]);for(;u--;)h[l++]=e[n++];return h}function So(e,t,i,o){for(var n=-1,s=e.length,a=-1,l=i.length,c=-1,u=t.length,h=yi(s-l,0),d=r(h+u),p=!o;++n<h;)d[n]=e[n];for(var g=n;++c<u;)d[g+c]=t[c];for(;++a<l;)(p||n<s)&&(d[g+i[a]]=e[n++]);return d}function Lo(e,t){var i=-1,o=e.length;for(t||(t=r(o));++i<o;)t[i]=e[i];return t}function Ro(e,t,i,r){var n=!i;i||(i={});for(var s=-1,a=t.length;++s<a;){var l=t[s],c=r?r(i[l],e[l],l,i,e):o;c===o&&(c=e[l]),n?nr(i,l,c):tr(i,l,c)}return i}function Po(e,t){return function(i,r){var o=Ys(i)?Vt:rr,n=t?t():{};return o(i,e,un(r,2),n)}}function Do(e){return Zr((function(t,i){var r=-1,n=i.length,s=n>1?i[n-1]:o,a=n>2?i[2]:o;for(s=e.length>3&&"function"==typeof s?(n--,s):o,a&&An(i[0],i[1],a)&&(s=n<3?o:s,n=1),t=Te(t);++r<n;){var l=i[r];l&&e(t,l,r,s)}return t}))}function Oo(e,t){return function(i,r){if(null==i)return i;if(!qs(i))return e(i,r);for(var o=i.length,n=t?o:-1,s=Te(i);(t?n--:++n<o)&&!1!==r(s[n],n,s););return i}}function Io(e){return function(t,i,r){for(var o=-1,n=Te(t),s=r(t),a=s.length;a--;){var l=s[e?a:++o];if(!1===i(n[l],l,n))break}return t}}function No(e){return function(t){var i=ai(t=_a(t))?gi(t):o,r=i?i[0]:t.charAt(0),n=i?xo(i,1).join(""):t.slice(1);return r[e]()+n}}function ko(e){return function(t){return kt(Xa(Wa(t).replace(et,"")),e,"")}}function Bo(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var i=ji(e.prototype),r=e.apply(i,t);return ta(r)?r:i}}function Fo(e){return function(t,i,r){var n=Te(t);if(!qs(t)){var s=un(i,3);t=Pa(t),i=function(e){return s(n[e],e,n)}}var a=e(t,i,r);return a>-1?n[s?t[a]:a]:o}}function zo(e){return on((function(t){var i=t.length,r=i,s=Gi.prototype.thru;for(e&&t.reverse();r--;){var a=t[r];if("function"!=typeof a)throw new Le(n);if(s&&!l&&"wrapper"==ln(a))var l=new Gi([],!0)}for(r=l?r:i;++r<i;){var c=ln(a=t[r]),u="wrapper"==c?an(a):o;l=u&&Cn(u[0])&&424==u[1]&&!u[4].length&&1==u[9]?l[ln(u[0])].apply(l,u[3]):1==a.length&&Cn(a)?l[c]():l.thru(a)}return function(){var e=arguments,r=e[0];if(l&&1==e.length&&Ys(r))return l.plant(r).value();for(var o=0,n=i?t[o].apply(this,e):r;++o<i;)n=t[o].call(this,n);return n}}))}function jo(e,t,i,n,s,a,l,c,u,d){var p=t&h,g=1&t,f=2&t,v=24&t,m=512&t,y=f?o:Bo(e);return function h(){for(var _=arguments.length,E=r(_),A=_;A--;)E[A]=arguments[A];if(v)var x=cn(h),C=function(e,t){for(var i=e.length,r=0;i--;)e[i]===t&&++r;return r}(E,x);if(n&&(E=Vo(E,n,s,v)),a&&(E=So(E,a,l,v)),_-=C,v&&_<d){var w=ui(E,x);return Ko(e,t,jo,h.placeholder,i,E,w,c,u,d-_)}var b=g?i:this,M=f?b[e]:e;return _=E.length,c?E=function(e,t){var i=e.length,r=_i(t.length,i),n=Lo(e);for(;r--;){var s=t[r];e[r]=En(s,i)?n[s]:o}return e}(E,c):m&&_>1&&E.reverse(),p&&u<_&&(E.length=u),this&&this!==ft&&this instanceof h&&(M=y||Bo(M)),M.apply(b,E)}}function Uo(e,t){return function(i,r){return function(e,t,i,r){return Er(e,(function(e,o,n){t(r,i(e),o,n)})),r}(i,e,t(r),{})}}function Go(e,t){return function(i,r){var n;if(i===o&&r===o)return t;if(i!==o&&(n=i),r!==o){if(n===o)return r;"string"==typeof i||"string"==typeof r?(i=co(i),r=co(r)):(i=lo(i),r=lo(r)),n=e(i,r)}return n}}function Wo(e){return on((function(t){return t=It(t,$t(un())),Zr((function(i){var r=this;return e(t,(function(e){return Tt(e,r,i)}))}))}))}function Yo(e,t){var i=(t=t===o?" ":co(t)).length;if(i<2)return i?Qr(t,e):t;var r=Qr(t,gt(e/pi(t)));return ai(t)?xo(gi(r),0,e).join(""):r.slice(0,e)}function Ho(e){return function(t,i,n){return n&&"number"!=typeof n&&An(t,i,n)&&(i=n=o),t=ga(t),i===o?(i=t,t=0):i=ga(i),function(e,t,i,o){for(var n=-1,s=yi(gt((t-e)/(i||1)),0),a=r(s);s--;)a[o?s:++n]=e,e+=i;return a}(t,i,n=n===o?t<i?1:-1:ga(n),e)}}function qo(e){return function(t,i){return"string"==typeof t&&"string"==typeof i||(t=ma(t),i=ma(i)),e(t,i)}}function Ko(e,t,i,r,n,s,a,l,h,d){var p=8&t;t|=p?c:u,4&(t&=~(p?u:c))||(t&=-4);var g=[e,t,n,p?s:o,p?a:o,p?o:s,p?o:a,l,h,d],f=i.apply(o,g);return Cn(e)&&Rn(f,g),f.placeholder=r,On(f,e,t)}function Qo(e){var t=Me[e];return function(e,i){if(e=ma(e),(i=null==i?0:_i(fa(i),292))&&Et(e)){var r=(_a(e)+"e").split("e");return+((r=(_a(t(r[0]+"e"+(+r[1]+i)))+"e").split("e"))[0]+"e"+(+r[1]-i))}return t(e)}}var Zo=Ti&&1/hi(new Ti([,-0]))[1]==p?function(e){return new Ti(e)}:cl;function Jo(e){return function(t){var i=vn(t);return i==b?li(t):i==L?di(t):function(e,t){return It(t,(function(t){return[t,e[t]]}))}(t,e(t))}}function Xo(e,t,i,s,p,g,f,v){var m=2&t;if(!m&&"function"!=typeof e)throw new Le(n);var y=s?s.length:0;if(y||(t&=-97,s=p=o),f=f===o?f:yi(fa(f),0),v=v===o?v:fa(v),y-=p?p.length:0,t&u){var _=s,E=p;s=p=o}var A=m?o:an(e),x=[e,t,i,s,p,_,E,g,f,v];if(A&&function(e,t){var i=e[1],r=t[1],o=i|r,n=o<131,s=r==h&&8==i||r==h&&i==d&&e[7].length<=t[8]||384==r&&t[7].length<=t[8]&&8==i;if(!n&&!s)return e;1&r&&(e[2]=t[2],o|=1&i?0:4);var l=t[3];if(l){var c=e[3];e[3]=c?Vo(c,l,t[4]):l,e[4]=c?ui(e[3],a):t[4]}(l=t[5])&&(c=e[5],e[5]=c?So(c,l,t[6]):l,e[6]=c?ui(e[5],a):t[6]);(l=t[7])&&(e[7]=l);r&h&&(e[8]=null==e[8]?t[8]:_i(e[8],t[8]));null==e[9]&&(e[9]=t[9]);e[0]=t[0],e[1]=o}(x,A),e=x[0],t=x[1],i=x[2],s=x[3],p=x[4],!(v=x[9]=x[9]===o?m?0:e.length:yi(x[9]-y,0))&&24&t&&(t&=-25),t&&1!=t)C=8==t||t==l?function(e,t,i){var n=Bo(e);return function s(){for(var a=arguments.length,l=r(a),c=a,u=cn(s);c--;)l[c]=arguments[c];var h=a<3&&l[0]!==u&&l[a-1]!==u?[]:ui(l,u);return(a-=h.length)<i?Ko(e,t,jo,s.placeholder,o,l,h,o,o,i-a):Tt(this&&this!==ft&&this instanceof s?n:e,this,l)}}(e,t,v):t!=c&&33!=t||p.length?jo.apply(o,x):function(e,t,i,o){var n=1&t,s=Bo(e);return function t(){for(var a=-1,l=arguments.length,c=-1,u=o.length,h=r(u+l),d=this&&this!==ft&&this instanceof t?s:e;++c<u;)h[c]=o[c];for(;l--;)h[c++]=arguments[++a];return Tt(d,n?i:this,h)}}(e,t,i,s);else var C=function(e,t,i){var r=1&t,o=Bo(e);return function t(){return(this&&this!==ft&&this instanceof t?o:e).apply(r?i:this,arguments)}}(e,t,i);return On((A?eo:Rn)(C,x),e,t)}function $o(e,t,i,r){return e===o||js(e,De[i])&&!Ne.call(r,i)?t:e}function en(e,t,i,r,n,s){return ta(e)&&ta(t)&&(s.set(t,e),Ur(e,t,o,en,s),s.delete(t)),e}function tn(e){return na(e)?o:e}function rn(e,t,i,r,n,s){var a=1&i,l=e.length,c=t.length;if(l!=c&&!(a&&c>l))return!1;var u=s.get(e),h=s.get(t);if(u&&h)return u==t&&h==e;var d=-1,p=!0,g=2&i?new Ki:o;for(s.set(e,t),s.set(t,e);++d<l;){var f=e[d],v=t[d];if(r)var m=a?r(v,f,d,t,e,s):r(f,v,d,e,t,s);if(m!==o){if(m)continue;p=!1;break}if(g){if(!Ft(t,(function(e,t){if(!ti(g,t)&&(f===e||n(f,e,i,r,s)))return g.push(t)}))){p=!1;break}}else if(f!==v&&!n(f,v,i,r,s)){p=!1;break}}return s.delete(e),s.delete(t),p}function on(e){return Dn(Vn(e,o,Hn),e+"")}function nn(e){return wr(e,Pa,gn)}function sn(e){return wr(e,Da,fn)}var an=Li?function(e){return Li.get(e)}:cl;function ln(e){for(var t=e.name+"",i=Ri[t],r=Ne.call(Ri,t)?i.length:0;r--;){var o=i[r],n=o.func;if(null==n||n==e)return o.name}return t}function cn(e){return(Ne.call(zi,"placeholder")?zi:e).placeholder}function un(){var e=zi.iteratee||nl;return e=e===nl?Ir:e,arguments.length?e(arguments[0],arguments[1]):e}function hn(e,t){var i,r,o=e.__data__;return("string"==(r=typeof(i=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==i:null===i)?o["string"==typeof t?"string":"hash"]:o.map}function dn(e){for(var t=Pa(e),i=t.length;i--;){var r=t[i],o=e[r];t[i]=[r,o,Mn(o)]}return t}function pn(e,t){var i=function(e,t){return null==e?o:e[t]}(e,t);return Or(i)?i:o}var gn=mt?function(e){return null==e?[]:(e=Te(e),Pt(mt(e),(function(t){return Qe.call(e,t)})))}:vl,fn=mt?function(e){for(var t=[];e;)Nt(t,gn(e)),e=qe(e);return t}:vl,vn=br;function mn(e,t,i){for(var r=-1,o=(t=Eo(t,e)).length,n=!1;++r<o;){var s=Bn(t[r]);if(!(n=null!=e&&i(e,s)))break;e=e[s]}return n||++r!=o?n:!!(o=null==e?0:e.length)&&ea(o)&&En(s,o)&&(Ys(e)||Ws(e))}function yn(e){return"function"!=typeof e.constructor||bn(e)?{}:ji(qe(e))}function _n(e){return Ys(e)||Ws(e)||!!(Je&&e&&e[Je])}function En(e,t){var i=typeof e;return!!(t=null==t?g:t)&&("number"==i||"symbol"!=i&&Ee.test(e))&&e>-1&&e%1==0&&e<t}function An(e,t,i){if(!ta(i))return!1;var r=typeof t;return!!("number"==r?qs(i)&&En(t,i.length):"string"==r&&t in i)&&js(i[t],e)}function xn(e,t){if(Ys(e))return!1;var i=typeof e;return!("number"!=i&&"symbol"!=i&&"boolean"!=i&&null!=e&&!ca(e))||(ie.test(e)||!te.test(e)||null!=t&&e in Te(t))}function Cn(e){var t=ln(e),i=zi[t];if("function"!=typeof i||!(t in Wi.prototype))return!1;if(e===i)return!0;var r=an(i);return!!r&&e===r[0]}(wi&&vn(new wi(new ArrayBuffer(1)))!=I||bi&&vn(new bi)!=b||Mi&&vn(Mi.resolve())!=V||Ti&&vn(new Ti)!=L||Vi&&vn(new Vi)!=D)&&(vn=function(e){var t=br(e),i=t==T?e.constructor:o,r=i?Fn(i):"";if(r)switch(r){case Pi:return I;case Di:return b;case Oi:return V;case Ii:return L;case Ni:return D}return t});var wn=Oe?Xs:ml;function bn(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||De)}function Mn(e){return e==e&&!ta(e)}function Tn(e,t){return function(i){return null!=i&&(i[e]===t&&(t!==o||e in Te(i)))}}function Vn(e,t,i){return t=yi(t===o?e.length-1:t,0),function(){for(var o=arguments,n=-1,s=yi(o.length-t,0),a=r(s);++n<s;)a[n]=o[t+n];n=-1;for(var l=r(t+1);++n<t;)l[n]=o[n];return l[t]=i(a),Tt(e,this,l)}}function Sn(e,t){return t.length<2?e:Cr(e,ro(t,0,-1))}function Ln(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var Rn=In(eo),Pn=pt||function(e,t){return ft.setTimeout(e,t)},Dn=In(to);function On(e,t,i){var r=t+"";return Dn(e,function(e,t){var i=t.length;if(!i)return e;var r=i-1;return t[r]=(i>1?"& ":"")+t[r],t=t.join(i>2?", ":" "),e.replace(le,"{\n/* [wrapped with "+t+"] */\n")}(r,function(e,t){return St(m,(function(i){var r="_."+i[0];t&i[1]&&!Dt(e,r)&&e.push(r)})),e.sort()}(function(e){var t=e.match(ce);return t?t[1].split(ue):[]}(r),i)))}function In(e){var t=0,i=0;return function(){var r=Ei(),n=16-(r-i);if(i=r,n>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(o,arguments)}}function Nn(e,t){var i=-1,r=e.length,n=r-1;for(t=t===o?r:t;++i<t;){var s=Kr(i,n),a=e[s];e[s]=e[i],e[i]=a}return e.length=t,e}var kn=function(e){var t=Is(e,(function(e){return 500===i.size&&i.clear(),e})),i=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(re,(function(e,i,r,o){t.push(r?o.replace(pe,"$1"):i||e)})),t}));function Bn(e){if("string"==typeof e||ca(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function Fn(e){if(null!=e){try{return Ie.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function zn(e){if(e instanceof Wi)return e.clone();var t=new Gi(e.__wrapped__,e.__chain__);return t.__actions__=Lo(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var jn=Zr((function(e,t){return Ks(e)?hr(e,mr(t,1,Ks,!0)):[]})),Un=Zr((function(e,t){var i=Jn(t);return Ks(i)&&(i=o),Ks(e)?hr(e,mr(t,1,Ks,!0),un(i,2)):[]})),Gn=Zr((function(e,t){var i=Jn(t);return Ks(i)&&(i=o),Ks(e)?hr(e,mr(t,1,Ks,!0),o,i):[]}));function Wn(e,t,i){var r=null==e?0:e.length;if(!r)return-1;var o=null==i?0:fa(i);return o<0&&(o=yi(r+o,0)),Ut(e,un(t,3),o)}function Yn(e,t,i){var r=null==e?0:e.length;if(!r)return-1;var n=r-1;return i!==o&&(n=fa(i),n=i<0?yi(r+n,0):_i(n,r-1)),Ut(e,un(t,3),n,!0)}function Hn(e){return(null==e?0:e.length)?mr(e,1):[]}function qn(e){return e&&e.length?e[0]:o}var Kn=Zr((function(e){var t=It(e,yo);return t.length&&t[0]===e[0]?Sr(t):[]})),Qn=Zr((function(e){var t=Jn(e),i=It(e,yo);return t===Jn(i)?t=o:i.pop(),i.length&&i[0]===e[0]?Sr(i,un(t,2)):[]})),Zn=Zr((function(e){var t=Jn(e),i=It(e,yo);return(t="function"==typeof t?t:o)&&i.pop(),i.length&&i[0]===e[0]?Sr(i,o,t):[]}));function Jn(e){var t=null==e?0:e.length;return t?e[t-1]:o}var Xn=Zr($n);function $n(e,t){return e&&e.length&&t&&t.length?Hr(e,t):e}var es=on((function(e,t){var i=null==e?0:e.length,r=sr(e,t);return qr(e,It(t,(function(e){return En(e,i)?+e:e})).sort(To)),r}));function ts(e){return null==e?e:Ci.call(e)}var is=Zr((function(e){return uo(mr(e,1,Ks,!0))})),rs=Zr((function(e){var t=Jn(e);return Ks(t)&&(t=o),uo(mr(e,1,Ks,!0),un(t,2))})),os=Zr((function(e){var t=Jn(e);return t="function"==typeof t?t:o,uo(mr(e,1,Ks,!0),o,t)}));function ns(e){if(!e||!e.length)return[];var t=0;return e=Pt(e,(function(e){if(Ks(e))return t=yi(e.length,t),!0})),Jt(t,(function(t){return It(e,qt(t))}))}function ss(e,t){if(!e||!e.length)return[];var i=ns(e);return null==t?i:It(i,(function(e){return Tt(t,o,e)}))}var as=Zr((function(e,t){return Ks(e)?hr(e,t):[]})),ls=Zr((function(e){return vo(Pt(e,Ks))})),cs=Zr((function(e){var t=Jn(e);return Ks(t)&&(t=o),vo(Pt(e,Ks),un(t,2))})),us=Zr((function(e){var t=Jn(e);return t="function"==typeof t?t:o,vo(Pt(e,Ks),o,t)})),hs=Zr(ns);var ds=Zr((function(e){var t=e.length,i=t>1?e[t-1]:o;return i="function"==typeof i?(e.pop(),i):o,ss(e,i)}));function ps(e){var t=zi(e);return t.__chain__=!0,t}function gs(e,t){return t(e)}var fs=on((function(e){var t=e.length,i=t?e[0]:0,r=this.__wrapped__,n=function(t){return sr(t,e)};return!(t>1||this.__actions__.length)&&r instanceof Wi&&En(i)?((r=r.slice(i,+i+(t?1:0))).__actions__.push({func:gs,args:[n],thisArg:o}),new Gi(r,this.__chain__).thru((function(e){return t&&!e.length&&e.push(o),e}))):this.thru(n)}));var vs=Po((function(e,t,i){Ne.call(e,i)?++e[i]:nr(e,i,1)}));var ms=Fo(Wn),ys=Fo(Yn);function _s(e,t){return(Ys(e)?St:dr)(e,un(t,3))}function Es(e,t){return(Ys(e)?Lt:pr)(e,un(t,3))}var As=Po((function(e,t,i){Ne.call(e,i)?e[i].push(t):nr(e,i,[t])}));var xs=Zr((function(e,t,i){var o=-1,n="function"==typeof t,s=qs(e)?r(e.length):[];return dr(e,(function(e){s[++o]=n?Tt(t,e,i):Lr(e,t,i)})),s})),Cs=Po((function(e,t,i){nr(e,i,t)}));function ws(e,t){return(Ys(e)?It:Fr)(e,un(t,3))}var bs=Po((function(e,t,i){e[i?0:1].push(t)}),(function(){return[[],[]]}));var Ms=Zr((function(e,t){if(null==e)return[];var i=t.length;return i>1&&An(e,t[0],t[1])?t=[]:i>2&&An(t[0],t[1],t[2])&&(t=[t[0]]),Wr(e,mr(t,1),[])})),Ts=ut||function(){return ft.Date.now()};function Vs(e,t,i){return t=i?o:t,t=e&&null==t?e.length:t,Xo(e,h,o,o,o,o,t)}function Ss(e,t){var i;if("function"!=typeof t)throw new Le(n);return e=fa(e),function(){return--e>0&&(i=t.apply(this,arguments)),e<=1&&(t=o),i}}var Ls=Zr((function(e,t,i){var r=1;if(i.length){var o=ui(i,cn(Ls));r|=c}return Xo(e,r,t,i,o)})),Rs=Zr((function(e,t,i){var r=3;if(i.length){var o=ui(i,cn(Rs));r|=c}return Xo(t,r,e,i,o)}));function Ps(e,t,i){var r,s,a,l,c,u,h=0,d=!1,p=!1,g=!0;if("function"!=typeof e)throw new Le(n);function f(t){var i=r,n=s;return r=s=o,h=t,l=e.apply(n,i)}function v(e){var i=e-u;return u===o||i>=t||i<0||p&&e-h>=a}function m(){var e=Ts();if(v(e))return y(e);c=Pn(m,function(e){var i=t-(e-u);return p?_i(i,a-(e-h)):i}(e))}function y(e){return c=o,g&&r?f(e):(r=s=o,l)}function _(){var e=Ts(),i=v(e);if(r=arguments,s=this,u=e,i){if(c===o)return function(e){return h=e,c=Pn(m,t),d?f(e):l}(u);if(p)return Co(c),c=Pn(m,t),f(u)}return c===o&&(c=Pn(m,t)),l}return t=ma(t)||0,ta(i)&&(d=!!i.leading,a=(p="maxWait"in i)?yi(ma(i.maxWait)||0,t):a,g="trailing"in i?!!i.trailing:g),_.cancel=function(){c!==o&&Co(c),h=0,r=u=s=c=o},_.flush=function(){return c===o?l:y(Ts())},_}var Ds=Zr((function(e,t){return ur(e,1,t)})),Os=Zr((function(e,t,i){return ur(e,ma(t)||0,i)}));function Is(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new Le(n);var i=function(){var r=arguments,o=t?t.apply(this,r):r[0],n=i.cache;if(n.has(o))return n.get(o);var s=e.apply(this,r);return i.cache=n.set(o,s)||n,s};return i.cache=new(Is.Cache||qi),i}function Ns(e){if("function"!=typeof e)throw new Le(n);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}Is.Cache=qi;var ks=Ao((function(e,t){var i=(t=1==t.length&&Ys(t[0])?It(t[0],$t(un())):It(mr(t,1),$t(un()))).length;return Zr((function(r){for(var o=-1,n=_i(r.length,i);++o<n;)r[o]=t[o].call(this,r[o]);return Tt(e,this,r)}))})),Bs=Zr((function(e,t){var i=ui(t,cn(Bs));return Xo(e,c,o,t,i)})),Fs=Zr((function(e,t){var i=ui(t,cn(Fs));return Xo(e,u,o,t,i)})),zs=on((function(e,t){return Xo(e,d,o,o,o,t)}));function js(e,t){return e===t||e!=e&&t!=t}var Us=qo(Mr),Gs=qo((function(e,t){return e>=t})),Ws=Rr(function(){return arguments}())?Rr:function(e){return ia(e)&&Ne.call(e,"callee")&&!Qe.call(e,"callee")},Ys=r.isArray,Hs=At?$t(At):function(e){return ia(e)&&br(e)==O};function qs(e){return null!=e&&ea(e.length)&&!Xs(e)}function Ks(e){return ia(e)&&qs(e)}var Qs=_t||ml,Zs=xt?$t(xt):function(e){return ia(e)&&br(e)==A};function Js(e){if(!ia(e))return!1;var t=br(e);return t==x||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!na(e)}function Xs(e){if(!ta(e))return!1;var t=br(e);return t==C||t==w||"[object AsyncFunction]"==t||"[object Proxy]"==t}function $s(e){return"number"==typeof e&&e==fa(e)}function ea(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=g}function ta(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function ia(e){return null!=e&&"object"==typeof e}var ra=Ct?$t(Ct):function(e){return ia(e)&&vn(e)==b};function oa(e){return"number"==typeof e||ia(e)&&br(e)==M}function na(e){if(!ia(e)||br(e)!=T)return!1;var t=qe(e);if(null===t)return!0;var i=Ne.call(t,"constructor")&&t.constructor;return"function"==typeof i&&i instanceof i&&Ie.call(i)==ze}var sa=wt?$t(wt):function(e){return ia(e)&&br(e)==S};var aa=bt?$t(bt):function(e){return ia(e)&&vn(e)==L};function la(e){return"string"==typeof e||!Ys(e)&&ia(e)&&br(e)==R}function ca(e){return"symbol"==typeof e||ia(e)&&br(e)==P}var ua=Mt?$t(Mt):function(e){return ia(e)&&ea(e.length)&&!!lt[br(e)]};var ha=qo(Br),da=qo((function(e,t){return e<=t}));function pa(e){if(!e)return[];if(qs(e))return la(e)?gi(e):Lo(e);if(Xe&&e[Xe])return function(e){for(var t,i=[];!(t=e.next()).done;)i.push(t.value);return i}(e[Xe]());var t=vn(e);return(t==b?li:t==L?hi:ja)(e)}function ga(e){return e?(e=ma(e))===p||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function fa(e){var t=ga(e),i=t%1;return t==t?i?t-i:t:0}function va(e){return e?ar(fa(e),0,v):0}function ma(e){if("number"==typeof e)return e;if(ca(e))return f;if(ta(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=ta(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Xt(e);var i=me.test(e);return i||_e.test(e)?dt(e.slice(2),i?2:8):ve.test(e)?f:+e}function ya(e){return Ro(e,Da(e))}function _a(e){return null==e?"":co(e)}var Ea=Do((function(e,t){if(bn(t)||qs(t))Ro(t,Pa(t),e);else for(var i in t)Ne.call(t,i)&&tr(e,i,t[i])})),Aa=Do((function(e,t){Ro(t,Da(t),e)})),xa=Do((function(e,t,i,r){Ro(t,Da(t),e,r)})),Ca=Do((function(e,t,i,r){Ro(t,Pa(t),e,r)})),wa=on(sr);var ba=Zr((function(e,t){e=Te(e);var i=-1,r=t.length,n=r>2?t[2]:o;for(n&&An(t[0],t[1],n)&&(r=1);++i<r;)for(var s=t[i],a=Da(s),l=-1,c=a.length;++l<c;){var u=a[l],h=e[u];(h===o||js(h,De[u])&&!Ne.call(e,u))&&(e[u]=s[u])}return e})),Ma=Zr((function(e){return e.push(o,en),Tt(Ia,o,e)}));function Ta(e,t,i){var r=null==e?o:Cr(e,t);return r===o?i:r}function Va(e,t){return null!=e&&mn(e,t,Vr)}var Sa=Uo((function(e,t,i){null!=t&&"function"!=typeof t.toString&&(t=Fe.call(t)),e[t]=i}),tl(ol)),La=Uo((function(e,t,i){null!=t&&"function"!=typeof t.toString&&(t=Fe.call(t)),Ne.call(e,t)?e[t].push(i):e[t]=[i]}),un),Ra=Zr(Lr);function Pa(e){return qs(e)?Zi(e):Nr(e)}function Da(e){return qs(e)?Zi(e,!0):kr(e)}var Oa=Do((function(e,t,i){Ur(e,t,i)})),Ia=Do((function(e,t,i,r){Ur(e,t,i,r)})),Na=on((function(e,t){var i={};if(null==e)return i;var r=!1;t=It(t,(function(t){return t=Eo(t,e),r||(r=t.length>1),t})),Ro(e,sn(e),i),r&&(i=lr(i,7,tn));for(var o=t.length;o--;)ho(i,t[o]);return i}));var ka=on((function(e,t){return null==e?{}:function(e,t){return Yr(e,t,(function(t,i){return Va(e,i)}))}(e,t)}));function Ba(e,t){if(null==e)return{};var i=It(sn(e),(function(e){return[e]}));return t=un(t),Yr(e,i,(function(e,i){return t(e,i[0])}))}var Fa=Jo(Pa),za=Jo(Da);function ja(e){return null==e?[]:ei(e,Pa(e))}var Ua=ko((function(e,t,i){return t=t.toLowerCase(),e+(i?Ga(t):t)}));function Ga(e){return Ja(_a(e).toLowerCase())}function Wa(e){return(e=_a(e))&&e.replace(Ae,oi).replace(tt,"")}var Ya=ko((function(e,t,i){return e+(i?"-":"")+t.toLowerCase()})),Ha=ko((function(e,t,i){return e+(i?" ":"")+t.toLowerCase()})),qa=No("toLowerCase");var Ka=ko((function(e,t,i){return e+(i?"_":"")+t.toLowerCase()}));var Qa=ko((function(e,t,i){return e+(i?" ":"")+Ja(t)}));var Za=ko((function(e,t,i){return e+(i?" ":"")+t.toUpperCase()})),Ja=No("toUpperCase");function Xa(e,t,i){return e=_a(e),(t=i?o:t)===o?function(e){return nt.test(e)}(e)?function(e){return e.match(rt)||[]}(e):function(e){return e.match(he)||[]}(e):e.match(t)||[]}var $a=Zr((function(e,t){try{return Tt(e,o,t)}catch(e){return Js(e)?e:new we(e)}})),el=on((function(e,t){return St(t,(function(t){t=Bn(t),nr(e,t,Ls(e[t],e))})),e}));function tl(e){return function(){return e}}var il=zo(),rl=zo(!0);function ol(e){return e}function nl(e){return Ir("function"==typeof e?e:lr(e,1))}var sl=Zr((function(e,t){return function(i){return Lr(i,e,t)}})),al=Zr((function(e,t){return function(i){return Lr(e,i,t)}}));function ll(e,t,i){var r=Pa(t),o=xr(t,r);null!=i||ta(t)&&(o.length||!r.length)||(i=t,t=e,e=this,o=xr(t,Pa(t)));var n=!(ta(i)&&"chain"in i&&!i.chain),s=Xs(e);return St(o,(function(i){var r=t[i];e[i]=r,s&&(e.prototype[i]=function(){var t=this.__chain__;if(n||t){var i=e(this.__wrapped__);return(i.__actions__=Lo(this.__actions__)).push({func:r,args:arguments,thisArg:e}),i.__chain__=t,i}return r.apply(e,Nt([this.value()],arguments))})})),e}function cl(){}var ul=Wo(It),hl=Wo(Rt),dl=Wo(Ft);function pl(e){return xn(e)?qt(Bn(e)):function(e){return function(t){return Cr(t,e)}}(e)}var gl=Ho(),fl=Ho(!0);function vl(){return[]}function ml(){return!1}var yl=Go((function(e,t){return e+t}),0),_l=Qo("ceil"),El=Go((function(e,t){return e/t}),1),Al=Qo("floor");var xl,Cl=Go((function(e,t){return e*t}),1),wl=Qo("round"),bl=Go((function(e,t){return e-t}),0);return zi.after=function(e,t){if("function"!=typeof t)throw new Le(n);return e=fa(e),function(){if(--e<1)return t.apply(this,arguments)}},zi.ary=Vs,zi.assign=Ea,zi.assignIn=Aa,zi.assignInWith=xa,zi.assignWith=Ca,zi.at=wa,zi.before=Ss,zi.bind=Ls,zi.bindAll=el,zi.bindKey=Rs,zi.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return Ys(e)?e:[e]},zi.chain=ps,zi.chunk=function(e,t,i){t=(i?An(e,t,i):t===o)?1:yi(fa(t),0);var n=null==e?0:e.length;if(!n||t<1)return[];for(var s=0,a=0,l=r(gt(n/t));s<n;)l[a++]=ro(e,s,s+=t);return l},zi.compact=function(e){for(var t=-1,i=null==e?0:e.length,r=0,o=[];++t<i;){var n=e[t];n&&(o[r++]=n)}return o},zi.concat=function(){var e=arguments.length;if(!e)return[];for(var t=r(e-1),i=arguments[0],o=e;o--;)t[o-1]=arguments[o];return Nt(Ys(i)?Lo(i):[i],mr(t,1))},zi.cond=function(e){var t=null==e?0:e.length,i=un();return e=t?It(e,(function(e){if("function"!=typeof e[1])throw new Le(n);return[i(e[0]),e[1]]})):[],Zr((function(i){for(var r=-1;++r<t;){var o=e[r];if(Tt(o[0],this,i))return Tt(o[1],this,i)}}))},zi.conforms=function(e){return function(e){var t=Pa(e);return function(i){return cr(i,e,t)}}(lr(e,1))},zi.constant=tl,zi.countBy=vs,zi.create=function(e,t){var i=ji(e);return null==t?i:or(i,t)},zi.curry=function e(t,i,r){var n=Xo(t,8,o,o,o,o,o,i=r?o:i);return n.placeholder=e.placeholder,n},zi.curryRight=function e(t,i,r){var n=Xo(t,l,o,o,o,o,o,i=r?o:i);return n.placeholder=e.placeholder,n},zi.debounce=Ps,zi.defaults=ba,zi.defaultsDeep=Ma,zi.defer=Ds,zi.delay=Os,zi.difference=jn,zi.differenceBy=Un,zi.differenceWith=Gn,zi.drop=function(e,t,i){var r=null==e?0:e.length;return r?ro(e,(t=i||t===o?1:fa(t))<0?0:t,r):[]},zi.dropRight=function(e,t,i){var r=null==e?0:e.length;return r?ro(e,0,(t=r-(t=i||t===o?1:fa(t)))<0?0:t):[]},zi.dropRightWhile=function(e,t){return e&&e.length?go(e,un(t,3),!0,!0):[]},zi.dropWhile=function(e,t){return e&&e.length?go(e,un(t,3),!0):[]},zi.fill=function(e,t,i,r){var n=null==e?0:e.length;return n?(i&&"number"!=typeof i&&An(e,t,i)&&(i=0,r=n),function(e,t,i,r){var n=e.length;for((i=fa(i))<0&&(i=-i>n?0:n+i),(r=r===o||r>n?n:fa(r))<0&&(r+=n),r=i>r?0:va(r);i<r;)e[i++]=t;return e}(e,t,i,r)):[]},zi.filter=function(e,t){return(Ys(e)?Pt:vr)(e,un(t,3))},zi.flatMap=function(e,t){return mr(ws(e,t),1)},zi.flatMapDeep=function(e,t){return mr(ws(e,t),p)},zi.flatMapDepth=function(e,t,i){return i=i===o?1:fa(i),mr(ws(e,t),i)},zi.flatten=Hn,zi.flattenDeep=function(e){return(null==e?0:e.length)?mr(e,p):[]},zi.flattenDepth=function(e,t){return(null==e?0:e.length)?mr(e,t=t===o?1:fa(t)):[]},zi.flip=function(e){return Xo(e,512)},zi.flow=il,zi.flowRight=rl,zi.fromPairs=function(e){for(var t=-1,i=null==e?0:e.length,r={};++t<i;){var o=e[t];r[o[0]]=o[1]}return r},zi.functions=function(e){return null==e?[]:xr(e,Pa(e))},zi.functionsIn=function(e){return null==e?[]:xr(e,Da(e))},zi.groupBy=As,zi.initial=function(e){return(null==e?0:e.length)?ro(e,0,-1):[]},zi.intersection=Kn,zi.intersectionBy=Qn,zi.intersectionWith=Zn,zi.invert=Sa,zi.invertBy=La,zi.invokeMap=xs,zi.iteratee=nl,zi.keyBy=Cs,zi.keys=Pa,zi.keysIn=Da,zi.map=ws,zi.mapKeys=function(e,t){var i={};return t=un(t,3),Er(e,(function(e,r,o){nr(i,t(e,r,o),e)})),i},zi.mapValues=function(e,t){var i={};return t=un(t,3),Er(e,(function(e,r,o){nr(i,r,t(e,r,o))})),i},zi.matches=function(e){return zr(lr(e,1))},zi.matchesProperty=function(e,t){return jr(e,lr(t,1))},zi.memoize=Is,zi.merge=Oa,zi.mergeWith=Ia,zi.method=sl,zi.methodOf=al,zi.mixin=ll,zi.negate=Ns,zi.nthArg=function(e){return e=fa(e),Zr((function(t){return Gr(t,e)}))},zi.omit=Na,zi.omitBy=function(e,t){return Ba(e,Ns(un(t)))},zi.once=function(e){return Ss(2,e)},zi.orderBy=function(e,t,i,r){return null==e?[]:(Ys(t)||(t=null==t?[]:[t]),Ys(i=r?o:i)||(i=null==i?[]:[i]),Wr(e,t,i))},zi.over=ul,zi.overArgs=ks,zi.overEvery=hl,zi.overSome=dl,zi.partial=Bs,zi.partialRight=Fs,zi.partition=bs,zi.pick=ka,zi.pickBy=Ba,zi.property=pl,zi.propertyOf=function(e){return function(t){return null==e?o:Cr(e,t)}},zi.pull=Xn,zi.pullAll=$n,zi.pullAllBy=function(e,t,i){return e&&e.length&&t&&t.length?Hr(e,t,un(i,2)):e},zi.pullAllWith=function(e,t,i){return e&&e.length&&t&&t.length?Hr(e,t,o,i):e},zi.pullAt=es,zi.range=gl,zi.rangeRight=fl,zi.rearg=zs,zi.reject=function(e,t){return(Ys(e)?Pt:vr)(e,Ns(un(t,3)))},zi.remove=function(e,t){var i=[];if(!e||!e.length)return i;var r=-1,o=[],n=e.length;for(t=un(t,3);++r<n;){var s=e[r];t(s,r,e)&&(i.push(s),o.push(r))}return qr(e,o),i},zi.rest=function(e,t){if("function"!=typeof e)throw new Le(n);return Zr(e,t=t===o?t:fa(t))},zi.reverse=ts,zi.sampleSize=function(e,t,i){return t=(i?An(e,t,i):t===o)?1:fa(t),(Ys(e)?Xi:Xr)(e,t)},zi.set=function(e,t,i){return null==e?e:$r(e,t,i)},zi.setWith=function(e,t,i,r){return r="function"==typeof r?r:o,null==e?e:$r(e,t,i,r)},zi.shuffle=function(e){return(Ys(e)?$i:io)(e)},zi.slice=function(e,t,i){var r=null==e?0:e.length;return r?(i&&"number"!=typeof i&&An(e,t,i)?(t=0,i=r):(t=null==t?0:fa(t),i=i===o?r:fa(i)),ro(e,t,i)):[]},zi.sortBy=Ms,zi.sortedUniq=function(e){return e&&e.length?ao(e):[]},zi.sortedUniqBy=function(e,t){return e&&e.length?ao(e,un(t,2)):[]},zi.split=function(e,t,i){return i&&"number"!=typeof i&&An(e,t,i)&&(t=i=o),(i=i===o?v:i>>>0)?(e=_a(e))&&("string"==typeof t||null!=t&&!sa(t))&&!(t=co(t))&&ai(e)?xo(gi(e),0,i):e.split(t,i):[]},zi.spread=function(e,t){if("function"!=typeof e)throw new Le(n);return t=null==t?0:yi(fa(t),0),Zr((function(i){var r=i[t],o=xo(i,0,t);return r&&Nt(o,r),Tt(e,this,o)}))},zi.tail=function(e){var t=null==e?0:e.length;return t?ro(e,1,t):[]},zi.take=function(e,t,i){return e&&e.length?ro(e,0,(t=i||t===o?1:fa(t))<0?0:t):[]},zi.takeRight=function(e,t,i){var r=null==e?0:e.length;return r?ro(e,(t=r-(t=i||t===o?1:fa(t)))<0?0:t,r):[]},zi.takeRightWhile=function(e,t){return e&&e.length?go(e,un(t,3),!1,!0):[]},zi.takeWhile=function(e,t){return e&&e.length?go(e,un(t,3)):[]},zi.tap=function(e,t){return t(e),e},zi.throttle=function(e,t,i){var r=!0,o=!0;if("function"!=typeof e)throw new Le(n);return ta(i)&&(r="leading"in i?!!i.leading:r,o="trailing"in i?!!i.trailing:o),Ps(e,t,{leading:r,maxWait:t,trailing:o})},zi.thru=gs,zi.toArray=pa,zi.toPairs=Fa,zi.toPairsIn=za,zi.toPath=function(e){return Ys(e)?It(e,Bn):ca(e)?[e]:Lo(kn(_a(e)))},zi.toPlainObject=ya,zi.transform=function(e,t,i){var r=Ys(e),o=r||Qs(e)||ua(e);if(t=un(t,4),null==i){var n=e&&e.constructor;i=o?r?new n:[]:ta(e)&&Xs(n)?ji(qe(e)):{}}return(o?St:Er)(e,(function(e,r,o){return t(i,e,r,o)})),i},zi.unary=function(e){return Vs(e,1)},zi.union=is,zi.unionBy=rs,zi.unionWith=os,zi.uniq=function(e){return e&&e.length?uo(e):[]},zi.uniqBy=function(e,t){return e&&e.length?uo(e,un(t,2)):[]},zi.uniqWith=function(e,t){return t="function"==typeof t?t:o,e&&e.length?uo(e,o,t):[]},zi.unset=function(e,t){return null==e||ho(e,t)},zi.unzip=ns,zi.unzipWith=ss,zi.update=function(e,t,i){return null==e?e:po(e,t,_o(i))},zi.updateWith=function(e,t,i,r){return r="function"==typeof r?r:o,null==e?e:po(e,t,_o(i),r)},zi.values=ja,zi.valuesIn=function(e){return null==e?[]:ei(e,Da(e))},zi.without=as,zi.words=Xa,zi.wrap=function(e,t){return Bs(_o(t),e)},zi.xor=ls,zi.xorBy=cs,zi.xorWith=us,zi.zip=hs,zi.zipObject=function(e,t){return mo(e||[],t||[],tr)},zi.zipObjectDeep=function(e,t){return mo(e||[],t||[],$r)},zi.zipWith=ds,zi.entries=Fa,zi.entriesIn=za,zi.extend=Aa,zi.extendWith=xa,ll(zi,zi),zi.add=yl,zi.attempt=$a,zi.camelCase=Ua,zi.capitalize=Ga,zi.ceil=_l,zi.clamp=function(e,t,i){return i===o&&(i=t,t=o),i!==o&&(i=(i=ma(i))==i?i:0),t!==o&&(t=(t=ma(t))==t?t:0),ar(ma(e),t,i)},zi.clone=function(e){return lr(e,4)},zi.cloneDeep=function(e){return lr(e,5)},zi.cloneDeepWith=function(e,t){return lr(e,5,t="function"==typeof t?t:o)},zi.cloneWith=function(e,t){return lr(e,4,t="function"==typeof t?t:o)},zi.conformsTo=function(e,t){return null==t||cr(e,t,Pa(t))},zi.deburr=Wa,zi.defaultTo=function(e,t){return null==e||e!=e?t:e},zi.divide=El,zi.endsWith=function(e,t,i){e=_a(e),t=co(t);var r=e.length,n=i=i===o?r:ar(fa(i),0,r);return(i-=t.length)>=0&&e.slice(i,n)==t},zi.eq=js,zi.escape=function(e){return(e=_a(e))&&J.test(e)?e.replace(Q,ni):e},zi.escapeRegExp=function(e){return(e=_a(e))&&ne.test(e)?e.replace(oe,"\\$&"):e},zi.every=function(e,t,i){var r=Ys(e)?Rt:gr;return i&&An(e,t,i)&&(t=o),r(e,un(t,3))},zi.find=ms,zi.findIndex=Wn,zi.findKey=function(e,t){return jt(e,un(t,3),Er)},zi.findLast=ys,zi.findLastIndex=Yn,zi.findLastKey=function(e,t){return jt(e,un(t,3),Ar)},zi.floor=Al,zi.forEach=_s,zi.forEachRight=Es,zi.forIn=function(e,t){return null==e?e:yr(e,un(t,3),Da)},zi.forInRight=function(e,t){return null==e?e:_r(e,un(t,3),Da)},zi.forOwn=function(e,t){return e&&Er(e,un(t,3))},zi.forOwnRight=function(e,t){return e&&Ar(e,un(t,3))},zi.get=Ta,zi.gt=Us,zi.gte=Gs,zi.has=function(e,t){return null!=e&&mn(e,t,Tr)},zi.hasIn=Va,zi.head=qn,zi.identity=ol,zi.includes=function(e,t,i,r){e=qs(e)?e:ja(e),i=i&&!r?fa(i):0;var o=e.length;return i<0&&(i=yi(o+i,0)),la(e)?i<=o&&e.indexOf(t,i)>-1:!!o&&Gt(e,t,i)>-1},zi.indexOf=function(e,t,i){var r=null==e?0:e.length;if(!r)return-1;var o=null==i?0:fa(i);return o<0&&(o=yi(r+o,0)),Gt(e,t,o)},zi.inRange=function(e,t,i){return t=ga(t),i===o?(i=t,t=0):i=ga(i),function(e,t,i){return e>=_i(t,i)&&e<yi(t,i)}(e=ma(e),t,i)},zi.invoke=Ra,zi.isArguments=Ws,zi.isArray=Ys,zi.isArrayBuffer=Hs,zi.isArrayLike=qs,zi.isArrayLikeObject=Ks,zi.isBoolean=function(e){return!0===e||!1===e||ia(e)&&br(e)==E},zi.isBuffer=Qs,zi.isDate=Zs,zi.isElement=function(e){return ia(e)&&1===e.nodeType&&!na(e)},zi.isEmpty=function(e){if(null==e)return!0;if(qs(e)&&(Ys(e)||"string"==typeof e||"function"==typeof e.splice||Qs(e)||ua(e)||Ws(e)))return!e.length;var t=vn(e);if(t==b||t==L)return!e.size;if(bn(e))return!Nr(e).length;for(var i in e)if(Ne.call(e,i))return!1;return!0},zi.isEqual=function(e,t){return Pr(e,t)},zi.isEqualWith=function(e,t,i){var r=(i="function"==typeof i?i:o)?i(e,t):o;return r===o?Pr(e,t,o,i):!!r},zi.isError=Js,zi.isFinite=function(e){return"number"==typeof e&&Et(e)},zi.isFunction=Xs,zi.isInteger=$s,zi.isLength=ea,zi.isMap=ra,zi.isMatch=function(e,t){return e===t||Dr(e,t,dn(t))},zi.isMatchWith=function(e,t,i){return i="function"==typeof i?i:o,Dr(e,t,dn(t),i)},zi.isNaN=function(e){return oa(e)&&e!=+e},zi.isNative=function(e){if(wn(e))throw new we("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Or(e)},zi.isNil=function(e){return null==e},zi.isNull=function(e){return null===e},zi.isNumber=oa,zi.isObject=ta,zi.isObjectLike=ia,zi.isPlainObject=na,zi.isRegExp=sa,zi.isSafeInteger=function(e){return $s(e)&&e>=-9007199254740991&&e<=g},zi.isSet=aa,zi.isString=la,zi.isSymbol=ca,zi.isTypedArray=ua,zi.isUndefined=function(e){return e===o},zi.isWeakMap=function(e){return ia(e)&&vn(e)==D},zi.isWeakSet=function(e){return ia(e)&&"[object WeakSet]"==br(e)},zi.join=function(e,t){return null==e?"":zt.call(e,t)},zi.kebabCase=Ya,zi.last=Jn,zi.lastIndexOf=function(e,t,i){var r=null==e?0:e.length;if(!r)return-1;var n=r;return i!==o&&(n=(n=fa(i))<0?yi(r+n,0):_i(n,r-1)),t==t?function(e,t,i){for(var r=i+1;r--;)if(e[r]===t)return r;return r}(e,t,n):Ut(e,Yt,n,!0)},zi.lowerCase=Ha,zi.lowerFirst=qa,zi.lt=ha,zi.lte=da,zi.max=function(e){return e&&e.length?fr(e,ol,Mr):o},zi.maxBy=function(e,t){return e&&e.length?fr(e,un(t,2),Mr):o},zi.mean=function(e){return Ht(e,ol)},zi.meanBy=function(e,t){return Ht(e,un(t,2))},zi.min=function(e){return e&&e.length?fr(e,ol,Br):o},zi.minBy=function(e,t){return e&&e.length?fr(e,un(t,2),Br):o},zi.stubArray=vl,zi.stubFalse=ml,zi.stubObject=function(){return{}},zi.stubString=function(){return""},zi.stubTrue=function(){return!0},zi.multiply=Cl,zi.nth=function(e,t){return e&&e.length?Gr(e,fa(t)):o},zi.noConflict=function(){return ft._===this&&(ft._=je),this},zi.noop=cl,zi.now=Ts,zi.pad=function(e,t,i){e=_a(e);var r=(t=fa(t))?pi(e):0;if(!t||r>=t)return e;var o=(t-r)/2;return Yo(vt(o),i)+e+Yo(gt(o),i)},zi.padEnd=function(e,t,i){e=_a(e);var r=(t=fa(t))?pi(e):0;return t&&r<t?e+Yo(t-r,i):e},zi.padStart=function(e,t,i){e=_a(e);var r=(t=fa(t))?pi(e):0;return t&&r<t?Yo(t-r,i)+e:e},zi.parseInt=function(e,t,i){return i||null==t?t=0:t&&(t=+t),Ai(_a(e).replace(se,""),t||0)},zi.random=function(e,t,i){if(i&&"boolean"!=typeof i&&An(e,t,i)&&(t=i=o),i===o&&("boolean"==typeof t?(i=t,t=o):"boolean"==typeof e&&(i=e,e=o)),e===o&&t===o?(e=0,t=1):(e=ga(e),t===o?(t=e,e=0):t=ga(t)),e>t){var r=e;e=t,t=r}if(i||e%1||t%1){var n=xi();return _i(e+n*(t-e+ht("1e-"+((n+"").length-1))),t)}return Kr(e,t)},zi.reduce=function(e,t,i){var r=Ys(e)?kt:Qt,o=arguments.length<3;return r(e,un(t,4),i,o,dr)},zi.reduceRight=function(e,t,i){var r=Ys(e)?Bt:Qt,o=arguments.length<3;return r(e,un(t,4),i,o,pr)},zi.repeat=function(e,t,i){return t=(i?An(e,t,i):t===o)?1:fa(t),Qr(_a(e),t)},zi.replace=function(){var e=arguments,t=_a(e[0]);return e.length<3?t:t.replace(e[1],e[2])},zi.result=function(e,t,i){var r=-1,n=(t=Eo(t,e)).length;for(n||(n=1,e=o);++r<n;){var s=null==e?o:e[Bn(t[r])];s===o&&(r=n,s=i),e=Xs(s)?s.call(e):s}return e},zi.round=wl,zi.runInContext=e,zi.sample=function(e){return(Ys(e)?Ji:Jr)(e)},zi.size=function(e){if(null==e)return 0;if(qs(e))return la(e)?pi(e):e.length;var t=vn(e);return t==b||t==L?e.size:Nr(e).length},zi.snakeCase=Ka,zi.some=function(e,t,i){var r=Ys(e)?Ft:oo;return i&&An(e,t,i)&&(t=o),r(e,un(t,3))},zi.sortedIndex=function(e,t){return no(e,t)},zi.sortedIndexBy=function(e,t,i){return so(e,t,un(i,2))},zi.sortedIndexOf=function(e,t){var i=null==e?0:e.length;if(i){var r=no(e,t);if(r<i&&js(e[r],t))return r}return-1},zi.sortedLastIndex=function(e,t){return no(e,t,!0)},zi.sortedLastIndexBy=function(e,t,i){return so(e,t,un(i,2),!0)},zi.sortedLastIndexOf=function(e,t){if(null==e?0:e.length){var i=no(e,t,!0)-1;if(js(e[i],t))return i}return-1},zi.startCase=Qa,zi.startsWith=function(e,t,i){return e=_a(e),i=null==i?0:ar(fa(i),0,e.length),t=co(t),e.slice(i,i+t.length)==t},zi.subtract=bl,zi.sum=function(e){return e&&e.length?Zt(e,ol):0},zi.sumBy=function(e,t){return e&&e.length?Zt(e,un(t,2)):0},zi.template=function(e,t,i){var r=zi.templateSettings;i&&An(e,t,i)&&(t=o),e=_a(e),t=xa({},t,r,$o);var n,s,a=xa({},t.imports,r.imports,$o),l=Pa(a),c=ei(a,l),u=0,h=t.interpolate||xe,d="__p += '",p=Ve((t.escape||xe).source+"|"+h.source+"|"+(h===ee?ge:xe).source+"|"+(t.evaluate||xe).source+"|$","g"),g="//# sourceURL="+(Ne.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++at+"]")+"\n";e.replace(p,(function(t,i,r,o,a,l){return r||(r=o),d+=e.slice(u,l).replace(Ce,si),i&&(n=!0,d+="' +\n__e("+i+") +\n'"),a&&(s=!0,d+="';\n"+a+";\n__p += '"),r&&(d+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),u=l+t.length,t})),d+="';\n";var f=Ne.call(t,"variable")&&t.variable;if(f){if(de.test(f))throw new we("Invalid `variable` option passed into `_.template`")}else d="with (obj) {\n"+d+"\n}\n";d=(s?d.replace(Y,""):d).replace(H,"$1").replace(q,"$1;"),d="function("+(f||"obj")+") {\n"+(f?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(n?", __e = _.escape":"")+(s?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var v=$a((function(){return be(l,g+"return "+d).apply(o,c)}));if(v.source=d,Js(v))throw v;return v},zi.times=function(e,t){if((e=fa(e))<1||e>g)return[];var i=v,r=_i(e,v);t=un(t),e-=v;for(var o=Jt(r,t);++i<e;)t(i);return o},zi.toFinite=ga,zi.toInteger=fa,zi.toLength=va,zi.toLower=function(e){return _a(e).toLowerCase()},zi.toNumber=ma,zi.toSafeInteger=function(e){return e?ar(fa(e),-9007199254740991,g):0===e?e:0},zi.toString=_a,zi.toUpper=function(e){return _a(e).toUpperCase()},zi.trim=function(e,t,i){if((e=_a(e))&&(i||t===o))return Xt(e);if(!e||!(t=co(t)))return e;var r=gi(e),n=gi(t);return xo(r,ii(r,n),ri(r,n)+1).join("")},zi.trimEnd=function(e,t,i){if((e=_a(e))&&(i||t===o))return e.slice(0,fi(e)+1);if(!e||!(t=co(t)))return e;var r=gi(e);return xo(r,0,ri(r,gi(t))+1).join("")},zi.trimStart=function(e,t,i){if((e=_a(e))&&(i||t===o))return e.replace(se,"");if(!e||!(t=co(t)))return e;var r=gi(e);return xo(r,ii(r,gi(t))).join("")},zi.truncate=function(e,t){var i=30,r="...";if(ta(t)){var n="separator"in t?t.separator:n;i="length"in t?fa(t.length):i,r="omission"in t?co(t.omission):r}var s=(e=_a(e)).length;if(ai(e)){var a=gi(e);s=a.length}if(i>=s)return e;var l=i-pi(r);if(l<1)return r;var c=a?xo(a,0,l).join(""):e.slice(0,l);if(n===o)return c+r;if(a&&(l+=c.length-l),sa(n)){if(e.slice(l).search(n)){var u,h=c;for(n.global||(n=Ve(n.source,_a(fe.exec(n))+"g")),n.lastIndex=0;u=n.exec(h);)var d=u.index;c=c.slice(0,d===o?l:d)}}else if(e.indexOf(co(n),l)!=l){var p=c.lastIndexOf(n);p>-1&&(c=c.slice(0,p))}return c+r},zi.unescape=function(e){return(e=_a(e))&&Z.test(e)?e.replace(K,vi):e},zi.uniqueId=function(e){var t=++ke;return _a(e)+t},zi.upperCase=Za,zi.upperFirst=Ja,zi.each=_s,zi.eachRight=Es,zi.first=qn,ll(zi,(xl={},Er(zi,(function(e,t){Ne.call(zi.prototype,t)||(xl[t]=e)})),xl),{chain:!1}),zi.VERSION="4.17.21",St(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){zi[e].placeholder=zi})),St(["drop","take"],(function(e,t){Wi.prototype[e]=function(i){i=i===o?1:yi(fa(i),0);var r=this.__filtered__&&!t?new Wi(this):this.clone();return r.__filtered__?r.__takeCount__=_i(i,r.__takeCount__):r.__views__.push({size:_i(i,v),type:e+(r.__dir__<0?"Right":"")}),r},Wi.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),St(["filter","map","takeWhile"],(function(e,t){var i=t+1,r=1==i||3==i;Wi.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:un(e,3),type:i}),t.__filtered__=t.__filtered__||r,t}})),St(["head","last"],(function(e,t){var i="take"+(t?"Right":"");Wi.prototype[e]=function(){return this[i](1).value()[0]}})),St(["initial","tail"],(function(e,t){var i="drop"+(t?"":"Right");Wi.prototype[e]=function(){return this.__filtered__?new Wi(this):this[i](1)}})),Wi.prototype.compact=function(){return this.filter(ol)},Wi.prototype.find=function(e){return this.filter(e).head()},Wi.prototype.findLast=function(e){return this.reverse().find(e)},Wi.prototype.invokeMap=Zr((function(e,t){return"function"==typeof e?new Wi(this):this.map((function(i){return Lr(i,e,t)}))})),Wi.prototype.reject=function(e){return this.filter(Ns(un(e)))},Wi.prototype.slice=function(e,t){e=fa(e);var i=this;return i.__filtered__&&(e>0||t<0)?new Wi(i):(e<0?i=i.takeRight(-e):e&&(i=i.drop(e)),t!==o&&(i=(t=fa(t))<0?i.dropRight(-t):i.take(t-e)),i)},Wi.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Wi.prototype.toArray=function(){return this.take(v)},Er(Wi.prototype,(function(e,t){var i=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),n=zi[r?"take"+("last"==t?"Right":""):t],s=r||/^find/.test(t);n&&(zi.prototype[t]=function(){var t=this.__wrapped__,a=r?[1]:arguments,l=t instanceof Wi,c=a[0],u=l||Ys(t),h=function(e){var t=n.apply(zi,Nt([e],a));return r&&d?t[0]:t};u&&i&&"function"==typeof c&&1!=c.length&&(l=u=!1);var d=this.__chain__,p=!!this.__actions__.length,g=s&&!d,f=l&&!p;if(!s&&u){t=f?t:new Wi(this);var v=e.apply(t,a);return v.__actions__.push({func:gs,args:[h],thisArg:o}),new Gi(v,d)}return g&&f?e.apply(this,a):(v=this.thru(h),g?r?v.value()[0]:v.value():v)})})),St(["pop","push","shift","sort","splice","unshift"],(function(e){var t=Re[e],i=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);zi.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var o=this.value();return t.apply(Ys(o)?o:[],e)}return this[i]((function(i){return t.apply(Ys(i)?i:[],e)}))}})),Er(Wi.prototype,(function(e,t){var i=zi[t];if(i){var r=i.name+"";Ne.call(Ri,r)||(Ri[r]=[]),Ri[r].push({name:t,func:i})}})),Ri[jo(o,2).name]=[{name:"wrapper",func:o}],Wi.prototype.clone=function(){var e=new Wi(this.__wrapped__);return e.__actions__=Lo(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Lo(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Lo(this.__views__),e},Wi.prototype.reverse=function(){if(this.__filtered__){var e=new Wi(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},Wi.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,i=Ys(e),r=t<0,o=i?e.length:0,n=function(e,t,i){var r=-1,o=i.length;for(;++r<o;){var n=i[r],s=n.size;switch(n.type){case"drop":e+=s;break;case"dropRight":t-=s;break;case"take":t=_i(t,e+s);break;case"takeRight":e=yi(e,t-s)}}return{start:e,end:t}}(0,o,this.__views__),s=n.start,a=n.end,l=a-s,c=r?a:s-1,u=this.__iteratees__,h=u.length,d=0,p=_i(l,this.__takeCount__);if(!i||!r&&o==l&&p==l)return fo(e,this.__actions__);var g=[];e:for(;l--&&d<p;){for(var f=-1,v=e[c+=t];++f<h;){var m=u[f],y=m.iteratee,_=m.type,E=y(v);if(2==_)v=E;else if(!E){if(1==_)continue e;break e}}g[d++]=v}return g},zi.prototype.at=fs,zi.prototype.chain=function(){return ps(this)},zi.prototype.commit=function(){return new Gi(this.value(),this.__chain__)},zi.prototype.next=function(){this.__values__===o&&(this.__values__=pa(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?o:this.__values__[this.__index__++]}},zi.prototype.plant=function(e){for(var t,i=this;i instanceof Ui;){var r=zn(i);r.__index__=0,r.__values__=o,t?n.__wrapped__=r:t=r;var n=r;i=i.__wrapped__}return n.__wrapped__=e,t},zi.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof Wi){var t=e;return this.__actions__.length&&(t=new Wi(this)),(t=t.reverse()).__actions__.push({func:gs,args:[ts],thisArg:o}),new Gi(t,this.__chain__)}return this.thru(ts)},zi.prototype.toJSON=zi.prototype.valueOf=zi.prototype.value=function(){return fo(this.__wrapped__,this.__actions__)},zi.prototype.first=zi.prototype.head,Xe&&(zi.prototype[Xe]=function(){return this}),zi}();ft._=mi,(r=function(){return mi}.call(t,i,t,e))===o||(e.exports=r)}.call(this)},3950:e=>{e.exports=function(){}},9063:(e,t,i)=>{var r=i(5765);e.exports=function(e,t){return t="function"==typeof t?t:void 0,e&&e.length?r(e,void 0,t):[]}},5072:e=>{"use strict";var t=[];function i(e){for(var i=-1,r=0;r<t.length;r++)if(t[r].identifier===e){i=r;break}return i}function r(e,r){for(var n={},s=[],a=0;a<e.length;a++){var l=e[a],c=r.base?l[0]+r.base:l[0],u=n[c]||0,h="".concat(c," ").concat(u);n[c]=u+1;var d=i(h),p={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==d)t[d].references++,t[d].updater(p);else{var g=o(p,r);r.byIndex=a,t.splice(a,0,{identifier:h,updater:g,references:1})}s.push(h)}return s}function o(e,t){var i=t.domAPI(t);i.update(e);return function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;i.update(e=t)}else i.remove()}}e.exports=function(e,o){var n=r(e=e||[],o=o||{});return function(e){e=e||[];for(var s=0;s<n.length;s++){var a=i(n[s]);t[a].references--}for(var l=r(e,o),c=0;c<n.length;c++){var u=i(n[c]);0===t[u].references&&(t[u].updater(),t.splice(u,1))}n=l}}},7659:e=>{"use strict";var t={};e.exports=function(e,i){var r=function(e){if(void 0===t[e]){var i=document.querySelector(e);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(e){i=null}t[e]=i}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(i)}},540:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},5056:(e,t,i)=>{"use strict";e.exports=function(e){var t=i.nc;t&&e.setAttribute("nonce",t)}},7825:e=>{"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(i){!function(e,t,i){var r="";i.supports&&(r+="@supports (".concat(i.supports,") {")),i.media&&(r+="@media ".concat(i.media," {"));var o=void 0!==i.layer;o&&(r+="@layer".concat(i.layer.length>0?" ".concat(i.layer):""," {")),r+=i.css,o&&(r+="}"),i.media&&(r+="}"),i.supports&&(r+="}");var n=i.sourceMap;n&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(n))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,i)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},1113:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var i=__webpack_module_cache__[e]={id:e,loaded:!1,exports:{}};return __webpack_modules__[e].call(i.exports,i,i.exports,__webpack_require__),i.loaded=!0,i.exports}__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var i in t)__webpack_require__.o(t,i)&&!__webpack_require__.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),__webpack_require__.nc=void 0;var __webpack_exports__={};(()=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{AecModelData:()=>$,AvatarExtension:()=>li,CanvasBookmarkExtension:()=>ze,DisciplinesExtension:()=>ar,DropMeExtension:()=>Me,FloorSelector:()=>L,HyperlinkExtension:()=>ue,HyperlinkTracker:()=>ae,Hypermodeling:()=>Ot,LevelsExtension:()=>re,ListPanel:()=>z,ListPanelEvents:()=>F,Locations:()=>Nt(),Minimap3DExtension:()=>Pt,SheetSyncExtension:()=>vi,TopViewRendererExtension:()=>Li,ViewportsExtension:()=>Ui});var e=__webpack_require__(5072),t=__webpack_require__.n(e),i=__webpack_require__(7825),r=__webpack_require__.n(i),o=__webpack_require__(7659),n=__webpack_require__.n(o),s=__webpack_require__(5056),a=__webpack_require__.n(s),l=__webpack_require__(540),c=__webpack_require__.n(l),u=__webpack_require__(1113),h=__webpack_require__.n(u),d=__webpack_require__(5684),p={};p.styleTagTransform=h(),p.setAttributes=a(),p.insert=n().bind(null,"head"),p.domAPI=r(),p.insertStyleElement=c();t()(d.A,p);d.A&&d.A.locals&&d.A.locals;var g=__webpack_require__(9392),f={};f.styleTagTransform=h(),f.setAttributes=a(),f.insert=n().bind(null,"head"),f.domAPI=r(),f.insertStyleElement=c();t()(g.A,f);g.A&&g.A.locals&&g.A.locals;var v=__webpack_require__(4574),m={};m.styleTagTransform=h(),m.setAttributes=a(),m.insert=n().bind(null,"head"),m.domAPI=r(),m.insertStyleElement=c();t()(v.A,m);v.A&&v.A.locals&&v.A.locals;const y=AutodeskNamespace("Autodesk.AEC");class _{constructor(e){this._viewer=e,this._dbIdsToUnhide=new Map,this._cache={}}filter(e,t){if(!e)throw new Error("floorFilterData cannot be undefined.");if(!(e.modelsDbIds instanceof Map))throw new Error("floorFilterData.modelsDbIds has to be a Map.");if(!t)throw new Error("floor cannot be undefined.");const i=this._getLevelHeightFactor(e.levelHeightFactor);let r=e.modelsDbIds;if(!this._hasModelDbIds(r))return;const o=t.zMin,n=t.zMax,s=o+(n-o)*i,a=n+.1*(n-o);this._cache[t.name]||(this._cache[t.name]={});const l=this._viewer.impl.modelQueue().getModels();for(let e=0,i=l.length;e<i;e++){const i=l[e];if(!i.visibilityManager){console.warn(`The VisibilityManager of the model with ID = ${i.id} is not yet initialized.`);break}if(this._cache[t.name][i.id]){const e=this._cache[t.name][i.id];e.size>0&&this.hideDbIds(i,e);continue}const o=i.getInstanceTree();if(!o){console.warn(`The instanceTree of the model with ID = ${i.id} is not yet initialized.`);continue}let n=new Set;const c=r.get(i.id);c&&(c.forEach((e=>{let t=new Float32Array(6);o.getNodeBox(e,t);const i=t[2],r=t[5];(i>=s&&i<=a||r>=s&&r<=a||i<=s&&r>=a)&&n.add(e)})),n.size>0&&this.hideDbIds(i,n),this._cache[t.name][i.id]=n)}}hideDbIds(e,t){if(e.visibilityManager)if(t.forEach((t=>{e.visibilityManager.setNodeOff(t,!0)})),this._dbIdsToUnhide.has(e)){const t=this._dbIdsToUnhide.get(e);for(let e of t)t.add(e)}else this._dbIdsToUnhide.set(e,t)}clearFilter(){0!==this._dbIdsToUnhide.size&&this._dbIdsToUnhide.forEach(function(e,t){t.visibilityManager&&(e.forEach((e=>{t.visibilityManager.setNodeOff(e,!1)})),this._dbIdsToUnhide.delete(t))}.bind(this))}unhideModel(e){this._dbIdsToUnhide.delete(e)}_hasModelDbIds(e){if(0===e.size)return!1;for(let t of e.values())if(t&&t.length>0)return!0;return!1}_getLevelHeightFactor(e){if(void 0===e)return.5;if("number"!=typeof e)throw new Error("floorFilterData.levelHeightFactor has to be a number");if(e<0||e>=1)throw new Error("floorFilterData.levelHeightFactor has to be a number between 0-1.");return e}reApplyFilter(e){const t=this._dbIdsToUnhide.get(e),i=e.visibilityManager;t&&i&&t.forEach((e=>{i.setNodeOff(e,!0)}))}isVisible(e,t){const i=this._dbIdsToUnhide.get(e);return!i||!i.has(t)}}y.FloorSelectorFilter=_;const E=Autodesk.Viewing,A=Autodesk.Viewing.Private,x=AutodeskNamespace("Autodesk.AEC"),C=1e20,w=-C,b=0,M=1,T=2,V=void 0,S="Autodesk.AEC.FloorSelector";class L{constructor(e){E.EventDispatcher.prototype.apply(this),this._viewer=e,this._renderer=e.impl.renderer(),this._cameraMovedCB=this._interruptFading.bind(this),e.addEventListener(E.CAMERA_CHANGE_EVENT,this._cameraMovedCB),this._viewerResizeCB=this._onViewerResized.bind(this),e.addEventListener(E.VIEWER_RESIZE_EVENT,this._viewerResizeCB),this._renderOptionsChangedCB=this._onRenderOptionsChanged.bind(this),e.addEventListener(E.RENDER_OPTION_CHANGED_EVENT,this._renderOptionsChangedCB),this._floorSelectionFilterToBeUpdated=this._runFloorSelectorFilterEventHandler.bind(this),e.addEventListener(E.MODEL_ADDED_EVENT,this._floorSelectionFilterToBeUpdated),e.addEventListener(E.OBJECT_TREE_CREATED_EVENT,this._floorSelectionFilterToBeUpdated),this._modelUnloadingCB=this._runModelUnloadingEventHandler.bind(this),e.addEventListener(E.MODEL_UNLOADED_EVENT,this._modelUnloadingCB),this._floors=[],this._currentMode=T,this._hovering=!1,this._floorSectionMin=void 0,this._floorSectionMax=void 0,this._zMinAllModels=void 0,this._zMaxAllModels=void 0,this._floorAnim=null,this._fadeAnim=null,this._ghostFloorOpacity=0,this._currentFloor=void 0,this._aoVisible=!0,this._aoOpacity=void 0,this._floorSelectorFilter=new _(this._viewer),this._floorFilterData=void 0,this._floorRollOverActive=!1,this._fadeEnabled=!0,this.enabled=!0,this.offscreenRenderBudget=void 0,this.fadingTime=.5}dtor(){this._viewer&&(this._viewer.removeEventListener(E.CAMERA_CHANGE_EVENT,this._cameraMovedCB),this._viewer.removeEventListener(E.VIEWER_RESIZE_EVENT,this._viewerResizeCB),this._viewer.removeEventListener(E.RENDER_OPTION_CHANGED_EVENT,this._renderOptionsChangedCB),this._viewer.removeEventListener(E.OBJECT_TREE_CREATED_EVENT,this._floorSelectionFilterToBeUpdated),this._viewer.removeEventListener(E.MODEL_ADDED_EVENT,this._floorSelectionFilterToBeUpdated),this._viewer.removeEventListener(E.MODEL_UNLOADED_EVENT,this._modelUnloadingCB),this._viewer=null)}get floorData(){return this._floors}set floorData(e){this.resetState(),this._floors=Array.isArray(e)?e:[],this.fireEvent({type:L.FLOOR_DATA_CHANGED,floorData:this._floors})}resetState(){this._floors=[],this._selectFloor(V),this._clearFloorSection(),this._floorSelectorFilter.clearFilter()}get floorFilterData(){return this._floorFilterData}set floorFilterData(e){this._floorFilterData=e}enterHoverMode(){this._currentMode!==M&&this._setMode(b),this._hovering=!0}exitHoverMode(e){(this._currentMode!==M||e)&&this._setMode(T),this._hovering=!1,this._setSpatialFilterForRollOver()}setPanelHoverEffectEnabled(e){this.exitHoverMode(!0),this._skipFadeAnimations(),this._fadeEnabled=e}_getFadeExtension(){return this._fadeEnabled&&this._viewer.getExtension("Autodesk.CrossFadeEffects")}_ghostFloorsEnabled(){return Boolean(this._getFadeExtension())}rollOverFloor(e){const t=this._ghostFloorsEnabled()||this._currentFloor===V,i=this._renderer.spatialFilterForRollOverSupported();if(void 0===e||!i||!t)return this._setSpatialFilterForRollOver(),void this._renderer.rolloverObjectId(0);this._renderer.rolloverObjectId(1),this._setSpatialFilterForRollOver(e),this._viewer.impl.invalidate(!1,!0,!0)}selectFloor(e,t){this.floorSelectionValid(e)&&(t?this._moveToFloor(e):this._selectFloor(e),this._runFloorSelectorFilter(),this._ghostFloorsEnabled()||this.rollOverFloor(),this.fireEvent({type:L.SELECTED_FLOOR_CHANGED,levelIndex:e}))}get currentFloor(){return this._currentFloor}floorSelectionValid(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V;return!(!Number.isInteger(e)&&e!==V||!this.floorData||0===this.floorData.length||this.currentFloor===e||!(e===V||e>=0||this.floorData.length>e))}isVisible(e,t){this._tmpNodeBox||(this._tmpNodeBox=new Float32Array(6));const i=this._floors[this._currentFloor];if(i===V)return!0;const r=e.getInstanceTree();if(!r)return!0;let o=this._tmpNodeBox;r.getNodeBox(t,o);const n=o[2],s=o[5];return!(n>i.zMax||s<i.zMin)&&this._floorSelectorFilter.isVisible(e,t)}setEnabled(e){this.enabled=e,this._applySelectedFloorSection()}_stopFloorAnim(){this._floorAnim&&(this._floorAnim.stop(),this._floorAnim=null)}_stopFadeAnim(){this._fadeAnim&&(this._fadeAnim.stop(),this._fadeAnim=null)}_skipFadeAnimations(){this._fadeAnim&&(this._fadeAnim.skip(),this._fadeAnim=null),this._floorAnim&&(this._floorAnim.skip(),this._floorAnim=null)}_leaveHoverMode(){this._viewer.impl.isWebGPU()&&this._renderer.disableSpatialFilterForRollOver();let e=this._getFadeExtension();e&&(e.releaseFadingImage(0),e.releaseFadingImage(1),e.setModelTargetIndexForAll(void 0),this._applySelectedFloorSection(),this._setAOVisible(!0))}_interruptFading(){!this._hovering&&this._fadeAnim&&this._fadeAnim.isRunning&&(this._stopFadeAnim(),this._leaveHoverMode())}_onViewerResized(){this.forceImageRefresh()}forceImageRefresh(){const e=this._hovering;this.exitHoverMode(),this._skipFadeAnimations(),e&&(this.enterHoverMode(),this._skipFadeAnimations())}_onRenderOptionsChanged(){this._floorRollOverActive&&!this._renderer.spatialFilterForRollOverSupported()&&this.rollOverFloor()}_getVisibleModels(){return this._viewer.impl.modelQueue().getModels()}_updateZLimits(){const e=this._getVisibleModels();this._zMinAllModels=C,this._zMaxAllModels=w;for(let t=0;t<e.length;t++){const i=e[t].getBoundingBox();this._zMinAllModels=Math.min(i.min.z,this._zMinAllModels),this._zMaxAllModels=Math.max(i.max.z,this._zMaxAllModels)}this._zMinAllModels>this._zMaxAllModels&&(this._zMinAllModels=w,this._zMaxAllModels=C)}_getBlendAOOpacity(){if(this._viewer.impl.isWebGPU())return 0;return this._renderer.getBlendPass().uniforms.aoOpacity.value}_setAOVisible(e){if(e===this._aoVisible)return;this._aoVisible=e;let t=0;if(e){0!==this._getBlendAOOpacity()&&console.warn("ao opacity should not be changed while FloorSelector is in use."),t=this._aoOpacity}else this._aoOpacity=this._getBlendAOOpacity();this._renderer.setAOOptions(this._renderer.getAORadius(),this._renderer.getAOIntensity(),t)}_setGhostFloorOpactiy(e){const t=this._getFadeExtension();t&&t.setCrossFadeOpacity(1,e),this._ghostFloorOpacity=e}_setSpatialFilterForRollOver(e){let t;const i=this._floors[e],r=(e,t)=>"bool spatialFilter(vec3 worldPos) { return (worldPos.z >= float("+e+") && worldPos.z <= float("+t+")); }",o=[C,w];i?(t=r(i.zMin,i.zMax),o[0]=i.zMin,o[1]=i.zMax):e===L.AllFloors&&(t=r(this._zMinAllModels,this._zMaxAllModels),o[0]=this._zMinAllModels,o[1]=this._zMaxAllModels),this._renderer.setSpatialFilterForRollOver(t,o);const n=this._getFadeExtension();n&&n.crossFade.setSaoHeuristicEnabled(!t),this._floorRollOverActive=!!t}_applyFloorSection(e,t){if(!this.enabled)return void this._viewer.impl.setCutPlaneSet(S,null);Number.isFinite(e)||(e=w),Number.isFinite(t)||(t=C);const i=[new THREE.Vector4(0,0,-1,e),new THREE.Vector4(0,0,1,-t)];this._viewer.impl.setCutPlaneSet(S,i)}_applySelectedFloorSection(){const e=void 0!==this._floorSectionMin?this._floorSectionMin:w,t=void 0!==this._floorSectionMax?this._floorSectionMax:C;this._applyFloorSection(e,t)}_setFloorSection(e,t){this._floorSectionMin=isNaN(e)?void 0:e,this._floorSectionMax=isNaN(t)?void 0:t,this._applySelectedFloorSection()}_clearFloorSection(){this._updateZLimits(),this._applyFloorSection()}_setMode(e){if(e!==this._currentMode)if(this._currentMode=e,e===b){const e=this._getFadeExtension();if(e){e.acquireControl("FloorSelector",(()=>this._interruptFading())),e.setModelTargetIndexForAll(void 0),this._applySelectedFloorSection(),this._renderer.rolloverObjectId(0),this._setAOVisible(!0),e.renderFadingImage(0,this.offscreenRenderBudget),e.setCrossFadeOpacity(0,1),this._clearFloorSection(),e.setModelTargetIndexForAll(1),this._setAOVisible(!1),this._stopFadeAnim();const t=this._setGhostFloorOpactiy.bind(this);this._fadeAnim=A.fadeValue(this._ghostFloorOpacity,.2,this.fadingTime,t)}}else if(e===M){const e=this._getFadeExtension();e&&(e.setClearEnabled(1,!1),e.setClearEnabled(0,!0),e.setModelTargetIndexForAll(0),e.setCrossFadeOpacity(0,1)),this._setAOVisible(!0),this._applySelectedFloorSection()}else if(e===T){this._stopFadeAnim();const e=this._setGhostFloorOpactiy.bind(this),t=this._leaveHoverMode.bind(this);this._fadeAnim=A.fadeValue(this._ghostFloorOpacity,0,this.fadingTime,e,t)}}_moveToFloor(e){this._currentFloor=e,this._setMode(M);const t=this._floors[e];this._updateZLimits();const i=void 0===this._floorSectionMin?this._zMinAllModels:this._floorSectionMin,r=void 0===this._floorSectionMax?this._zMaxAllModels:this._floorSectionMax,o=t?t.zMin:this._zMinAllModels,n=t?t.zMax:this._zMaxAllModels;this._stopFloorAnim(),this._floorAnim=A.fadeValue(0,1,this.fadingTime,(e=>{const t=A.smootherStep(e),s=A.lerp(i,o,t),a=A.lerp(r,n,t);this._setFloorSection(s,a);const l=this._renderer.getBlendHighlightIntensity();this._renderer.setBlendHighlightIntensity(Math.min(l,1-t))}),(()=>{const e=this._hovering?b:T;this._setMode(e)}))}_selectFloor(e){this._stopFloorAnim(),this._currentFloor=e;const t=this._floors[e],i=t?t.zMin:void 0,r=t?t.zMax:void 0;this._setFloorSection(i,r)}_runFloorSelectorFilter(){if(this._floorSelectorFilter.clearFilter(),this._floorFilterData&&void 0!==this._currentFloor){const e=this._floors[this._currentFloor];this._floorSelectorFilter.filter(this._floorFilterData,e)}}_runFloorSelectorFilterEventHandler(e){e.model.isObjectTreeLoaded()&&(this._floorFilterData&&void 0!==this._currentFloor?this._runFloorSelectorFilter():this._floorSelectorFilter.clearFilter())}_runModelUnloadingEventHandler(e){this._floorFilterData&&void 0!==this._currentFloor&&this._floorSelectorFilter.unhideModel(e.model)}invalidateFloorSelection(e){this._selectFloor(e),this._runFloorSelectorFilter()}}L.AllFloors=-1,L.NoFloor=V,L.SELECTED_FLOOR_CHANGED="selectedFloorChanged",L.FLOOR_DATA_CHANGED="floorDataChanged",x.FloorSelector=L;class R{constructor(e,t,i,r,o,n){this.index=e,this.name=i,this.zMin=r,this.zMax=o,this.guid=t,this.isArtificialLevel=n}}function P(e){let t=e.extension;return t&&Object.prototype.hasOwnProperty.call(t,"projectElevation")?t.projectElevation:e.elevation}function D(e,t){let i=new THREE.Vector3;const r=e=>(i.set(0,0,e),i.applyMatrix4(t),i.z);e.forEach((e=>{e.zMin=r(e.zMin),e.zMax=r(e.zMax)}))}const O=1/12;function I(e,t,i){const r=e.levels.filter((e=>{let t=e.extension;return!t||(!Object.prototype.hasOwnProperty.call(t,"buildingStory")||t.buildingStory)}));let o=[];const n=r.length;return r.forEach(((e,t)=>{let i;if(t+1<n)i=P(r[t+1]);else{const e=r[r.length-1];i=P(e)+e.height}o.push(new R(o.length,e.guid,e.name,P(e)-O,i))})),t?D(o,t):function(e,t){if(!t)return;D(e,Autodesk.Viewing.BubbleNode.readMatrixFromArray12(t))}(o,e.refPointTransformation),i&&D(o,i),o}function N(e,t){let i=e.impl.modelQueue().getModels(),r=null,o=-1;return i.forEach((e=>{if(e.is2d())return;let i=e.getDocumentNode();if(i){if(!t){if(!i.getAecModelData())return}i.data.size>o?(r=e,o=i.data.size):i.data.size||-1!==o||(r=e,o=0)}})),r}var k=Autodesk.Viewing,B=Autodesk.Viewing.UI,F={ITEM_SELECT:"itemSelect",ITEM_VISIBILITY_CHANGED:"itemVisibibilityChanged",ITEM_MOUSE_ENTER:"itemMouseEnter",ITEM_MOUSE_LEAVE:"itemMouseLeave"};function z(e,t,i,r){B.DockingPanel.call(this,e,t,i,r),k.EventDispatcher.prototype.apply(this),this.container.classList.add("list-panel"),this.container.dockRight=!0,this.createScrollContainer({left:!1,heightAdjustment:65,marginTop:0})}z.prototype=Object.create(B.DockingPanel.prototype),z.prototype.setItems=function(e){this.buttons=[],this.items=e,this.listDiv&&this.scrollContainer.removeChild(this.listDiv);var t=this.getDocument();this.listDiv=t.createElement("div"),this.listDiv.classList.add("itemList"),this.scrollContainer.appendChild(this.listDiv);for(var i=this,r=function(e){var r=i._getItemText?i._getItemText(e):"<no item text>",o=t.createElement("div");o.classList.add("listItem"),o.item=e,o.setAttribute("title",r),o.addEventListener("click",(function(){i.fireEvent({type:F.ITEM_SELECT,item:e})})),o.addEventListener("mouseenter",(function(){i.fireEvent({type:F.ITEM_MOUSE_ENTER,item:e}),o.classList.add("hover")})),o.addEventListener("mouseleave",(function(){i.fireEvent({type:F.ITEM_MOUSE_LEAVE,item:e}),o.classList.remove("hover")}));var n=t.createElement("span");n.innerHTML=r,n.classList.add("text");var s=t.createElement("div");if(s.classList.add("textContainer"),s.appendChild(n),o.appendChild(s),i.options.enableWarningSymbol){var a=t.createElement("span");a.classList.add("list-panel-item-warning"),o.appendChild(a),o.warnSpan=a}if(i.options.enableCheckmark){var l=t.createElement("span");l.classList.add("icon"),o.appendChild(l)}if(i.options.enableVisibilityToggle){var c=t.createElement("div");c.classList.add("visibility"),o.appendChild(c),c.addEventListener("click",(function(){const e=!i._isVisible||i._isVisible(o.item);i.fireEvent({type:F.ITEM_VISIBILITY_CHANGED,item:o.item,visible:!e}),i.updateItemStates()}))}return o},o=0;o<e.length;o++){var n=r(e[o]);this.listDiv.appendChild(n),this.buttons.push(n)}this.updateItemStates()},z.prototype.rollOverItem=function(e){for(var t=0;t<this.buttons.length;t++){var i=this.buttons[t];e(i.item)?i.classList.add("hover"):i.classList.remove("hover")}},z.prototype.updateItemStates=function(){if(this.buttons)for(var e=0;e<this.buttons.length;e++){var t=this.buttons[e];if(t.classList.remove("selected"),this._isSelected&&this._isSelected(t.item)&&t.classList.add("selected"),this.options.enableWarningSymbol){var i=this._getWarningText&&this._getWarningText(t.item);t.warnSpan.style.visibility=i?"visible":"hidden",t.warnSpan.setAttribute("title",i||"")}if(this.options.enableVisibilityToggle)t.classList.remove("dim"),!this._isVisible||this._isVisible(t.item)||t.classList.add("dim")}},z.prototype.setItemHandlers=function(e,t,i,r){this._isSelected=e,this._getItemText=t,this._getWarningText=i,this._isVisible=r,this.updateItemStates()},B.ListPanelEvents=F,B.ListPanel=z;const j=AutodeskNamespace("Autodesk.AEC"),U=["FloorPlan","CeilingPlan","EngineeringPlan"],G=(e,t,i,r,o,n,s,a)=>{let l=(s-o)/(i-e),c=(a-n)/(r-t),u=o-l*e,h=n-c*t,d=new THREE.Matrix4;return d.elements[0]=l,d.elements[5]=c,d.elements[10]=l,d.elements[12]=u,d.elements[13]=h,d},W=e=>.3048*(1/e),Y=(e,t)=>{const i=e.geometryViewportRegion;if(!i)return null;const r=W(t),o=.01;let n=new THREE.Box2;return n.min.x=(i[0]+o)*r,n.min.y=(i[1]+o)*r,n.max.x=(i[3]-o)*r,n.max.y=(i[4]-o)*r,n},H=(e,t)=>{if(!e.modelToSheetTransform)return null;const i=e.modelToSheetTransform,r=Autodesk.Viewing.BubbleNode.readMatrixFromArray12(i),o=W(t),n=(new THREE.Matrix4).makeScale(o,o,o);return r.multiplyMatrices(n,r),r},q=(e,t)=>{const i=Y(e,t),r=e.sectionBox,o=Autodesk.Viewing.BubbleNode.readMatrixFromArray12(r.transform);let n=G(i.min.x,i.min.y,i.max.x,i.max.y,0,0,1,1),s=(e=>{const t=new THREE.Matrix4;switch(e){case 0:return t;case 1:t.elements[0]=0,t.elements[4]=-1,t.elements[12]=1,t.elements[1]=1,t.elements[5]=0;break;case 2:t.elements[0]=0,t.elements[4]=1,t.elements[1]=-1,t.elements[5]=0,t.elements[13]=1;break;default:console.warn("Unexpected enum value for view rotation: ",e)}return t})(e.viewportRotation),a=G(0,0,1,1,r.min.x,r.min.y,r.max.x,r.max.y);return o.multiply(a).multiply(s).multiply(n)},K=e=>{const t=e instanceof Autodesk.Viewing.BubbleNode?e:e.getDocumentNode(),i=t.getAecModelData();return i&&i.viewports?i.viewports.filter((e=>e.sheetGuid===t.guid())):[]},Q=e=>{const t=e.extensions&&e.extensions.viewRange,i=t&&t.cutPlane;return i&&i.levelGuid},Z={},J=(e,t)=>{let i=t.myData.placementWithOffset;i||(i=new THREE.Matrix4);const r=new THREE.Box3;if(e.forEach(((o,n)=>{const s=((e,t,i)=>{const r=t.getData().instanceTree;if(!r)return;const o=((e,t)=>{const i=[],r=t=>{let o=0;e.enumNodeChildren(t,(e=>{r(e),o+=1})),0===o&&i.push(t)};r(t);const o=[];return i.forEach((t=>{e.enumNodeFragments(t,(e=>{o.push(e)}))})),o})(r,e),n=t.getFuzzyBox({allowlist:o});if(i.min.z!==1/0&&i.max.z>n.min.z){const e=Math.abs(n.max.z-n.min.z);Math.abs(i.max.z-i.min.z)>e?i.max.z=i.min.z:n.min.z=i.max.z}return i.copy(n),n})(o.dbId,t,r);s&&s.min.z!==1/0&&s.max.z!==1/0&&(o.elevation=s.min.z-(i?i.elements[14]:0),n===e.length-1?o.height=t.getBoundingBox().max.z-s.min.z:o.height=s.max.z-s.min.z)})),e.some((e=>!e.elevation)))return void console.warn("Failed to derive elevation for some levels");const o=[i.elements[0],i.elements[1],i.elements[2],i.elements[4],i.elements[5],i.elements[6],i.elements[8],i.elements[9],i.elements[10],i.elements[12],i.elements[13],i.elements[14]];return{version:"1.0.0",phases:[{name:"Default"}],levels:e,scopeBoxes:[],refPointTransformation:o}},X={get2DTo3DMatrix:(e,t)=>{const i=H(e,t);return i?i.invert():q(e,t)},get3DTo2DMatrix:(e,t)=>{let i=H(e,t);return i||(i=q(e,t),i.invert())},getViewportBounds:Y,remapRectangle:G,findSheetForViewport:(e,t)=>e.search(Autodesk.Viewing.BubbleNode.SHEET_NODE).find((e=>e.guid()===t.sheetGuid)),findViewportsForLevel:(e,t)=>(e.viewports||[]).filter((e=>Q(e)===t)),supports2DTo3DTransform:e=>{const t=Boolean(e.modelToSheetTransform),i=Boolean(e.sectionBox&&e.isCropBoxActive);if(!t&&!i)return!1;const r=[...U,"Section"];return Boolean(r.includes(e.viewType)&&e.geometryViewportRegion&&!e.hasBreaks&&!e.extensions.hasRegions)},getLinkedLevel:Q,findViewportsOnSheet:K,findViewportAtPoint:function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;console.warn("Please use ViewportExtension.findViewportAtPoint instead.");let r=K(e);i&&(r=r.filter(i)),r=r.map((t=>({viewport:t,bounds:Y(t,e.getUnitScale())})));if(r=r.filter((e=>e.bounds&&e.bounds.containsPoint(t))),!r.length)return;const o=(e,t)=>Math.min(Math.min(t.x-e.min.x,e.max.x-t.x),Math.min(t.y-e.min.y,e.max.y-t.y));return r.reduce(((e,i)=>{let r=o(e.bounds,t);return o(i.bounds,t)>r?i:e})).viewport},findLevelForViewport:(e,t)=>{const i=Q(t);return i&&e.levels.find((e=>e.guid===i))},computeAecModelDataForIfc:e=>{if(!e)return null;const t=e.getModelKey();if(Z[t])return Z[t];const i=new Promise((i=>{const r=r=>{if(!r||!r.length)return i(null);const o=J(r,e);t&&(Z[t]=Object.assign({},o)),i(o)},o=e=>{console.error(e),i(null)};e.isOTG()?((e,t,i)=>{const r="IFCBUILDING";i.search(r,(o=>{i.getBulkProperties(o,null,(o=>{const n=o.findIndex((e=>e.properties.find((e=>e.displayValue===r))));if(-1===n)return e(void 0);const s=o[n].properties.filter((e=>"child"===e.displayName)).map((e=>e.displayValue));i.getBulkProperties(s,["Name","Type"],(t=>{const i=t.map((e=>{const t=e.properties.find((e=>"Type"===e.displayName)),i=e.properties.find((e=>"Name"===e.displayName));if(t&&(t.displayValue.includes("Level")||"IfcBuildingStorey"===t.displayValue)&&i)return{guid:e.dbId.toString(),name:i.displayValue,dbId:e.dbId,extension:{buildingStory:!0,structure:!1,computationHeight:0,groundPlane:!1,hasAssociatedViewPlans:!1}}})).filter(Boolean);e(i)}),t)}),t)}),t,["Type"])})(r,o,e):((e,t,i)=>{i.search("IfcBuildingStorey",(r=>{i.getBulkProperties(r,["Type","GUID","NAME","Name","ELEVATION","Elevation","IfcElevation"],(t=>{const i=[];for(let e=0;e<t.length;e++)if(t[e].properties.length>1){const r=t[e].properties.findIndex((e=>"GUID"===e.displayName)),o=t[e].properties.findIndex((e=>"Levels: Level: Level 1"===e.displayValue));let n=-1,s=-1;if(o>=0?n=t[e].properties.findIndex((e=>("name"===e.attributeName.toLowerCase()||"LcOaNode:LcOaSceneBaseUserName"===e.attributeName)&&"Item"===e.displayCategory)):(n=t[e].properties.findIndex((e=>"name"===e.displayName.toLowerCase()&&("IFC"===e.displayCategory||"LcOaNode:LcOaSceneBaseUserName"===e.attributeName&&"Item"===e.displayCategory||"LcRevitData_Element:LcRevitPropertyElementName"===e.attributeName&&"Element"===e.displayCategory))),s=t[e].properties.findIndex((e=>"ELEVATION"===e.displayName&&"IFC"===e.displayCategory||("IfcElevation"===e.displayName||"Elevation"===e.displayName)&&"Element"===e.displayCategory))),n>=0&&(s>=0||o>=0)){const o=r>-1?t[e].properties[r].displayValue:t[e].dbId;i.push({guid:o.toString(),name:t[e].properties[n].displayValue,dbId:t[e].dbId,extension:{buildingStory:!0,structure:!1,computationHeight:0,groundPlane:!1,hasAssociatedViewPlans:!1}})}}e(i)}),t)}),t,["Type"])})(r,o,e)}));return t&&(Z[t]=i),i},TopViewViewportTypes:U,computeLevels:J},$=X;j.AecModelData=X;const ee=Autodesk.Viewing,te=ee.UI,ie=AutodeskNamespace("Autodesk.AEC");class re extends ee.Extension{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,t),this.container=this.options.panelUIContainers&&this.options.panelUIContainers.levelsPanel,this._onCameraMoved=this._onCameraMoved.bind(this),this.onItemMouseEnter=this.onItemMouseEnter.bind(this),this.onItemMouseLeave=this.onItemMouseLeave.bind(this),this.onItemSelected=this.onItemSelected.bind(this),this.updateFloorsData=this.updateFloorsData.bind(this),this.doNotCreateUI=t.doNotCreateUI,this._currentLevel=void 0}_onCameraMoved(){const e=this._mapCameraToLevel();e&&(this._currentLevel&&e.guid===this._currentLevel.guid||(this._currentLevel=e,this.viewer.dispatchEvent({type:re.LEVEL_CHANGED,level:e})))}_mapCameraToLevel(){const e=this.floorSelector.floorData;if(!e.length)return;const t=this.viewer.impl.camera.position.z;return t<e[0].zMin?e[0]:t>e[e.length-1].zMax?e[e.length-1]:e.find((e=>e.zMin<=t&&e.zMax>=t))}onToolbarCreated(){if(this.container)return;let e=this.viewer.getToolbar().getControl(ee.TOOLBAR.MODELTOOLSID);e&&this.levelsButton&&e.addControl(this.levelsButton)}onItemMouseEnter(e){let{item:t}=e;var i=t.index;i===this.floorSelector.currentFloor&&(i=L.AllFloors),this.floorSelector.rollOverFloor(i),this.hoveredFloor=i}onItemMouseLeave(e){let{item:t}=e;this.hoveredFloor===t.index&&(this.hoveredFloor=void 0,this.floorSelector.rollOverFloor(L.NoFloor))}onItemSelected(e){let{item:t}=e,i=t.index!==this.floorSelector.currentFloor?t.index:void 0;this.floorSelector.selectFloor(i,!0),void 0!==i||this.floorSelector._ghostFloorsEnabled()||this.floorSelector.rollOverFloor(t.index)}_createUI(){if(this.doNotCreateUI)return;this.levelsButton=new te.Button("toolbar-levelsTool"),this.levelsButton.setToolTip("Levels"),this.levelsButton.icon.innerHTML=oe();this.levelsPanel=new z(this.container||this.viewer.container,"LevelsPanel-"+this.viewer.id,"Levels",{enableCheckmark:!0}),this.levelsPanel.setGlobalManager(this.globalManager),this.container||this.viewer.addPanel&&this.viewer.addPanel(this.levelsPanel),this.levelsPanel.addVisibilityListener((e=>{this.levelsButton.setState(e?te.Button.State.ACTIVE:te.Button.State.INACTIVE)})),this.levelsPanel.closer.addEventListener("click",(()=>{this.onPanelVisibilityToggled&&this.onPanelVisibilityToggled(!1)})),this.levelsPanel.addEventListener(F.ITEM_MOUSE_ENTER,this.onItemMouseEnter),this.levelsPanel.addEventListener(F.ITEM_MOUSE_LEAVE,this.onItemMouseLeave),this.levelsPanel.addEventListener(F.ITEM_SELECT,this.onItemSelected),this.levelsPanel.container.addEventListener("mouseenter",(()=>this.floorSelector.enterHoverMode())),this.levelsPanel.container.addEventListener("mouseleave",(()=>this.floorSelector.exitHoverMode())),this.floorSelector.addEventListener(L.SELECTED_FLOOR_CHANGED,(()=>this.levelsPanel.updateItemStates())),this.levelsPanel.setItemHandlers((e=>e.index===this.floorSelector.currentFloor),(e=>e.text)),this.levelsButton.onClick=()=>{let e=!this.levelsPanel.isVisible();this.levelsPanel.setVisible(e),this.onPanelVisibilityToggled&&this.onPanelVisibilityToggled(e)}}setAecModelData(e,t,i){if(e!==this.aecModelData||t!==this.currentModel||i!==this.isDataInWorldCoords){this.aecModelData=e,this.isDataInWorldCoords=i,this.currentModel=t,this.updateFloorsData();for(var r=this.floorSelector.floorData,o=[],n=0;n<r.length;n++){let e=r[n];o.push({text:e.name,index:n})}o.reverse(),this.levelsPanel&&this.levelsPanel.setItems(o),this._updateOccluderData()}}setFloorDataTransform(e){this.floorDataTransform=e,this.updateFloorsData()}updateFloorsData(){const e=this.floorSelector.currentFloor;if(this.aecModelData){if(this.isDataInWorldCoords)this.floorSelector.floorData=this.aecModelData;else{var t,i;const e=(null===(t=this.currentModel)||void 0===t||null===(t=t.getData())||void 0===t?void 0:t.placementWithOffset)||this.floorDataTransform,r=null===(i=this.currentModel)||void 0===i?void 0:i.getModelTransform();this.floorSelector.floorData=I(this.aecModelData,e,r)}this.floorSelector.invalidateFloorSelection(e)}else this.floorSelector.floorData=[];this._onCameraMoved()}_updateOccluderData(){let e=this.aecModelData?function(e){let t=e.impl.modelQueue().getModels(),i=new Map;return t.forEach((e=>{if(e.is2d())return;let t=e.getDocumentNode();if(!t)return;let r=t.getAecModelData();r&&i.set(e.id,r.levelOccluderIds)})),{modelsDbIds:i}}(this.viewer):void 0;this.floorSelector.floorFilterData=e}async load(){return this.viewportsExtension=await this.viewer.loadExtension("Autodesk.AEC.ViewportsExtension"),this.floorSelector=new L(this.viewer),this.updateFloorSelector=async()=>{if(!this.floorSelector)return;if(!1!==this.options.autoDetectAecModelData){let e=!1;const t=N(this.viewer,!0),i=t&&t.getDocumentNode();let r=i&&await ee.Document.getAecModelData(i);if(t&&!t.getData())return;if(!r&&t&&"ifc"===t.getData().loadOptions.fileExt&&this.options.ifcLevelsEnabled&&(this.setAecModelData(void 0,t),r=await $.computeAecModelDataForIfc(t)),!r&&i&&!this.options.useOnlyAecModelDataViewports){const t=await this.viewportsExtension.generateLevelsFromViewports(i);t.length&&(r=t,e=!0)}this.setAecModelData(r,t,e)}this._updateOccluderData();var e=this.viewer.getVisibleModels().some((e=>e.is3d()));this.floorSelector.setEnabled(e)},this.viewer.addEventListener(ee.MODEL_ROOT_LOADED_EVENT,this.updateFloorSelector),this.viewer.addEventListener(ee.MODEL_UNLOADED_EVENT,this.updateFloorSelector),this.viewer.addEventListener(ee.MODEL_ADDED_EVENT,this.updateFloorSelector),this.viewer.addEventListener(ee.MODEL_TRANSFORM_CHANGED_EVENT,this.updateFloorsData),this.viewer.addEventListener(ee.CAMERA_CHANGE_EVENT,this._onCameraMoved),this.viewportsExtension.addEventListener(Autodesk.AEC.ViewportsExtension.Events.VIEWPORT_DATA_FETCHED_EVENT,this.updateFloorSelector),this._createUI(),this.updateFloorSelector(),!0}unload(){var e,t;return this.container||this.viewer.removePanel&&this.viewer.removePanel(this.levelsPanel),this.floorSelector.selectFloor(void 0,!1),null===(e=this.levelsPanel)||void 0===e||e.uninitialize(),this.levelsPanel=null,null===(t=this.levelsButton)||void 0===t||t.removeFromParent(),this.updateFloorSelector&&(this.viewer.removeEventListener(ee.MODEL_ROOT_LOADED_EVENT,this.updateFloorSelector),this.viewer.removeEventListener(ee.MODEL_UNLOADED_EVENT,this.updateFloorSelector),this.viewer.removeEventListener(ee.MODEL_ADDED_EVENT,this.updateFloorSelector),this.viewer.removeEventListener(ee.MODEL_TRANSFORM_CHANGED_EVENT,this.updateFloorsData),this.viewportsExtension.removeEventListener(Autodesk.AEC.ViewportsExtension.Events.VIEWPORT_DATA_FETCHED_EVENT,this.updateFloorSelector),this.updateFloorSelector=null),this.viewer.removeEventListener(ee.CAMERA_CHANGE_EVENT,this._onCameraMoved),this._currentLevel=null,this.floorSelector=null,this.aecModelData=null,this.currentModel=null,!0}getState(e){if(!this.viewer.model||this.viewer.model.is2d())return;const t=this.floorSelector.currentFloor;e.floorGuid=t?this.floorSelector.floorData[t].guid:null}restoreState(e){if(void 0!==e.floorGuid){if(e.floorGuid){const t=this.floorSelector.floorData.find((t=>t.guid===e.floorGuid));t&&this.floorSelector.selectFloor(t.index,!1)}else this.floorSelector.selectFloor(L.NoFloor,!1);return!0}}getCurrentLevel(){const e=this.floorSelector,t=e.floorData[e.currentFloor];return t||this._mapCameraToLevel()}getZRange(e){const t=this.floorSelector&&this.floorSelector.floorData[e],i=t.zMin+.5*(t.zMax-t.zMin),r=this.floorSelector.floorData[e-1];return{zMin:r?.5*(r.zMin+r.zMax):t.zMin,zMax:i}}}const oe=()=>['<svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">','<g stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">','<path d="M4 8 L12 3 L 20 8 L12 13Z"/>','<path d="M4 12 L12 17 L 20 12"/>','<path d="M4 16 L12 21 L 20 16"/>Ä',"</g>","</svg>"].join("");ie.LevelsExtension=re,re.LEVEL_CHANGED="levelChanged",Autodesk.Viewing.theExtensionManager.registerExtension("Autodesk.AEC.LevelsExtension",re);const ne=Autodesk.Viewing,se=Autodesk.Viewing.Private;function ae(e,t,i,r){ne.ToolInterface.call(this),this.names=["hyperlink-tracker"],e.toolController.registerTool(this);const o=e,n=i,s=r,a=[0,0];let l,c,u={},h=0,d=!1,p=!1;function g(){let e=u[a[1]];if(!e){const t=function(){const e=o.impl.modelQueue().getModels();return 1===e.length?e[0]:void 0}();t&&(e=u[t.id])}return e}function f(e){return e&&Object.keys(e).length>0}function v(e,t,i,r){const o=4*i;let n=t.stringBoxes[o+1],s=t.stringBoxes[o+3];const a=.2*(s-n);n-=a,s+=a;const l=t.stringBoxes[o]-a,c=t.stringBoxes[o+2]+a,u=t.stringDbIds[i],h=e.vcount,d=2009054015;e.addVertexPolytriangle(l,n,d,u,0,0),e.addVertexPolytriangle(c,n,d,u,0,0),e.addVertexPolytriangle(c,s,d,u,0,0),e.addVertexPolytriangle(l,s,d,u,0,0),e.addIndices([0,1,2,0,2,3],h),e.addSegment(l,n,c,n,0,-2*r,-4211905,u,0,0,0),e.addSegment(c,n,c,s,0,-2*r,-4211905,u,0,0,0),e.addSegment(c,s,l,s,0,-2*r,-4211905,u,0,0,0),e.addSegment(l,s,l,n,0,-2*r,-4211905,u,0,0,0)}function m(e){if(!e||!e.is2d())return;let t=u[e.id];if(t)return;const i=e.getDocumentNode(),r=i&&i.getRootNode(),n=r&&r.search({role:"2d",type:"geometry"});if(!n||!n.length)return;t=u[e.id]={};let a="";e.myData&&(a=e.myData.basePath);const l=n.map((function(e){const t=(e=>{if(e.children)for(const t of e.children)if("resource"===t.type()){const e=t.urn();if(e){let t=e.split("/");return t.pop(),t.join("/")}}return null})(e);if(-1===a.indexOf(t)){const t=e.name().split(" ")[0];if(t.length>2)return t}return""}));t.numHyperlinks=0;const c=new se.VertexBufferBuilder,h=1/(e.getData().loadOptions.modelScale||1),d=e.getData();for(let e=0;e<d.strings.length;e++){const i=l.indexOf(d.strings[e]);i>=0&&(t[d.stringDbIds[e]]=n[i],v(c,d,e,h),t.numHyperlinks++)}t.boxFragId=function(e,t){const i=e.getFragmentList().vizmeshes.length,r={mesh:t.toMesh(),is2d:!0,packId:"0",meshIndex:i},n=se.BufferGeometryUtils.meshToGeometry(r),s=o.impl.matman().create2DMaterial(e,{}),a=o.impl.setupMesh(e,n,s,e.getData().loadOptions.placementTransform);return e.activateFragment(i,a),i}(e,c),s&&s(e.id,t.numHyperlinks)}function y(e){m(e.model)}function _(e){let t=o.getAllModels();for(let i=0;i<t.length;i++){let r=t[i];r.is2d()&&r.isLoadDone()&&e(r)}}this.update=function(){if(o.model&&o.model.is2d()){if(p)h=0;else if(d){const e=o.impl.clientToViewport(l,c);h=o.impl.renderer().idAtPixel(e.x,e.y,a),d=!1}return!1}},this.handleSingleClick=function(){if(!o.model||!o.model.is2d())return;const e=o.impl.clientToViewport(l,c);h=o.impl.renderer().idAtPixel(e.x,e.y,a);const t=g(),i=f(t)?t[h]:null;return!!i&&(n(i,t.numHyperlinks),!0)},this.handleButtonDown=function(e){return p=!0,l=e.canvasX,c=e.canvasY,!1},this.handleButtonUp=function(){return p=!1,!1},this.handleMouseMove=function(e){return l=e.canvasX,c=e.canvasY,d=!0,!1},this.activate=function(){_((e=>{m(e)})),o.addEventListener(ne.GEOMETRY_LOADED_EVENT,y),o.impl.invalidate(!0,!0)},this.deactivate=function(){o.removeEventListener(ne.GEOMETRY_LOADED_EVENT,y),_((e=>{let t=u[e.id];t&&function(e,t){let i=e.getFragmentList();i.vizmeshes[t].geometry.dispose(),delete i.vizmeshes[t]}(e,t.boxFragId)})),u={},o.impl.invalidate(!0,!0)},this.getCursor=function(){const e=g();return h<-1&&f(e)&&e[h]?"pointer":null}}AutodeskNamespace("Autodesk.AEC").HyperlinkTracker=ae;const le=Autodesk.Viewing,ce=AutodeskNamespace("Autodesk.AEC");class ue extends le.Extension{constructor(e,t){super(e,t),this.hyperlinkTracker=new ae(this.viewer,this.options.rootBubbleNode,this.options.loadViewableCb,this.options.hyperlinksAddedCb)}load(){return this.viewer.toolController.activateTool("hyperlink-tracker"),!0}unload(){return this.viewer.toolController.deactivateTool("hyperlink-tracker"),!0}}ce.HyperlinkExtension=ue,Autodesk.Viewing.theExtensionManager.registerExtension("Autodesk.AEC.HyperlinkExtension",ue);const he=Autodesk.Viewing.Private;class de{constructor(e){this.viewer=e,this.overlayName="DropMeViewPortOverlay"}addOverlay(e,t,i,r){this.viewer.impl.createOverlayScene(this.overlayName);const o=this._createMesh(e,t,i,r);this.viewer.impl.addOverlay(this.overlayName,o)}removeOverlay(){this.viewer.impl.removeOverlayScene(this.overlayName)}_createMesh(e,t,i,r){const o=2581042694,n=.1;let s=new he.VertexBufferBuilder(!1,void 0,4);s.addSegment(e,t,i,t,0,n,o,-1,0,0),s.addSegment(i,t,i,r,0,n,o,-1,0,0),s.addSegment(i,r,e,r,0,n,o,-1,0,0),s.addSegment(e,r,e,t,0,n,o,-1,0,0);const a={mesh:s.toMesh(),is2d:!0,packId:"0",meshIndex:1},l=he.BufferGeometryUtils.meshToGeometry(a),c=this.viewer.impl.matman(),u=c.create2DMaterial(this.viewer.impl.model,{skipEllipticals:!0,skipCircles:!0,skipTriangleGeoms:!0,skipMiterLines:!0,useInstancing:!1}),h=c.findMaterial(this.viewer.impl.model,u);return new THREE.Mesh(l,h)}}const pe=Autodesk.Viewing,ge=pe.GlobalManagerMixin,fe="Auto",ve="Manual";class me extends pe.ToolInterface{constructor(e,t,i){super(),this.names=["drop-me"],this.viewer=e,this.setGlobalManager(this.viewer.globalManager),this.extension=i,this.options=i.options,void 0===this.options.teleportOnRelease&&(this.options.teleportOnRelease=!0),this.viewer.toolController.registerTool(this),this.onDrop=t,this.active=!1,this._movedSinceFirstClick=!1,this.init(),this.cameraSelectionState={pending:!1,pos:null,target:null,inViewport:!1,initialVp:null},this.teleportationInProgress=0,this.isFirstClick=!0,this.viewPortOverlay=new de(this.viewer),this.escapeHotkeyId="Autodesk.AEC.DropMeToolEsc"}init(){this.activate=()=>{const e=this.viewer.toolController.getTool("gestures");e&&e.setGestureParameter("drag","threshold",0);const t=[{keycodes:[Autodesk.Viewing.KeyCode.ESCAPE],onRelease:()=>this.options.triggerDeactivate()}];this.viewer.getHotkeyManager().pushHotkeys(this.escapeHotkeyId,t),this.viewer.addEventListener(pe.MODEL_ADDED_EVENT,this.options.triggerDeactivate),this.viewer.impl.pauseHighlight(!0),this.active=!0},this.deactivate=()=>{const e=this.viewer.toolController.getTool("gestures");e&&e.restoreGestureParameterDefault("drag","threshold"),this.viewer.getHotkeyManager().popHotkeys(this.escapeHotkeyId),this._cancelTeleportation(),this._destroyCameraSelectorUi(),this.viewer.removeEventListener(pe.MODEL_ADDED_EVENT,this.options.triggerDeactivate),this.viewer.impl.pauseHighlight(!1),this.active=!1,this._movedSinceFirstClick=!1},this.handleButtonDown=function(){return!0},this.handleButtonUp=function(){return!(!this._movedSinceFirstClick||this.isFirstClick)},this.handleSingleClick=(e,t)=>{if(this.isFirstClick){const i=this._get3DCameraPositionAndVp(e.canvasX,e.canvasY);i&&i.pos&&(this.cameraSelectionState.pos={x:e.canvasX,y:e.canvasY},this.cameraSelectionState.pending=!0,this.cameraSelectionState.initialVp=i.vp,this._createCameraSelectorUi(this.cameraSelectionState.pos),requestAnimationFrame((()=>{this._movedSinceFirstClick||this.cameraSelectorPosition.classList.add("camera-selector-position--teleporting")})),i.vp.isTopViewViewport()&&!t?(this._scheduleTeleportation(),this.isFirstClick=!1,this.cursor="none",this.getCursor()):this._runTeleportation(fe))}else this.options.teleportOnRelease&&this.teleport();return!0},this.teleport=()=>{this.cameraSelectionState.target={x:this.lastX,y:this.lastY},this._runTeleportation(ve),this.isFirstClick=this.options.teleportOnRelease,this._movedSinceFirstClick=!1,this._recoverCursor()},this.handleMouseMove=e=>{this.isFirstClick||this._movedSinceFirstClick||(this._movedSinceFirstClick=!0),this.cursor&&this._recoverCursor();const t=this._get3DCameraPositionAndVp(e.canvasX,e.canvasY);if(this.cameraSelectionState.initialVp&&!this.isFirstClick?this._addVpOverlay(this.cameraSelectionState.initialVp):t&&t.pos?this._addVpOverlay(t.vp):this.viewPortOverlay.removeOverlay(),this.cameraSelectionState.inViewport=this.isFirstClick&&t&&t.pos||!this.isFirstClick,this.getCursor(),!this.cameraSelectionState.pending)return;this.teleportationInProgress&&(this.cameraSelectorPosition.classList.remove("camera-selector-position--teleporting"),clearTimeout(this.teleportationInProgress),this.teleportationInProgress=0),this.lastX=e.canvasX,this.lastY=e.canvasY;const i=e.canvasX-this.cameraSelectionState.pos.x,r=e.canvasY-this.cameraSelectionState.pos.y;let o=180*Math.atan2(r,i)/Math.PI;return 0===i&&0===r||(o+=90),this.cameraSelector.style.transform=`rotate(${o}deg)`,this.options.teleportOnRelease||this.teleport(),!0},this.handleSingleTap=function(e){return this.handleSingleClick(e,!0)},this.handleResize=()=>{this.options.triggerDeactivate()},this.handleSingleTap=e=>{this.isFirstClick?this.handleSingleClick(e):this.handleMouseMove(e)},this.handleGesture=e=>{switch(e.type){case"dragstart":default:break;case"dragmove":return this.handleMouseMove(e,0);case"dragend":case"panmove":case"panstart":case"panend":case"pinchmove":case"pinchstart":case"pinchend":return!0}return!1}}_recoverCursor(){this.cursor=null,this.getCursor()}getCursor(){return this.cursor?this.cursor:this.cameraSelectionState.inViewport?"cell":"default"}_addVpOverlay(e){this.viewPortOverlay.removeOverlay();const t=e.getViewportBounds(this.viewer.model.getUnitScale()),i=t.min,r=t.max;this.viewPortOverlay.addOverlay(i.x,i.y,r.x,r.y)}_runTeleportation(e){this.extension.dispatchEvent({type:Autodesk.AEC.DropMeExtension.DROP_ME_STARTED_EVENT}),this._mapToCameraPositionIn3D(e),this.options.triggerDeactivate(!0)}_scheduleTeleportation(){this.teleportationInProgress=setTimeout((()=>{this._runTeleportation(fe)}),3e3)}_cancelTeleportation(){this.teleportationInProgress&&(clearTimeout(this.teleportationInProgress),this.teleportationInProgress=0)}_createCameraSelectorUi(e){const t=this.getDocument();this.cameraSelectorBackground=t.createElement("div"),this.cameraSelectorBackground.className="camera-selector-background",this.viewer.container.appendChild(this.cameraSelectorBackground),this.cameraSelectorBackground.style.top=`${e.y}px`,this.cameraSelectorBackground.style.left=`${e.x}px`,this.cameraSelectorPosition=t.createElement("div"),this.cameraSelectorPosition.className="camera-selector-position",this.viewer.container.appendChild(this.cameraSelectorPosition),this.cameraSelectorPosition.style.top=e.y-10+"px",this.cameraSelectorPosition.style.left=e.x-10+"px",this.cameraSelector=t.createElement("div"),this.cameraSelector.className="camera-selector",this.viewer.container.appendChild(this.cameraSelector),this.cameraSelector.style.top=e.y-100+"px",this.cameraSelector.style.left=e.x-50+"px"}_destroyCameraSelectorUi(){this.viewer.container.contains(this.cameraSelector)&&this.viewer.container.removeChild(this.cameraSelector),this.viewer.container.contains(this.cameraSelectorBackground)&&this.viewer.container.removeChild(this.cameraSelectorBackground),this.viewer.container.contains(this.cameraSelectorPosition)&&this.viewer.container.removeChild(this.cameraSelectorPosition),this.cameraSelectionState={pending:!1,pos:null,target:null,inViewport:!1,initialVp:null},this.isFirstClick=!0,this.viewPortOverlay.removeOverlay()}_findViewport(e){const t=new THREE.Vector2(e.x,e.y),i=this.viewer.model,r=this.extension.viewportsExtension.findViewportAtPoint(i,t,{onlyTopViewPlans:!0});return!this.options.useOnlyAecModelDataViewports||r instanceof Autodesk.AEC.ViewportsExtension.AecModelDataViewport?r:null}async _getOtgRoot(e){const t=this.viewer.getAllModels().find((t=>t.getDocumentNode()==e));if(t)return t.myData;const i=e.getRootNode(),r=i.getDocument().getViewablePath(e),o={acmSessionId:i.urn()};return await Autodesk.Viewing.Private.OtgLoader.loadOnlyOtgRoot(r,o)}async _getModelUnitsFromNode(e){const t=await this._getOtgRoot(e);if(t){var i;const e=null===(i=t.metadata)||void 0===i||null===(i=i["distance unit"])||void 0===i?void 0:i.value;if(e)return e}return"ft"}async _getMeterToModelScale(e){const t=await this._getModelUnitsFromNode(e);return 1/Autodesk.Viewing.Private.getUnitData(t).unitScale}async _mapToCameraPositionIn3DForFloorPlan(e,t,i){var r,o;const n=this.viewer.model.getDocumentNode();let s=null===(r=(o=this.options).getMain3DView)||void 0===r?void 0:r.call(o,n);const a=this.cameraSelectionState.target;s||(s=(await e.get3DNodesForViewport())[0]);const l=e.findLevelForViewport(),c=e.isFloorPlan();if(l&&c){const e=1.75*await this._getMeterToModelScale(s);t.z=l.elevation+e}let u=t;e.isMatrixInLocalCoords()&&(u=await this._applyModelToViewerTransform(t,s));let h=new THREE.Vector3(0,1,0);if(a){const t=a.x,i=a.y,r=this._get3DCameraPositionAndVp(t,i,!0);if(r&&r.pos){let t=r.pos;e.isMatrixInLocalCoords()&&(t=await this._applyModelToViewerTransform(r.pos,s));const i=t.x-u.x,o=t.y-u.y;0===i&&0===o||(h.setX(i).setY(o),h.normalize())}}const d=new THREE.Vector3(-h.y,h.x,0);h.applyAxisAngle(d,Math.PI/18),this.onDrop(u,h,i,s,!e.isMatrixInLocalCoords())}async _mapToCameraPositionIn3DForSection(e,t,i){var r,o;const n=this.viewer.model.getDocumentNode();let s=null===(r=(o=this.options).getMain3DView)||void 0===r?void 0:r.call(o,n);s||(s=(await e.get3DNodesForViewport())[0]);let a=t;e.isMatrixInLocalCoords()&&(t=await this._applyModelToViewerTransform(t,s));let l=new THREE.Vector3(0,1,0);const c=new THREE.Vector3(-l.y,l.x,0);l.applyAxisAngle(c,Math.PI/18),this.onDrop(a,l,i,s,!e.isMatrixInLocalCoords())}_mapToCameraPositionIn3D(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ve;const t=this.cameraSelectionState.pos.x,i=this.cameraSelectionState.pos.y,r=this._get3DCameraPositionAndVp(t,i);r&&r.pos&&r.vp&&(r.vp.isTopViewViewport()?this._mapToCameraPositionIn3DForFloorPlan(r.vp,r.pos,e):this._mapToCameraPositionIn3DForSection(r.vp,r.pos,fe))}_get3DCameraPositionAndVp(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=this.viewer.impl.clientToViewport(e,t),o=this.viewer.impl.intersectGroundViewport(r),n=this._findViewport(o)||i&&this.cameraSelectionState.initialVp;if(!n)return null;const s=this.viewer.model.getUnitScale();return{pos:this.sheetTo3DWorld(n,o,s),vp:n}}sheetTo3DWorld(e,t,i){const r=e.get2DTo3DMatrix(i);return t.clone().applyMatrix4(r)}async _applyModelToViewerTransform(e,t){let i,r=e.clone();if(this.options.useLocalModelCoords)return r;if(t&&this.options.getTransformForNode&&(i=await this.options.getTransformForNode(t)),!i){i=this.viewer.model.getDocumentNode().getRootNode().extractRefPointTransform()}return r.applyMatrix4(i),r}}ge.call(me.prototype);const ye=Autodesk.Viewing,_e=ye.Private,Ee="ViewObjectIn3D";class Ae{constructor(e,t,i){this.viewer=t,this.dropMeExt=e,this.options=i,this._onModelAdded=this._onModelAdded.bind(this),this._onGeometryLoaded=this._onGeometryLoaded.bind(this),this._onModelUnloaded=this._onModelUnloaded.bind(this),this._onAggregatedSelectionChanged=this._onAggregatedSelectionChanged.bind(this)}activate(){this.viewer.registerContextMenuCallback(Ee,(e=>{const t=this.viewer.model.is2d();var i=this.options.enableViewIn3d&&this.dropMeExt.isSupportedModel(this.viewer.model,!1,!0)&&this.viewer.getAggregateSelection();t&&i&&1===i.length&&1===i[0].selection.length&&(this.pos3dFrom2d=this._getSelected3dPosFrom2d(i[0].selection[0],i[0].model),e.push({title:"View object in 3D",target:()=>this.selectObject(i[0].selection[0])}))}))}deactivate(){this.viewer.unregisterContextMenuCallback(Ee)}selectObject(e){if(this.viewer.addEventListener(ye.MODEL_ADDED_EVENT,this._onModelAdded,{once:!0}),this.viewer.addEventListener(ye.GEOMETRY_LOADED_EVENT,this._onGeometryLoaded),this.viewer.addEventListener(ye.MODEL_UNLOADED_EVENT,this._onModelUnloaded),this.viewer.addEventListener(ye.AGGREGATE_SELECTION_CHANGED_EVENT,this._onAggregatedSelectionChanged),this.selectedObjectID=e,this.dropMeExt.dispatchEvent({type:Me.OBJECT_SELECTED_EVENT,selectedObjectID:e}),this.options.onDrop){var t,i;const e=this.viewer.model.getDocumentNode(),r=null===(t=(i=this.options).getMain3DView)||void 0===t?void 0:t.call(i,e);this.options.onDrop(void 0,void 0,void 0,r)}_e.analytics.track("viewer.view_in_3d")}_onAggregatedSelectionChanged(e){const t=e.selections&&1===e.selections.length&&e.selections[0];(t.dbIdArray&&1===t.dbIdArray.length&&t.dbIdArray[0])!==this.selectedObjectID&&e.selections.length&&(this.hidingObjectInterval&&clearInterval(this.hidingObjectInterval),this.viewer.removeEventListener(ye.GEOMETRY_LOADED_EVENT,this._onGeometryLoaded),this.viewer.removeEventListener(ye.AGGREGATE_SELECTION_CHANGED_EVENT,this._onAggregatedSelectionChanged),this.chosenPos=null,this.selectedObjectID=null)}_onModelAdded(e){let{model:t}=e;this.hidingObjectInterval&&clearInterval(this.hidingObjectInterval),this.selectedObjectID&&t.is3d()&&this._waitForAllModels().then((()=>this._placeMeToObject()))}_onModelUnloaded(){this.hidingObjectInterval&&clearInterval(this.hidingObjectInterval)}async _placeMeToObject(){this.isGeometryLoaded=this._loadingAllGeometriesDone();const e=this._getAllBoundingBoxes();if(this.selectionBox=e[this.selectedObjectID],!this.selectionBox){if(this.pos3dFrom2d){let e=this.pos3dFrom2d.clone().add(new THREE.Vector3(0,1,0));const t=this.dropMeExt.dropMeTool,i=this.viewer.model.getDocumentNode();this.pos3dFrom2d=await t._applyModelToViewerTransform(this.pos3dFrom2d,i),e=await t._applyModelToViewerTransform(e,i),this.options.onHandleViewIn3D?this.options.onHandleViewIn3D(this.pos3dFrom2d,e,!1):(console.warn("Legacy event. Do not use. Please use onHandleViewIn3D CB instead."),this.dropMeExt.dispatchEvent({type:Me.POSITION_FOUND_EVENT,position:this.pos3dFrom2d,target:e,isPosFrom2dTo3dMatrix:!0}))}return}this._setBoundingBoxPoints(),this.selectionCenter=this.selectionBox.getCenter(new THREE.Vector3),delete e[this.selectedObjectID];const t=this._createCandidates(),i=this._getCloseBoxesKeys(e),r=this._getBetterCandidates(t,e,i);this.chosenPos=this._chooseBestCandidate(r,e,i);const o=()=>this._applySelections(this.chosenPos);this.options.onHandleViewIn3D?this.options.onHandleViewIn3D(this.chosenPos.position,this.selectionCenter,!0,o):(console.warn("Legacy event. Do not use. Please use onHandleViewIn3D CB instead."),this.dropMeExt.dispatchEvent({type:Me.POSITION_FOUND_EVENT,position:this.chosenPos.position,target:this.selectionCenter,applySelectionCB:o})),this.isGeometryLoaded||this._waitForAllInstanceTrees().then((()=>{this.hidingObjectInterval&&clearInterval(this.hidingObjectInterval),this.hidingObjectInterval=setInterval((()=>this._hideCurrentIntersections()),Ae.HIDING_INTERVAL_FREQUENCY)}))}_getAllBoundingBoxes(){let e={};const t=this.viewer.getVisibleModels();for(let i=0;i<t.length;i++){const r=t[i].getFragmentList();e=Object.assign(e,this._getBoundingBoxes(r))}return e}_getBoundingBoxes(e){const t={},i=new THREE.Box3;for(let r=0;r<e.fragments.length;r++){const o=e.fragments.fragId2dbId[r];t[o]||(t[o]=new THREE.Box3),e.getWorldBounds(r,i),t[o].union(i)}return t}_createCandidates(){const e=this._getHeight(this.selectionCenter.z);this.maxDistance=Number.MIN_VALUE;const t=this.viewer.navigation.getWorldRightVector(),i=this.viewer.navigation.getWorldUpVector().cross(t),r=this.selectionBox.getSize(new THREE.Vector3),o=Math.abs(r.clone().multiply(t).length()),n=Math.abs(r.clone().multiply(i).length());let s;const a=Math.max(o,n);a/Math.min(o,n)>Ae.COVERAGE_FACTOR&&(s=a===o?t:i),this.viewer.navigation.toPerspective();const l=[],c=new THREE.Vector3;for(let t=0;t<Ae.NUMBER_OF_POSITION;++t){const i=t/(Ae.NUMBER_OF_POSITION/2)*Math.PI,r=this.selectionCenter.clone().add(new THREE.Vector3(Math.cos(i),-Math.sin(i),0)),o=this.viewer.navigation.getVerticalFov(),n=this.viewer.getCamera().aspect,a=this.viewer.navigation.computeFit(r,this.selectionCenter,o,this.selectionBox,n),{position:u}=a,h=u.clone().sub(this.selectionCenter);u.add(h.clone().multiplyScalar(.1)),u.z=e;let d=s&&h.normalize().dot(s),p=d&&Math.abs(d)>Math.cos(THREE.Math.degToRad(Ae.IGNORE_ANGLE));const g=this.selectionCenter.clone().sub(u.clone()),f=g.clone().normalize(),v=new THREE.Ray(u.clone(),f.clone()),m=v.intersectBox(this.selectionBox,c),y=m&&m.sub(u).length(),_=g.length();this.maxDistance=Math.max(this.maxDistance,y,_),y&&!p&&l.push({index:t,position:u,ray:v,distanceToTarget:y,distanceToCenterTarget:_,selectionID:this.selectedObjectID,intersections:[],cornerIntersections:[],cornerIntersectionsToHide:[]})}return l}_getClientViewBoundingBox(e){const t=new THREE.Box3;for(let i=0;i<this.boundingBoxPoints.length;i++){const r=this.boundingBoxPoints[i],o=this.viewer.impl.worldToClient(r,e);t.min.x>o.x&&(t.min.x=o.x),t.max.x<o.x&&(t.max.x=o.x),t.min.y>o.y&&(t.min.y=o.y),t.max.y<o.y&&(t.max.y=o.y)}return t}_setBoundingBoxPoints(){this.boundingBoxPoints=[];for(let e=0;e<8;e++){const t=new THREE.Vector3;t.x=!1==!!(1&e)?this.selectionBox.max.x:this.selectionBox.min.x,t.y=!1==!!(2&e)?this.selectionBox.max.y:this.selectionBox.min.y,t.z=!1==!!(4&e)?this.selectionBox.max.z:this.selectionBox.min.z,this.boundingBoxPoints.push(t)}}_getCloseBoxesKeys(e){const t=new THREE.Vector3;return Object.keys(e).filter((i=>e[i].getCenter(t).clone().sub(this.selectionCenter).length()<this.maxDistance*Ae.DISTANCE_FACTOR))}_getBetterCandidates(e,t,i){let r=[],o=Number.POSITIVE_INFINITY;for(let n=0;n<e.length;++n){const s=e[n];if(this.isGeometryLoaded){const e=[];s.intersections=[],this.viewer.impl.rayIntersect(s.ray,!1,!1,!1,e);let t=this._getClosestIntersectionWithSelectedObject(e);t?s.distanceToTarget=t:t=s.distanceToCenterTarget,e.forEach((e=>{e.dbId!==this.selectedObjectID&&-1===s.intersections.indexOf(e.dbId)&&e.distance<t&&s.intersections.push(e.dbId)}))}else s.intersections=this._getIntersectionsOfRayWithBoundingBoxes(s,s.ray,o,t,i);s.intersections.length===o?r.push(s):s.intersections.length<o&&(r=[s],o=s.intersections.length)}return r}_chooseBestCandidate(e,t,i){let r,o=Number.MAX_VALUE;return e.forEach((e=>{r=r||e;for(let r=0;r<this.boundingBoxPoints.length;r++){const n=this.boundingBoxPoints[r],s=n.clone().sub(this.selectionCenter).multiplyScalar(.1);n.sub(s);const a=n.clone().sub(e.position).normalize(),l=new THREE.Ray(e.position.clone(),a);let c=[];if(this.isGeometryLoaded){this.viewer.impl.rayIntersect(l,!1,!1,!1,c);const e=this._getClosestIntersectionWithSelectedObject(c);if(!e)continue;c=c.filter((t=>t.dbId!==this.selectedObjectID&&t.distance<=e)),c=c.map((e=>e.dbId))}else c=this._getIntersectionsOfRayWithBoundingBoxes(e,l,o,t,i);if(c.length&&(e.cornerIntersections.push(...c),e.cornerIntersections=[...new Set(e.cornerIntersections)],e.cornerIntersections.length>o))break;if(this.isGeometryLoaded){n.clone().sub(this.selectionCenter).dot(e.ray.direction)>0&&c.length&&(e.cornerIntersectionsToHide.push(...c),e.cornerIntersectionsToHide=[...new Set(e.cornerIntersections)])}}let n=e.cornerIntersections.length;this._isInsideOtherObject(e,t,i)&&n++,n<o?(o=n,r=e):n===o&&(e.distanceToCenterTarget===r.distanceToCenterTarget?e.distanceToTarget<r.distanceToTarget&&(r=e):e.distanceToCenterTarget<r.distanceToCenterTarget&&(r=e))})),r}_getIntersectionsOfRayWithBoundingBoxes(e,t,i,r,o){const n=[],s=o.length,a=new THREE.Vector3;for(let l=0;l<s;++l){const s=o[l],c=r[s],u=parseInt(s),h=c&&t.intersectBox(c,a),d=h&&e.position.clone().sub(h).length();if(d&&d<e.distanceToTarget&&(n.push(u),n.length>i))break}return n}_isInsideOtherObject(e,t,i){for(let r=0;r<i.length;++r){if(t[i[r]].containsPoint(e.position))return!0}return!1}_getClosestIntersectionWithSelectedObject(e){const t=e.filter((e=>e.dbId===this.selectedObjectID));let i=Number.MAX_VALUE;if(!t[0])return null;for(let e=0;e<t.length;e++)t[e].distance<i&&(i=t[e].distance);return i}_hideCurrentIntersections(e){if(!this.chosenPos)return;let t=!1;const i=[];this.viewer.impl.rayIntersect(this.chosenPos.ray,!1,!1,!1,i),t=this._hideIntersectionsCandidates(i,!0),e&&(t=this._hideCornersIntersections()||t),t&&this.viewer.impl.invalidate(!0,!0,!0)}_hideCornersIntersections(){let e=!1;for(let t=0;t<this.boundingBoxPoints.length;t++){const i=this.boundingBoxPoints[t];for(let t=0;t<Ae.NUMBER_OF_CORNER_INTERSECTIONS;t++){const r=[],o=i.clone().sub(this.selectionCenter).multiplyScalar(t/Ae.NUMBER_OF_CORNER_INTERSECTIONS);i.sub(o);const n=i.clone().sub(this.chosenPos.position).normalize(),s=new THREE.Ray(this.chosenPos.position.clone(),n);this.viewer.impl.rayIntersect(s,!1,!1,!1,r),e=this._hideIntersectionsCandidates(r)||e}}return e}_hideIntersectionsCandidates(e,t){const i=e.length;let r,o=!1;if(i>1&&(r=this._getClosestIntersectionWithSelectedObject(e),t&&r&&!this._isSelected(this.selectedObjectID)&&this.allTreesLoaded()&&this.viewer.select(this.selectedObjectID),t||r))for(let t=0;t<i;t++){const i=e[t];i.dbId!==this.selectedObjectID&&i.distance<(r||this.chosenPos.distanceToCenterTarget)&&(this.viewer.hide(i.dbId),o=!0)}return o}_isSelected(e){const t=this.viewer.getVisibleModels();for(let i=0;i<t.length;++i)if(t[i].selector.isSelected(e))return!0;return!1}_applySelections(e){if(e&&this.allTreesLoaded())if(this._isSelected(e.selectionID)||this.viewer.select(e.selectionID),this.isGeometryLoaded)this._hideCurrentIntersections(!0);else{for(let t=0;t<e.intersections.length;++t)this.viewer.hide(e.intersections[t]);for(let t=0;t<e.cornerIntersectionsToHide.length;++t)this.viewer.hide(e.cornerIntersectionsToHide[t])}}_getHeight(e){const t=this.viewer.model.getData().metadata["distance unit"].value||"foot",i=1.8/Autodesk.Viewing.Private.convertUnits(t,"m",1,1),r=I(this.viewer.model.getDocumentNode().getAecModelData(),this.viewer.model.myData.placementWithOffset);if(!r.length)return this.selectionBox.min.z+i;let o;return o=e<r[0].zMin?r[0]:e>r[r.length-1].zMax?r[r.length-1]:r.find((t=>t.zMin<=e&&t.zMax>=e)),o.zMin+i}_pending3DLoaders(){return!!this.viewer.impl.loaders.filter((e=>e.is3d())).length}_loadingAllGeometriesDone(){const e=this.viewer.getVisibleModels();for(let t=0;t<e.length;++t){if(!e[t].isLoadDone())return!1}return!this._pending3DLoaders()}_waitForAllModels(){return new Promise((e=>{const t=()=>{const e=this.viewer.getVisibleModels();for(let t=0;t<e.length;++t)if(!e[t].modelRootLoaded)return!1;return!this._pending3DLoaders()},i=()=>{t()?e():this.viewer.addEventListener(ye.MODEL_ROOT_LOADED_EVENT,i,{once:!0})};i()}))}allTreesLoaded(){const e=this.viewer.getVisibleModels();for(let t=0;t<e.length;++t)if(!e[t].getInstanceTree())return!1;return!this._pending3DLoaders()}_waitForAllInstanceTrees(){return new Promise((e=>{const t=()=>{this.allTreesLoaded()?e():this.viewer.addEventListener(ye.OBJECT_TREE_CREATED_EVENT,t,{once:!0})};t()}))}_onGeometryLoaded(){this._loadingAllGeometriesDone()&&(this.viewer.removeEventListener(ye.GEOMETRY_LOADED_EVENT,this._onGeometryLoaded),this.hidingObjectInterval&&clearInterval(this.hidingObjectInterval),this.selectedObjectID&&this.chosenPos&&this._waitForAllInstanceTrees().then((()=>{this.viewer.clearSelection(),this._isSelected(this.selectedObjectID)||this.viewer.select(this.selectedObjectID),this._hideCurrentIntersections(!0),this.viewer.impl.invalidate(!0,!0,!0),this.chosenPos=null,this.selectedObjectID=null})))}_getSelected3dPosFrom2d(e,t){const i=this.viewer.impl.computeSelectionBounds([e],t),r=this.viewer.impl.worldToClient(i.getCenter(new THREE.Vector3)),o=this.dropMeExt.dropMeTool._get3DCameraPositionAndVp(r.x,r.y);return o&&o.pos}}Ae.HIDING_INTERVAL_FREQUENCY=300,Ae.NUMBER_OF_CORNER_INTERSECTIONS=10,Ae.DISTANCE_FACTOR=3,Ae.COVERAGE_FACTOR=4,Ae.IGNORE_ANGLE=35,Ae.NUMBER_OF_POSITION=8;const xe=Autodesk.Viewing,Ce=Autodesk.Viewing.UI,we=xe.Private,be=AutodeskNamespace("Autodesk.AEC");class Me extends xe.Extension{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{teleportOnRelease:!0};super(e,t),Autodesk.Viewing.EventDispatcher.prototype.apply(this),this.teleportOnRelease=t.teleportOnRelease,this.viewer=e,this._onModelLoaded=this._onModelLoaded.bind(this),this._deactivateTool=this._deactivateTool.bind(this),this._onViewportDataFetched=this._onViewportDataFetched.bind(this),this.onDropOverride=null,this.options=t,this.options.triggerDeactivate=this._deactivateTool,this.toggleIndex=t.toggleIndex||0,this.enableGuidance=t.enableGuidance||!1,this.options.enableViewIn3d&&(this.viewObjectIn3D=new Ae(this,e,this.options))}async load(){var e,t=this;return this.viewportsExtension=await this.viewer.loadExtension("Autodesk.AEC.ViewportsExtension"),this.viewportsExtension.addEventListener(Autodesk.AEC.ViewportsExtension.Events.VIEWPORT_DATA_FETCHED_EVENT,this._onViewportDataFetched),this.dropMeTool=new me(this.viewer,(function(){return t._onDrop(...arguments)}),this),this.viewer.addEventListener(xe.MODEL_ADDED_EVENT,this._onModelLoaded),this.viewer.model&&this._initUI(this.viewer.model),null===(e=this.viewObjectIn3D)||void 0===e||e.activate(),!0}unload(){var e;return null===(e=this.viewObjectIn3D)||void 0===e||e.deactivate(),this.viewportsExtension.removeEventListener(Autodesk.AEC.ViewportsExtension.Events.VIEWPORT_DATA_FETCHED_EVENT,this._onViewportDataFetched),this.viewportsExtension=null,this.viewer.removeEventListener(xe.MODEL_ADDED_EVENT,this._onModelLoaded),this.viewer.toolController.setIsLocked(!1),this._deactivateTool(),this._destroyUI(),!0}_onViewportDataFetched(){this.viewer.model&&this._onModelLoaded({model:this.viewer.model})}setOnDrop(e){this.onDropOverride=e}_destroyUI(){this._showDrop(!1),this.dropMeButton&&(this.dropMeButton.removeFromParent(),this.dropMeButton=null),this.uiInitialized=!1}_onDrop(e,t,i,r,o){this.teleportOnRelease&&(this.viewer.toolController.setIsLocked(!1),this._deactivateTool(!0));const n=this.viewer.model.getDocumentNode().getInputFileType(),s=r.getInputFileType();we.analytics.track("viewer.place_me",{file_2d_extension:n,file_3d_extension:s}),console.log(`DropMe: 3D camera position is ${JSON.stringify(e)}`),console.log(`DropMe: 3D camera direction is ${JSON.stringify(t)}`),this.dispatchEvent({type:Me.DROP_ME_EVENT,pos:e,dir:t,mode:i,bubbleNode:r,ignoreCameraGlobalOffset:o}),this.onDropOverride?this.onDropOverride(e,t,i,r,o):this.options.onDrop?this.options.onDrop(e,t,i,r,o):console.warn("DropMe: No onDrop callback specified ")}_onModelLoaded(e){this.uiInitialized?this._updateUI(e.model):this._initUI(e.model)}_deactivateTool(e){this.uiInitialized&&(this._showGuidenaceUI(!1),this.dropMeButton.setState(e?Ce.Button.State.DISABLED:Ce.Button.State.INACTIVE)),this.viewer.toolController.deactivateTool("drop-me")}isSupportedModel(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==e||!e.is2d())return!1;const r=e.getDocumentNode();if(!r)return!1;let o=this.viewportsExtension.filterAndFlattenViewports(r,{onlyTopViewPlans:t});return(i||this.options.useOnlyAecModelDataViewports)&&(o=o.filter((e=>e instanceof Autodesk.AEC.ViewportsExtension.AecModelDataViewport))),o.length}async _updateUI(e){const t=this.viewer.getToolbar&&this.viewer.getToolbar();if(!t)return;this.dropMeButton.removeFromParent();t.getControl(this.options.toolbarGroup||xe.TOOLBAR.NAVTOOLSID).addControl(this.dropMeButton,{index:this.toggleIndex});const i=this.isSupportedModel(e);this._showDrop(i)}_initUI(e){this.viewer.getToolbar&&this.viewer.getToolbar()&&(this.dropMeButton=new Ce.Button("drop-me-icon"),this.dropMeButton.icon.innerHTML=Te(),this.dropMeButton.onClick=()=>{this.dropMeTool.active?this._deactivateTool():(this.dropMeButton.setState(Ce.Button.State.ACTIVE),this.viewer.toolController.activateTool("drop-me"),this._showGuidenaceUI())},this.uiInitialized=!0,this._updateUI(e))}_showGuidenaceUI(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.enableGuidance)if(e){const e=this.getDocument();this.guidenaceUI=e.createElement("div"),this.guidenaceUI.className="dropme-guidenace-ui",this.guidenaceUI.innerHTML=Autodesk.Viewing.i18n.translate("Click on a location to ground yourself, then select a camera direction"),this.viewer.container.appendChild(this.guidenaceUI)}else this.viewer.container.contains(this.guidenaceUI)&&this.viewer.container.removeChild(this.guidenaceUI)}_showDrop(e){if(!this.dropMeButton)return;this.viewer.getToolbar().getControl(this.options.toolbarGroup||xe.TOOLBAR.NAVTOOLSID)&&!this.container&&this.dropMeButton.setState(e?Ce.Button.State.INACTIVE:Ce.Button.State.DISABLED);const t=Autodesk.Viewing.i18n.translate("Click a 2D location to view that space in 3D"),i=Autodesk.Viewing.i18n.translate("Current view is not supported by Place Me");this.dropMeButton.setToolTip(e?t:i)}}const Te=()=>['<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 128 128">','<g stroke="currentColor" fill="currentColor">','<path d="M67,0c2.4.5,4.8.9,7.1,1.6C87.5,5.3,96.6,16.6,98,31a37.2,37.2,0,0,1-2.1,16.2c-4.7,13-23.6,48.1-31.6,58.2-.3-.2-.6-.3-.8-.5-11.1-17.6-21.9-35.4-30-54.7-4.6-10.9-4.6-21.7.6-32.3S47.5,2.6,58.3.7l3-.7ZM64,47A11.8,11.8,0,1,0,52.3,34.9,12,12,0,0,0,64,47Z"/>','<path d="M12.8,103.4c1.4-8,6.9-12.3,14-14.6s12-2.9,18.1-4.2c1.1-.2,2.4.5,3.4,1.5-4.5,1.1-9.1,1.8-13.5,3.3a35,35,0,0,0-9.6,5c-4,3-4.3,7.5-.7,10.9a28.7,28.7,0,0,0,9.6,6.2,87.3,87.3,0,0,0,59.9.1,28.2,28.2,0,0,0,8.7-5.2c4.9-4.1,4.8-9.7-.8-12.8S90.7,89.3,85,87.3c-1.6-.6-3.4-.6-5.3-1.7,1.1-.4,2.2-1.2,3.2-1.1,7.8.9,15.5,2.2,22.6,6,12,6.4,13,17.9,2.1,26.1-8.1,6.1-17.6,8.5-27.4,10L69.1,128H59.2l-5.2-.7c-9.1-.8-18-2.6-26.4-6.5s-13.4-8.1-14.9-16.8Z"/>',"</g>","</svg>"].join("");be.DropMeExtension=Me,Me.POSITION_FOUND_EVENT="POSITION_FOUND_EVENT",Me.OBJECT_SELECTED_EVENT="OBJECT_SELECTED_EVENT",Me.DROP_ME_EVENT="DROP_ME_EVENT",Me.DROP_ME_STARTED_EVENT="DROP_ME_STARTED_EVENT",Autodesk.Viewing.theExtensionManager.registerExtension("Autodesk.AEC.DropMeExtension",Me);class Ve{static FlattenCluster(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.value?t.push(e.value):(Ve.FlattenCluster(e.left,t),Ve.FlattenCluster(e.right,t)),t}static ComputeMeanValueForFlattenCluster(e){let t=new THREE.Box3,i=new THREE.Box3;return e.forEach((e=>{t.expandByPoint(e.currentPosProjected),i.expandByPoint(e.currentPos3D)})),{center2D:t.getCenter(new THREE.Vector3),center3D:i.getCenter(new THREE.Vector3)}}constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;this._clusterfck=e,this.setDistanceFuncAndThreshold(t,i)}setDistanceFuncAndThreshold(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;this._distanceFunc=e,this._threshold=t}setThreshold(e){this._threshold=e}createClusters(e){return this._clusterfck.hcluster(e,this._distanceFunc,this._clusterfck.AVERAGE_LINKAGE,this._threshold)}}const Se=Autodesk.Viewing,Le=Se.Private,Re=Autodesk.Viewing.UI,Pe=AutodeskNamespace("Autodesk.AEC"),De="Autodesk.AEC.LevelsExtension",Oe="canvasBookmarks",Ie="CanvasBookmark_Extension_Overlay",Ne="CanvasBookmark_CutPlanes",ke=(()=>{let e=new THREE.Vector3,t=new THREE.Vector3,i=new THREE.Vector3,r=new THREE.Vector3,o=new THREE.Quaternion,n=new THREE.Quaternion,s=new THREE.Vector3,a=new THREE.Vector3,l=new THREE.Quaternion;return(c,u,h,d)=>(c.decompose(e,o,i),u.decompose(t,n,r),s.lerpVectors(e,t,h),a.lerpVectors(i,r,h),l.slerpQuaternions(o,n,h),d.compose(s,l,a),d)})(),Be=e=>{let t=e.clone();return t.transform=e.transform?e.transform.clone():new THREE.Matrix4,t},Fe=(e,t)=>{e.visiblityChangePending=!0,requestAnimationFrame((()=>{t?e.container.classList.add("visible"):e.container.classList.remove("visible"),e.visiblityChangePending=!1}))};class ze extends Se.Extension{constructor(e,t){super(e,t),this.viewer=e,this.bookmarks=[],this.clusteredBookmarks=[],this.camera=this.viewer.navigation.getCamera(),this.cameraMovedCB=this.onCameraMoved.bind(this),this.onModelTransformChanged=this.onModelTransformChanged.bind(this),this.onVisibilityChangedCB=this.onVisibilityChanged.bind(this),this.sectionBox=null,this.activeSectionBox=null,this.animStartSectionBox=null,this.animEndSectionBox=null,this.sectionBoxAnim=null,this.changeBookmarksVisibility=this.changeBookmarksVisibility.bind(this),this.changeBookmarksVisibilityTimeout=null,this._clusteringEnabled=void 0!==this.options.clusterfck,this._clusteringThreshold=this.options.clusteringThreshold||110,this._clusteringEnabled&&(this.hcluster=new Ve(this.options.clusterfck,((e,t)=>{const i=new THREE.Vector2(e.currentPosProjected.x,e.currentPosProjected.y);return new THREE.Vector2(t.currentPosProjected.x,t.currentPosProjected.y).distanceTo(i)}),this._clusteringThreshold)),this._filterOutInvisibleBookmark=this._filterOutInvisibleBookmark.bind(this),this.levelChangedCB=this.onLevelChanged.bind(this),this.extensionLoadedCB=this.onExtensionLoaded.bind(this),this.isFrustumFading=!1,this.waitingCallbacks=[]}setBookmarksVisible(e){this.bookmarks.forEach((t=>Fe(t.marker,e))),this.clusteredBookmarks.forEach((t=>Fe(t.marker,e))),e||this.stopGhosting()}onVisibilityChanged(e){this.viewer.prefs&&this.viewer.prefs.set(Oe,e),this.setBookmarksVisible(e),e&&this.updateBookmarkPositions()}isVisible(){return this.viewer.prefs&&this.viewer.prefs.get(Oe)}onCameraMoved(){this.setBookmarksVisible(!1),this.debounceBookmarksVisibility()}createTooltip(e,t){e.setToolTip(t.name()),e._toolTipElement.innerHTML=`<b>${t.name()}</b>`}flyToBookmark(e){const t={position:e.pos,target:e.target,up:e.up};this.anim=Le.flyToView(this.viewer,t,1)}getRelatedModelTransform(e){const t=e.getRootNode(),i=this.viewer.getVisibleModels().find((e=>e.getDocumentNode().getRootNode()===t));return null==i?void 0:i.getModelToViewerTransform()}createBookmark(e){const t=e.extractCamera();if(!t)return;let i=t.position,r=t.target;const o=this.getRelatedModelTransform(e);o&&(i.applyMatrix4(o),r.applyMatrix4(o));const n=new THREE.Vector3(r.x-i.x,r.y-i.y,r.z-i.z).normalize(),s=new THREE.Vector3(0,0,1);let a=new Autodesk.Viewing.UI.Button(`b-${e.name().replace(/\s/g,"")}`);a.container.classList.add("canvas-bookmark"),a.container.innerHTML=['<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 114 114">',"<defs>",'<path id="camera-view-icon-3-with-shadow-v3-b" d="M60.934065,73.4602645 C54.1164768,73.4602645 48.5886781,67.9324658 48.5886781,61.1148776 C48.5886781,54.2963836 54.1164768,48.7694907 60.934065,48.7694907 C67.752559,48.7694907 73.2803577,54.2963836 73.2803577,61.1148776 C73.2803577,67.9324658 67.752559,73.4602645 60.934065,73.4602645 M78.7230158,42.834104 C77.2575106,42.9581919 75.7711731,42.808743 74.2984219,42.8748628 C73.4714712,42.9119986 72.9388896,42.637556 72.4470667,41.9817922 C70.947143,39.9827997 69.3693246,38.0417751 67.8621549,36.0491228 C67.287003,35.2873862 66.5959149,34.9939228 65.6521223,35.0029804 C62.0046628,35.0355874 58.354486,35.0401161 54.7070265,35.0002631 C53.7097946,34.9893941 53.0033088,35.3145587 52.4046073,36.1116196 C50.9028721,38.1088007 49.382116,40.0951128 47.7852769,42.0171165 C47.4311283,42.4437253 46.748192,42.7707014 46.1884378,42.8187062 C44.8515493,42.9346424 43.4974514,42.855842 41.9640149,42.855842 C41.9640149,42.2091358 41.9929989,41.6520989 41.9576746,41.0995907 C41.8897433,40.036239 41.3046281,39.4293858 40.2331246,39.4112707 C38.5112919,39.381381 36.7894591,39.3759465 35.0676263,39.4130822 C33.9934056,39.4366318 33.4291227,40.057977 33.3892696,41.1303863 C33.3693431,41.6557219 33.3856466,42.1819632 33.3856466,42.8078372 C31.121269,42.9074698 29.8523117,44.2289606 29,46.07941 L29,75.8722796 C30.0434252,78.4165343 31.9636175,79.1737422 34.6482636,79.1583444 C49.3911736,79.0686751 64.1340835,79.0713923 78.8769935,79.1556272 C81.5299383,79.1710249 83.372236,78.3377339 84.4011692,75.8722796 L84.4011692,46.07941 C83.3332887,43.5523646 81.4058504,42.6067605 78.7230158,42.834104"/>','<filter id="camera-view-icon-3-with-shadow-v3-a" width="125.3%" height="131.7%" x="-12.6%" y="-11.3%" filterUnits="objectBoundingBox">','<feOffset dy="2" in="SourceAlpha" result="shadowOffsetOuter1"/>','<feGaussianBlur in="shadowOffsetOuter1" result="shadowBlurOuter1" stdDeviation="2"/>','<feColorMatrix in="shadowBlurOuter1" values="0 0 0 0 0   0 0 0 0 0   0 0 0 0 0  0 0 0 0.1 0"/>',"</filter>",'<path id="camera-view-icon-3-with-shadow-v3-d" d="M104.440851,57.2204256 C104.440851,83.2997158 83.2997158,104.440851 57.2204256,104.440851 C31.1411354,104.440851 10,83.2997158 10,57.2204256 C10,31.1411354 31.1411354,10 57.2204256,10 C83.2997158,10 104.440851,31.1411354 104.440851,57.2204256 Z"/>','<filter id="camera-view-icon-3-with-shadow-v3-c" width="125.5%" height="125.5%" x="-12.8%" y="-10.6%" filterUnits="objectBoundingBox">','<feMorphology in="SourceAlpha" operator="dilate" radius="5.045" result="shadowSpreadOuter1"/>','<feOffset dy="2" in="shadowSpreadOuter1" result="shadowOffsetOuter1"/>','<feMorphology in="SourceAlpha" radius="5.045" result="shadowInner"/>','<feOffset dy="2" in="shadowInner" result="shadowInner"/>','<feComposite in="shadowOffsetOuter1" in2="shadowInner" operator="out" result="shadowOffsetOuter1"/>','<feGaussianBlur in="shadowOffsetOuter1" result="shadowBlurOuter1" stdDeviation="2"/>','<feColorMatrix in="shadowBlurOuter1" values="0 0 0 0 0   0 0 0 0 0   0 0 0 0 0  0 0 0 0.1 0"/>',"</filter>","</defs>",'<g fill="none" fill-rule="evenodd">','<use fill="#000" filter="url(#camera-view-icon-3-with-shadow-v3-a)" xlink:href="#camera-view-icon-3-with-shadow-v3-b"/>','<use fill="currentColor" xlink:href="#camera-view-icon-3-with-shadow-v3-b"/>',"<g>",'<use fill="#000" filter="url(#camera-view-icon-3-with-shadow-v3-c)" xlink:href="#camera-view-icon-3-with-shadow-v3-d"/>','<use stroke="currentColor" stroke-width="10.09" xlink:href="#camera-view-icon-3-with-shadow-v3-d"/>',"</g>","</g>","</svg>"].join(""),Fe(a,this.isVisible()),this.createTooltip(a,e),this.viewer.container.appendChild(a.container);const l=a.getDimensions(),c=this.findSectionBox(e,e.name()),u=c?c.getCenter(new THREE.Vector3).applyMatrix4(c.transform):null,h={marker:a,pos:c?u:i,cameraPos:i,dir:n,up:s,target:r,name:e.name(),anchorX:l.width/2,anchorY:l.height/2,fadeValue:0,hovered:!1,bubbleNode:e,clustered:!1};return a.container.addEventListener("mouseenter",(()=>{this.onBookmarkMouseEnter(h)})),a.container.addEventListener("mouseleave",(()=>{this.onBookmarkMouseLeave(h)})),a.addEventListener(Re.Button.Event.CLICK,(()=>{this.options&&this.options.onBookmark&&this.options.onBookmark(h.bubbleNode,t)})),h}createClusteredBookmark(e,t,i){let r=new Autodesk.Viewing.UI.Button(t);r.container.classList.add("clustered-canvas-bookmark"),r.container.innerHTML=['<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 652 598">','<path fill="currentColor" d="M254.7,94.3A157.6,157.6,0,1,0,412.3,251.9,157.6,157.6,0,0,0,254.7,94.3ZM173.6,281.4a24.2,24.2,0,1,1,23.9-24.2A23.8,23.8,0,0,1,173.6,281.4Zm86.6,0a24.2,24.2,0,1,1,23.9-24.2A23.8,23.8,0,0,1,260.2,281.4Zm86.7,0a24.2,24.2,0,1,1,23.9-24.2A23.8,23.8,0,0,1,346.9,281.4Z"/>','<circle fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="42.87px" cx="256" cy="256" r="221.5" transform="translate(-101.8 200.6) rotate(-36.2)"/>',"</svg>"].join(""),Fe(r,this.isVisible()&&i),this.viewer.container.appendChild(r.container);const o=Ve.ComputeMeanValueForFlattenCluster(e),n={marker:r,name:t,pos:o.center3D,currentPosProjected:o.center2D,cluster:e,fadeValue:0,hovered:!1,folded:!0};r.container.addEventListener("mouseenter",(()=>{this.onClusteredBookmarkMouseEnter(n)})),r.container.addEventListener("mouseleave",(()=>{this.onClusteredBookmarkMouseLeave(n)})),r.addEventListener(Re.Button.Event.CLICK,(()=>{this.onClusteredBookmarkClicked(n)})),n.marker.container.style.transform=`translate(${o.center2D.x}px, ${o.center2D.y}px)`,this.clusteredBookmarks.push(n)}deleteBookmark(e){this.viewer.container.removeChild(e.marker.container),this.hideFrustumShape(e)}clearBookmarks(){this.stopSectionBoxAnim(),this.applySectionBox(),this.bookmarks.forEach((e=>{this.deleteBookmark(e)})),this.bookmarks=[],this.clusteredBookmarks.forEach((e=>{this.deleteBookmark(e)})),this.clusteredBookmarks=[]}resetBookmarks(e){this.clearBookmarks(),e&&Se.Document.getAecModelData(e).then((()=>{for(let t=0;t<e.length;t++){const i=e[t],r=this.createBookmark(i);r&&this.bookmarks.push(r)}this.bookmarkData=e,this.updateBookmarkPositions()}))}resetGlobalOffset(e){this.options.globalOffset=e,this.resetBookmarks(this.bookmarkData)}showFrustumShape(e){e.frustumShape||(e.frustumShape=function(e,t){const i=THREE.Math.degToRad,r=Math.sin(i(17)),o=Math.sin(i(17)),n=Math.sqrt(1-r*r-o*o),s=new THREE.Vector3(-r,-o,n),a=new THREE.Vector3(r,-o,n),l=new THREE.Vector3(-r,o,n),c=new THREE.Vector3(r,o,n),u=new Float32Array([s.x,s.y,s.z,a.x,a.y,a.z,l.x,l.y,l.z,c.x,c.y,c.z,0,0,0]),h=new Uint32Array([4,1,0,4,3,1,4,2,3,4,0,2,0,1,3,0,3,2]);let d=new Float32Array(3*h.length);for(let e=0;e<h.length;e++){let t=h[e];d[3*e]=u[3*t],d[3*e+1]=u[3*t+1],d[3*e+2]=u[3*t+2]}let p=new THREE.BufferGeometry;p.setAttribute("position",new THREE.BufferAttribute(d,3)),p.computeVertexNormals();let g=new THREE.MeshPhongMaterial({color:5263615,transparent:!0,opacity:0,depthTest:!1,depthWrite:!1,blending:THREE.NoBlending});const f=new THREE.Mesh(p,g),v=new Uint32Array([4,0,4,1,4,3,4,2,0,1,1,3,3,2,2,0]);let m=new THREE.BufferGeometry;m.setIndex(new THREE.BufferAttribute(v,1)),m.setAttribute("position",new THREE.BufferAttribute(u,3)),m.isLines=!0;let y=new THREE.LineBasicMaterial({color:16777215,transparent:!0,side:THREE.DoubleSide,opacity:0,depthTest:!1,depthWrite:!1,blending:THREE.NoBlending});const _=new THREE.Mesh(m,y);let E=new THREE.Scene;E.add(f),E.add(_),p.visible=!0,m.visible=!0,f.name="FrustumGizmo",E.scale.set(50,50,50),E.position.copy(e);const A=new THREE.Vector3(0,0,0),x=new THREE.Vector3(0,0,1),C=new THREE.Vector3(-t.x,-t.y,-t.z),w=(new THREE.Matrix4).lookAt(A,C,x);return E.rotation.setFromRotationMatrix(w),E.frustumCulled=!1,f.frustumCulled=!1,_.frustumCulled=!1,E.setFadeValue=e=>{g.opacity=.05*e,y.opacity=1*e},E}(e.cameraPos,e.dir),this.viewer.impl.addOverlay(Ie,e.frustumShape),e.frustumShape.name=e.bubbleNode.name(),this.viewer.impl.updateCameraMatrices())}hideFrustumShape(e){e.frustumShape&&(this.viewer.impl.removeOverlay(Ie,e.frustumShape),e.frustumShape=null)}setFrustumFadeValue(e,t){e.fadeValue=t,e.frustumShape&&e.frustumShape.setFadeValue(t)}updateFrustumShapeFading(e,t){const i=e.hovered&&e.fadeValue<1,r=!e.hovered&&e.fadeValue>0;if(!i&&!r)return!1;let o=t/500,n=t/500,s=e.fadeValue+(i?o:-n);return s=THREE.Math.clamp(s,0,1),this.setFrustumFadeValue(e,s),e.marker&&e.marker._toolTipElement&&(e.marker._toolTipElement.style.opacity=Math.min(1,3*s)),e.hovered||0!==e.fadeValue||this.hideFrustumShape(e),this.viewer.impl.invalidate(!1,!1,!0),!0}requestTimer(){const e=this.getWindow();this.timerId=e.requestAnimationFrame((()=>this.onTimer()))}onTimer(){const e=performance.now(),t=e-this.lastTime;this.lastTime=e,this.isFrustumFading=!1,this.bookmarks.forEach((e=>{const i=this.updateFrustumShapeFading(e,t);this.isFrustumFading=this.isFrustumFading||i})),this.isAllDone()&&(this.waitingCallbacks.forEach((e=>e())),this.waitingCallbacks.length=0),this.requestTimer()}findSectionBox(e,t){const i=e.search({type:"view"});if(!i.length||i[0].data.name!==t)return null;const r=i[0].data.sectionBox,o=i[0].data.sectionBoxTransform;if(!r||!o)return null;const n=(new THREE.Matrix4).fromArray([o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7],o[8],o[9],o[10],o[11],o[12],o[13],o[14],o[15]]);let s=new THREE.Box3;s.min.set(r[0],r[1],r[2]),s.max.set(r[3],r[4],r[5]),s.transform=new THREE.Matrix4;const a=this.getRelatedModelTransform(e);return a&&s.transform.multiply(a),s.transform.multiply(n),s}setOverlaySceneVisible(e){let t=this.viewer.impl.overlayScenes[Ie],i=t&&t.scene;i&&(i.visible=e)}getFadeExtension(){return this.viewer.getExtension("Autodesk.CrossFadeEffects")}showGhosting(){let e=this.getFadeExtension();e&&(e.acquireControl("CanvasBookmarks",(()=>this.stopGhosting())),this.ghostingActive?this.stopGhostFadeOut():(this.viewer.impl.setCutPlaneSet(Ne),this.setOverlaySceneVisible(!1),e.renderFadingImage(0),this.applySectionBox(this.activeSectionBox),this.setOverlaySceneVisible(!0),this.ghostingActive=!0),e.setCrossFadeOpacity(0,.3))}stopGhosting(){if(this.ghostingActive){this.stopGhostFadeOut();let e=this.getFadeExtension();e&&e.releaseFadingImage(0),this.ghostingActive=!1}}stopGhostFadeOut(){this.ghostFadeAnim&&(this.ghostFadeAnim.skip(),this.ghostFadeAnim=null)}fadeOutGhosting(){let e=this.getFadeExtension();if(!this.ghostingActive||!e)return;let t=e.getCrossFadeOpacity(0);this.ghostFadeAnim=Le.fadeValue(t,0,.5,(t=>e.setCrossFadeOpacity(0,t)))}onBookmarkMouseEnter(e){let t=this.findSectionBox(e.bubbleNode,e.name);t&&(this.showGhosting(),this.animateToSectionBox(t)),this.showFrustumShape(e),e.hovered=!0}onBookmarkMouseLeave(e){this.animateToSectionBox(null),this.fadeOutGhosting(),e.hovered=!1}onClusteredBookmarkMouseEnter(e){e.hovered=!0}onClusteredBookmarkMouseLeave(e){e.hovered=!1}onClusteredBookmarkClicked(e){if(e.folded){const t=(e,t,i)=>{const r=Math.cos(i),o=Math.sin(i),n=e.x-t.x,s=e.y-t.y;e.x=n*r-s*o+t.x,e.y=n*o+s*r+t.y},i=e.cluster.length,r=Math.round(360/i),o=new THREE.Vector2(e.currentPosProjected.x,e.currentPosProjected.y);let n=new THREE.Vector2(o.x,o.y+35);for(let s=0;s<i;++s){let i=e.cluster[s],a=n.clone();t(a,o,s*r*Math.PI/180),i.currentPosProjected.x=a.x,i.currentPosProjected.y=a.y,i.marker.container.style.transform=`translate(${a.x}px, ${a.y}px)`,Fe(i.marker,!0)}e.marker.container.classList.add("declustered-canvas-bookmark")}else e.cluster.forEach((e=>{Fe(e.marker,!1)})),e.marker.container.classList.remove("declustered-canvas-bookmark");e.folded=!e.folded}debounceBookmarksVisibility(){this.changeBookmarksVisibilityTimeout&&clearTimeout(this.changeBookmarksVisibilityTimeout),this.changeBookmarksVisibilityTimeout=setTimeout(this.changeBookmarksVisibility,100)}debounceResetBookmarks(){this.resetBookmarksTimeout&&clearTimeout(this.resetBookmarksTimeout),this.resetBookmarksTimeout=setTimeout((()=>this.resetBookmarks(this.bookmarkData)),100)}onModelTransformChanged(){this.onCameraMoved(),this.debounceResetBookmarks()}changeBookmarksVisibility(){this.updateBookmarkPositions()}updateBookmarkPositions(){if(!this.isVisible())return;this.bookmarks.forEach((e=>{const t=e.bubbleNode.sectionBox,i=t?t.getCenter(new THREE.Vector3):e.pos;e.currentPos3D=i;let r=this.project(i);r.x-=e.anchorX,r.y-=e.anchorY,e.currentPosProjected=new THREE.Vector3(r.x,r.y,r.z),e.marker.container.style.transform=`translate(${r.x}px, ${r.y}px)`}));const e=this._clusteringEnabled?this.hcluster.createClusters(this.bookmarks):[];this.updateClusteredBookmarks(e)}updateClusteredBookmarks(e){this.clusteredBookmarks.forEach((e=>{this.deleteBookmark(e)})),this.clusteredBookmarks=[],this.bookmarks.forEach((e=>{Fe(e.marker,!1)}));const t=this._getFloorSelector();if(void 0!==(t&&t.currentFloor))return;this.bookmarks.filter(this._filterOutInvisibleBookmark).forEach((e=>{e.clustered=!1,Fe(e.marker,!0)}));for(let t=0;t<e.length;t++){const i=e[t];if(i.size>1){const e=Ve.FlattenCluster(i);let t=!1;e.forEach((e=>{e.clustered=!0,!t&&e.marker.isVisible()&&(t=!0),Fe(e.marker,!1)})),this.createClusteredBookmark(e,`c-${e[0].bubbleNode.data.viewableID}`,t)}}}project(e){const t=this.viewer.navigation.getScreenViewport();let i=(new THREE.Vector3).copy(e);const r=new THREE.Matrix4;return r.multiplyMatrices(this.camera.projectionMatrix,this.camera.matrixWorldInverse),i.applyProjection(r),new THREE.Vector3(Math.round((i.x+1)/2*t.width),Math.round((1-i.y)/2*t.height),i.z)}load(){this.viewer.prefs.add(Oe,!0),this.viewer.addEventListener(Se.CAMERA_CHANGE_EVENT,this.cameraMovedCB),this.viewer.addEventListener(Se.MODEL_TRANSFORM_CHANGED_EVENT,this.onModelTransformChanged);const e=this._getFloorSelector();return e&&e.addEventListener(Autodesk.AEC.FloorSelector.SELECTED_FLOOR_CHANGED,this.levelChangedCB),this.viewer.addEventListener(Se.EXTENSION_LOADED_EVENT,this.extensionLoadedCB),this.updateBookmarkPositions(),this.viewer.impl.createOverlayScene(Ie),this.lastTime=performance.now(),this.requestTimer(),this.updateSettingsPanel||(this.updateSettingsPanel=this.configureSettings.bind(this),this.viewer.addEventListener(Se.SETTINGS_PANEL_CREATED_EVENT,this.updateSettingsPanel)),!0}unload(){this.resetBookmarksTimeout&&clearTimeout(this.resetBookmarksTimeout),this.clearBookmarks(),this.viewer.impl.removeOverlayScene(Ie),this.viewer.removeEventListener(Se.CAMERA_CHANGE_EVENT,this.cameraMovedCB),this.viewer.removeEventListener(Se.MODEL_TRANSFORM_CHANGED_EVENT,this.onModelTransformChanged);const e=this._getFloorSelector();if(e&&e.removeEventListener(Autodesk.AEC.FloorSelector.SELECTED_FLOOR_CHANGED,this.levelChangedCB),this.viewer.removeEventListener(Se.EXTENSION_LOADED_EVENT,this.extensionLoadedCB),this.timerId){this.getWindow().cancelAnimationFrame(this.timerId),this.timerId=null}return this.updateSettingsPanel&&(this.viewer.removeEventListener(Se.SETTINGS_PANEL_CREATED_EVENT,this.updateSettingsPanel),this.updateSettingsPanel=null),!0}applySectionBox(e){if(this.activeSectionBox=e,!e)return void this.viewer.impl.setCutPlaneSet(Ne);const t=Le.SceneMath.box2CutPlanes(e,e.transform);this.viewer.impl.setCutPlaneSet(Ne,t)}getModelBox(){const e=this.viewer.impl.modelQueue().getModels();let t=new THREE.Box3;for(let i=0;i<e.length;i++)t.union(e[i].getBoundingBox());return t}stopSectionBoxAnim(){this.sectionBoxAnim&&(this.sectionBoxAnim.stop(),this.sectionBoxAnim=null)}animateToSectionBox(e){if(!e&&!this.activeSectionBox)return;this.stopSectionBoxAnim();this.animStartBox=this.activeSectionBox?Be(this.activeSectionBox):Be(this.getModelBox()),this.animEndBox=Be(e||this.getModelBox()),this.sectionBox=e;let t=new THREE.Box3;t.transform=new THREE.Matrix4;this.sectionBoxAnim=Le.fadeValue(0,1,.5,(e=>{e=Le.smootherStep(e),((e,t,i,r)=>{r.min.lerpVectors(e.min,t.min,i),r.max.lerpVectors(e.max,t.max,i),ke(e.transform,t.transform,i,r.transform)})(this.animStartBox,this.animEndBox,e,t),this.applySectionBox(t)}),(()=>{this.applySectionBox(this.sectionBox),this.sectionBoxAnim=null}))}enableClustering(e){this._clusteringEnabled!==e&&(this._clusteringEnabled=e,this.updateClusteredBookmarks([]))}setClusteringThreshold(e){this._clusteringThreshold!==e&&(this._clusteringThreshold=e,this.hcluster.setThreshold(e),this.updateClusteredBookmarks([]))}isAllDone(){const e=this.sectionBoxAnim&&this.sectionBoxAnim.isRunning,t=this.bookmarks.some((e=>e.marker&&e.marker.visiblityChangePending));return!e&&!this.isFrustumFading&&!t}waitForAllDone(){return this.onTimer(),this.isAllDone()?Promise.resolve():new Promise((e=>{this.waitingCallbacks.push(e)}))}_filterOutInvisibleBookmark(e){const t=this.viewer.navigation.getScreenViewport();if(e.currentPosProjected.x<0||e.currentPosProjected.x>t.width)return!1;if(e.currentPosProjected.y<0||e.currentPosProjected.y>t.height)return!1;const i=this.camera.target.clone().sub(this.camera.position),r=e.pos.clone().sub(this.camera.position);return i.dot(r)>0}onLevelChanged(){this.updateBookmarkPositions()}onExtensionLoaded(e){e.extensionId===De&&this.updateBookmarkPositions()}configureSettings(){if(!this.viewer.getSettingsPanel)return;let e=this.viewer.getSettingsPanel(!0);if(!e.is3dMode)return;let t=Se.Extensions.ViewerSettingTab.Navigation;e.addLabel(t,"Location Icons"),e&&!e.showLocationIconsChkBoxId&&(e.showLocationIconsChkBoxId=e.addCheckbox(t,"Show location icons","Toggles availability of the location icons when looking at the project model",!0,this.onVisibilityChangedCB,Oe))}_getFloorSelector(){const e=this.viewer.getExtension(De);return e&&e.floorSelector}}Pe.CanvasBookmarkExtension=ze,Autodesk.Viewing.theExtensionManager.registerExtension("Autodesk.AEC.CanvasBookmarkExtension",ze);const je=Autodesk.Viewing,Ue=je.Private.analytics,Ge=je.GlobalManagerMixin,We="Autodesk.AEC.LevelsExtension";class Ye{constructor(e){this.parent=e,this.viewer=e.viewer,this.setGlobalManager(this.viewer.globalManager),this.dropdownWrapper=null,this.parentContainer=e.mapWidgetHeader,this.onClickOptionHandler=this.onClickOption.bind(this),this.createWrapper(50);const t=this.getFloorDataFromLevelExtension();this.createDropdown(t),this.onLevelChanged=this.onLevelChanged.bind(this),this.viewer.addEventListener(Autodesk.AEC.LevelsExtension.LEVEL_CHANGED,this.onLevelChanged),this.viewer.getExtensionAsync(We).then((e=>{e.floorSelector.addEventListener(Autodesk.AEC.FloorSelector.SELECTED_FLOOR_CHANGED,this.onLevelChanged),this.onLevelChanged()}))}createWrapper(e){const t=this.getDocument().createElement("div");t.classList.add("minimap-dropdown-wrapper"),t.id="minimap-dropdown-wrapper",t.style.height=e,this.parent.expandButton||(t.style.paddingLeft="14px"),this.parentContainer.appendChild(t),this.dropdownWrapper=t}createDropdown(e){const t=this.getDocument();this.titleElement=t.createElement("div"),this.titleElement.classList.add("minimap-title"),this.dropdownWrapper.appendChild(this.titleElement),this.recreateDropdownElement(),this.createDropdownOptions(e),this.dropdownWrapper.addEventListener("click",(e=>{this.dropdownElement.classList.toggle("active"),e.stopPropagation()}))}onClickOption(e){const t=this.getDocument();this.titleElement.id=e.target.id;this.viewer.getExtension("Autodesk.BimWalk").jumpToFloor(e.target.id);const i=t.createEvent("Event");i.initEvent("change",!0,!0),Ue.track("viewer.3d_minimap.levels"),this.titleElement.dispatchEvent(i),Array.from(this.dropdownElement.children).forEach((e=>e.classList.remove("active"))),this.dropdownWrapper.classList.toggle("active"),e.target.classList.toggle("active")}createDropdownOptions(e){for(let t=e.length-1;t>=0;t--)this.createNewOption(e[t].name,t)}createNewOption(e,t){const i=this.getDocument(),r=i.createElement("li");r.appendChild(i.createTextNode(e)),r.setAttribute("id",t),r.onclick=this.onClickOptionHandler,this.dropdownElement.appendChild(r)}onLevelChanged(){const e=this.viewer.getExtension(We).getCurrentLevel();if(e){const t=this.getFloorDataFromLevelExtension();this.update(e.index,t)}}getFloorDataFromLevelExtension(){var e;const t=this.viewer.getExtension(We);return null!=t&&null!==(e=t.floorSelector)&&void 0!==e&&e.floorData?t.floorSelector.floorData:[]}recreateDropdownElement(){const e=this.getDocument();this.dropdownElement&&this.dropdownWrapper.removeChild(this.dropdownElement),this.dropdownElement=e.createElement("ul"),this.dropdownElement.classList.add("minimap-dropdown"),this.dropdownElement.id="minimap-dropdown",this.dropdownWrapper.appendChild(this.dropdownElement)}update(e,t){this.recreateDropdownElement();const i=t.some((e=>!e.isArtificialLevel)),r=1===(null==t?void 0:t.length)&&"d53d4fd9-1bc6-4549-9084-1caed451e96f"===t[0].guid;if(i&&!r){if(this.dropdownWrapper.classList.remove("no-levels"),this.createDropdownOptions(t),e>=0&&t[e]){const i=t[e];this.dropdownWrapper.style.display="flex",this.setSelectedValue(i.name),this.dropdownElement&&Array.from(this.dropdownElement.children).forEach((e=>{e.classList.remove("active"),e.textContent===i.name&&e.classList.add("active")}))}}else this.dropdownWrapper.classList.add("no-levels"),this.setSelectedValue(Autodesk.Viewing.i18n.translate("No Levels"))}setSelectedValue(e){this.titleElement.textContent=e}dtor(){var e;this.viewer.removeEventListener(Autodesk.AEC.LevelsExtension.LEVEL_CHANGED,this.onLevelChanged);const t=this.viewer.getExtension(We);null==t||null===(e=t.floorSelector)||void 0===e||e.removeEventListener(Autodesk.AEC.FloorSelector.SELECTED_FLOOR_CHANGED,this.onLevelChanged),this.dropdownWrapper.parentNode.removeChild(this.dropdownWrapper),this.dropdownWrapper=null}}Ge.call(Ye.prototype);const He=(e,t)=>{e.container.style.width="20px",e.container.style.height="20px",e.container.style.padding="3px 8px",e.icon.classList.remove("adsk-button-icon"),e.setToolTip("");const i=e._toolTipElement.style;i.bottom="0px",i.top="auto",i.height="fit-content",t?(i.left="auto",i.right="130%"):i.top="40px",i.zIndex=3},qe=['<svg viewBox="2 2 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">','<path d="M20 10V17C20 17.5523 19.5523 18 19 18H5C4.44772 18 4 17.5523 4 17V7C4 6.44772 4.44772 6 5 6H16M20 10L16 6M20 10H17C16.4477 10 16 9.55228 16 9V6" stroke="currentColor"/>','<path d="M13 9H7V15.5H12V13" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>','<path d="M11.5 15.5H16V12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>','<path d="M10 9V11.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>',"</svg>"].join(""),Ke=['<svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">','<rect width="24" height="24" fill="none"/>','<rect x="3" y="5" width="18" height="14" rx="2" stroke="currentColor" stroke-width="1.5"/>','<rect x="13.5" y="7.5" width="5" height="9" rx="0.5" fill="currentColor" stroke="currentColor"/>',"</svg>"].join(""),Qe=['<svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">','<rect width="24" height="24" fill="none"/>','<rect x="3" y="5" width="18" height="14" rx="2" stroke="currentColor" stroke-width="1.5"/>','<rect x="13.5" y="7.5" width="5" height="3.16667" rx="0.5" fill="currentColor" stroke="currentColor"/>',"</svg>"].join(""),Ze=['<svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">','<path d="M0.199982 17.0002L0.199982 12.0002C0.199982 11.8013 0.279 11.6106 0.419652 11.4699C0.560303 11.3293 0.751071 11.2502 0.949982 11.2502C1.14889 11.2502 1.33966 11.3293 1.48031 11.4699C1.62096 11.6106 1.69998 11.8013 1.69998 12.0002L1.69998 15.2202L15.24 1.68024L12 1.68024C11.8011 1.68024 11.6103 1.60123 11.4697 1.46057C11.329 1.31992 11.25 1.12916 11.25 0.930244C11.25 0.731332 11.329 0.540565 11.4697 0.399913C11.6103 0.259262 11.8011 0.180244 12 0.180244L17 0.180244L17.15 0.180244C17.2922 0.211971 17.4233 0.281006 17.53 0.380243C17.6327 0.484358 17.7023 0.616594 17.73 0.760244C17.7349 0.810125 17.7349 0.860363 17.73 0.910244L17.73 6.00025C17.73 6.19916 17.651 6.38992 17.5103 6.53057C17.3697 6.67123 17.1789 6.75025 16.98 6.75025C16.7811 6.75025 16.5903 6.67123 16.4497 6.53057C16.309 6.38992 16.23 6.19916 16.23 6.00024L16.23 2.78025L2.74998 16.2902L5.99998 16.2902C6.19889 16.2902 6.38966 16.3693 6.53031 16.5099C6.67096 16.6506 6.74998 16.8413 6.74998 17.0402C6.74998 17.2392 6.67096 17.4299 6.53031 17.5706C6.38966 17.7112 6.19889 17.7902 5.99998 17.7902L0.999981 17.7902C0.893908 17.7975 0.787506 17.7821 0.68783 17.7451C0.588154 17.7081 0.497484 17.6504 0.421833 17.5756C0.346182 17.5009 0.287279 17.411 0.249031 17.3118C0.210783 17.2126 0.194063 17.1064 0.199982 17.0002Z" fill="currentColor"/>',"</svg>"].join(""),Je=['<svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">','<path d="M0.469912 16.5099L5.39991 11.5799L2.18991 11.5799C1.991 11.5799 1.80023 11.5009 1.65958 11.3602C1.51893 11.2196 1.43991 11.0288 1.43991 10.8299C1.43991 10.631 1.51893 10.4402 1.65958 10.2996C1.80023 10.1589 1.991 10.0799 2.18991 10.0799L7.18991 10.0799C7.28969 10.0796 7.38845 10.1 7.47991 10.1399C7.57121 10.1739 7.65336 10.2287 7.71991 10.2999C7.7877 10.3692 7.84197 10.4506 7.87991 10.5399C7.91979 10.6313 7.94022 10.7301 7.93991 10.8299L7.93991 15.8299C7.93991 16.0288 7.8609 16.2196 7.72024 16.3602C7.57959 16.5009 7.38883 16.5799 7.18991 16.5799C6.991 16.5799 6.80024 16.5009 6.65958 16.3602C6.51893 16.2196 6.43991 16.0288 6.43991 15.8299L6.43991 12.6399L1.50991 17.5699C1.44125 17.6436 1.35845 17.7027 1.26645 17.7437C1.17445 17.7847 1.07514 17.8067 0.974434 17.8085C0.873732 17.8103 0.773703 17.7917 0.680315 17.754C0.586927 17.7163 0.502092 17.6601 0.430874 17.5889C0.359655 17.5177 0.303511 17.4329 0.265789 17.3395C0.228067 17.2461 0.209543 17.1461 0.211321 17.0454C0.213099 16.9447 0.235138 16.8453 0.276131 16.7533C0.317124 16.6613 0.376227 16.5785 0.449913 16.5099L0.469912 16.5099ZM10.1699 7.28988C10.1976 7.43354 10.2672 7.56577 10.3699 7.66988C10.4393 7.73768 10.5207 7.79194 10.6099 7.82988C10.7014 7.86976 10.8001 7.8902 10.8999 7.88989L15.8999 7.88989C16.0988 7.88989 16.2896 7.81087 16.4302 7.67022C16.5709 7.52956 16.6499 7.3388 16.6499 7.13989C16.6499 6.94097 16.5709 6.75021 16.4302 6.60956C16.2896 6.4689 16.0988 6.38989 15.8999 6.38989L12.7099 6.38989L17.6399 1.45988C17.7804 1.31926 17.8593 1.12864 17.8593 0.929886C17.8593 0.731134 17.7804 0.54051 17.6399 0.399885C17.4971 0.262712 17.3079 0.184195 17.1099 0.179886C16.9111 0.180061 16.7204 0.259193 16.5799 0.399885L11.6499 5.32988L11.6499 2.11989C11.6499 1.92097 11.5709 1.73021 11.4302 1.58956C11.2896 1.4489 11.0988 1.36989 10.8999 1.36989C10.701 1.36989 10.5102 1.4489 10.3696 1.58956C10.2289 1.73021 10.1499 1.92097 10.1499 2.11989L10.1499 7.11988C10.1502 7.17712 10.1569 7.23414 10.1699 7.28988Z" fill="currentColor"/>',"</svg>"].join(""),Xe=['<svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">','<path fill-rule="evenodd" clip-rule="evenodd" d="M1.23266e-07 12.59L1.41 14L7 8.41L12.59 14L14 12.59L8.41 7L14 1.41L12.59 -1.23266e-07L7 5.59L1.41 -1.10065e-06L1.10065e-06 1.41L5.59 7L1.23266e-07 12.59Z" fill="currentColor"/>',"</svg>"].join(""),$e=Autodesk.Viewing,et=$e.UI,tt=$e.GlobalManagerMixin;class it{constructor(e){this.parent=e,this.parentElement=e.mapWidgetHeader,this.setGlobalManager(e.viewer.globalManager),this.sideBySideButton=new et.Button("Minimap_SideBySide"),this.sideBySideButton.setGlobalManager(this.globalManager),this.sideBySideButton.onClick=()=>e.minimap3DExtension.setSideBySideEnabled(!e.sideBySideEnabled),this.sideBySideButton.icon.innerHTML=Ke,this.sideBySideButton.icon.style.width="20px",this.sideBySideButton.icon.style.height="20px",this.parentElement.appendChild(this.sideBySideButton.container);const t=this.getDocument();this.shrinkIcon=t.createElement("div"),this.shrinkIcon.innerHTML=Qe,this.shrinkIcon.style.width="20px",this.shrinkIcon.style.height="20px",this.sideBySideButton.container.appendChild(this.shrinkIcon),He(this.sideBySideButton,!0),this.update()}setSideBySideButtonDisabled(e){this.sideBySideButtonDisabled=e}update(){const e=this.parent.sideBySideEnabled;this.shrinkIcon.style.display=e?"block":"none",this.sideBySideButton.icon.style.display=e?"none":"block",this.sideBySideButton.setState(this.sideBySideButtonDisabled?et.Button.State.DISABLED:et.Button.State.INACTIVE);const t=Autodesk.Viewing.i18n.translate("Side by side"),i=Autodesk.Viewing.i18n.translate("Small map");this.sideBySideButton.setToolTip(e?i:t)}dtor(){this.parentElement.removeChild(this.sideBySideButton.container),this.sideBySideButton=null,this.shrinkIcon=null}}tt.call(it.prototype);const rt=Autodesk.Viewing,ot=rt.UI,nt=rt.GlobalManagerMixin;class st{constructor(e){this.parent=e,this.parentElement=e.mapWidgetHeader,this.viewer=e.viewer,this.setGlobalManager(e.viewer.globalManager),this.expandButton=new ot.Button("Minimap_Expand"),this.expandButton.setGlobalManager(this.globalManager),this.expandButton.onClick=()=>e.minimap3DExtension.expandSheetMap(),this.expandButton.icon.innerHTML=qe,this.expandButton.icon.style.width="20px",this.expandButton.icon.style.height="20px",this.parentElement.appendChild(this.expandButton.container),He(this.expandButton,!1),this.update()}update(){this.expandButton.setState(this.parent.minimap3DExtension.isSheetVisible()?ot.Button.State.INACTIVE:ot.Button.State.DISABLED);const e=Autodesk.Viewing.i18n.translate("Go to 2D");this.expandButton.setToolTip(e)}dtor(){this.viewer=null}}nt.call(st.prototype);const at={en:JSON.parse('{"@@locale":"en","@@context":"Minimap3D Extension","Side by side":"Side by side","Small map":"Small map","Go to 2D":"Go to 2D","Show sheet":"Show sheet","Hide sheet":"Hide sheet","Loading sheet...":"Loading sheet...","Loading models...":"Loading models...","No Levels":"No Levels"}'),"en-GB":JSON.parse('{"@@locale":"en","@@context":"Minimap3D Extension","Side by side":"Side By Side","Small map":"Small Map","Go to 2D":"Go to 2D","Show sheet":"Show Sheet","Hide sheet":"Hide Sheet","Loading sheet...":"Loading Sheet...","Loading models...":"Loading Models...","No Levels":"No Levels"}'),cs:JSON.parse('{"@@locale":"cs","@@context":"Rozšíření Minimap3D","Side by side":"Vedle sebe","Small map":"Malá mapa","Go to 2D":"Přejít do 2D","Show sheet":"Zobrazit list","Hide sheet":"Skrýt list","Loading sheet...":"Načítání listu...","Loading models...":"Načítání modelů...","No Levels":"Žádné úrovně"}'),de:JSON.parse('{"@@locale":"de","@@context":"Minimap3D-Erweiterung","Side by side":"Nebeneinander","Small map":"Kleine Karte","Go to 2D":"Zu 2D wechseln","Show sheet":"Plan anzeigen","Hide sheet":"Blatt ausblenden","Loading sheet...":"Plan wird geladen...","Loading models...":"Modelle werden geladen...","No Levels":"Keine Ebenen"}'),es:JSON.parse('{"@@locale":"es","@@context":"Extensión de minimapa 3D","Side by side":"En paralelo","Small map":"Mapa pequeño","Go to 2D":"Ir a 2D","Show sheet":"Mostrar plano","Hide sheet":"Ocultar plano","Loading sheet...":"Cargando plano...","Loading models...":"Cargando modelos...","No Levels":"Sin niveles"}'),fr:JSON.parse('{"@@locale":"fr","@@context":"Extension Minimap3D","Side by side":"Côte à côte","Small map":"Petite carte","Go to 2D":"Aller à la 2D","Show sheet":"Afficher une feuille","Hide sheet":"Masquer la feuille","Loading sheet...":"Chargement de la feuille…","Loading models...":"Chargement des modèles…","No Levels":"Aucun niveau"}'),"fr-CA":JSON.parse('{"@@locale":"fr-CA","@@context":"Extension Minimap3D","Side by side":"Côte à côte","Small map":"Petite carte","Go to 2D":"Aller à la 2D","Show sheet":"Afficher la feuille","Hide sheet":"Masquer la feuille","Loading sheet...":"Chargement de la feuille...","Loading models...":"Chargement des modèles...","No Levels":"Aucun niveau"}'),it:JSON.parse('{"@@locale":"it","@@context":"Estensione Minimap3D","Side by side":"Affiancato","Small map":"Mappa piccola","Go to 2D":"Vai a 2D","Show sheet":"Mostra foglio","Hide sheet":"Nascondi foglio","Loading sheet...":"Caricamento foglio in corso...","Loading models...":"Caricamento modelli in corso...","No Levels":"Nessun livello"}'),ja:JSON.parse('{"@@locale":"ja","@@context":"Minimap3D Extension","Side by side":"並べて表示","Small map":"小マップ","Go to 2D":"2D に移動","Show sheet":"シートを表示","Hide sheet":"シートを非表示","Loading sheet...":"シートをロード中...","Loading models...":"モデルをロード中...","No Levels":"レベルなし"}'),ko:JSON.parse('{"@@locale":"ko","@@context":"Minip3D 확장 프로그램","Side by side":"나란히","Small map":"작은 맵","Go to 2D":"2D로 이동","Show sheet":"시트 표시","Hide sheet":"시트 숨기기","Loading sheet...":"시트 로드 중...","Loading models...":"모델 로드 중...","No Levels":"레벨 없음"}'),pl:JSON.parse('{"@@locale":"pl","@@context":"Rozszerzenie Minimap3D","Side by side":"Równolegle","Small map":"Mała mapa","Go to 2D":"Przejdź do 2D","Show sheet":"Pokaż arkusz","Hide sheet":"Ukryj arkusz","Loading sheet...":"Wczytywanie arkusza...","Loading models...":"Wczytywanie modeli...","No Levels":"Brak poziomów"}'),"pt-BR":JSON.parse('{"@@locale":"pt","@@context":"Extensão Minimap3D","Side by side":"Lado a lado","Small map":"Mapa pequeno","Go to 2D":"Ir para 2D","Show sheet":"Mostrar folha","Hide sheet":"Ocultar folha","Loading sheet...":"Carregando folha...","Loading models...":"Carregando modelos...","No Levels":"Nenhum nível"}'),ru:JSON.parse('{"@@locale":"ru","@@context":"Расширение Minimap3D","Side by side":"Рядом","Small map":"Маленькая карта","Go to 2D":"Перейти к 2D","Show sheet":"Показать лист","Hide sheet":"Скрыть лист","Loading sheet...":"Загрузка листа...","Loading models...":"Загрузка моделей...","No Levels":"Нет уровней"}'),tr:JSON.parse('{"@@locale":"tr","@@context":"Minimap3D Uzantısı","Side by side":"Yan yana","Small map":"Küçük harita","Go to 2D":"2B haritaya git","Show sheet":"Sayfayı göster","Hide sheet":"Sayfayı gizle","Loading sheet...":"Sayfa yükleniyor...","Loading models...":"Model yükleniyor...","No Levels":"Seviye Yok"}'),"zh-Hans":JSON.parse('{"@@locale":"zh-Hans","@@context":"Minimap3D 扩展","Side by side":"并排","Small map":"小地图","Go to 2D":"转至二维","Show sheet":"显示图纸","Hide sheet":"隐藏工作表","Loading sheet...":"正在加载图纸...","Loading models...":"正在加载模型...","No Levels":"无标高"}'),"zh-Hant":JSON.parse('{"@@locale":"zh-Hant","@@context":"Minimap3D 延伸","Side by side":"並排","Small map":"小地圖","Go to 2D":"移至 2D","Show sheet":"展示圖紙","Hide sheet":"隱藏圖紙","Loading sheet...":"正在載入圖紙...","Loading models...":"正在載入模型...","No Levels":"無樓層"}'),"zh-HK":JSON.parse('{"@@locale":"zh-hk","@@context":"Minimap3D 擴充功能","Side by side":"並排","Small map":"小地圖","Go to 2D":"移至 2D","Show sheet":"展示圖紙","Hide sheet":"隱藏圖紙","Loading sheet...":"圖紙載入中…","Loading models...":"模型載入中…","No Levels":"沒有層級"}'),nl:JSON.parse('{"@@locale":"nl","@@context":"Minimap3D-extensie","Side by side":"Naast elkaar","Small map":"Kleine kaart","Go to 2D":"Ga naar 2D","Show sheet":"Blad weergeven","Hide sheet":"Hide sheet","Loading sheet...":"Blad laden...","Loading models...":"Modellen laden...","No Levels":"Geen niveaus"}'),sv:JSON.parse('{"@@locale":"sv","@@context":"Minimap3D-tillägg","Side by side":"Sida vid sida","Small map":"Liten karta","Go to 2D":"Gå till 2D","Show sheet":"Visa blad","Hide sheet":"Dölj blad","Loading sheet...":"Läser in blad...","Loading models...":"Läser in modeller...","No Levels":"Inga nivåer"}'),da:JSON.parse('{"@@locale":"da","@@context":"Minimap3D-udvidelse","Side by side":"Side om side","Small map":"Lille kort","Go to 2D":"Gå til 2D","Show sheet":"Vis ark","Hide sheet":"Skjul sheet","Loading sheet...":"Indlæser ark...","Loading models...":"Indlæser modeller...","No Levels":"Ingen niveauer"}'),no:JSON.parse('{"@@locale":"no","@@context":"Minikart-3D-utvidelse","Side by side":"Side ved side","Small map":"Lite kart","Go to 2D":"Gå til 2D","Show sheet":"Vis ark","Hide sheet":"Skjul ark","Loading sheet...":"Laster ark ...","Loading models...":"Laster modeller ...","No Levels":"Ingen nivåer"}')};var lt=__webpack_require__(4676),ct={};ct.styleTagTransform=h(),ct.setAttributes=a(),ct.insert=n().bind(null,"head"),ct.domAPI=r(),ct.insertStyleElement=c();t()(lt.A,ct);lt.A&&lt.A.locals&&lt.A.locals;const ut=Autodesk.Viewing.GlobalManagerMixin,ht=e=>e.toString()+"px";class dt{constructor(e){this.minimap3DExtension=e,this.viewer=this.minimap3DExtension.viewer,this.options=e.options,this.setGlobalManager(this.viewer.globalManager),e.extendLocalization(at),this.sideBySideOptions=this.options.sideBySideOptions||{},this.showHeader=void 0===this.options.showHeader||this.options.showHeader,this.update=this.update.bind(this),this.mapWidgetWidth=300,this.mapWidgetHeight=300,this.sideOffset=void 0!==this.options.sideOffset?this.options.sideOffset:10,this.mapWidgetTop=0,this.sideBySideOptions.left2DView?(this.mapWidgetLeft=0,this.mapWidgetRight=void 0):(this.mapWidgetLeft=void 0,this.mapWidgetRight=0),this.relMapWidgetSizeLongEdge=.25,this.relMapWidgetSizeShortEdge=.37,this.dropdown=null,this.sideBySideEnabled=this.sideBySideOptions.sideBySideDefault||!1,this.sideBySide=!1,this.expanded=!1,this.sideBySideSplit=this.sideBySideOptions.sideBySideSplit||40,this.init()}setMinimapVisible(e){if(this.visible===e)return;if(this.visible=e,!this.mapWidget)return;this.getWindow().requestAnimationFrame((()=>{this.mapWidgetRoot&&(e?this.mapWidgetRoot.classList.add("visible"):this.mapWidgetRoot.classList.remove("visible"),this.viewer.getExtension("Autodesk.ViewCubeUi",(function(t){t.displayViewCube(!e),t.displayHomeButton(!e)})))})),this.updateBimWalkInfoButtonPos(),e&&this.updateSideBySide()}initWidgets(){const e=this.getDocument(),t=this.options.additionalWrapperCss?" "+this.options.additionalWrapperCss:"";this.mapWidgetRoot=e.createElement("div"),this.mapWidgetRoot.style.width=ht(this.mapWidgetWidth),this.mapWidgetRoot.style.height=ht(this.mapWidgetHeight),this.mapWidgetRoot.className=`minimap3D ${t} `,this.mapWidgetRoot.classList.add("adsk-viewing-viewer"),this.mapWidgetRoot.classList.add(this.viewer.theme),this.mapWidgetHeader=e.createElement("div"),this.mapWidgetHeader.className="minimap-header",this.mapWidgetHeader.classList.add("adsk-viewing-viewer"),this.mapWidgetHeader.classList.add("adsk-control-group"),this.mapWidgetHeader.classList.add(this.viewer.theme),this.showHeader&&this.mapWidgetRoot.appendChild(this.mapWidgetHeader),this.mapWidget=e.createElement("div"),this.mapWidget.className="minimapScrollArea",this.mapWidgetRoot.appendChild(this.mapWidget),this.showHeader&&(this.options.onExpand&&(this.expandButton=new st(this)),this.initDropdownIfNeeded(),this.sideBySideButton=new it(this)),this.setMinimapVisible(!1),this.mapWidgetRoot.addEventListener("transitionend",(()=>{this.updateBimWalkInfoButtonPos(),this.updateSideBySide()}))}initDropdownIfNeeded(){this.showHeader&&!this.dropdown&&(this.dropdown=new Ye(this),this.sideBySideButton&&(this.sideBySideButton.dtor(),this.sideBySideButton=new it(this)))}destroyWidgets(){this.widgetAnimation&&(this.widgetAnimation.stop(),this.widgetAnimation=null),this.mapWidgetRoot.parentElement&&this.mapWidgetRoot.parentElement.removeChild(this.mapWidgetRoot),this.mapWidgetRoot=null,this.mapWidget=null,this.mapWidgetHeader=null,this.dropdown&&(this.dropdown.dtor(),this.dropdown=null),this.expandButton&&(this.expandButton.dtor(),this.expandButton=null),this.sideBySideButton&&(this.sideBySideButton.dtor(),this.sideBySideButton=null)}init(){this.initWidgets(),this.initialViewerWidth=this.viewer.container.clientWidth,this.initialViewerHeight=this.viewer.container.clientHeight,this.resizeObserver=new ResizeObserver((()=>{this.updateSideBySide(!0)})),this.resizeObserver.observe(this.viewer.clientContainer),this.updateMapSize(!0),this.viewer.clientContainer.appendChild(this.mapWidgetRoot)}destroy(){this.destroyWidgets(),this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null),this.restoreViewerContainerStyle()}getClientContainerWidth(){return this.viewer.clientContainer.clientWidth||this.initialViewerWidth}getClientContainerHeight(){return this.viewer.clientContainer.clientHeight||this.initialViewerHeight}updateToolbar(){this.sideBySideButton&&this.sideBySideButton.update(),this.expandButton&&this.expandButton.update()}update(){this.initDropdownIfNeeded(),this.minimap3DExtension.isEnabled()?this.setMinimapVisible(!0):this.setMinimapVisible(!1),this.updateToolbar(),this.updateSideBySide()}setWidgetSize(e,t,i,r,o,n){this.mapWidgetWidth=e,this.mapWidgetHeight=t,this.mapWidgetTop=i,this.mapWidgetLeft=r,this.mapWidgetRight=o,this.mapWidgetRoot.style.width=ht(e),this.mapWidgetRoot.style.height=ht(t),this.mapWidgetRoot.style.top=ht(i),this.mapWidgetRoot.style.left=void 0!==r?ht(r):"initial",this.mapWidgetRoot.style.right=void 0!==o?ht(o):"initial",void 0!==n&&(this.mapWidgetHeader.style.height=ht(n),this.mapWidgetHeader.style.opacity=(n/this.getInitialHeaderHeight()*100).toString()+"%"),this.minimap3DExtension.mapViewer&&this.minimap3DExtension.mapViewer.resize(),this.update()}setViewerSize(e,t,i,r,o){this.viewer.container.style.width=ht(e),this.viewer.container.style.height=ht(t),this.viewer.container.style.left=ht(i),this.viewer.container.style.right=ht(r),this.viewer.container.style.top=ht(o),this.viewer.resize(),this.update()}updateMapSize(e,t){let i,r,o,n,s,a,l=this.getClientContainerWidth(),c=this.getClientContainerHeight();if(this.expanded)i=l,r=c,o=0,this.sideBySideOptions.left2DView?n=0:s=0,a=!1;else if(this.sideBySide)this.verticalSideBySide?(i=l,r=c*(this.sideBySideSplit/100)):(i=l*(this.sideBySideSplit/100),r=c),o=0,this.sideBySideOptions.left2DView?n=0:s=0,a=!0;else{let e=Math.max(l,c),t=Math.min(l,c);const u=.66;i=Math.min(this.relMapWidgetSizeLongEdge*e,this.relMapWidgetSizeShortEdge*t),r=i*u+this.mapWidgetHeader.clientHeight,o=10,this.sideBySideOptions.left2DView?n=this.sideOffset:s=this.sideOffset,a=!0}return e&&!this.widgetAnimation?this.setWidgetSize(i,r,o,n,s):this.animateWidgetSize(i,r,o,n,s,a,t)}getInitialHeaderHeight(){return this.headerHeight||(this.headerHeight=this.mapWidgetHeader.clientHeight),this.headerHeight}animateWidgetSize(e,t,i,r,o){let n=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],s=arguments.length>6?arguments[6]:void 0;const a=this.mapWidgetWidth,l=this.mapWidgetHeight,c=this.mapWidgetTop,u=this.mapWidgetLeft,h=this.mapWidgetRight,d=this.mapWidgetHeader.clientHeight;s=s||this.minimap3DExtension.resizeDuration,this.widgetAnimation&&(this.widgetAnimation.stop(),this.widgetAnimation=null);const p=s=>{s=Autodesk.Viewing.Private.smootherStep(s);const p=Autodesk.Viewing.Private.lerp(a,e,s),g=Autodesk.Viewing.Private.lerp(l,t,s),f=Autodesk.Viewing.Private.lerp(c,i,s),v=void 0!==r?Autodesk.Viewing.Private.lerp(u||0,r,s):void 0,m=void 0!==o?Autodesk.Viewing.Private.lerp(h||0,o,s):void 0,y=Autodesk.Viewing.Private.lerp(d,n?this.getInitialHeaderHeight()+2*(10-i):0,s);this.setWidgetSize(p,g,f,v,m,y)};return new Promise((e=>{this.widgetAnimation=Autodesk.Viewing.Private.fadeValue(0,1,s,p,(()=>{this.widgetAnimation=null,e()}))}))}updateBimWalkInfoButtonPos(){const e=this.viewer.getExtension("Autodesk.BimWalk"),t=e&&e.getInfoButton();if(!t)return;if(e.options.disableBimWalkInfoIcon)return;let i=this.getWindow().getComputedStyle(this.mapWidgetRoot),r=this.visible||i.opacity>0?this.mapWidgetWidth:0;this.sideBySide&&(r=0);const o=r+20;t.style.right=ht(o)}setSideBySideEnabled(e){this.sideBySideEnabled=e,this.updateSideBySide()}setSideBySideSplit(e){this.sideBySideSplit=e,this.updateSideBySide(!0),this.updateBimWalkInfoButtonPos()}animateViewerSize(e,t,i,r,o,n){const s=this.viewer.container.clientWidth,a=this.viewer.container.clientHeight,l=this.viewer.container.clientLeft,c=this.viewer.container.clientRight,u=this.viewer.container.clientTop;this.viewerResizeAnimation&&(this.viewerResizeAnimation.stop(),this.viewerResizeAnimation=null),n=n||this.minimap3DExtension.resizeDuration;const h=n=>{n=Autodesk.Viewing.Private.smootherStep(n);const h=Autodesk.Viewing.Private.lerp(s,e,n),d=Autodesk.Viewing.Private.lerp(a,t,n),p=Autodesk.Viewing.Private.lerp(u,o,n),g=Autodesk.Viewing.Private.lerp(l,i,n),f=Autodesk.Viewing.Private.lerp(c,r,n);this.setViewerSize(h,d,g,f,p)};return new Promise((e=>{this.viewerResizeAnimation=Autodesk.Viewing.Private.fadeValue(0,1,n,h,(()=>{this.viewerResizeAnimation=null,e()}))}))}updateSideBySide(e){let t,i,r,o,n,s=this.sideBySide;if(this.sideBySide=this.visible&&this.sideBySideEnabled,!e&&s===this.sideBySide)return;const a=this.getClientContainerHeight(),l=this.getClientContainerWidth();this.sideBySide?(this.mapWidgetRoot.classList.add("side-by-side"),l>=a?(t=(100-this.sideBySideSplit)/100*l,i=a,this.sideBySideOptions.left2DView?(r=this.sideBySideSplit/100*l,o=0):(r=0,o=this.sideBySideSplit/100*l),n=0,this.sideBySideOptions.left2DView&&this.mapWidgetRoot.classList.add("left-2d-view"),this.verticalSideBySide=!1):(t=l,i=(100-this.sideBySideSplit)/100*a,r=0,o=0,n=this.sideBySideSplit/100*a,this.verticalSideBySide=!0),this.sideBySideOptions.onSideBySideUpdated&&this.sideBySideOptions.onSideBySideUpdated(this.sideBySideSplit)):(t=l,i=a,r=0,o=0,n=0,this.mapWidgetRoot.classList.remove("side-by-side"),this.mapWidgetRoot.classList.remove("left-2d-view")),e?this.setViewerSize(t,i,r,o,n):this.animateViewerSize(t,i,r,o,n),this.updateMapSize(e)}restoreViewerContainerStyle(){this.viewerResizeAnimation&&(this.viewerResizeAnimation.stop(),this.viewerResizeAnimation=null),this.viewer.container.style.width="100%",this.viewer.container.style.height="100%",this.viewer.container.style.left="",this.viewer.container.style.right="",this.viewer.container.style.top="",this.viewer.resize()}getMapViewerContainer(){return this.mapWidget}expandSheetMap(e){if(!this.expanded)return this.expanded=!0,this.mapWidgetHeader.style.pointerEvents="none",this.setSideBySideEnabled(!1),this.updateMapSize(!1,e)}}ut.call(dt.prototype);var pt=__webpack_require__(1658),gt={};gt.styleTagTransform=h(),gt.setAttributes=a(),gt.insert=n().bind(null,"head"),gt.domAPI=r(),gt.insertStyleElement=c();t()(pt.A,gt);pt.A&&pt.A.locals&&pt.A.locals;const ft=Autodesk.Viewing,vt=ft.UI,mt=ft.GlobalManagerMixin,yt=AutodeskNamespace("Autodesk.AEC"),_t=16,Et=e=>e.toString()+"px";class At{constructor(e){this.minimap3DExtension=e,this.viewer=this.minimap3DExtension.viewer,this.options=e.options,this.setGlobalManager(this.viewer.globalManager),this.update=this.update.bind(this),this.onResize=this.onResize.bind(this),this.isLargeMode=this.options.isLargeMode||!1,this.toolbarHeight=this.options.toolbarHeight||308,this.isTablet=this.options.isTablet||!1,this.init()}initWidgets(){const e=this.getDocument(),t=this.options.additionalWrapperCss?" "+this.options.additionalWrapperCss:"";this.mapWidget=e.createElement("div"),this.mapWidget.className=`minimap3D-mobile ${t} `,this.mapWidget.classList.add("adsk-viewing-viewer"),this.mapWidget.classList.add(this.viewer.theme),this.viewer.clientContainer.appendChild(this.mapWidget),this.buttonsContainer=e.createElement("div"),this.buttonsContainer.className="buttons-container",this.mapWidget.appendChild(this.buttonsContainer);const i="#0696D7";this.resizeButton=new vt.Button("minimap_mobile_resize"),this.resizeButton.setGlobalManager(this.viewer.globalManager),this.resizeButton.container.style.pointerEvents="auto",this.resizeButton.icon.style.width="20px",this.resizeButton.icon.style.height="20px",this.resizeButton.icon.style.paddingLeft="5px",this.resizeButton.icon.style.paddingTop="3px",this.resizeButton.icon.style.color=i,this.resizeButton.onClick=()=>this.minimap3DExtension.setSideBySideEnabled(!this.isLargeMode),this.buttonsContainer.appendChild(this.resizeButton.container),this.divider=e.createElement("div"),this.divider.className="divider",this.buttonsContainer.appendChild(this.divider),this.closeButton=new vt.Button("minimap_mobile_close"),this.closeButton.setGlobalManager(this.viewer.globalManager),this.closeButton.container.style.pointerEvents="auto",this.closeButton.icon.innerHTML=Xe,this.closeButton.icon.style.width="20px",this.closeButton.icon.style.height="20px",this.closeButton.icon.style.paddingLeft="7px",this.closeButton.icon.style.paddingTop="2px",this.closeButton.icon.style.color=i,this.closeButton.onClick=()=>this.minimap3DExtension.changeMinimapVisibility(!1),this.buttonsContainer.appendChild(this.closeButton.container),this.setSideBySideEnabled(this.isLargeMode),this.changeDeviceType(this.isTablet),this.update(!0)}destroyWidgets(){this.mapWidget.parentElement&&this.mapWidget.parentElement.removeChild(this.mapWidget),this.mapWidget=null,this.resizeButton=null,this.closeButton=null,this.divider=null}init(){this.initWidgets(),this.viewer.addEventListener(ft.VIEWER_RESIZE_EVENT,this.onResize)}destroy(){this.destroyWidgets(),this.viewer.removeEventListener(ft.VIEWER_RESIZE_EVENT,this.onResize)}setMinimapVisible(e){this.visible!==e&&(this.visible=e,this.mapWidget&&(e?this.mapWidget.classList.add("visible"):this.mapWidget.classList.remove("visible")))}getMapViewerContainer(){return this.mapWidget}update(e){const t=this.minimap3DExtension.isEnabled();if(this.setMinimapVisible(t),t)return this.updateWidgetClasses(),this.updateToolbar(),this.updateWidgetSize(e)}updateToolbar(){this.sideBySideButton&&this.sideBySideButton.update(),this.expandButton&&this.expandButton.update()}isPortrait(){const e=this.viewer.impl.getCanvasBoundingClientRect();return e.width<e.height}updateWidgetClasses(){this.isPortrait()?!this.mapWidget.classList.contains("portrait")&&this.mapWidget.classList.add("portrait"):this.mapWidget.classList.contains("portrait")&&this.mapWidget.classList.remove("portrait"),this.isTablet?this.mapWidget.classList.contains("phone")&&this.mapWidget.classList.remove("phone"):!this.mapWidget.classList.contains("phone")&&this.mapWidget.classList.add("phone")}updateWidgetSize(e){const t=this.viewer.impl.getCanvasBoundingClientRect(),i=this.isPortrait();let r,o;if(this.isTablet)if(this.isLargeMode)if(i){r=t.width-32;o=Math.min(t.height-this.toolbarHeight,t.height/2)-32-32}else r=t.width/2-32,o=t.height-32;else{const e=Math.max(t.width,t.height),i=Math.min(t.width,t.height);r=Math.min(.35*e,.45*i),o=.75*r}else if(this.isLargeMode)i?(r=t.width,o=t.height-_t):(r=t.width-_t,o=t.height);else if(i){r=t.width;const e=Math.min(t.height-this.toolbarHeight,t.height/2.5)-32;o=Math.min(t.width,e)}else r=t.width/2.5,o=t.height;return r=Math.floor(r),o=Math.floor(o),this.animateWidgetSize(r,o,e)}animateWidgetSize(e,t,i){if(e===this.mapWidgetWidth&&t===this.mapWidgetHeight)return Promise.resolve();const r=this.mapWidgetWidth||e,o=this.mapWidgetHeight||t;if(this.widgetAnimation&&(this.widgetAnimation.stop(),this.widgetAnimation=null),i)return this.setWidgetSize(e,t),Promise.resolve();const n=i=>{i=Autodesk.Viewing.Private.smootherStep(i);const n=Autodesk.Viewing.Private.lerp(r,e,i),s=Autodesk.Viewing.Private.lerp(o,t,i);this.setWidgetSize(n,s)};return new Promise((e=>{this.widgetAnimation=Autodesk.Viewing.Private.fadeValue(0,1,this.minimap3DExtension.resizeDuration,n,(()=>{this.widgetAnimation=null,e()}))}))}setWidgetSize(e,t){var i;this.mapWidget.style.width=Et(e),this.mapWidget.style.height=Et(t),this.mapWidgetWidth=e,this.mapWidgetHeight=t,null===(i=this.minimap3DExtension.mapViewer)||void 0===i||i.resize()}setSideBySideEnabled(e){this.isLargeMode=e,this.resizeButton.icon.innerHTML=this.isLargeMode?Je:Ze,this.minimap3DExtension.fireEvent({type:yt.Minimap3DExtension.Events.LARGE_MODE_CHANGED,isLargeMode:e}),this.update()}changeDeviceType(e){this.isTablet=e,this.mapWidget.style.margin=this.isTablet?Et(_t):"initial",this.resizeButton.container.style.display=this.isTablet?"block":"none",this.divider.style.display=this.isTablet?"block":"none",this.update(!0)}setToolbarHeight(e){this.toolbarHeight=e,this.update(!0)}onResize(){this.update(!0)}}mt.call(At.prototype);const xt={MAIN_MAP_CHANGED_EVENT:"mapChanged",CHANGING_SHEET_EVENT:"changingSheet",SHEET_VISIBILITY_CHANGED_EVENT:"sheetVisibilityChanged"},Ct=Autodesk.Viewing,wt=Ct.Private,bt=wt.Empty2DModelLoader,Mt=AutodeskNamespace("Autodesk.AEC"),Tt="Autodesk.AEC.AvatarExtension",Vt="Autodesk.AEC.TopViewRendererExtension",St="miniMap3D",Lt={Minimap3DLayout:dt,Minimap3DMobileLayout:At},Rt={VISIBILITY_CHANGED:"visibility_changed",LARGE_MODE_CHANGED:"large_mode_changed"};class Pt extends Ct.Extension{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,t),Ct.EventDispatcher.prototype.apply(this),this.mapViewerHighlightEnabled=t.mapViewerHighlightEnabled||!1,this.mapViewerSelectionEnabled=t.mapViewerSelectionEnabled||!1,this.update=this.update.bind(this),this.onModelAdded=this.onModelAdded.bind(this),this.changeMinimapVisibility=this.changeMinimapVisibility.bind(this),this.resizeDuration=.3}async load(){var e;return this.levelExt=await this.viewer.loadExtension("Autodesk.AEC.LevelsExtension"),this.loaded=!0,this.viewer.prefs.add(St,!0),this.configureSettings()||this.updateSettingsPanel||(this.updateSettingsPanel=this.configureSettings.bind(this),this.viewer.addEventListener(Ct.SETTINGS_PANEL_CREATED_EVENT,this.updateSettingsPanel)),this.viewer.addEventListener(Ct.TOOL_CHANGE_EVENT,this.update),this.viewer.addEventListener(Ct.MODEL_ADDED_EVENT,this.onModelAdded),null!==(e=this.levelExt)&&void 0!==e&&e.floorSelector&&this.levelExt.floorSelector.addEventListener(Autodesk.AEC.FloorSelector.FLOOR_DATA_CHANGED,this.update),this.activate(),!0}unload(){return this.loaded=!1,this.deactivate(),this.updateSettingsPanel&&(this.viewer.removeEventListener(Ct.SETTINGS_PANEL_CREATED_EVENT,this.updateSettingsPanel),this.updateSettingsPanel=null),this.viewer.removeEventListener(Ct.TOOL_CHANGE_EVENT,this.update),this.viewer.removeEventListener(Ct.MODEL_ADDED_EVENT,this.onModelAdded),this.levelExt=null,!0}onModelAdded(){this.viewer.impl.is2d?this.deactivate():this.activate()}activate(){this.active||(this.update(),this.active=!0)}deactivate(){var e;this.active&&(this.active=!1,this.mapViewer&&(this.mapViewer.finish(),this.sheetSyncExtension=null,this.mapViewer=null),this.layout&&(this.layout.destroy&&this.layout.destroy(),this.layout=null),null!==(e=this.levelExt)&&void 0!==e&&e.floorSelector&&this.levelExt.floorSelector.removeEventListener(Autodesk.AEC.FloorSelector.FLOOR_DATA_CHANGED,this.update))}isEnabled(){var e,t;const i=this.viewer.prefs&&this.viewer.prefs.get(St),r=this.viewer.getExtension("Autodesk.BimWalk"),o=null==r||null===(e=r.tool)||void 0===e?void 0:e.active,n=this.options.enableWithoutAecModelData||(null===(t=this.levelExt)||void 0===t||null===(t=t.floorSelector)||void 0===t||null===(t=t.floorData)||void 0===t?void 0:t.length)>0;return i&&(o&&n||this.options.minimapDebugMode)}changeMinimapVisibility(e){this.viewer.prefs&&this.viewer.prefs.set(St,e),this.fireEvent({type:Rt.VISIBILITY_CHANGED,visible:e}),wt.analytics.track("viewer.3d_minimap",{action:e?"Show":"Hide"}),this.update()}initLayoutIfNeeded(){if(this.layout)return;let e;this.options.LayoutClass?"string"==typeof this.options.LayoutClass?(e=Lt[this.options.LayoutClass],e||(console.warn("Invalid LayoutClass. Fallback to default layout."),e=Lt.Minimap3DLayout)):e=this.options.LayoutClass:e=Lt.Minimap3DLayout,this.layout=new e(this)}initMapViewerIfNeeded(){if(this.mapViewer)return;const e=this.layout.getMapViewerContainer();if(this.options.getMapViewer)this.mapViewer=this.options.getMapViewer(e);else{const t=this.options.MapViewerClass||Autodesk.Viewing.Viewer3D;this.mapViewer=new t(e,{}),this.mapViewer.start(void 0,void 0,void 0,void 0,{webglInitParams:{alpha:!0}})}this.mapViewer.config.extensions=this.mapViewer.config.extensions||[],this.mapViewer.config.sheetSyncOptions={targetViewer:this.viewer,cropToViewport:!0,hideSheetWhenNotFocused:!0,autoSwitchSheet:!0,hidePaper:!0,useCustomModel:this.options.useCustomModel,showSheet:this.options.showSheet,loadDocumentNode:this.options.loadDocumentNode,unloadModel:this.options.unloadModel,minimapDebugMode:this.options.minimapDebugMode,useOnlyAecModelDataViewports:this.options.useOnlyAecModelDataViewports},this.mapViewer.config.avatarOptions={trackUsage:this.options.trackUsage,autoFocus:this.options.autoFocus??!this.options.minimapDebugMode},this.mapViewer.config.topViewRendererOptions={minimapDebugMode:this.options.minimapDebugMode},-1===this.mapViewer.config.extensions.indexOf(Tt)&&this.mapViewer.config.extensions.push(Tt),-1===this.mapViewer.config.extensions.indexOf(Vt)&&this.mapViewer.config.extensions.push(Vt),this.mapViewer.disableHighlight(!this.mapViewerHighlightEnabled),this.mapViewer.disableSelection(!this.mapViewerSelectionEnabled),this.mapViewer.getExtensionAsync("Autodesk.AEC.SheetSyncExtension").then((e=>{this.sheetSyncExtension=e})),this.mapViewer.addEventListener(xt.SHEET_VISIBILITY_CHANGED_EVENT,this.update),this.mapViewer.loadModel("Dummy",{fileLoader:bt,headlessViewer:!0}),this.mapViewer.impl.setFrameTimePriority(.01),this.mapViewer.getExtensionAsync(Vt).then((e=>{e.topViewViewer.impl.setFrameTimePriority(.1)}))}update(){this.isEnabled()&&(this.initLayoutIfNeeded(),this.initMapViewerIfNeeded()),this.layout&&this.layout.update&&this.layout.update()}configureSettings(){if(!this.viewer.getSettingsPanel)return!1;let e=this.viewer.getSettingsPanel();if(!e||!e.is3dMode)return!1;let t=Ct.Extensions.ViewerSettingTab.Navigation;return e.addLabel(t,"3D Mini-map"),e.showMinimapChkBoxId||(e.showMinimapChkBoxId=e.addCheckbox(t,"Show 3D mini-map","Toggles availability of the 3D mini-map when using first person mode",!0,this.changeMinimapVisibility,St)),!0}setSheetMapEnabled(e){this.sheetSyncExtension&&(this.sheetSyncExtension.setShowSheet(e),this.update())}getSheetMapEnabled(){var e;return null===(e=this.sheetSyncExtension)||void 0===e?void 0:e.getShowSheet()}setSideBySideEnabled(e){var t;null!==(t=this.layout)&&void 0!==t&&t.setSideBySideEnabled&&(this.layout.setSideBySideEnabled(e),wt.analytics.track("viewer.3d_minimap",{action:e?"LargeView":"SmallView"}))}setSideBySideSplit(e){var t;null!==(t=this.layout)&&void 0!==t&&t.setSideBySideSplit&&this.layout.setSideBySideSplit(e)}isSheetVisible(){var e;return null===(e=this.sheetSyncExtension)||void 0===e?void 0:e.isSheetVisible()}setLockDragDirection(e){var t;null===(t=this.mapViewer.getExtension(Tt))||void 0===t||t.setDragDirectionLocked(e)}async waitForRotationDone(){const e=this.mapViewer.getExtension(Vt);await e.waitForRotationDone()}async hideAvatarAndWait(){const e=this.mapViewer.getExtension(Tt);await e.hide()}async expandSheetMap(){const e=this.sheetSyncExtension.sheetMap.getSheetNode();this.sheetSyncExtension.expandCropBounds(this.resizeDuration),this.sheetSyncExtension.changePaperVisibility(!0),await this.layout.expandSheetMap(this.resizeDuration),await this.waitForRotationDone(),this.sheetSyncExtension.setSheetOpaque(this.resizeDuration),await this.hideAvatarAndWait();const t=this.mapViewer.getState(),i=await e,r=i.getInputFileType(),o=1===this.mapViewer.getVisibleModels().length?this.mapViewer.model.getDocumentNode().getInputFileType():"Aggregate";wt.analytics.track("viewer.3d_minimap.open_sheet",{file_2d_extension:r,file_3d_extension:o}),await this.options.onExpand(i,this.sheetSyncExtension.getCustomHash()),this.viewer.restoreState(t,void 0,!0)}}Mt.Minimap3DExtension=Pt,Mt.Minimap3DExtension.Events=Rt,Autodesk.Viewing.theExtensionManager.registerExtension("Autodesk.AEC.Minimap3DExtension",Pt);const Dt=AutodeskNamespace("Autodesk.AEC");class Ot extends Autodesk.Viewing.Extension{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),this.loadedSheets={},this.sheetsPerLevelCache={},this.zPositionPerLevel={},this.onModelRootLoaded=this.onModelRootLoaded.bind(this),this.onModelChanged=this.onModelChanged.bind(this)}async load(){this.levelExtension=await this.viewer.loadExtension("Autodesk.AEC.LevelsExtension"),this.addListeners();const e=N(this.viewer);return this.init(e),!0}onModelChanged(e){let{model:t}=e;if(t.is2d())return;const i=N(this.viewer);i!==this.model3D&&(this.unloadAll(),this.init(i))}init(e){this.loadedSheets={},this.sheetsPerLevelCache={},this.zPositionPerLevel={},this.floorSelector=this.levelExtension.floorSelector,this.model3D=e,e&&(this.rootNode=this.model3D.getDocumentNode().getRootNode(),this.document=this.rootNode.getDocument(),this.aec=this.rootNode.getAecModelData())}unload(){return this.removeListeners(),this.unloadAll(),this.floorSelector=null,this.model3D=null,this.rootNode=null,this.document=null,this.aec=null,!0}addListeners(){this.viewer.addEventListener(Autodesk.Viewing.MODEL_ROOT_LOADED_EVENT,this.onModelRootLoaded),this.viewer.addEventListener(Autodesk.Viewing.MODEL_ADDED_EVENT,this.onModelChanged),this.viewer.addEventListener(Autodesk.Viewing.MODEL_REMOVED_EVENT,this.onModelChanged)}removeListeners(){this.viewer.removeEventListener(Autodesk.Viewing.MODEL_ROOT_LOADED_EVENT,this.onModelRootLoaded),this.viewer.removeEventListener(Autodesk.Viewing.MODEL_ADDED_EVENT,this.onModelChanged),this.viewer.removeEventListener(Autodesk.Viewing.MODEL_REMOVED_EVENT,this.onModelChanged)}getHashNameForViewportAndLevel(e,t){return e.viewportGuid+"."+t}onModelRootLoaded(e){let{model:t}=e;if(t.is3d())return;const i=t.loader.options.customHash,r=this.loadedSheets[i];if(!r||!r.loading)return void Autodesk.Viewing.Private.logger.warn("Model root loaded called for sheet not being loaded");const o=t.getUnitScale(),n=$.get2DTo3DMatrix(r.viewport,o),s=this.floorSelector.floorData[r.levelIndex],a=this.model3D.getModelToViewerTransform();a&&n.multiplyMatrices(a,n),Object.prototype.hasOwnProperty.call(this.zPositionPerLevel,r.levelIndex)?this.zPositionPerLevel[r.levelIndex]+=.001:this.zPositionPerLevel[r.levelIndex]=0;const l=1/12+1/120+this.zPositionPerLevel[r.levelIndex],c=new THREE.Vector3;c.setFromMatrixPosition(n),c.z=s.zMin+l,n.setPosition(c),t.setPlacementTransform(n)}getAvailableSheetsForLevel(e){if(this.sheetsPerLevelCache[e])return this.sheetsPerLevelCache[e];const t=this.floorSelector.floorData[e];let i=$.findViewportsForLevel(this.aec,t.guid);if(i=i.filter($.supports2DTo3DTransform),0===i.length)return Autodesk.Viewing.Private.logger.warn("No supported viewports for current level"),[];const r=[],o=new THREE.Box3,n=new THREE.Vector3;return i.forEach((e=>{const t=this.rootNode.search({type:"geometry",role:"2d",guid:e.sheetGuid});if(t.length){o.set(e.sectionBox.min,e.sectionBox.max);const i=Autodesk.Viewing.BubbleNode.readMatrixFromArray12(e.sectionBox.transform);o.applyMatrix4(i);const s=o.getSize(n);r.push({viewport:e,node:t[0],boxSize:s.x*s.y})}})),r.sort(((e,t)=>t.boxSize-e.boxSize)),this.sheetsPerLevelCache[e]=r,r}loadSheetFromLevel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const r=this.getAvailableSheetsForLevel(e);if(!r.length)return;const o=r[t],n=this.getHashNameForViewportAndLevel(o.viewport,e),s=o.node;if(this.loadedSheets[n]){const e=this.loadedSheets[n];return e.loading||this.viewer.showModel(e.model),void(i&&i({hash:n,model:e.model}))}const a={isAEC:!0,useConsolidation:!1,preserveView:!0,keepCurrentModels:!0,disable3DModelLayers:!0,disablePrecomputedNodeBoxes:!0,noShadow:!0,doNotCut:!0,customHash:n};this.options.hidePaper&&(a.modelSpace=!0,a.bgColor=0),this.loadedSheets[n]={node:s,levelIndex:e,sheetIndex:t,viewport:o.viewport,loading:!0},this.viewer.loadDocumentNode(this.document,s,a).then((e=>{this.loadedSheets[n]?(this.loadedSheets[n].loading=!1,this.loadedSheets[n].model=e,e.invalidateBBoxes(),i&&i({hash:n,model:e})):i&&i({})}))}findLoadedSheetsFromLevelIndex(e){const t=[];for(const i in this.loadedSheets)this.loadedSheets[i].levelIndex===e&&t.push(i);return t}findLoadedSheetFromLevelAndSheetIndex(e,t){for(const i in this.loadedSheets)if(this.loadedSheets[i].levelIndex===e&&this.loadedSheets[i].sheetIndex===t)return i}unloadSheet(e){const t=this.loadedSheets[e];t&&(this.viewer.unloadDocumentNode(t.node),delete this.loadedSheets[e])}hideModel(e){const t=this.loadedSheets[e];t&&(t.model?this.viewer.hideModel(t.model):t.loading&&this.unloadSheet(e))}hideSheetFromLevel(e,t){const i=this.findLoadedSheetFromLevelAndSheetIndex(e,t);i&&this.hideModel(i)}hideAllSheetsFromLevel(e){this.findLoadedSheetsFromLevelIndex(e).forEach((e=>{this.hideModel(e)}))}unloadSheetsFromLevel(e){this.findLoadedSheetsFromLevelIndex(e).forEach((e=>{this.unloadSheet(e)}))}unloadAll(){for(const e in this.loadedSheets)this.viewer.unloadDocumentNode(this.loadedSheets[e].node);this.loadedSheets={}}}Dt.HypermodelingExtension=Ot,Autodesk.Viewing.theExtensionManager.registerExtension("Autodesk.AEC.Hypermodeling",Ot);var It=__webpack_require__(8951),Nt=__webpack_require__.n(It);const kt=new THREE.Vector3(0,1,0);let Bt=null;const Ft=function(e,t,i,r,o){let n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:kt,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:kt;const a=THREE.Box3.prototype.getCenter.call(t,new THREE.Vector3);let l=Math.abs(e.position.x-a.x)>Number.EPSILON||Math.abs(e.position.y-a.y)>Number.EPSILON||Math.abs(e.position.z-r)>Number.EPSILON;return e.position.copy(a),e.position.z=r,l||(l=Math.abs(e.target.x-e.position.x)>Number.EPSILON||Math.abs(e.target.y-e.position.y)>Number.EPSILON||Math.abs(e.target.z-(e.position.z-o))>Number.EPSILON||e.isPerspective),e.target.copy(e.position),e.target.z-=o,e.isPerspective=!1,l||(l=Math.abs(e.up.x-n.x)>Number.EPSILON||Math.abs(e.up.y-n.y)>Number.EPSILON||Math.abs(e.up.z-n.z)>Number.EPSILON||Math.abs(e.worldup.x-s.x)>Number.EPSILON||Math.abs(e.worldup.y-s.y)>Number.EPSILON||Math.abs(e.worldup.z-s.z)>Number.EPSILON),e.up.copy(n),e.worldup.copy(s),l||(l=0!==e.near||Math.abs(e.far-(r-i))>Number.EPSILON),e.near=0,e.far=r-i,e.updateCameraMatrices(),l},zt=(e,t,i)=>{let r=Math.cos(i),o=Math.sin(i),n=e.x-t.x,s=e.y-t.y;e.x=n*r-s*o+t.x,e.y=n*o+s*r+t.y},jt=(e,t)=>{var i=t.max.x-t.min.x,r=t.max.y-t.min.y;e.x-=t.min.x,e.y-=t.min.y,e.x/=i,e.y/=r},Ut=(e,t)=>{const i=t.x-e.x,r=t.y-e.y;let o=Math.atan2(r,i);return o+=Math.PI/2,o};function Gt(e,t){const i=e.viewportBounds.getSize(new THREE.Vector3);return((e,t,i,r)=>{const o=e.clone().applyProjection(t);return new THREE.Vector2((o.x+1)/2*i,(1-o.y)/2*r)})(t,e.mapMatrix,i.x,i.y)}function Wt(e,t,i,r){const o=e.viewportBounds.getSize(new THREE.Vector3);return((e,t,i,r,o,n)=>{const s=e/o*2-1,a=t/n*2-1;let l=new THREE.Vector3(s,-a,0).applyProjection(r);return l.z=i,l})(t,i,r,e.mapMatrixInv,o.x,o.y)}function Yt(e,t){t.y=e.viewportBounds.getSize(new THREE.Vector3).y-t.y;const i=e.viewportBounds.min;t.x+=i.x,t.y+=i.y}const Ht=.001;function qt(e,t,i,r){let o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],n=i.x,s=i.y;o||(n-=.5,s-=.5);const a=t.clientToWorld(n,s,void 0,!0);i.copy(a.point);const l=e.viewportBounds.min;if(i.x-=l.x,i.y-=l.y,i.y=e.viewportBounds.getSize(new THREE.Vector3).y-i.y,r){const t=e.viewportBounds.getSize(new THREE.Vector3);i.x=THREE.Math.clamp(i.x,Ht,t.x-Ht),i.y=THREE.Math.clamp(i.y,Ht,t.y-Ht)}}function Kt(e){const t=e.navigation.getCameraUpVector();return Math.atan2(t.y,t.x)-.5*Math.PI}const Qt=Autodesk.Viewing.GlobalManagerMixin,Zt=new THREE.Vector3(0,0,1),Jt=new THREE.Vector3,Xt=Autodesk.Viewing.Private;class $t{constructor(e){this.avatarWidget=e,this.targetViewer=e.targetViewer,this.transforms=e.transforms,this.setGlobalManager(e.globalManager),this.dragDirectionStart=this.dragDirectionStart.bind(this),this.dragDirectionMove=this.dragDirectionMove.bind(this),this.dragDirectionEnd=this.dragDirectionEnd.bind(this),this.dragPositionStart=this.dragPositionStart.bind(this),this.dragPositionMove=this.dragPositionMove.bind(this),this.dragPositionEnd=this.dragPositionEnd.bind(this),this.onMouseWheel=this.onMouseWheel.bind(this),this.lastAngle=void 0,this.isDragging=!1,this.isRotating=!1,this.isDragDirectionLocked=!1,this.active=!1,this.names=["avatar-tool"]}getNames(){return this.names}getName(){return this.names[0]}isActive(){return this.active}activate(){this.isActive()||(this.active=!0,this.avatarWidget.widgetUI.hitArea.addEventListener("mousedown",this.dragPositionStart),this.avatarWidget.widgetUI.hitArea.addEventListener("touchstart",this.dragPositionStart),this.avatarWidget.widgetUI.addEventListener("mousedown",this.dragDirectionStart),this.avatarWidget.widgetUI.addEventListener("touchstart",this.dragDirectionStart),this.avatarWidget.canvasWrap&&(this.avatarWidget.widgetUI.hitArea.addEventListener("mousewheel",this.onMouseWheel),this.avatarWidget.widgetUI.hitArea.addEventListener("DOMMouseScroll",this.onMouseWheel),this.avatarWidget.widgetUI.addEventListener("mousewheel",this.onMouseWheel),this.avatarWidget.widgetUI.addEventListener("DOMMouseScroll",this.onMouseWheel)))}deactivate(){this.isActive()&&(this.active=!1,this.isDragDirectionLocked=!1,this.avatarWidget.widgetUI.hitArea.removeEventListener("mousedown",this.dragPositionStart),this.avatarWidget.widgetUI.hitArea.removeEventListener("touchstart",this.dragPositionStart),this.avatarWidget.widgetUI.removeEventListener("mousedown",this.dragDirectionStart),this.avatarWidget.widgetUI.removeEventListener("touchstart",this.dragDirectionStart),this.avatarWidget.canvasWrap&&(this.avatarWidget.widgetUI.hitArea.removeEventListener("mousewheel",this.onMouseWheel),this.avatarWidget.widgetUI.hitArea.removeEventListener("DOMMouseScroll",this.onMouseWheel),this.avatarWidget.widgetUI.removeEventListener("mousewheel",this.onMouseWheel),this.avatarWidget.widgetUI.removeEventListener("DOMMouseScroll",this.onMouseWheel)),this.dragPositionEnd(),this.dragDirectionEnd())}onMouseWheel(e){const t=new MouseEvent(e.type,e);t.wheelDelta=e.wheelDelta,t.deltaY=e.deltaY,this.avatarWidget.canvasWrap.dispatchEvent(t),t.defaultPrevented&&e.preventDefault()}screenToMap(e,t){e.type.indexOf("touch")>=0&&(e.clientX=e.touches[0].pageX,e.clientY=e.touches[0].pageY);const i=this.avatarWidget.container.getBoundingClientRect(),r=new THREE.Vector2(e.clientX-i.left,e.clientY-i.top);return this.transforms.widgetToMapPixels(r,t),r}dragPositionStart(e){this.addWindowEventListener("mousemove",this.dragPositionMove),this.addWindowEventListener("mouseup",this.dragPositionEnd),this.addWindowEventListener("touchmove",this.dragPositionMove),this.addWindowEventListener("touchend",this.dragPositionEnd),e.stopPropagation(),e.preventDefault(),this.isDragging=!0,this.avatarWidget.dispatchEvent({type:Autodesk.AEC.AvatarEvents.DRAG_START_EVENT})}dragPositionMove(e){const{x:t,y:i}=this.screenToMap(e,!0),r=this.targetViewer.impl.camera,o=r.position.z,n=r.position.clone(),s=this.transforms.mapPixelsToWorld(t,i,o);r.position.copy(s);const a=r.position.clone().sub(n);r.target.add(a),r.target.z=o,this.targetViewer.impl.invalidate(!0,!0,!0),this.targetViewer.dispatchEvent({type:Autodesk.Viewing.CAMERA_CHANGE_EVENT,camera:r}),e.stopPropagation(),this.avatarWidget&&this.avatarWidget.dispatchEvent({type:Autodesk.AEC.AvatarEvents.DRAG_MOVE_EVENT,camera:r})}dragPositionEnd(e){this.removeWindowEventListener("mousemove",this.dragPositionMove),this.removeWindowEventListener("mouseup",this.dragPositionEnd),this.removeWindowEventListener("touchmove",this.dragPositionMove),this.removeWindowEventListener("touchend",this.dragPositionEnd),e&&e.stopPropagation(),this.isDragging=!1,this.avatarInteractionTracked||(this.avatarInteractionTracked=!0,this.avatarWidget&&this.avatarWidget.trackUsage&&this.avatarWidget.trackUsage({avatar_interaction_tracked:!0})),this.avatarWidget&&this.avatarWidget.dispatchEvent({type:Autodesk.AEC.AvatarEvents.DRAG_END_EVENT}),Xt.analytics.track("viewer.3d_minimap.avatar",{action:"Move"})}getCameraPositionOnMap(){const e=this.targetViewer.impl.camera.position;return this.transforms.worldToMapPixels(e)}dragDirectionStart(e){if(this.isDragDirectionLocked)return;const t=this.getCameraPositionOnMap(),i=this.screenToMap(e);this.lastAngle=Ut(t,i),this.addWindowEventListener("mousemove",this.dragDirectionMove),this.addWindowEventListener("mouseup",this.dragDirectionEnd),this.addWindowEventListener("touchmove",this.dragDirectionMove),this.addWindowEventListener("touchend",this.dragDirectionEnd),e.stopPropagation(),e.preventDefault(),this.isRotating=!0,this.avatarWidget&&this.avatarWidget.dispatchEvent({type:Autodesk.AEC.AvatarEvents.ROTATE_START_EVENT,angle:this.lastAngle})}dragDirectionMove(e){if(this.isDragDirectionLocked)return;const t=this.getCameraPositionOnMap(),i=this.screenToMap(e),r=Ut(t,i),o=this.lastAngle-r,n=this.targetViewer.impl.camera,s=n.target.clone().sub(n.position);s.applyAxisAngle(Zt,o),s.add(n.position),n.target.copy(s),n.up.applyAxisAngle(Zt,o),this.targetViewer.impl.syncCamera(),this.targetViewer.dispatchEvent({type:Autodesk.Viewing.CAMERA_CHANGE_EVENT,camera:n}),this.lastAngle=r,e.stopPropagation(),this.avatarWidget&&this.avatarWidget.dispatchEvent({type:Autodesk.AEC.AvatarEvents.ROTATE_MOVE_EVENT,angle:this.lastAngle})}dragDirectionEnd(e){this.isDragDirectionLocked||(this.removeWindowEventListener("mousemove",this.dragDirectionMove),this.removeWindowEventListener("mouseup",this.dragDirectionEnd),this.removeWindowEventListener("touchmove",this.dragDirectionMove),this.removeWindowEventListener("touch",this.dragDirectionEnd),e&&e.stopPropagation(),this.isRotating=!1,this.avatarWidget&&this.avatarWidget.dispatchEvent({type:Autodesk.AEC.AvatarEvents.ROTATE_END_EVENT,angle:this.lastAngle}),Xt.analytics.track("viewer.3d_minimap.avatar",{action:"Rotate"}))}convertEventHammerToMouse(e){e.pointers&&(e.clientX=e.pointers[0].clientX,e.clientY=e.pointers[0].clientY)}getCurrentLevel(){const e=this.targetViewer.getExtension("Autodesk.AEC.LevelsExtension");if(e)return e.getCurrentLevel()}handleDoubleClick(e){this.convertEventHammerToMouse(e);const{x:t,y:i}=this.screenToMap(e),r=this.targetViewer.impl.camera,o=r.getWorldDirection(Jt);o.z=Math.max(o.z,0);let n=r.position.z;const s=this.getCurrentLevel();if(s){let e=s.zMin+1.8/this.targetViewer.model.getUnitScale();e>=s.zMax&&(e=(s.zMin+s.zMax)/2),isFinite(e)&&(n=e)}const a=this.transforms.mapPixelsToWorld(t,i,n),l=a.clone().add(o),c={position:a,target:l,up:r.up};return this.isDragging=!0,Autodesk.Viewing.Private.flyToView(this.targetViewer,c,.5,(()=>{this.isDragging=!1})),e.stopPropagation(),e.preventDefault(),Xt.analytics.track("viewer.3d_minimap.avatar",{action:"Teleport"}),!0}handleDoubleTap(e){return this.handleDoubleClick(e)}}Qt.call($t.prototype);var ei=__webpack_require__(3543),ti={};ti.styleTagTransform=h(),ti.setAttributes=a(),ti.insert=n().bind(null,"head"),ti.domAPI=r(),ti.insertStyleElement=c();t()(ei.A,ti);ei.A&&ei.A.locals&&ei.A.locals;const ii=AutodeskNamespace("Autodesk.AEC"),ri=Autodesk.Viewing.GlobalManagerMixin,oi=Autodesk.Viewing;class ni extends Autodesk.Viewing.EventDispatcher{constructor(e,t,i,r,o,n){super(),this.container=e,this.targetViewer=t,this.transforms=r,this.trackUsage=o,this.canvasWrap=n,this.setGlobalManager(i),this.widgetUI=this.createUI(),this.tool=new $t(this),this.tool.activate()}createUI(){const e=this.getDocument(),t=e.createElement("div");t.className="avatar-widget",this.container.appendChild(t);const i=e.createElement("div");i.className="avatar-frustum",t.appendChild(i),t.frustumWidget=i,t.anchorX=20,t.anchorY=40;const r=e.createElement("div");r.className="avatar-position-fill",t.appendChild(r),t.posCircle=r;const o=e.createElement("div");return o.className="avatar-position-hitarea",t.posCircle.appendChild(o),t.hitArea=o,oi.isTouchDevice()&&(o.classList.add("touch"),i.classList.add("touch"),t.posCircle.classList.add("touch"),t.anchorX=40,t.anchorY=80),t}destroy(){this.tool.deactivate(),this.tool=null,this.container.removeChild(this.widgetUI),this.widgetUI=null}show(){return this.changeVisibility(!0)}hide(){return this.changeVisibility(!1)}changeVisibility(e){return new Promise((t=>{if(e^this.widgetUI.classList.contains("visible")){e?this.widgetUI.classList.add("visible"):this.widgetUI.classList.remove("visible");const i=()=>{this.widgetUI.removeEventListener("transitionend",i),t()};this.widgetUI.addEventListener("transitionend",i)}else t()}))}getPosition2D(){const e=this.targetViewer.impl.camera.position;return this.transforms.worldToMapPixels(e)}getTarget2D(){const e=this.targetViewer.impl.camera.target;return this.transforms.worldToMapPixels(e)}update(){const e=this.getPosition2D(),t=this.getTarget2D(),i=Ut(e,t),r=this.transforms.getMapRotationAngle();this.widgetUI.frustumWidget.style.transform=`rotate(${i+r}rad)`,this.transforms.mapPixelsToWidget(e),this.widgetUI.style.transform=`translate(${e.x-this.widgetUI.anchorX}px, ${e.y-this.widgetUI.anchorY}px)`}isDragging(){return this.tool.isDragging}isRotating(){return this.tool.isRotating}}ri.call(ni.prototype),Object.assign(ii,{AvatarEvents:{DRAG_START_EVENT:"dragStart",DRAG_MOVE_EVENT:"dragMove",DRAG_END_EVENT:"dragEnd",ROTATE_START_EVENT:"rotateStart",ROTATE_MOVE_EVENT:"rotateMove",ROTATE_END_EVENT:"rotateEnd"}});const si=Autodesk.Viewing,ai=AutodeskNamespace("Autodesk.AEC");class li extends Autodesk.Viewing.Extension{constructor(e,t){super(e,t),this.options=this.options.avatarOptions||this.options,this.autoFocus=void 0===this.options.autoFocus||this.options.autoFocus,this.outOfFocus=!0,this.focusDuration=2,this.last3dCameraPos=new THREE.Vector3,this.update=this.update.bind(this),this.onMainMapChanged=this.onMainMapChanged.bind(this),this.on3dCameraChanged=this.on3dCameraChanged.bind(this),this.onSheetCameraChanged=this.onSheetCameraChanged.bind(this),this.onDragStart=this.onDragStart.bind(this),this.onDragEnd=this.onDragEnd.bind(this)}async load(){if(this.sheetSyncExt=await this.viewer.loadExtension("Autodesk.AEC.SheetSyncExtension",this.viewer.config),!this.sheetSyncExt)return!1;this.targetViewer=this.sheetSyncExt.targetViewer;const e={mapPixelsToWorld:this.mapPixelsToWorld.bind(this),worldToMapPixels:this.worldToMapPixels.bind(this),mapPixelsToWidget:this.mapPixelsToWidget.bind(this),widgetToMapPixels:this.widgetToMapPixels.bind(this),getMapRotationAngle:this.getCameraRotationAngle.bind(this)};if(this.avatarWidget=new ni(this.viewer.container,this.targetViewer,this.globalManager,e,this.options.trackUsage,this.viewer.canvasWrap),this.visible=!0,this.autoFocus){const e=this.getFuzzyBoundsCenter();e?this.setCameraPosition(e,!0):this.targetViewer.addEventListener(si.GEOMETRY_LOADED_EVENT,(()=>{this.focusOnModel()}),{once:!0})}return this.addListeners(),this.activateTool(),!0}unload(){return this.sheetSyncExt=null,this.removeListeners(),this.deactivateTool(),this.avatarWidget.destroy(),this.avatarWidget=null,this.focusAnim&&(this.focusAnim.stop(),this.focusAnim=null),!0}activateTool(){this.toolActive||(this.toolActive=!0,this.viewer.toolController.registerTool(this.avatarWidget.tool),this.viewer.toolController.activateTool(this.avatarWidget.tool.getName()),this.avatarWidget.addEventListener(Autodesk.AEC.AvatarEvents.DRAG_START_EVENT,this.onDragStart),this.avatarWidget.addEventListener(Autodesk.AEC.AvatarEvents.DRAG_END_EVENT,this.onDragEnd),this.updateFocus())}deactivateTool(){this.toolActive&&(this.toolActive=!1,this.viewer.toolController.deactivateTool(this.avatarWidget.tool.getName()),this.viewer.toolController.deregisterTool(this.avatarWidget.tool),this.avatarWidget.removeEventListener(Autodesk.AEC.AvatarEvents.DRAG_START_EVENT,this.onDragStart),this.avatarWidget.removeEventListener(Autodesk.AEC.AvatarEvents.DRAG_END_EVENT,this.onDragEnd))}addListeners(){this.targetViewer.addEventListener(si.NAVIGATION_MODE_CHANGED_EVENT,this.update),this.targetViewer.addEventListener(si.MODEL_ADDED_EVENT,this.update),this.targetViewer.addEventListener(si.MODEL_REMOVED_EVENT,this.update),this.targetViewer.addEventListener(si.CAMERA_CHANGE_EVENT,this.on3dCameraChanged),this.viewer.addEventListener(si.MODEL_ADDED_EVENT,this.update),this.viewer.addEventListener(si.MODEL_REMOVED_EVENT,this.update),this.viewer.addEventListener(si.RENDER_PRESENTED_EVENT,this.update),this.viewer.addEventListener(si.VIEWER_RESIZE_EVENT,this.update),this.viewer.addEventListener(xt.MAIN_MAP_CHANGED_EVENT,this.onMainMapChanged),this.viewer.addEventListener(si.CAMERA_CHANGE_EVENT,this.onSheetCameraChanged)}removeListeners(){this.targetViewer.removeEventListener(si.NAVIGATION_MODE_CHANGED_EVENT,this.update),this.targetViewer.removeEventListener(si.MODEL_ADDED_EVENT,this.update),this.targetViewer.removeEventListener(si.MODEL_REMOVED_EVENT,this.update),this.targetViewer.removeEventListener(si.CAMERA_CHANGE_EVENT,this.on3dCameraChanged),this.viewer.removeEventListener(si.MODEL_ADDED_EVENT,this.update),this.viewer.removeEventListener(si.MODEL_REMOVED_EVENT,this.update),this.viewer.removeEventListener(si.RENDER_PRESENTED_EVENT,this.update),this.viewer.removeEventListener(si.VIEWER_RESIZE_EVENT,this.update),this.viewer.removeEventListener(xt.MAIN_MAP_CHANGED_EVENT,this.onMainMapChanged),this.viewer.removeEventListener(si.CAMERA_CHANGE_EVENT,this.onSheetCameraChanged)}onDragStart(){this.focusAnim&&(this.focusAnim.stop(),this.focusAnim=null)}onDragEnd(){this.outOfFocus=!0,this.updateFocus()}isEnabled(){return this.sheetSyncExt.isEnabled()}onMainMapChanged(e){let{sheetMap:t}=e;t&&this.update()}update(){if(!(this.viewer.impl&&this.viewer.model&&this.avatarWidget&&this.sheetSyncExt))return;let e;return this.sheetSyncExt.sheetMap&&this.isEnabled()&&this.visible?(e=this.avatarWidget.show(),this.activateTool()):(e=this.avatarWidget.hide(),this.deactivateTool()),this.sheetSyncExt.sheetMap&&this.avatarWidget.update(),e}show(){if(!this.visible)return this.visible=!0,this.update()}hide(){if(this.visible)return this.visible=!1,this.update()}setCameraPosition(e,t){const i=this.viewer.getCamera();i.position.set(e.x,e.y,t?e.z:i.position.z),i.target.set(e.x,e.y,i.target.z),i.dirty=!0}getCameraRotationAngle(){return Kt(this.viewer)}worldToMapPixels(e){return Gt(this.sheetSyncExt.sheetMap,e)}mapPixelsToWorld(e,t,i){return Wt(this.sheetSyncExt.sheetMap,e,t,i)}mapPixelsToWidget(e){return function(e,t,i){Yt(e,i),i.copy(t.worldToClient(i))}(this.sheetSyncExt.sheetMap,this.viewer,e)}widgetToMapPixels(e,t){return t=t&&!this.sheetSyncExt.options.cropToViewport,qt(this.sheetSyncExt.sheetMap,this.viewer,e,t)}world3DtoWorld2D(e){const t=this.worldToMapPixels(e);this.mapPixelsToWidget(t);return this.viewer.clientToWorld(t.x,t.y,void 0,!0).point}getAvatarPositionOn2DSheet(){return this.world3DtoWorld2D(this.targetViewer.getCamera().position)}on3dCameraChanged(){this.updateFocus(),this.update()}onSheetCameraChanged(){this.viewer.toolController.getTool("pan").isInteractionActive()&&(this.outOfFocus=!0,this.focusAnim&&(this.focusAnim.stop(),this.focusAnim=null))}focusOnAvatar(){this.animateFocus(!1,(()=>{this.outOfFocus=!1}))}focusOnModel(){this.animateFocus(!0,(()=>{this.outOfFocus=!0}))}updateFocus(){if(!this.sheetSyncExt||!this.sheetSyncExt.sheetMap||!this.autoFocus||this.avatarWidget.tool.isDragging)return void(this.outOfFocus=!0);const e=this.targetViewer.getCamera();if(this.last3dCameraPos.x!==e.position.x||this.last3dCameraPos.y!==e.position.y){if(this.isAvatarInsideBounds())if(this.outOfFocus)this.focusOnAvatar();else{const e=this.getAvatarPositionOn2DSheet();this.setCameraPosition(e)}else this.focusOnModel();this.last3dCameraPos=e.position.clone()}}getFuzzyBoundsCenter(){const e=this.sheetSyncExt.getFuzzyBox();if(e.isEmpty())return null;const t=this.world3DtoWorld2D(e.min),i=this.world3DtoWorld2D(e.max),r=(new THREE.Box3).setFromPoints([t,i]),o=this.viewer.getCamera();return this.viewer.navigation.computeFit(o.position,o.target,o.fov,r,o.aspect).position}isAvatarInsideBounds(){const e=this.sheetSyncExt.getFuzzyBox();if(e.isEmpty())return!1;e.min.z=-1/0,e.max.z=1/0;const t=this.targetViewer.getCamera().position;return e.containsPoint(t)}animateFocus(e,t){if(this.focusAnim)return;const i=this.viewer.getCamera().position;this.focusAnim=Autodesk.Viewing.Private.fadeValue(0,1,this.focusDuration,(t=>{if(!this.toolActive)return;const r=e?this.getFuzzyBoundsCenter():this.getAvatarPositionOn2DSheet();if(r){t=Autodesk.Viewing.Private.smootherStep(t);const o=i.clone().lerp(r,t);this.setCameraPosition(o,e)}}),(()=>{this.focusAnim=null,t&&t()}))}getAutoFocus(){return this.autoFocus}setAutoFocus(e){this.autoFocus=e,this.updateFocus()}setDragDirectionLocked(e){this.avatarWidget.tool.isDragDirectionLocked=e}}ai.AvatarExtension=li,si.theExtensionManager.registerExtension("Autodesk.AEC.AvatarExtension",li);class ci{constructor(e,t,i){this.viewport=e,this.mapMatrix=t,this.mapMatrixInv=t.clone().invert(),this.levelGuid=i,this.thumbnail=void 0}async getSheetNode(){return this._sheetNode||(this._sheetNode=await this.viewport.getParentSheetNode()),this._sheetNode}}class ui{static computeMapMatrix(e,t){let i=e.getViewportBounds(1),r=$.remapRectangle(i.min.x,i.min.y,i.max.x,i.max.y,-1,-1,1,1),o=e.get3DTo2DMatrix(1),n=(new THREE.Matrix4).multiplyMatrices(r,o);if(e.isMatrixInLocalCoords()){const e=t.getInverseModelToViewerTransform();e&&n.multiply(e)}return n}static createSheetMapConfigs(e,t,i,r){const o=[];for(let n=0;n<e.length;n++){const s=e[n];if(!s.getDocumentNode())continue;let a=i.findViewportsInLevel(s,t);r&&(a=a.filter((e=>e instanceof Autodesk.AEC.ViewportsExtension.AecModelDataViewport)));for(let e=0;e<a.length;e++){const i=a[e];let r=ui.computeMapMatrix(i,s);const n=new ci(i,r,t);o.push(n)}}return o}}const hi=(new THREE.Box3).setFromPoints([new THREE.Vector3(-1e20,-1e20,-1e20),new THREE.Vector3(1e20,1e20,1e20)]);class di{constructor(e,t){this.viewer=e,this.options=t}updateSheetAppearance(e,t){if(!this.viewer.model)return;const i=t?.8:0,r=e&&e.viewportBounds;t&&this.updateCrop(t,r),this.animateOpacity(this.viewer.model,i,(()=>{this.updateCrop(t,r)}))}setVisibilityImmediate(e){this.viewer.getAllModels().forEach((t=>{t.fadeAnim&&(t.fadeAnim.stop(),t.fadeAnim=null),this.setModelOpacity(t,e?1:0)}))}animateOpacity(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.7;if(!e)return;e.fadeAnim&&(e.fadeAnim.stop(),e.fadeAnim=null);const o=e.opacity||0;e.fadeAnim=Autodesk.Viewing.Private.fadeValue(0,1,r,(i=>{i=Autodesk.Viewing.Private.smootherStep(i);const r=Autodesk.Viewing.Private.lerp(o,t,i);this.setModelOpacity(e,r)}),(()=>{e.fadeAnim=null,i&&i()})),e.fadeAnim.targetValue=t}setModelOpacity(e,t){if(this.options.hideSheetWhenNotFocused&&e){const i=this.viewer.impl.matman().getModelMaterials(e).mats;let r=!1;Object.keys(i).forEach((e=>{i[e].uniforms&&i[e].uniforms.opacity&&i[e].uniforms.opacity.value!==t&&(i[e].uniforms.opacity.value=t,r=!0)})),e.opacity=t,r&&(this.viewer.dispatchEvent({type:xt.SHEET_VISIBILITY_CHANGED_EVENT,model:e,value:t}),this.viewer.impl.invalidate(!0))}}expandCropBounds(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.7;const i=e.viewportBounds,r=this.viewer.model.getBoundingBox(),o=new THREE.Box2;Autodesk.Viewing.Private.fadeValue(0,1,t,(e=>{e=Autodesk.Viewing.Private.smootherStep(e),o.min.lerpVectors(i.min,r.min,e),o.max.lerpVectors(i.max,r.max,e),this.updateCrop(!0,o)}))}updateCrop(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:hi;if(this.options.cropToViewport){const i=this.viewer.model;if(!i)return;let r;i.latestCropBounds||(i.latestCropBounds=new THREE.Box3),r=e?t:hi,i.latestCropBounds.equals(r)||(i.latestCropBounds=r.clone(),this.viewer.impl.setViewportBounds(i,r.isEmpty()?null:r))}}isSheetVisible(){var e;return 0!==(null===(e=this.viewer)||void 0===e||null===(e=e.model)||void 0===e?void 0:e.opacity)}setSheetOpaque(e){this.animateOpacity(this.viewer.model,1,void 0,e);Autodesk.Viewing.Private.fadeValue(0,1,e,(e=>{e=Autodesk.Viewing.Private.smootherStep(e);const t=Autodesk.Viewing.Private.lerp(0,1,e);this.viewer.impl&&this.viewer.setBackgroundOpacity(t)}))}}const pi=Autodesk.Viewing,gi=pi.Private.Empty2DModelLoader,fi=AutodeskNamespace("Autodesk.AEC");class vi extends Autodesk.Viewing.Extension{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),this.options=this.options.sheetSyncOptions||this.options,this.targetViewer=this.options.targetViewer,this.sheetMap=null,this.targetModels=[],this.mapCache={},this.modelIdToFuzzyBox=[],this.isModelLoadingMap={};const t=void 0===this.options.showSheet||this.options.showSheet;this.setShowSheet(t),this.sheetVisibilityManager=new di(this.viewer,this.options),this.onNavigationToolChanged=this.onNavigationToolChanged.bind(this),this.onSheetGeometryLoaded=this.onSheetGeometryLoaded.bind(this),this.on3dGeometryLoaded=this.on3dGeometryLoaded.bind(this),this.updateSheetAppearance=this.updateSheetAppearance.bind(this),this.isCameraInsideMap=this.isCameraInsideMap.bind(this),this.onModelTransformChanged=this.onModelTransformChanged.bind(this),this.update=this.update.bind(this),this.onViewportDataFetched=this.onViewportDataFetched.bind(this)}async load(){return!!this.targetViewer&&(this.viewportsExtension=await this.targetViewer.loadExtension("Autodesk.AEC.ViewportsExtension"),this.targetViewer.addEventListener(pi.NAVIGATION_MODE_CHANGED_EVENT,this.onNavigationToolChanged),this.onNavigationToolChanged(),!0)}unload(){return this.deactivate(),this.viewportsExtension=null,this.sheetVisibilityManager.setVisibilityImmediate(!0),this.sheetVisibilityManager.updateCrop(null),this.changePaperVisibility(!0),this.sheetMap=null,this.targetModels=[],this.targetViewer.removeEventListener(pi.NAVIGATION_MODE_CHANGED_EVENT,this.onNavigationToolChanged),!0}onViewportDataFetched(){this.invalidateSheetMaps()}changePaperVisibility(e,t){this.options.hidePaper&&((t=t||this.viewer.getAllModels()).forEach((t=>{t.changePaperVisibility(e)})),this.viewer.impl.invalidate(!0))}activate(){this.active||(this.active=!0,this.addListeners(),this.on3dGeometryLoaded(),this.changePaperVisibility(!1))}deactivate(){this.active&&(this.active=!1,this.sheetMap=null,this.removeListeners())}addListeners(){var e,t;this.targetViewer.addEventListener(pi.MODEL_ADDED_EVENT,(e=>{e.model.addEventListener(pi.MODEL_FRAGMENT_BOUNDING_BOXES_SET_EVENT,this.on3dGeometryLoaded),this.update()})),this.targetViewer.addEventListener(pi.MODEL_REMOVED_EVENT,(e=>{e.model.removeEventListener(pi.MODEL_FRAGMENT_BOUNDING_BOXES_SET_EVENT,this.on3dGeometryLoaded),this.update()}));for(const e of this.targetViewer.getAllModels())e.addEventListener(pi.MODEL_FRAGMENT_BOUNDING_BOXES_SET_EVENT,this.on3dGeometryLoaded);this.targetViewer.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.update),this.targetViewer.addEventListener(Autodesk.Viewing.MODEL_TRANSFORM_CHANGED_EVENT,this.onModelTransformChanged),this.targetViewer.addEventListener(pi.GEOMETRY_LOADED_EVENT,this.on3dGeometryLoaded),this.targetViewer.addEventListener(Autodesk.AEC.LevelsExtension.LEVEL_CHANGED,this.updateSheetAppearance),this.viewer.addEventListener(pi.MODEL_ROOT_LOADED_EVENT,this.onSheetGeometryLoaded),this.viewer.addEventListener(pi.GEOMETRY_LOADED_EVENT,this.onSheetGeometryLoaded),this.viewer.addEventListener(pi.TEXTURES_LOADED_EVENT,this.onSheetGeometryLoaded),this.viewer.addEventListener(xt.MAIN_MAP_CHANGED_EVENT,this.updateSheetAppearance),this.viewportsExtension.addEventListener(Autodesk.AEC.ViewportsExtension.Events.VIEWPORT_DATA_FETCHED_EVENT,this.onViewportDataFetched);const i=this.targetViewer.getExtension("Autodesk.AEC.LevelsExtension");null==i||null===(e=i.floorSelector)||void 0===e||e.addEventListener(Autodesk.AEC.FloorSelector.SELECTED_FLOOR_CHANGED,this.update),null==i||null===(t=i.floorSelector)||void 0===t||t.addEventListener(Autodesk.AEC.FloorSelector.FLOOR_DATA_CHANGED,this.onViewportDataFetched)}removeListeners(){var e,t;this.targetViewer.removeEventListener(pi.MODEL_ADDED_EVENT,this.update),this.targetViewer.removeEventListener(pi.MODEL_REMOVED_EVENT,this.update),this.targetViewer.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.update),this.targetViewer.removeEventListener(Autodesk.Viewing.MODEL_TRANSFORM_CHANGED_EVENT,this.onModelTransformChanged),this.targetViewer.removeEventListener(pi.GEOMETRY_LOADED_EVENT,this.on3dGeometryLoaded);for(const e of this.targetViewer.getAllModels())e.removeEventListener(pi.MODEL_FRAGMENT_BOUNDING_BOXES_SET_EVENT,this.on3dGeometryLoaded);this.targetViewer.removeEventListener(Autodesk.AEC.LevelsExtension.LEVEL_CHANGED,this.updateSheetAppearance),this.viewer.removeEventListener(pi.MODEL_ROOT_LOADED_EVENT,this.onSheetGeometryLoaded),this.viewer.removeEventListener(pi.GEOMETRY_LOADED_EVENT,this.onSheetGeometryLoaded),this.viewer.removeEventListener(pi.TEXTURES_LOADED_EVENT,this.onSheetGeometryLoaded),this.viewer.removeEventListener(xt.MAIN_MAP_CHANGED_EVENT,this.updateSheetAppearance),this.viewportsExtension.removeEventListener(Autodesk.AEC.ViewportsExtension.Events.VIEWPORT_DATA_FETCHED_EVENT,this.onViewportDataFetched);const i=this.targetViewer.getExtension("Autodesk.AEC.LevelsExtension");null==i||null===(e=i.floorSelector)||void 0===e||e.removeEventListener(Autodesk.AEC.FloorSelector.SELECTED_FLOOR_CHANGED,this.update),null==i||null===(t=i.floorSelector)||void 0===t||t.removeEventListener(Autodesk.AEC.FloorSelector.FLOOR_DATA_CHANGED,this.onViewportDataFetched)}isEnabled(){var e;return"bimwalk"===this.targetViewer.getActiveNavigationTool()||(null===(e=this.targetViewer.getExtension("Autodesk.AEC.Minimap3DExtension"))||void 0===e?void 0:e.isEnabled())}onNavigationToolChanged(){this.isEnabled()?this.activate():this.deactivate(),this.update()}updateSheetAppearance(){if(this.isSheetMapLoaded(this.sheetMap)&&this.isMapOnCurrentLevel(this.sheetMap)){const e=this.showSheet&&this.isCameraInsideMap(this.sheetMap)&&this.isEnabled();this.sheetVisibilityManager.updateSheetAppearance(this.sheetMap,e)}else this.sheetVisibilityManager.setVisibilityImmediate(!1),this.sheetVisibilityManager.updateCrop(null)}getFuzzyBox(){const e=new THREE.Box3;for(let t=0;t<this.targetModels.length;t++){const i=this.targetModels[t];if(i&&i.loader instanceof Autodesk.Viewing.Private.OtgLoader&&!i.loader.fragmentDataLoaded)continue;let r=this.modelIdToFuzzyBox[i.id];if(!r){r=i.getFuzzyBox();let e=i.isLoadDone()||i.getFragmentList().fragments.boxesLoaded;i&&i.loader instanceof Autodesk.Viewing.Private.OtgLoader&&i.loader.fragmentDataLoaded&&i.getFragmentList().fragments.length===i.loader.svf.fragments.length&&(e=!0),e&&(this.modelIdToFuzzyBox[i.id]=r)}e.union(r)}return e}generateDummyMap(){if(this.sheetMap)return;const e=this.targetViewer.getExtension("Autodesk.AEC.LevelsExtension"),t=e&&e.getCurrentLevel(),i=t&&e.getZRange(t.index),r=this.getFuzzyBox();if(r.isEmpty())return;const o=i?i.zMin:r.min.z,n=i?i.zMax:r.max.z;r.min.z=0,r.max.z=0;const s=this.viewer.impl.renderer(),a=s.settings.logicalWidth,l=s.settings.logicalHeight,c=new pi.UnifiedCamera(a,l);Ft(c,r,o,n,r.getSize(new THREE.Vector3).y);const u=new THREE.Matrix4;((e,t)=>{t.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse)})(c,u);const h=u.clone().invert(),d=this.viewer.clientToWorld(0,0,void 0,!0).point,p=this.viewer.clientToWorld(a,l,void 0,!0).point,g=(new THREE.Box3).setFromPoints([d,p]);this.sheetMap={viewportBounds:g,mapMatrix:u,mapMatrixInv:h,viewport:{getGuid:()=>"dummyViewportGuid",getSheetName:()=>"dummySheetName",getSheetUrn:()=>"dummySheetUrn"}},this.viewer.dispatchEvent({type:xt.MAIN_MAP_CHANGED_EVENT,sheetMap:this.sheetMap}),this.update()}on3dGeometryLoaded(){this.updateTargetModels(),this.targetModels&&(this.generateDummyMap(),this.update())}onSheetGeometryLoaded(e){let{model:t}=e;this.changePaperVisibility(!1,[t]),this.update()}invalidateSheetMaps(){Object.keys(this.mapCache).forEach((e=>{ui.createSheetMapConfigs(this.targetModels,e,this.viewportsExtension,this.options.useOnlyAecModelDataViewports).forEach((t=>{const i=this.mapCache[e].find((e=>e.viewport.getGuid()===t.viewport.getGuid()));var r;i?(i.mapMatrix=t.mapMatrix,i.mapMatrixInv=t.mapMatrixInv,null!==(r=i.thumbnail)&&void 0!==r&&r.mesh&&(i.thumbnail.mesh.dirty=!0)):(t.viewportBounds=t.viewport.getViewportBounds(this.viewer.model.getUnitScale()),this.mapCache[e].push(t))}))})),this.update(),this.viewer.dispatchEvent({type:xt.MAIN_MAP_CHANGED_EVENT,sheetMap:this.sheetMap})}onModelTransformChanged(e){let{model:t}=e;this.targetModels.includes(t)&&(this.modelIdToFuzzyBox[t.id]=null,this.invalidateSheetMaps())}updateTargetModels(){if(!this.options.useCustomModel){const e=this.targetViewer.getVisibleModels().filter((e=>e.is3d()));this.setTargetModels(e)}}setTargetModels(e){this.targetModels=e}getSheetNodeKey(e){return e&&`${e.viewport.getSheetUrn()}_${e.viewport.getSheetName()}`}isLoadingSheetNode(e){const t=this.getSheetNodeKey(e);return t&&this.isModelLoadingMap[t]}shouldSwitchSheet(){const e=this.showSheet,t=this.options.autoSwitchSheet,i=!this.isSheetMapLoaded(this.sheetMap),r=this.isCameraInsideMap(this.sheetMap),o=this.isLoadingSheetNode(this.sheetMap),n=this.options.minimapDebugMode;return t&&i&&e&&r&&!o&&!n}getCurrentLevel(){const e=this.targetViewer.getExtension("Autodesk.AEC.LevelsExtension");if(e)return e.getCurrentLevel()}update(){if(!this.viewer.model)return;if(this.viewer.impl.isWebGPU())return;this.getCurrentLevel()&&this.isEnabled()&&(this.updateTargetModels(),this.updateSheetMaps(),this.updateSheetAppearance(),this.switchSheetIfNeededDebounce())}switchSheetIfNeededDebounce(){this.debounceTimeout&&clearTimeout(this.debounceTimeout),this.debounceTimeout=setTimeout(this.switchSheetIfNeeded.bind(this),300)}getCustomHash(){return`sheetsync_${this.viewer.id}`}async switchSheetIfNeeded(){if(this.shouldSwitchSheet()){this.viewer.dispatchEvent({type:xt.CHANGING_SHEET_EVENT});const e=this.viewer.model,t=this.sheetMap,i=await this.sheetMap.getSheetNode();if(t!==this.sheetMap)return;const r=i.getRootNode().getDocument(),o=this.options.hideSheetWhenNotFocused?0:1,n=this.options.loadDocumentNode||this.viewer.loadDocumentNode.bind(this.viewer),s=this.options.unloadModel||this.viewer.unloadModel.bind(this.viewer),a=this.getSheetNodeKey(t);this.isModelLoadingMap[a]=!0,n(r,i,{opacity:o,preserveView:!0,keepCurrentModels:!0,loadAsHidden:!0,customHash:this.getCustomHash()}).catch((e=>console.error("Failed to load sheet: ",i.name(),": ",e))).then((i=>{e&&e!==i&&(e.loader instanceof gi?this.viewer.unloadModel(e):s(e)),this.isModelLoadingMap[a]=!1,this.viewer.showModel(i,!0),this.viewer.navigation.setConstraints2D(),this.sheetVisibilityManager.setVisibilityImmediate(!1),t.viewportBounds=t.viewport.getViewportBounds(i.getUnitScale()),t.model=i,this.update(),this.viewer.dispatchEvent({type:xt.MAIN_MAP_CHANGED_EVENT,sheetMap:t})}))}}isSheetMapsEqual(e,t){return(null==e?void 0:e.viewport.getGuid())===(null==t?void 0:t.viewport.getGuid())}isMapOnCurrentLevel(e){if(!e)return!1;const t=this.getCurrentLevel();return!(!t||e.levelGuid!==t.guid)}isSheetMapLoaded(e){return(null==e?void 0:e.model)===this.viewer.model}isCameraInsideMap(e){return!!e&&(!!this.isMapOnCurrentLevel(e)&&(!(!this.options.autoSwitchSheet&&!this.isSheetMapLoaded(e))&&((e,t)=>{Bt=Bt||new THREE.Vector3;const i=Bt.copy(e).applyProjection(t);return Math.abs(i.x)<1&&Math.abs(i.y)<1})(this.targetViewer.getCamera().position,e.mapMatrix)))}updateSheetMaps(){let e;const t=this.getCurrentLevel();if(this.mapCache[t.guid])e=this.mapCache[t.guid];else{e=ui.createSheetMapConfigs(this.targetModels,t.guid,this.viewportsExtension,this.options.useOnlyAecModelDataViewports);const i=this.viewer.model,r=i.getDocumentNode();e.forEach((e=>{e.viewportBounds=e.viewport.getViewportBounds(i.getUnitScale()),e.viewport.getSheetName()===r.name()&&e.viewport.getSheetUrn()===r.urn(!0)&&(e.model=i)})),this.mapCache[t.guid]=e}const i=e.find(this.isCameraInsideMap)||(this.options.cropToViewport?this.sheetMap:void 0),r=!this.isSheetMapsEqual(this.sheetMap,i);this.sheetMap=i,r&&this.viewer.dispatchEvent({type:xt.MAIN_MAP_CHANGED_EVENT,sheetMap:this.sheetMap})}setShowSheet(e){this.showSheet=e,this.active&&this.update()}getShowSheet(){return this.showSheet}isSheetVisible(){return this.showSheet&&this.isSheetMapLoaded(this.sheetMap)&&this.sheetVisibilityManager.isSheetVisible()&&this.viewer.model.isLoadDone()}expandCropBounds(e){this.sheetVisibilityManager.expandCropBounds(this.sheetMap,e)}setSheetOpaque(e){this.sheetVisibilityManager.setSheetOpaque(e)}}Object.assign(fi,{SheetSyncEvents:xt}),fi.SheetSyncExtension=vi,pi.theExtensionManager.registerExtension("Autodesk.AEC.SheetSyncExtension",vi);const mi=Autodesk.Viewing,yi=400,_i=1500,Ei=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.0254;var r,o,n,s;o=(r=e).getSize(new THREE.Vector2),n=r.getCenter(new THREE.Vector2),s=.5*Math.max(o.x,o.y),r.min.set(n.x-s,n.y-s),r.max.set(n.x+s,n.y+s);var a=t.getViewportBounds(i).clone();return jt(a.min,e),jt(a.max,e),a};class Ai{constructor(e,t,i){this.sheetMapConfig=e,this.viewer=t,this.thumbnailImage=null,this.thumbnailRefined=!1,this.onThumbnailReady=i,this.img=new Image,this.img.onload=async()=>{const e=(await this.sheetMapConfig.getSheetNode()).search({type:"view"})[0];if(!e)return;var t=e.getViewBox(),i=new THREE.Box2;i.min.set(t[0],t[1]),i.max.set(t[2],t[3]);const r=Ei(i,this.sheetMapConfig.viewport);this.cropThumbnail(this.img,r)}}cropThumbnail(e,t){const i=((e,t)=>{const i=mi.getGlobal().document.createElement("canvas"),r=i.getContext("2d"),o=t.max.x-t.min.x,n=t.max.y-t.min.y,s=o*e.width,a=n*e.height;i.width=s,i.height=a,r.drawImage(e,t.min.x*e.width,(1-t.max.y)*e.height,s,a,0,0,s,a);const l=new Image;return l.src=i.toDataURL(),l})(e,t);i.onload=()=>{this.thumbnailImage=i,this.onThumbnailReady(this.sheetMapConfig)}}onThumbnailDownloaded(e){this.thumbnailRefined||(this.img.src=e)}async requestThumbnail(){const e=await this.sheetMapConfig.getSheetNode(),t=e.getRootNode().getDocument(),i=t.getThumbnailOptions(e.data,yi,yi);if(e.data.thumbnailUrn)i.urn=e.getDocument().getFullPath(e.data.thumbnailUrn),i.responseType="blob",Autodesk.Viewing.Private.ViewingService.getThumbnail(Autodesk.Viewing.initLoadContext(),i.urn,(e=>{var t=new FileReader;t.onload=e=>{this.onThumbnailDownloaded(e.target.result)},t.readAsDataURL(e)}),(t=>{console.warn(`Failed to load sheet thumbnail. Error: ${t}, Urn: ${i.urn}, SheetName: ${e.name()}`)}),i);else if(Autodesk.Viewing.endpoint.getUseCookie()){const i=t.getThumbnailPath(e.data,yi,yi);this.onThumbnailDownloaded(i)}else{const t=(t,r)=>{if(t)return void console.warn(`Failed to load sheet thumbnail. Error: ${t}, Urn: ${i.urn}, SheetName: ${e.name()}`);const o=mi.getGlobal().URL.createObjectURL(r);this.onThumbnailDownloaded(o)};Autodesk.Viewing.Document.requestThumbnailWithSecurity(i,t)}}refineThumbnail(){if(this.thumbnailRefined)return;this.thumbnailRefined=!0;const e=this.viewer.model.getBoundingBox(!0),t=new Autodesk.Viewing.UnifiedCamera(_i,_i);t.setViewFromBox(e,!0);const i={camera:t};this.viewer.impl.getScreenShotProgressive(_i,_i,(t=>{this.img.src=t,this.img.onload=()=>{var t;if(null!==(t=this.viewer)&&void 0!==t&&t.model){const t=Ei(e,this.sheetMapConfig.viewport,this.viewer.model.getUnitScale());this.cropThumbnail(this.img,t)}}}),i)}}const xi="thumbnail-overlay-scene";class Ci{constructor(e,t){this.viewer=e,this.sheetSyncExt=t,this.planeGeometry=new THREE.PlaneBufferGeometry(1,1),this.viewer.impl.createOverlayScene(xi),this.createThumbnailMesh=this.createThumbnailMesh.bind(this)}createThumbnailMesh(e){if(!this.viewer)return;let t=e.thumbnail.mesh;if(!t){const i=new THREE.MeshBasicMaterial({opacity:0,transparent:!0});t=new THREE.Mesh(this.planeGeometry,i),this.setMeshTransform(t,e),e.thumbnail.mesh=t;const r=new THREE.Texture;r.minFilter=THREE.LinearFilter,t.material.map=r}t.material.map.image=e.thumbnail.thumbnailImage,t.material.map.needsUpdate=!0,this.update()}setMeshTransform(e,t){const i=Wt(t,t.viewportBounds.min.x,t.viewportBounds.min.y,0),r=Wt(t,t.viewportBounds.max.x,t.viewportBounds.max.y,0),o=Wt(t,t.viewportBounds.max.x,t.viewportBounds.min.y,0),n=Math.atan2(o.y-i.y,o.x-i.x),s=(new THREE.Box3).setFromPoints([i,r]),a=s.getCenter(new THREE.Vector3);zt(i,a,-n),zt(r,a,-n),s.setFromPoints([i,r]);const l=s.getSize(new THREE.Vector3),c=t.viewportBounds.getSize(new THREE.Vector3),u=Wt(t,c.x/2,c.y/2,this.viewer.getCamera().position.z-1e-4);e.position.copy(u),e.rotation.set(0,0,n),e.scale.set(l.x,l.y,1),e.dirty=!1}showThumbnail(e){e&&e.mesh&&-1===this.viewer.impl.overlayScenes[xi].scene.children.indexOf(e.mesh)&&(this.viewer.impl.addOverlay(xi,e.mesh),this.animateOpacity(e,.5))}hideThumbnail(e,t){e&&e.mesh&&-1!==this.viewer.impl.overlayScenes[xi].scene.children.indexOf(e.mesh)&&(t?(this.viewer.impl.removeOverlay(xi,e.mesh),e.mesh.material.opacity=0):this.animateOpacity(e,0,(()=>{this.viewer.impl.removeOverlay(xi,e.mesh)})))}animateOpacity(e,t,i){if(e.fadeAnim){if(e.fadeAnim.targetValue===t)return;e.fadeAnim.stop(),e.fadeAnim=null}const r=e.mesh.material.opacity;e.fadeAnim=Autodesk.Viewing.Private.fadeValue(0,1,.7,(i=>{if(!this.viewer)return;i=Autodesk.Viewing.Private.smootherStep(i);const o=Autodesk.Viewing.Private.lerp(r,t,i);this.setThumbnailOpacity(e,o)}),(()=>{e.fadeAnim=null,i&&i()})),e.fadeAnim.targetValue=t}setThumbnailOpacity(e,t){e.mesh.material.opacity!==t&&(e.mesh.material.opacity=t,this.viewer.impl.invalidate(!1,!1,!0))}requestThumbnailDebounce(e){this.debounceTimeout&&clearTimeout(this.debounceTimeout),this.debounceTimeout=setTimeout((()=>{this.sheetSyncExt&&(e.thumbnail=new Ai(e,this.sheetSyncExt.viewer,this.createThumbnailMesh),this.tryRefineThumbnail(e)||e.thumbnail.requestThumbnail())}),300)}tryRefineThumbnail(e){return!(!this.sheetSyncExt.isSheetMapLoaded(e)||!this.sheetSyncExt.viewer.model.isLoadDone(!0)||.8!==this.sheetSyncExt.viewer.model.opacity)&&(e.thumbnail.refineThumbnail(),!0)}update(){const e=this.sheetSyncExt.mapCache,t=this.sheetSyncExt.getCurrentLevel();if(!t)return;const i=this.sheetSyncExt.getShowSheet();Object.keys(e).forEach((r=>{const o=e[r],n=r===t.guid;o.forEach((e=>{var o;const s=n&&i&&!this.sheetSyncExt.isCameraInsideMap(e);n&&(e.thumbnail?e.thumbnail.thumbnailRefined||this.tryRefineThumbnail(e):this.requestThumbnailDebounce(e)),null!==(o=e.thumbnail)&&void 0!==o&&null!==(o=o.mesh)&&void 0!==o&&o.dirty&&this.setMeshTransform(e.thumbnail.mesh,e),s?this.showThumbnail(e.thumbnail):this.hideThumbnail(e.thumbnail,r!==t.guid)}))}))}destroy(){this.planeGeometry.dispose(),this.planeGeometry=null,this.viewer.impl.removeOverlayScene(xi),this.sheetSyncExt=null,this.viewer=null}}const wi=Autodesk.Viewing,bi=wi.ProgressState,Mi=AutodeskNamespace("Autodesk.AEC"),Ti=new THREE.Vector3,Vi=new THREE.Vector2,Si=new THREE.Box3;class Li extends Autodesk.Viewing.Extension{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),this.options=this.options.topViewRendererOptions||this.options,this.isModelLoadingMap={},this.waitBeforeRotation=1,this.rotationDuration=2,this.onBeginScene=this.onBeginScene.bind(this),this.update=this.update.bind(this),this.onMainMapChanged=this.onMainMapChanged.bind(this),this.onResize=this.onResize.bind(this),this.rotateToSheet=this.rotateToSheet.bind(this),this.onSheetGeometryLoaded=this.onSheetGeometryLoaded.bind(this),this.updateBackgroundTexture=this.updateBackgroundTexture.bind(this),this.onCameraChanged=this.onCameraChanged.bind(this),this.pendingFinishedCallbacks=[]}async load(){var e=this;if(this.sheetSyncExt=await this.viewer.loadExtension("Autodesk.AEC.SheetSyncExtension",this.viewer.config),!this.sheetSyncExt)return!1;if(this.targetViewer=this.sheetSyncExt.targetViewer,this.initTopViewViewer(),this.options.minimapDebugMode){const t=__webpack_require__(6702).A;this.nearFarOverlay=new t(this.topViewViewer,this.targetViewer);const i=this.topViewViewer.impl.modelQueue(),r=i.reset.bind(i);i.reset=function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];i[0]=e.targetViewer.getCamera(),r(...i)}}else this.thumbnailsOverlay=new Ci(this.topViewViewer,this.sheetSyncExt);return this.addListeners(),!0}initTopViewViewer(){var e;const t=this.viewer.container,i=this.targetViewer.sharedResources,r={};null!==(e=this.targetViewer.config)&&void 0!==e&&e.profileSettings&&(r.profileSettings=Object.assign({},this.targetViewer.config.profileSettings)),i?this.topViewViewer=Autodesk.Viewing.createLeechViewer(t,r,i,Autodesk.Viewing.Viewer3D):(console.warn("TopViewRenderer - It is highly recommended using LeechViewer as your target viewer when using this extension."),this.topViewViewer=new Autodesk.Viewing.Viewer3D(t,r)),this.viewer.container.insertBefore(this.topViewViewer.container,this.viewer.container.firstChild),this.backgroundOpacityBackup=this.viewer.impl.renderer().getClearAlpha(),this.isCanvasOverlaySupported()?this.viewer.setBackgroundOpacity(0):this.topViewViewer.container.style.opacity=0,this.topViewViewer.container.style.zIndex=-1,this.topViewViewer.container.style.pointerEvents="none",this.topViewViewer.container.style.transition="opacity 0.7s",this.topViewViewer.container.style.backgroundColor="transparent",this.topViewViewer.start(void 0,void 0,void 0,void 0,{webglInitParams:{alpha:!0}}),this.topViewViewer.impl.skipCameraUpdate=!0,this.topViewViewer.setBackgroundOpacity(0),this.backgroundColorBackup=this.viewer.container.style.backgroundColor,this.viewer.container.style.backgroundColor="transparent"}destroyTopViewViewer(){this.topViewViewer&&(this.topViewViewer.finish(),this.topViewViewer=null,this.viewer.container.style.backgroundColor=this.backgroundColorBackup,this.viewer.setBackgroundOpacity(this.backgroundOpacityBackup))}unload(){return this.removeListeners(),this.thumbnailsOverlay&&(this.thumbnailsOverlay.destroy(),this.thumbnailsOverlay=null),this.nearFarOverlay&&(this.nearFarOverlay.destroy(),this.nearFarOverlay=null),this.destroyTopViewViewer(),this.rotationAnim&&(this.rotationAnim.stop(),this.rotationAnim=null),this.rotationTimeout&&clearTimeout(this.rotationTimeout),this.viewer=null,this.targetViewer=null,this.sheetSyncExt=null,this.pendingFinishedCallbacks=[],!0}addListeners(){this.targetViewer.addEventListener(wi.NAVIGATION_MODE_CHANGED_EVENT,this.update),this.targetViewer.addEventListener(wi.MODEL_ADDED_EVENT,this.update),this.targetViewer.addEventListener(wi.MODEL_REMOVED_EVENT,this.update),this.targetViewer.addEventListener(Autodesk.AEC.LevelsExtension.LEVEL_CHANGED,this.update),this.viewer.addEventListener(wi.PROGRESS_UPDATE_EVENT,this.onBeginScene),this.viewer.addEventListener(wi.RENDER_SCENE_PART,this.update),this.viewer.addEventListener(wi.VIEWER_RESIZE_EVENT,this.onResize),this.viewer.addEventListener(xt.MAIN_MAP_CHANGED_EVENT,this.onMainMapChanged),this.viewer.addEventListener(wi.GEOMETRY_LOADED_EVENT,this.onSheetGeometryLoaded),this.topViewViewer.addEventListener(wi.MODEL_ADDED_EVENT,this.update),this.isCanvasOverlaySupported()||(this.topViewViewer.addEventListener(Autodesk.Viewing.RENDER_PRESENTED_EVENT,this.updateBackgroundTexture,{priority:-2e3}),this.viewer.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.onCameraChanged));const e=this.targetViewer.getExtension("Autodesk.AEC.LevelsExtension");e&&e.floorSelector&&e.floorSelector.addEventListener(Autodesk.AEC.FloorSelector.SELECTED_FLOOR_CHANGED,this.update),this.options.minimapDebugMode&&this.targetViewer.addEventListener(wi.PROGRESS_UPDATE_EVENT,this.onBeginScene)}removeListeners(){this.targetViewer.removeEventListener(wi.NAVIGATION_MODE_CHANGED_EVENT,this.update),this.targetViewer.removeEventListener(wi.MODEL_ADDED_EVENT,this.update),this.targetViewer.removeEventListener(wi.MODEL_REMOVED_EVENT,this.update),this.targetViewer.removeEventListener(Autodesk.AEC.LevelsExtension.LEVEL_CHANGED,this.update),this.viewer.removeEventListener(wi.PROGRESS_UPDATE_EVENT,this.onBeginScene),this.viewer.removeEventListener(wi.RENDER_SCENE_PART,this.update),this.viewer.removeEventListener(wi.VIEWER_RESIZE_EVENT,this.onResize),this.viewer.removeEventListener(xt.MAIN_MAP_CHANGED_EVENT,this.onMainMapChanged),this.viewer.removeEventListener(wi.GEOMETRY_LOADED_EVENT,this.onSheetGeometryLoaded),this.topViewViewer.removeEventListener(wi.MODEL_ADDED_EVENT,this.update),this.isCanvasOverlaySupported()||(this.topViewViewer.removeEventListener(Autodesk.Viewing.RENDER_PRESENTED_EVENT,this.updateBackgroundTexture),this.viewer.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.onCameraChanged));const e=this.targetViewer.getExtension("Autodesk.AEC.LevelsExtension");e&&e.floorSelector&&e.floorSelector.removeEventListener(Autodesk.AEC.FloorSelector.SELECTED_FLOOR_CHANGED,this.update),this.options.minimapDebugMode&&this.targetViewer.removeEventListener(wi.PROGRESS_UPDATE_EVENT,this.onBeginScene)}onResize(e){let{width:t,height:i}=e;this.topViewViewer.impl.resize(t,i,!0),this.update()}onMainMapChanged(){this.syncCamera(),this.update(),this.validateRotation()}onSheetGeometryLoaded(){this.validateRotation()}validateRotation(){this.rotationTimeout&&clearTimeout(this.rotationTimeout),this.rotationTimeout=setTimeout(this.rotateToSheet,1e3*this.waitBeforeRotation)}isDraggingAvatar(){const e=this.viewer.getExtension("Autodesk.AEC.AvatarExtension");return!e||!e.avatarWidget||e.avatarWidget.isDragging()}rotateToSheet(){if(!this.viewer)return;if(!this.sheetSyncExt.getShowSheet())return;if(this.rotationAnim&&(this.rotationAnim.stop(),this.rotationAnim=null),this.isDraggingAvatar())return void this.validateRotation();let e=Kt(this.viewer);if(e<-Math.PI?e+=2*Math.PI:e>Math.PI&&(e-=2*Math.PI),0===e)return;this.rotationAnim=Autodesk.Viewing.Private.fadeValue(0,1,this.rotationDuration,(t=>{t=Autodesk.Viewing.Private.smootherStep(t);const i=e*(1-t),r=this.viewer.getCamera();r.up.set(0,1,0),zt(r.up,Ti,i),r.dirty=!0,r.updateCameraMatrices()}),(()=>{this.rotationAnim=null,this.pendingFinishedCallbacks.forEach((e=>e())),this.pendingFinishedCallbacks=[]}))}waitForRotationDone(){return new Promise((e=>{if(!this.rotationAnim)return e();this.pendingFinishedCallbacks.push(e)}))}onBeginScene(e){let{percent:t,state:i}=e;0===t&&i===bi.RENDERING&&this.update()}syncCamera(){if(!(this.sheetSyncExt&&this.sheetSyncExt.sheetMap&&this.viewer.model&&this.worldBoundingBox))return;const e=this.viewer.getCamera(),t=this.sheetSyncExt.sheetMap,i=Wt(t,t.viewportBounds.min.x,t.viewportBounds.min.y,0),r=Wt(t,t.viewportBounds.max.x,t.viewportBounds.min.y,0);let o=Math.atan2(r.y-i.y,r.x-i.x);const n=this.worldBoundingBox.getCenter(new THREE.Vector3);zt(this.worldBoundingBox.min,n,o),zt(this.worldBoundingBox.max,n,o);const s=Gt(t,this.worldBoundingBox.min.clone()),a=Gt(t,new THREE.Vector3(this.worldBoundingBox.min.x,this.worldBoundingBox.max.y,0)),l=Gt(t,this.worldBoundingBox.max.clone());s.z=0,a.z=0,l.z=0,Yt(t,s),Yt(t,l),Yt(t,a),Si.setFromPoints([s,l]),e.setViewFromBox(Si,!0);const c=Kt(this.topViewViewer);zt(e.up,Ti,c-o),e.dirty=!0,e.updateCameraMatrices(),this.viewer.impl.invalidate(!0),this.rotationAnim&&this.rotateToSheet()}updateTopViewViewerCamera(){if(!this.viewer.model)return;const e=this.sheetSyncExt.getCurrentLevel(),t=this.targetViewer.getExtension("Autodesk.AEC.LevelsExtension"),i=e?t.getZRange(e.index).zMax:1/0,r=this.viewer.impl.renderer(),o=r.settings.logicalWidth,n=r.settings.logicalHeight,s=this.viewer.getCamera().up.clone(),a=!1,l=Vi.set(0,n);qt(this.sheetSyncExt.sheetMap,this.viewer,l,!1,a);const c=Wt(this.sheetSyncExt.sheetMap,l.x,l.y,0),u=Vi.set(o,n);qt(this.sheetSyncExt.sheetMap,this.viewer,u,!1,a);const h=Wt(this.sheetSyncExt.sheetMap,u.x,u.y,0),d=Vi.set(o,0);qt(this.sheetSyncExt.sheetMap,this.viewer,d,!1,a);const p=Wt(this.sheetSyncExt.sheetMap,d.x,d.y,0);Si.setFromPoints([c,p]);const g=Si.getCenter(new THREE.Vector3),f=Kt(this.viewer),v=Math.atan2(h.y-c.y,h.x-c.x);zt(c,g,-v),zt(p,g,-v),zt(s,Ti,v-f),Si.setFromPoints([c,p]),this.worldBoundingBox=Si.clone();const m=this.targetViewer.impl.getVisibleBounds(),y=Math.min(i,m.max.z),_=m.min.z,E=this.topViewViewer.getCamera(),A=Ft(E,Si,_,y,Si.getSize(new THREE.Vector3).y,s);this.forcedRerender||E.dirty||(E.dirty=A)}unloadIrrelevant3DModels(){if(!this.sheetSyncExt.targetModels)return;const e=this.sheetSyncExt.targetModels.map((e=>e.getModelKey()));this.topViewViewer.getVisibleModels().forEach((t=>{const i=t.getModelKey();-1===e.indexOf(i)&&(this.topViewViewer.unloadModel(t),this.isModelLoadingMap[i]=!1)}))}loadRelevant3DModels(){if(!this.sheetSyncExt.targetModels)return;const e=this.topViewViewer.getVisibleModels().map((e=>e.getModelKey()));this.sheetSyncExt.targetModels.forEach((t=>{const i=t.getModelKey();if(-1===e.indexOf(i)&&!this.isModelLoadingMap[i]){this.isModelLoadingMap[i]=!0;const e=t.getData().loadOptions;this.topViewViewer.loadDocumentNode(t.getDocumentNode().getRootNode().getDocument(),t.getDocumentNode(),{keepCurrentModels:!0,preserveView:!0,globalOffset:e.globalOffset,applyRefPoint:e.applyRefPoint,placementTransform:e.placementTransform,applyPlacementInModelUnits:e.applyPlacementInModelUnits}).then((()=>{const e=this.targetViewer.impl.renderer().getConfig();e.renderEdges=!0,e.envMapBackground=null,e.aoEnabled=!1,e.antialias=!0,e.envMap=null,this.topViewViewer.impl.renderer().applyConfig(e),this.topViewViewer.setBackgroundOpacity(0)}))}}))}hideTopViewViewer(){this.topViewViewer&&(this.topViewViewer.container.style.opacity=0)}showTopViewViewer(){this.topViewViewer&&this.isCanvasOverlaySupported()&&(this.topViewViewer.container.style.opacity=1)}update(){var e;this.sheetSyncExt&&this.sheetSyncExt.sheetMap&&this.viewer&&this.targetViewer&&this.topViewViewer?(this.showTopViewViewer(),this.unloadIrrelevant3DModels(),this.loadRelevant3DModels(),this.updateTopViewViewerCamera(),null===(e=this.thumbnailsOverlay)||void 0===e||e.update()):this.hideTopViewViewer()}onCameraChanged(){this.forcedRerender||this.topViewViewer.impl.tick(performance.now())}updateBackgroundTexture(){this.backgroundTexture||(this.backgroundTexture=new THREE.Texture,this.backgroundTexture.minFilter=THREE.LinearFilter,this.backgroundTexture.image=this.topViewViewer.canvas,this.viewer.impl.renderer().setBackgroundTexture(this.backgroundTexture)),this.forcedRerender=!0,this.backgroundTexture.needsUpdate=!0,this.viewer.impl.invalidate(!0),this.viewer.impl.tick(performance.now()),this.forcedRerender=!1}isCanvasOverlaySupported(){return!Autodesk.Viewing.isIOSDevice()}}Mi.TopViewRenderer=Li,wi.theExtensionManager.registerExtension("Autodesk.AEC.TopViewRendererExtension",Li);class Ri{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=e}async fetchViewports(){throw"fetchViewports not implemented"}static getProviderName(){throw"getProviderName not implemented"}async deleteViewport(){throw"deleteViewport not implemented"}}class Pi{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;this.viewportRaw=e,this.viewportName=t,this.sheetUrn=i,this.lineageUrn=Autodesk.Viewing.BubbleNode.parseLineageUrnFromEncodedUrn(i),this.sheetName=r,this.options=o}getGuid(){throw"getGuid not implemented"}isMatrixInLocalCoords(){throw"isMatrixInLocalCoords not implemented"}getSheetUrn(){return this.sheetUrn}getSheetLineageUrn(){return this.lineageUrn}getSheetName(){return this.sheetName}getName(){return this.viewportName}getViewportBounds(){throw"getViewportBounds not implemented"}get2DTo3DMatrix(){throw"get2DTo3DMatrix not implemented"}get3DTo2DMatrix(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.get2DTo3DMatrix(e).clone().invert()}async getParentSheetNode(){throw"getParentSheetNode not implemented"}async get3DNodesForViewport(){throw"get3DNodesForViewport not implemented"}async getRelatedModel3DInfo(){throw"getRelatedModel3DInfo not implemented"}findLevelForViewport(){throw"findLevelForViewport not implemented"}isViewportInLevel(e){throw"isViewportInLevel not implemented"}supports2DTo3DTransform(){throw"supports2DTo3DTransform not implemented"}isTopViewViewport(){throw"isTopViewViewport not implemented"}isFloorPlan(){throw"isFloorPlan not implemented"}getElevation(){return this.get2DTo3DMatrix().elements[14]}}const Di=Autodesk.AEC.AecModelData;class Oi extends Pi{constructor(){super(...arguments),this.sheetNode=this.options.sheetNode,this.aecModelData=this.options.aecModelData}getGuid(){return this.viewportRaw.viewportGuid}isMatrixInLocalCoords(){return!0}getViewportBounds(e){return e?Di.getViewportBounds(this.viewportRaw,e):(console.error("Unit scale must be provided"),null)}get2DTo3DMatrix(e){if(!e)return console.error("Unit scale must be provided"),null;let t=Di.get2DTo3DMatrix(this.viewportRaw,e);if(this.isFloorPlan()){const e=this.findLevelForViewport();if(e){const i=1/120,r=new THREE.Vector3;r.setFromMatrixPosition(t),r.z=e.elevation+i,t=t.clone().setPosition(r)}}return t}async getParentSheetNode(){return this.sheetNode}async get3DNodesForViewport(){const e=this.sheetNode.getRootNode().search(Autodesk.Viewing.BubbleNode.MODEL_NODE);return e.length||console.error("That shouldn't happen - No AEC views"),e}findLevelForViewport(){return Di.findLevelForViewport(this.aecModelData,this.viewportRaw)}isViewportInLevel(e){const t=Di.getLinkedLevel(this.viewportRaw);return e.guid===t}supports2DTo3DTransform(){return Di.supports2DTo3DTransform(this.viewportRaw)}isTopViewViewport(){return Di.TopViewViewportTypes.includes(this.viewportRaw.viewType)}isFloorPlan(){return"FloorPlan"===this.viewportRaw.viewType}}class Ii extends Ri{async fetchViewports(e){const t=e.getRootNode(),i=t.getAecModelData(),r=e.is2D()?Autodesk.AEC.AecModelData.findViewportsOnSheet(e):null==i?void 0:i.viewports;if(!r)return[];return r.map((e=>{const r=t.search({guid:e.sheetGuid})[0];if(!r)return void console.warn("Shouldn't happen - couldn't find corresponding sheet.");const o=r.name(),n=t.urn();return new Oi(e,o,n,o,{aecModelData:i,sheetNode:r})}))}static getProviderName(){return"AecModelDataViewportProvider"}async deleteViewport(){return console.warn("Viewport deletion not allowed for AecModelData"),!1}}class Ni extends Pi{constructor(){super(...arguments),this.fetchSheetNodeForViewport=this.options.fetchSheetNodeForViewport,this.fetch3DNodeForViewport=this.options.fetch3DNodeForViewport,this.getModel3DInfoRelatedToViewport=this.options.getModel3DInfoRelatedToViewport}getGuid(){return this.viewportRaw.regionId}isMatrixInLocalCoords(){return!1}getViewportBounds(){return this.viewportRaw.boundingBox}get2DTo3DMatrix(){return this.viewportRaw.transform}async getParentSheetNode(){return this.parentSheetNodePromise||(this.parentSheetNodePromise=this.fetchSheetNodeForViewport(this)),this.parentSheetNodePromise}async get3DNodesForViewport(){return this.fetch3DNodeForViewport(this)}async getRelatedModel3DInfo(){return this.getModel3DInfoRelatedToViewport(this)}findLevelForViewport(){return this.isTopViewViewport()?{elevation:this.getElevation()}:null}isViewportInLevel(e){if(!this.isTopViewViewport())return!1;const t=this.getElevation();return t>e.zMin&&t<e.zMax}supports2DTo3DTransform(){return!!this.options.supports2DTo3DTransform}isTopViewViewport(){if(void 0===this._topViewViewport){const e=this.get2DTo3DMatrix(),t=(new THREE.Matrix3).getNormalMatrix(e),i=new THREE.Vector3(0,0,1);let r=i.clone().applyMatrix3(t).angleTo(i);r>=Math.PI&&(r-=Math.PI);const o=.05;this._topViewViewport=Math.abs(r)<o}return this._topViewViewport}isFloorPlan(){return this.isTopViewViewport()}}const ki=__webpack_require__(9063);class Bi extends Ri{constructor(e){if(super(e),this.service=this.options.service,this.getVersionUrn=this.options.getVersionUrn,this.loadDocument=this.options.loadDocument,!this.service||!this.getVersionUrn||!this.loadDocument)throw console.error("One of AlignmentServiceViewportProvider callbacks is missing."),"AlignmentServiceViewportProvider callbacks is missing";this.getModel3DInfoRelatedToViewport=this.getModel3DInfoRelatedToViewport.bind(this),this.fetch3DNodeForViewport=this.fetch3DNodeForViewport.bind(this),this.fetchSheetNodeForViewport=this.fetchSheetNodeForViewport.bind(this)}async fetchViewports(e){return await(e.is2D()?this.fetchViewportsFromBubble2D(e):this.fetchViewportsFromBubble3D(e))}static getProviderName(){return"AlignmentServiceViewportProvider"}async fetchViewportsFromBubble2D(e){const t=e.name(),i=e.lineageUrn();let r;try{r=await this.getVersionUrn(i)}catch(e){return console.log("Could not get latest version. Probably no permission or document has been deleted"),[]}const o=Autodesk.Viewing.Private.toUrlSafeBase64(r),n=await this.service.loadRegions(o,t);if(!n||!n.length)return[];const s=await Promise.all(n.map((async e=>{const r=(await this.service.getRelationships(Autodesk.AlignmentService.RelationshipEntityTypes.Region,i,t,e.regionId)).length>0;return this._createViewport(e,t,o,t,r)})));return s}async fetchViewportsFromBubble3D(e){const t=e.lineageUrn(),i=e.name();let r;try{r=await this.service.getRelationships(Autodesk.AlignmentService.RelationshipEntityTypes.Model3D,t,i)}catch(e){return console.warn("getRelationships Error: "+e),[]}if(!r.length)return[];const o=[];await Promise.all(r.map((async e=>{const t=e.entities.find((e=>e.type===Autodesk.AlignmentService.RelationshipEntityTypes.Region));if(!t)return void console.warn("Related model not found");const{lineageUrn:i,rest:r}=this._splitId(t.id),n=r.slice(Autodesk.AlignmentService.RelationshipIdPrefix.Name.length),[s,a]=n.split(Autodesk.AlignmentService.RelationshipIdPrefix.Region);let l;try{l=await this.getVersionUrn(i)}catch(e){return void console.log("Could not get latest version for alignment relationship. Probably no permission or document has been deleted")}const c=Autodesk.Viewing.Private.toUrlSafeBase64(l);o.push({versionUrn:c,viewablePartId:s,regionId:a,createdOn:new Date(t.createdOn||0)})})));const n=ki(o,((e,t)=>e.versionUrn===t.versionUrn&&e.viewablePartId===t.viewablePartId));let s=await this.service.loadBatchedRegions(n);s=s.filter((e=>e)).flat(),o.sort(((e,t)=>e.createdOn-t.createdOn));const a=[];return o.forEach((e=>{const{versionUrn:t,viewablePartId:i,regionId:r}=e,o=s.find((e=>e.regionId===r));if(!o)return void console.warn("Viewport not found.",t,i,r);const n=this._createViewport(o,i,t,i,!0);a.push(n)})),a}async fetchSheetNodeForViewport(e){return await this._fetchBubbleNode(e.getSheetUrn(),e.getSheetName())}async getModel3DInfoRelatedToViewport(e){var t;const i=e.getSheetLineageUrn(),r=e.getSheetName(),o=e.getGuid();let n;try{[n]=await this.service.getRelationships(Autodesk.AlignmentService.RelationshipEntityTypes.Region,i,r,o)}catch(e){throw console.warn("No relationship found. Error: "+e),e}const s=null===(t=n)||void 0===t?void 0:t.entities.find((e=>e.type===Autodesk.AlignmentService.RelationshipEntityTypes.Model3D));if(!s)throw"No related model found for sheet-model transition";const{lineageUrn:a,rest:l}=this._splitId(s.id);let c;try{c=await this.getVersionUrn(a)}catch(e){throw console.log("Could not get latest version for alignment relationship. Probably no permission or document has been deleted"),e}return{versionUrn3D:c,lineageUrn3D:a,name3D:l}}async fetch3DNodeForViewport(e){const{versionUrn3D:t,name3D:i}=await this.getModel3DInfoRelatedToViewport(e),r=Autodesk.Viewing.toUrlSafeBase64(t),o=decodeURIComponent(i.slice(Autodesk.AlignmentService.RelationshipIdPrefix.Name.length));return[await this._fetchBubbleNode(r,o)]}async deleteViewport(e){return await this.service.deleteRegion(e.lineageUrn,e.sheetUrn,e.sheetName,e.viewportRaw.regionId),!0}_createViewport(e,t,i,r,o){const n={getModel3DInfoRelatedToViewport:this.getModel3DInfoRelatedToViewport,fetch3DNodeForViewport:this.fetch3DNodeForViewport,fetchSheetNodeForViewport:this.fetchSheetNodeForViewport,supports2DTo3DTransform:o};return new Ni(e,t,i,r,n)}async _fetchBubbleNode(e,t){let i;try{i=await this.loadDocument(e)}catch(e){throw"Could not load document"}return i.getRoot().search({type:"geometry",name:t})[0]}_splitId(e){const t=e.indexOf("?");if(t<0)throw"Malformed relationship id";return{lineageUrn:e.substring(0,t),rest:e.substring(t+1)}}}const Fi={en:JSON.parse('{"@@locale":"en","@@context":"Viewports Extension","Level":"Level"}'),"en-GB":JSON.parse('{"@@locale":"en","@@context":"Viewports Extension","Level":"Level"}'),cs:JSON.parse('{"@@locale":"cs","@@context":"Rozšíření výřezů","Level":"Úroveň"}'),de:JSON.parse('{"@@locale":"de","@@context":"Ansichtsfenstererweiterung","Level":"Ebene"}'),es:JSON.parse('{"@@locale":"es","@@context":"Extensión de ventanas gráficas","Level":"Nivel"}'),fr:JSON.parse('{"@@locale":"fr","@@context":"Extension des fenêtres","Level":"Niveau"}'),"fr-CA":JSON.parse('{"@@locale":"fr-CA","@@context":"Extension des fenêtres","Level":"Niveau"}'),it:JSON.parse('{"@@locale":"it","@@context":"Estensione finestre","Level":"Livello"}'),ja:JSON.parse('{"@@locale":"ja","@@context":"Viewports Extension","Level":"レベル"}'),ko:JSON.parse('{"@@locale":"ko","@@context":"뷰포트 확장","Level":"수준"}'),pl:JSON.parse('{"@@locale":"pl","@@context":"Rozszerzenie Viewports","Level":"Poziom"}'),"pt-BR":JSON.parse('{"@@locale":"ptb","@@context":"Extensão de viewports","Level":"Nível"}'),ru:JSON.parse('{"@@locale":"ru","@@context":"Расширение видовых экранов","Level":"Уровень"}'),tr:JSON.parse('{"@@locale":"tr","@@context":"Görüntü Alanları Uzantısı","Level":"Seviye"}'),"zh-Hans":JSON.parse('{"@@locale":"zh-Hans","@@context":"视口扩展","Level":"级别"}'),"zh-Hant":JSON.parse('{"@@locale":"zh-Hant","@@context":"Viewports 延伸","Level":"樓層"}'),"zh-HK":JSON.parse('{"@@locale":"zh-hk","@@context":"檢視區擴充程式","Level":"樓層"}'),nl:JSON.parse('{"@@locale":"nl","@@context":"Extensie viewports","Level":"Niveau"}'),sv:JSON.parse('{"@@locale":"sv","@@context":"Tillägg för vyportar","Level":"Våning"}'),da:JSON.parse('{"@@locale":"da","@@context":"Viewports-udvidelse","Level":"Niveau"}'),no:JSON.parse('{"@@locale":"no","@@context":"Viewports-utvidelse","Level":"Nivå"}')},zi=Autodesk.Viewing,ji=AutodeskNamespace("Autodesk.AEC");class Ui extends zi.Extension{constructor(e,t){super(e,t),zi.EventDispatcher.prototype.apply(this),this.name="Viewports",this.onModelAdded=this.onModelAdded.bind(this),this.onViewportDataCreated=this.onViewportDataCreated.bind(this)}load(){return super.load(),this.extendLocalization(Fi),this.cache=this.getCache(),this.cache.viewports||(this.cache.viewports={}),this.providers={},this.addViewportProvider(new Ii),this.addEventListeners(),this.fetchViewportsForAllModels(),!0}unload(){return super.unload(),this.providers=null,this.removeEventListeners(),!0}addViewportProvider(e){const t=e.constructor.getProviderName();this.providers[t]||(this.providers[t]=e),this.fetchViewportsForAllModels()}removeViewportProvider(e){delete this.providers[e.constructor.getProviderName()]}fetchViewportsForAllModels(){this.viewer.getAllModels().forEach((e=>this.fetchViewports(e.getDocumentNode())))}addEventListeners(){this.viewer.addEventListener(zi.MODEL_ADDED_EVENT,this.onModelAdded),this.addEventListener(Ui.Events.VIEWPORT_DATA_CREATED_EVENT,this.onViewportDataCreated)}removeEventListeners(){this.viewer.removeEventListener(zi.MODEL_ADDED_EVENT,this.onModelAdded),this.removeEventListener(Ui.Events.VIEWPORT_DATA_CREATED_EVENT,this.onViewportDataCreated)}onModelAdded(e){let{model:t}=e;this.fetchViewports(t.getDocumentNode())}async generateLevelsFromViewports(e){const t=await this.getViewportsAsync(e);if(!t)return[];const i=[];t.sort(((e,t)=>e.getElevation()-t.getElevation()));for(let e=0;e<t.length-1;e++)Math.abs(t[e].getElevation()-t[e+1].getElevation())<1&&(t.splice(e+1,1),e--);for(let e=0;e<t.length;e++){const r=t[e].getElevation();let o;o=e===t.length-1?2147483647:t[e+1].getElevation(),i.push(new R(e,e.toString(),`${Autodesk.Viewing.i18n.translate("Level")} #${e+1}`,r-O,o,!0))}return i}onViewportDataCreated(e){let{models:t}=e;t.forEach((e=>{const t=e.getModelKey();this.cache.viewports[t]&&(delete this.cache.viewports[t],this.onModelAdded({model:e}))}))}async getViewportsAsync(e,t){return await this.fetchViewports(e),this.filterAndFlattenViewports(e,t)}getViewports(e,t){return this.filterAndFlattenViewports(e,t)}filterAndFlattenViewports(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=t.filter2DTo3DTransformSupport??!0,r=t.onlyTopViewPlans??!0,o=t.filterCB,n=e.getModelKey(),s=this.cache.viewports[n];if(!s)return[];let a=Object.values(s).flat();return i&&(a=a.filter((e=>e.supports2DTo3DTransform()))),r&&(a=a.filter((e=>e.isTopViewViewport()))),o&&(a=a.filter(o)),a}async fetchViewports(e){if(!e)return;const t=e.getModelKey();this.cache.viewports[t]||(this.cache.viewports[t]={}),await Promise.all(Object.values(this.providers).map((async i=>{const r=i.constructor.getProviderName();if(this.cache.viewports[t][r])this.cache.viewports[t][r].pendingPromise&&await this.cache.viewports[t][r].pendingPromise;else{this.cache.viewports[t][r]=[],this.cache.viewports[t][r].pendingPromise=i.fetchViewports(e);const o=await this.cache.viewports[t][r].pendingPromise;delete this.cache.viewports[t][r].pendingPromise,o.length&&(this.cache.viewports[t][r]=o,this.fireEvent({type:Ui.Events.VIEWPORT_DATA_FETCHED_EVENT,modelKey:t,providerName:r,viewports:o}))}})))}findViewportAtPoint(e,t,i){let r=this.filterAndFlattenViewports(e.getDocumentNode(),i);r=r.map((t=>({viewport:t,bounds:t.getViewportBounds(e.getUnitScale())})));if(r=r.filter((e=>{var i;return null===(i=e.bounds)||void 0===i?void 0:i.containsPoint(t)})),!r.length)return null;const o=(e,t)=>Math.min(Math.min(t.x-e.min.x,e.max.x-t.x),Math.min(t.y-e.min.y,e.max.y-t.y));return r.reduce(((e,i)=>{let r=o(e.bounds,t);return o(i.bounds,t)>r?i:e})).viewport}findViewportsInLevel(e,t){const i=this.viewer.getExtension("Autodesk.AEC.LevelsExtension");if(!i)return[];const r=i.floorSelector.floorData.find((e=>e.guid===t));if(!r)return[];return this.getViewports(e.getDocumentNode(),{filterCB:e=>e.isViewportInLevel(r)})}async deleteViewport(e,t){var i,r;const o=this.getViewportType(e),n=null===(i=this.cache.viewports[t])||void 0===i?void 0:i[o];if(!n)return!1;const s=n.findIndex((t=>t===e));if(-1===s)return!1;n.splice(s,1),this.fireEvent({type:Ui.Events.VIEWPORT_DATA_FETCHED_EVENT,modelKey:t,providerName:o,viewports:n});return!!await(null===(r=this.providers[o])||void 0===r?void 0:r.deleteViewport(e))||(console.warn("Could not delete viewport or not allowed.",e),n.splice(s,0,e),this.fireEvent({type:Ui.Events.VIEWPORT_DATA_FETCHED_EVENT,modelKey:t,providerName:o,viewports:n}),!1)}getViewportType(e){return e instanceof Oi?Ii.getProviderName():e instanceof Ni?Bi.getProviderName():void 0}findViewportByGuid(e){for(const t in this.cache.viewports){const i=this.cache.viewports[t],r=Object.values(i).flat().find((t=>t.getGuid()===e));if(r)return r}return null}}ji.ViewportsExtension=Ui,Ui.Events={VIEWPORT_DATA_FETCHED_EVENT:"viewportDataFetched",VIEWPORT_DATA_CREATED_EVENT:"viewportDataCreated"},Ui.ViewportProviderInterface=Ri,Ui.AecModelDataViewportProvider=Ii,Ui.AlignmentServiceViewportProvider=Bi,Ui.AlignmentServiceViewport=Ni,Ui.AecModelDataViewport=Oi,zi.theExtensionManager.registerExtension("Autodesk.AEC.ViewportsExtension",Ui);var Gi=__webpack_require__(2543);const Wi=JSON.parse('[{"Key":"Architecture","Name":"Architecture","Categories":["Závitové spojky konstrukčních výztuží","Konstrukční přípoje","Konstrukční výztuž","Objem","Plochy","Informace o projektu","Výkresy","Položky detailu","Stafáž","Výsadba","Konstrukční výztuha","Speciální vybavení","Topografie","Konstrukční sloupy","Systémy konstrukčních trámů","Konstrukční rámová konstrukce","Konstrukční základy","Pozemek","Silnice","Parkování","Instalační zařizovací předměty","Mechanické zařízení","Osvětlovací tělesa","Nábytkový systém","Elektrická tělesa","Elektrické vybavení","Truhlářské výrobky","Otvory šacht","Rastrové obrázky","Obvodové pláště","Styl zobrazení analýzy","Výsledky analýzy","Součásti","Maskovací oblast","Vyplněná oblast","Rampy","Osnovy obvodového pláště","Příčle obvodového pláště","Panely obvodového pláště","Místnosti","Obecné modely","Zábradlí","Schodiště","Sloupy","Nábytek","Čáry","Stropy","Střechy","Podlahy","Dveře","Okna","Stěny"],"DisplayOrder":0},{"Key":"Structure","Name":"Structure","Categories":["Závitové spojky konstrukčních výztuží","Konstrukční přípoje","Konstrukční oblasti svařovaných sítí","Konstrukční výztuž sítě","Konstrukční výztuž podél trajektorie","Konstrukční výztuž plochy","Konstrukční výztuž","Objem","Informace o projektu","Výkresy","Položky detailu","Konstrukční výztuha","Konstrukční příhradové nosníky","Konstrukční sloupy","Systémy konstrukčních trámů","Konstrukční rámová konstrukce","Konstrukční základy","Otvory šacht","Rastrové obrázky","Styl zobrazení analýzy","Výsledky analýzy","Součásti","Maskovací oblast","Vyplněná oblast","Rampy","Osnovy obvodového pláště","Obecné modely","Schodiště","Sloupy","Čáry","Střechy","Podlahy","Stěny"],"DisplayOrder":1},{"Key":"Mechanical","Name":"Mechanical","Categories":["Výroba – závěsy TZB","Potrubí TZB výroby","Zástupci potrubí","Předvolby tras","Výstelka potrubí","Izolace potrubí","Zóny VZT","Elektrické obvody","Ohebná potrubí","Příslušenství potrubí","Potrubní systémy","Vyústky vzduchotechniky","Tvarovky potrubí","Potrubí","Prostory","Objem","Plochy","Informace o projektu","Výkresy","Položky detailu","Mechanické zařízení","Rastrové obrázky","Styl zobrazení analýzy","Výsledky analýzy","Součásti","Maskovací oblast","Vyplněná oblast","Osnovy obvodového pláště","Místnosti","Obecné modely","Čáry"],"DisplayOrder":4},{"Key":"Electrical","Name":"Electrical","Categories":["Izolace TZB výroby","Výroba – závěsy TZB","Rezervy/prostory elektrických obvodů","Ramena kabelové lávky","Větve elektroinstalačních trubek","Elektroinstalační trubky","Kabelové lávky","Tvarovky elektroinstalační trubky","Tvarovky kabelové lávky","Předvolby tras","Systém přepínání","Osvětlení","Požární poplachová zařízení","Datová zařízení","Komunikační zařízení","Zabezpečovací zařízení","Zařízení na přivolání ošetřovatelky","Telefonní přístroje","Vodiče","Elektrické obvody","Prostory","Objem","Plochy","Informace o projektu","Výkresy","Položky detailu","Osvětlovací tělesa","Elektrická tělesa","Elektrické vybavení","Rastrové obrázky","Styl zobrazení analýzy","Výsledky analýzy","Součásti","Maskovací oblast","Vyplněná oblast","Osnovy obvodového pláště","Místnosti","Obecné modely","Čáry"],"DisplayOrder":2},{"Key":"Piping","Name":"Piping","Categories":["Systém potrubí TZB výroby","Výroba – závěsy TZB","Potrubí TZB výroby","Segmenty potrubí","Zástupci trubek","Předvolby tras","Izolace trubky","Rozstřikovače","Příslušenství trubek","Ohebné trubky","Tvarovky","Trubky","Systémy trubek","Prostory","Objem","Plochy","Informace o projektu","Výkresy","Položky detailu","Instalační zařizovací předměty","Mechanické zařízení","Rastrové obrázky","Styl zobrazení analýzy","Výsledky analýzy","Součásti","Maskovací oblast","Vyplněná oblast","Osnovy obvodového pláště","Místnosti","Obecné modely","Čáry"],"DisplayOrder":3}]'),Yi=JSON.parse('[{"Key":"Architecture","Name":"Architektur","Categories":["Allgemeines Modell","Bepflanzung","Bewehrung - Stabstahl","Decken","Detailelemente","Dächer","Elektrische Ausstattung","Elektroinstallationen","Fassadenelemente","Fassadenpfosten","Fassadensysteme","Fenster","Flächen","Fundamente","Geländer","Geschossdecken","Grundstück","HLS-Bauteile","Körper","Leuchten","Linien","Möbel","Möbelsysteme","Parkplatz","Rampen","Rasterbilder","Räume","Sanitärinstallationen","Schachtöffnungen","Schreinerarbeiten","Skelettbau","Sonderausstattung","Steifen","Straßen","Stützen","Teile","Topographie","Tragwerksstützen","Tragwerksverbindungen","Treppen","Trägersysteme","Türen","Umgebung","Verbindungsmittel","Wände"],"DisplayOrder":0},{"Key":"Structure","Name":"Konstruktion","Categories":["Allgemeines Modell","Bewehrung - linear","Bewehrung - Matten","Bewehrung - Stabstahl","Bewehrung - Verlegebereich Fläche","Bewehrung - Verlegebereich Matten","Detailelemente","Dächer","Fachwerkbinder","Fundamente","Geschossdecken","Körper","Linien","Rampen","Rasterbilder","Schachtöffnungen","Skelettbau","Steifen","Stützen","Teile","Tragwerksstützen","Tragwerksverbindungen","Treppen","Trägersysteme","Verbindungsmittel","Wände"],"DisplayOrder":1},{"Key":"Mechanical","Name":"HLS","Categories":["Allgemeines Modell","Detailelemente","Flexkanäle","Flächen","HLS-Bauteile","Körper","Linien","Luftdurchlässe","Luftkanaldämmung außen","Luftkanaldämmung innen","Luftkanalformteile","Luftkanalplatzhalter","Luftkanalzubehör","Luftkanäle","MEP Fabrication Halterungen","MEP Fabrication Luftkanäle","MEP-Räume","Rasterbilder","Räume","Teile","Zonen"],"DisplayOrder":4},{"Key":"Electrical","Name":"Elektro","Categories":["Allgemeines Modell","Brandmelder","Datengeräte","Detailelemente","Elektrische Ausstattung","Elektroinstallationen","Flächen","Kabel","Kabeltrassen","Kabeltrassenformteile","Kommunikationsgeräte","Körper","Leerrohr","Leerrohrformteile","Leuchten","Lichtschalter","Linien","MEP Fabrication Halterungen","MEP Fabrication Kabelführungen","MEP-Räume","Notrufgeräte","Rasterbilder","Räume","Sicherheitsgeräte","Teile","Telefongeräte"],"DisplayOrder":2},{"Key":"Piping","Name":"Rohre","Categories":["Allgemeines Modell","Detailelemente","Flexible Rohre","Flächen","HLS-Bauteile","Körper","Linien","MEP Fabrication Halterungen","MEP Fabrication Luftkanäle","MEP Fabrication Rohre","MEP-Räume","Rasterbilder","Rohre","Rohrformteile","Rohrplatzhalter","Rohrzubehör","Räume","Sanitärinstallationen","Sprinkler","Teile"],"DisplayOrder":3}]'),Hi=JSON.parse('[{"Key":"Architecture","Name":"Architecture","Categories":["Areas","Casework","Ceilings","Columns","Curtain Panels","Curtain Systems","Curtain Wall Mullions","Detail Items","Doors","Electrical Equipment","Electrical Fixtures","Entourage","Floors","Furniture","Furniture Systems","Generic Models","Lighting Fixtures","Lines","Mass","Mechanical Equipment","Parking","Parts","Planting","Plumbing Fixtures","Railings","Ramps","Raster Images","Roads","Roofs","Rooms","Shaft Openings","Site","Specialty Equipment","Stairs","Structural Beam Systems","Structural Columns","Structural Connections","Structural Foundations","Structural Framing","Structural Rebar","Structural Rebar Couplers","Structural Stiffeners","Topography","Walls","Windows"],"DisplayOrder":0},{"Key":"Structure","Name":"Structure","Categories":["Columns","Detail Items","Floors","Generic Models","Lines","Mass","Parts","Ramps","Raster Images","Roofs","Shaft Openings","Stairs","Structural Area Reinforcement","Structural Beam Systems","Structural Columns","Structural Connections","Structural Fabric Areas","Structural Fabric Reinforcement","Structural Foundations","Structural Framing","Structural Path Reinforcement","Structural Rebar","Structural Rebar Couplers","Structural Stiffeners","Structural Trusses","Walls"],"DisplayOrder":1},{"Key":"Mechanical","Name":"Mechanical","Categories":["Air Terminals","Areas","Detail Items","Duct Accessories","Duct Fittings","Duct Insulations","Duct Linings","Duct Placeholders","Ducts","Flex Ducts","Generic Models","HVAC Zones","Lines","Mass","Mechanical Equipment","MEP Fabrication Ductwork","MEP Fabrication Hangers","Parts","Raster Images","Rooms","Spaces"],"DisplayOrder":4},{"Key":"Electrical","Name":"Electrical","Categories":["Areas","Cable Tray Fittings","Cable Trays","Communication Devices","Conduit Fittings","Conduits","Data Devices","Detail Items","Electrical Equipment","Electrical Fixtures","Fire Alarm Devices","Generic Models","Lighting Devices","Lighting Fixtures","Lines","Mass","MEP Fabrication Containment","MEP Fabrication Hangers","Nurse Call Devices","Parts","Raster Images","Rooms","Security Devices","Spaces","Telephone Devices","Wires"],"DisplayOrder":2},{"Key":"Piping","Name":"Piping","Categories":["Areas","Detail Items","Flex Pipes","Generic Models","Lines","Mass","Mechanical Equipment","MEP Fabrication Ductwork","MEP Fabrication Hangers","MEP Fabrication Pipework","Parts","Pipe Accessories","Pipe Fittings","Pipe Insulations","Pipe Placeholders","Pipes","Plumbing Fixtures","Raster Images","Rooms","Spaces","Sprinklers"],"DisplayOrder":3}]'),qi=JSON.parse('[{"Key":"Architecture","Name":"Arquiterctura","Categories":["Acopladores de armadura estructural","Conexiones estructurales","Armadura estructural","Masa","Áreas","Información de proyecto","Planos","Elementos de detalle","Entorno","Vegetación","Contrafuertes estructurales","Equipos especializados","Topografía","Pilares estructurales","Sistemas de vigas estructurales","Armazón estructural","Cimentación estructural","Emplazamiento","Carreteras","Aparcamiento","Aparatos sanitarios","Equipos mecánicos","Luminarias","Sistemas de mobiliario","Aparatos eléctricos","Equipos eléctricos","Muebles de obra","Aberturas de agujero","Imágenes ráster","Sistemas de muro cortina","Estilo de visualización de análisis","Resultados de análisis","Piezas","Región de máscara","Región rellenada","Rampas","Rejillas de muro cortina","Montantes de muro cortina","Paneles de muro cortina","Habitaciones","Modelos genéricos","Barandillas","Escaleras","Pilares","Mobiliario","Líneas","Techos","Cubiertas","Suelos","Puertas","Ventanas","Muros"],"DisplayOrder":0},{"Key":"Structure","Name":"Estructura","Categories":["Acopladores de armadura estructural","Conexiones estructurales","Áreas de mallazo estructural","Mallazo de refuerzo estructural","Refuerzo estructural  por camino","Refuerzo de área estructural","Armadura estructural","Masa","Información de proyecto","Planos","Elementos de detalle","Contrafuertes estructurales","Vigas de celosía estructurales","Pilares estructurales","Sistemas de vigas estructurales","Armazón estructural","Cimentación estructural","Aberturas de agujero","Imágenes ráster","Estilo de visualización de análisis","Resultados de análisis","Piezas","Región de máscara","Región rellenada","Rampas","Rejillas de muro cortina","Modelos genéricos","Escaleras","Pilares","Líneas","Cubiertas","Suelos","Muros"],"DisplayOrder":1},{"Key":"Mechanical","Name":"Mecanica","Categories":["Soportes de fabricación MEP","Red de conductos de fabricación MEP","Marcadores de posición de conducto","Preferencias de enrutamiento","Aislamientos interiores de conducto","Aislamientos de conducto","Zonas de climatización","Circuitos eléctricos","Conductos flexibles","Accesorios de conductos","Sistemas de conductos","Terminales de aire","Uniones de conducto","Conductos","Espacios","Masa","Áreas","Información de proyecto","Planos","Elementos de detalle","Equipos mecánicos","Imágenes ráster","Estilo de visualización de análisis","Resultados de análisis","Piezas","Región de máscara","Región rellenada","Rejillas de muro cortina","Habitaciones","Modelos genéricos","Líneas"],"DisplayOrder":4},{"Key":"Electrical","Name":"Electricidad","Categories":["Canalización de fabricación MEP","Soportes de fabricación MEP","Reserva eléctrica/Circuitos de espacio","Tramos de bandeja de cables","Tramos de tubo","Tubos","Bandejas de cables","Uniones de tubo","Uniones de bandeja de cables","Preferencias de enrutamiento","Sistema de interruptores","Dispositivos de iluminación","Dispositivos de alarma de incendios","Dispositivos de datos","Dispositivos de comunicación","Dispositivos de seguridad","Timbres de enfermería","Dispositivos telefónicos","Cables","Circuitos eléctricos","Espacios","Masa","Áreas","Información de proyecto","Planos","Elementos de detalle","Luminarias","Aparatos eléctricos","Equipos eléctricos","Imágenes ráster","Estilo de visualización de análisis","Resultados de análisis","Piezas","Región de máscara","Región rellenada","Rejillas de muro cortina","Habitaciones","Modelos genéricos","Líneas"],"DisplayOrder":2},{"Key":"Piping","Name":"Fonaneria","Categories":["Tuberías de fabricación MEP","Soportes de fabricación MEP","Red de conductos de fabricación MEP","Segmentos de tubería","Marcadores de posición de tubería","Preferencias de enrutamiento","Aislamientos de tubería","Rociadores","Accesorios de tuberías","Tuberías flexibles","Uniones de tubería","Tuberías","Sistemas de tuberías","Espacios","Masa","Áreas","Información de proyecto","Planos","Elementos de detalle","Aparatos sanitarios","Equipos mecánicos","Imágenes ráster","Estilo de visualización de análisis","Resultados de análisis","Piezas","Región de máscara","Región rellenada","Rejillas de muro cortina","Habitaciones","Modelos genéricos","Líneas"],"DisplayOrder":3}]'),Ki=JSON.parse('[{"Key":"Architecture","Name":"Architecture","Categories":["Appareils sanitaires","Armature béton","Connexions structurelles","Coupleurs d\'armature structurelle ","Eléments","Eléments de détail","Environnement","Equipement de génie climatique","Equipement spécialisé","Equipement électrique","Escalier","Fenétres","Fondations","Garde-corps","Images raster","Installations électriques","Lignes","Luminaires","Meneaux de murs-rideaux","Meubles de rangement","Mobilier","Modeles génériques","Murs","Ossature","Ouvertures de cages","Panneaux de murs-rideaux","Parking","Pieces","Plafonds","Plantes","Portes","Poteaux","Poteaux poteurs","Raidisseurs","Rampes d\'accés ","Routes","Réseaux de poutres","Surfaces","Systèmes de mobilier","Systèmes de murs-rideaux","Toits"],"DisplayOrder":0},{"Key":"Structure","Name":"Structure","Categories":["Armature surfa cique","Armature surfacique (treillis)","Armature béton","Armatures surfaciques (treillis)","Connexions structurelles","Coupleurs d\'armature structurelle ","Direction principale du ferraillage","Eléments","Eléments de détail","Escalier","Fondations","Images raster","Lignes","Modeles génériques","Murs","Ossature","Ouvertures de cages","Poteaux","Poteaux porteurs","Poutres treillis","Raidisseurs","Rampes d\'accés ","Réseaux de poutres","Sols","Toits","Volume"],"DisplayOrder":1},{"Key":"Mechanical","Name":"Génie climatique","Categories":["Accessoire de gaine","Bouche d\'aération ","Eléments","Eléments de détail","Equipement de génie climatique","Espaces","Espaces réservés aux gaines","Gaine","Gaine flexible","Images raster","Isolations des gaines","Lignes","Modeles génériques","Pieces","Raccords de gaine","Revétements des gaines","Réseau de gaines de fabrication MEP","Surfaces","Tirants de fabrication MEP","Volume","Zones HVAC"],"DisplayOrder":4},{"Key":"Electrical","Name":"Electrique","Categories":["Appareil d\'appel malade ","Appareils de communication","Appareils téléphoniques","Cheminement de fabrication MEP","Chemins de cÉbIes","Conduits","Dispositifs d\'alarme incendie ","Dispositifs d\' éclairage ","Dispositifs de données","Dispositifs de sécurité","Eléments","Eléments de détail","Equipement électrique","Espaces","Images raster","Installations électriques","Lignes","Luminaires","Modeles génériques","Pieces","Raccords de chemins de cåbles","Raccords de conduits","Surfaces","Tirants de fabrication MEP","Volume"],"DisplayOrder":2},{"Key":"Piping","Name":"Canalisation","Categories":["Accessoire de canalisation","Appareils sanitaires","Canalisation","Canalisation souple","Eléments","Eléments de détail","Equipement de génie climatique","Espaces","Espaces réservés aux canalisations","Images raster","Isolations des canalisations","Lignes","Modeles génériques","Pieces","Raccords de canalisation","Réseau de canalisations de fabrication MEP","Réseau de gaines de fabrication MEP","Sprinklers","Surfaces","Tirants de fabrication MEP","Volume"],"DisplayOrder":3}]'),Qi=JSON.parse('[{"Key":"Architecture","Name":"Architettura","Categories":["Manicotti armatura strutturale","Connessioni strutturali","Armatura strutturale","Massa","Aree","Informazioni sul progetto","Tavole","Elementi di dettaglio","Contesto","Verde","Ritegni strutturali","Attrezzature speciali","Topografia","Pilastri strutturali","Sistemi di travi strutturali","Telaio strutturale","Fondazioni strutturali","Planimetria","Strade","Posti auto","Apparecchi idraulici","Attrezzatura meccanica","Apparecchi per illuminazione","Sistemi di arredo","Apparecchi elettrici","Attrezzatura elettrica","Arredi fissi","Cavedii","Immagini raster","Sistemi di facciata continua","Stile di visualizzazione analisi","Risultati analisi","Stratigrafia","Mascheratura","Campitura","Rampe inclinate","Griglie facciata continua","Montanti della facciata continua","Pannelli di facciata continua","Locali","Modelli generici","Ringhiere","Scale","Pilastri","Arredi","Linee","Controsoffitti","Tetti","Pavimenti","Porte","Finestre","Muri"],"DisplayOrder":0},{"Key":"Structure","Name":"Struttura","Categories":["Manicotti armatura strutturale","Connessioni strutturali","Aree rete strutturale","Rinforzo rete strutturale","Armatura su percorso strutturale","Armatura su area strutturale","Armatura strutturale","Massa","Informazioni sul progetto","Tavole","Elementi di dettaglio","Ritegni strutturali","Travi reticolari strutturali","Pilastri strutturali","Sistemi di travi strutturali","Telaio strutturale","Fondazioni strutturali","Cavedii","Immagini raster","Stile di visualizzazione analisi","Risultati analisi","Stratigrafia","Mascheratura","Campitura","Rampe inclinate","Griglie facciata continua","Modelli generici","Scale","Pilastri","Linee","Tetti","Pavimenti","Muri"],"DisplayOrder":1},{"Key":"Mechanical","Name":"Meccanico","Categories":["Staffe di fabbricazione MEP","Condotti di fabbricazione MEP","Collocazioni condotto","Preferenze di instradamento","Rivestimenti condotti","Isolamenti condotti","Zone riscaldamento, ventilazione e aria condizionata","Circuiti elettrici","Condotto flessibile","Accessori per condotti","Sistema di condotti","Bocchettoni","Raccordi condotto","Condotto","Vani","Massa","Aree","Informazioni sul progetto","Tavole","Elementi di dettaglio","Attrezzatura meccanica","Immagini raster","Stile di visualizzazione analisi","Risultati analisi","Stratigrafia","Mascheratura","Campitura","Griglie facciata continua","Locali","Modelli generici","Linee"],"DisplayOrder":4},{"Key":"Electrical","Name":"Elettrico","Categories":["Canaline di fabbricazione MEP","Staffe di fabbricazione MEP","Circuiti riserva/vano elettrici","Percorsi passerelle","Percorsi tubi protettivi","Tubi protettivi","Passerelle","Raccordi tubo protettivo","Raccordi passerella","Preferenze di instradamento","Sistema di interruttori","Dispositivi di illuminazione","Dispositivi allarme incendio","Dispositivi dati","Dispositivi di comunicazione","Dispositivi di sicurezza","Dispositivi chiamata infermiera","Dispositivi telefonici","Cavi","Circuiti elettrici","Vani","Massa","Aree","Informazioni sul progetto","Tavole","Elementi di dettaglio","Apparecchi per illuminazione","Apparecchi elettrici","Attrezzatura elettrica","Immagini raster","Stile di visualizzazione analisi","Risultati analisi","Stratigrafia","Mascheratura","Campitura","Griglie facciata continua","Locali","Modelli generici","Linee"],"DisplayOrder":2},{"Key":"Piping","Name":"Tubazioni","Categories":["Tubazioni di fabbricazione MEP","Staffe di fabbricazione MEP","Condotti di fabbricazione MEP","Segmenti di tubazione","Collocazioni tubazione","Preferenze di instradamento","Isolamenti tubazioni","Estintori","Accessori per tubazioni","Tubazioni flessibili","Raccordi tubazione","Tubazione","Sistema di tubazioni","Vani","Massa","Aree","Informazioni sul progetto","Tavole","Elementi di dettaglio","Apparecchi idraulici","Attrezzatura meccanica","Immagini raster","Stile di visualizzazione analisi","Risultati analisi","Stratigrafia","Mascheratura","Campitura","Griglie facciata continua","Locali","Modelli generici","Linee"],"DisplayOrder":3}]'),Zi=JSON.parse('[{"Key":"Architecture","Name":"建築","Categories":["構造鉄筋カプラー","構造接合","構造鉄筋","マス","エリア","プロジェクト情報","シート","詳細項目","点景","植栽","構造スチフナ材","特殊設備","地形","構造柱","構造梁システム","構造フレーム","構造基礎","外構","道路","駐車場","衛生器具","機械設備","照明器具","家具システム","電気器具","電気機器","収納設備","シャフト開口部","ラスター イメージ","カーテン システム","解析表示スタイル","解析結果","パーツ","マスキング領域","塗り潰し領域","スロープ","カーテン グリッド","カーテン マリオン","カーテン パネル","部屋","一般モデル","手すり","階段","柱","家具","線分","天井","屋根","床","ドア","窓","壁"],"DisplayOrder":0},{"Key":"Structure","Name":"構造","Categories":["構造鉄筋カプラー","構造接合","構造メッシュ筋エリア","構造メッシュ筋","構造パス配筋","構造面配筋","構造鉄筋","マス","プロジェクト情報","シート","詳細項目","構造スチフナ材","構造トラス","構造柱","構造梁システム","構造フレーム","構造基礎","シャフト開口部","ラスター イメージ","解析表示スタイル","解析結果","パーツ","マスキング領域","塗り潰し領域","スロープ","カーテン グリッド","一般モデル","階段","柱","線分","屋根","床","壁"],"DisplayOrder":1},{"Key":"Mechanical","Name":"機械","Categories":["MEP 製造用ハンガー部品","MEP 製造用ダクト部品","ダクト ルート","推奨経路設定","ダクト ライニング","ダクト断熱材","HVAC ゾーン","電気回路","フレキシブル ダクト","ダクト付属品","ダクト システム","吹き出し口","ダクト継手","ダクト","スペース","マス","エリア","プロジェクト情報","シート","詳細項目","機械設備","ラスター イメージ","解析表示スタイル","解析結果","パーツ","マスキング領域","塗り潰し領域","カーテン グリッド","部屋","一般モデル","線分"],"DisplayOrder":4},{"Key":"Electrical","Name":"電気","Categories":["MEP 製造用収納部品","MEP 製造用ハンガー部品","スペア / スペースの電気回路","ケーブル ラック経路","電線管経路","電線管","ケーブル ラック","電線管継手","ケーブル ラック継手","推奨経路設定","スイッチ システム","照明機器","火災報知機器","データ機器","通信機器","警備機器","ナース コール機器","電話機器","配線","電気回路","スペース","マス","エリア","プロジェクト情報","シート","詳細項目","照明器具","電気器具","電気機器","ラスター イメージ","解析表示スタイル","解析結果","パーツ","マスキング領域","塗り潰し領域","カーテン グリッド","部屋","一般モデル","線分"],"DisplayOrder":2},{"Key":"Piping","Name":"配管","Categories":["MEP 製造用配管部品","MEP 製造用ハンガー部品","MEP 製造用ダクト部品","配管セグメント","配管ルート","推奨経路設定","パイプ断熱材","スプリンクラ","配管付属品","フレキシブル配管","配管継手","配管","配管システム","スペース","マス","エリア","プロジェクト情報","シート","詳細項目","衛生器具","機械設備","ラスター イメージ","解析表示スタイル","解析結果","パーツ","マスキング領域","塗り潰し領域","カーテン グリッド","部屋","一般モデル","線分"],"DisplayOrder":3}]'),Ji=JSON.parse('[{"Key":"Architecture","Name":"건축m","Categories":["구조 보강 철근 커플러","구조 연결","구조 보강 철근","매스","면적","프로젝트 정보","시트","상세 항목","환경","수목","구조 보강재","특수 시설물","지형","구조 기둥","구조 보 시스템","구조 프레임","구조 기초","대지","도로","주차장","배관 설비","기계 장비","조명 설비","가구 시스템","전기 설비","전기 시설물","케이스워크","샤프트 개구부","래스터 이미지","커튼 시스템","해석 화면표시 스타일","해석 결과","부품","마스킹 영역","채워진 영역","경사로","커튼월 그리드","커튼월 멀리언","커튼월 패널","룸","일반 모델","난간","계단","기둥","가구","선","천장","지붕","바닥","문","창","벽"],"DisplayOrder":0},{"Key":"Structure","Name":"구조","Categories":["구조 보강 철근 커플러","구조 연결","구조 선조립 영역","구조 선조립 철근 배근","구조 경로 철근 배근","구조 면적 철근 배근","구조 보강 철근","매스","프로젝트 정보","시트","상세 항목","구조 보강재","구조 트러스","구조 기둥","구조 보 시스템","구조 프레임","구조 기초","샤프트 개구부","래스터 이미지","해석 화면표시 스타일","해석 결과","부품","마스킹 영역","채워진 영역","경사로","커튼월 그리드","일반 모델","계단","기둥","선","지붕","바닥","벽"],"DisplayOrder":1},{"Key":"Mechanical","Name":"기계","Categories":["MEP 제작 행거","MEP 제작 덕트장치","덕트 자리 표시자","라우팅 기본 설정","덕트 라이닝","덕트 단열재","HVAC 구역","전기 회로","플렉시블 덕트","덕트 액세서리","덕트 시스템","공기 터미널","덕트 장치","덕트","공간","매스","면적","프로젝트 정보","시트","상세 항목","기계 장비","래스터 이미지","해석 화면표시 스타일","해석 결과","부품","마스킹 영역","채워진 영역","커튼월 그리드","룸","일반 모델","선"],"DisplayOrder":4},{"Key":"Electrical","Name":"전기","Categories":["MEP 제작 격리","MEP 제작 행거","전기 예비/공간 회로","케이블 트레이 계단진행","배선 계단진행","배선","케이블 트레이","배선 장치","케이블 트레이 장치","라우팅 기본 설정","스위치 시스템","조명 장치","화재 경보 장치","데이터 장치","통신 장치","보안 장치","간호사 호출 장치","전화 장치","와이어","전기 회로","공간","매스","면적","프로젝트 정보","시트","상세 항목","조명 설비","전기 설비","전기 시설물","래스터 이미지","해석 화면표시 스타일","해석 결과","부품","마스킹 영역","채워진 영역","커튼월 그리드","룸","일반 모델","선"],"DisplayOrder":2},{"Key":"Piping","Name":"파이프","Categories":["MEP 제작 배관","MEP 제작 행거","MEP 제작 덕트장치","파이프 세그먼트","파이프 자리 표시자","라우팅 기본 설정","파이프 단열재","스프링클러","파이프 액세서리","플렉시블 파이프","파이프 장치","파이프","파이프 시스템","공간","매스","면적","프로젝트 정보","시트","상세 항목","배관 설비","기계 장비","래스터 이미지","해석 화면표시 스타일","해석 결과","부품","마스킹 영역","채워진 영역","커튼월 그리드","룸","일반 모델","선"],"DisplayOrder":3}]'),Xi=JSON.parse('[{"Key":"Architecture","Name":"Architektura","Categories":["Łączniki zbrojenia konstrukcyjnego","Połączenia konstrukcyjne","Zbrojenie prętami","Bryła","Powierzchnie","Informacje o projekcie","Arkusze","Elementy szczegółów","Elementy otoczenia","Zieleń","Usztywnienie konstrukcyjne","Sprzęt specjalistyczny","Model terenu","Słupy konstrukcyjne","Układy belek konstrukcyjnych","Ramy konstrukcyjne","Fundamenty konstrukcyjne","Teren","Drogi","Parking","Osprzęt hydrauliczny","Wyposażenie mechaniczne","Oprawy oświetleniowe","Systemy meblowe","Osprzęt elektryczny","Wyposażenie elektryczne","Zabudowa","Otwory szybu","Obrazy rastrowe","Systemy elementów ścian osłonowych","Styl wyświetlania analizy","Rezultaty analizy","Części","Obszar maskowania","Obszar wypełnienia","Rampy","Podziały ściany osłonowej","Szprosy ścian osłonowych","Pola ściany osłonowej","Pomieszczenia","Modele ogólne","Poręcze","Schody","Słupy","Meble","Linie","Sufity","Dachy","Stropy","Drzwi","Okna","Ściany"],"DisplayOrder":0},{"Key":"Structure","Name":"Konstrukcja","Categories":["Łączniki zbrojenia konstrukcyjnego","Połączenia konstrukcyjne","Powierzchnie zbrojenia siatką konstrukcyjną","Zbrojenie siatkami konstrukcyjnymi","Konstrukcyjne zbrojenie po ścieżce","Konstrukcyjne zbrojenie powierzchniowe","Zbrojenie prętami","Bryła","Informacje o projekcie","Arkusze","Elementy szczegółów","Usztywnienie konstrukcyjne","Kratownice","Słupy konstrukcyjne","Układy belek konstrukcyjnych","Ramy konstrukcyjne","Fundamenty konstrukcyjne","Otwory szybu","Obrazy rastrowe","Styl wyświetlania analizy","Rezultaty analizy","Części","Obszar maskowania","Obszar wypełnienia","Rampy","Podziały ściany osłonowej","Modele ogólne","Schody","Słupy","Linie","Dachy","Stropy","Ściany"],"DisplayOrder":1},{"Key":"Mechanical","Name":"Mechaniczne","Categories":["Podwieszenia produkcyjne MEP","Kanały produkcyjne MEP","Obiekty zastępcze kanałów","Preferencje przebiegu","Okładziny rur","Izolacje kanałów","Strefy HVAC","Obwody elektryczne","Przewody elastyczne","Akcesoria wentylacyjne","Systemy kanałów","Terminale wentylacyjne","Złączki kanału","Kanały","Przestrzenie","Bryła","Powierzchnie","Informacje o projekcie","Arkusze","Elementy szczegółów","Wyposażenie mechaniczne","Obrazy rastrowe","Styl wyświetlania analizy","Rezultaty analizy","Części","Obszar maskowania","Obszar wypełnienia","Podziały ściany osłonowej","Pomieszczenia","Modele ogólne","Linie"],"DisplayOrder":4},{"Key":"Electrical","Name":"Elektryczne","Categories":["Odwadniania produkcyjne MEP","Podwieszenia produkcyjne MEP","Obwody elektryczne urządzeń rezerwowych/wolnego miejsca","Przebiegi drabinek kablowych","Przebiegi rur kablowych","Rury kablowe","Drabinki kablowe","Złączki rury kablowej","Złączki drabinki kablowej","Preferencje przebiegu","System przełączania","Urządzenia oświetleniowe","Urządzenia alarmowe ppoż.","Urządzenia danych","Urządzenia komunikacyjne","Urządzenia bezpieczeństwa","Urządzenia przywołania pielęgniarek","Urządzenia telefoniczne","Przewody","Obwody elektryczne","Przestrzenie","Bryła","Powierzchnie","Informacje o projekcie","Arkusze","Elementy szczegółów","Oprawy oświetleniowe","Osprzęt elektryczny","Wyposażenie elektryczne","Obrazy rastrowe","Styl wyświetlania analizy","Rezultaty analizy","Części","Obszar maskowania","Obszar wypełnienia","Podziały ściany osłonowej","Pomieszczenia","Modele ogólne","Linie"],"DisplayOrder":2},{"Key":"Piping","Name":"Orurowanie","Categories":["Rurociągi produkcyjne MEP","Podwieszenia produkcyjne MEP","Kanały produkcyjne MEP","Segmenty rury","Obiekty zastępcze rur","Preferencje przebiegu","Izolacje rur","Tryskacze","Akcesoria rur","Rury elastyczne","Złączki rurowe","Rury","Systemy rur","Przestrzenie","Bryła","Powierzchnie","Informacje o projekcie","Arkusze","Elementy szczegółów","Osprzęt hydrauliczny","Wyposażenie mechaniczne","Obrazy rastrowe","Styl wyświetlania analizy","Rezultaty analizy","Części","Obszar maskowania","Obszar wypełnienia","Podziały ściany osłonowej","Pomieszczenia","Modele ogólne","Linie"],"DisplayOrder":3}]'),$i=JSON.parse('[{"Key":"Architecture","Name":"Architecture","Categories":["Acopladores do vergalhão estrutural","Conexões estruturais","Vergalhão estrutural","Massa","Áreas","Informações do projeto","Folhas","Itens de detalhe","Ambiente","Vegetação","Fixadores estruturais","Equipamento especial","Topografia","Pilares estruturais","Sistema de viga estrutural","Quadro estrutural","Fundações estruturais","Terreno","Estradas","Estacionamento","Equipamentos hidráulicos","Equipamento mecânico","Luminárias","Sistema de mobiliário","Iluminação elétrica","Equipamento elétrico","Componentes de gabinete","Aberturas de shaft","Imagens raster","Sistema de cortina","Estilo de visualização da análise","Resultados da análise","Peças","Região de máscara","Região preenchida","Rampas","Eixos cortina","Montantes de parede cortina","Painéis cortina","Ambientes","Modelos genéricos","Guarda-corpos","Escadas","Colunas","Mobiliário","Linhas","Forros","Telhados","Pisos","Portas","Janelas","Paredes"],"DisplayOrder":0},{"Key":"Structure","Name":"Structure","Categories":["Acopladores do vergalhão estrutural","Conexões estruturais","Áreas de tela soldada estrutural","Armadura da tela soldada estrutural","Armadura do caminho estrutural","Armadura estrutural da área","Vergalhão estrutural","Massa","Informações do projeto","Folhas","Itens de detalhe","Fixadores estruturais","Treliças estruturais","Pilares estruturais","Sistema de viga estrutural","Quadro estrutural","Fundações estruturais","Aberturas de shaft","Imagens raster","Estilo de visualização da análise","Resultados da análise","Peças","Região de máscara","Região preenchida","Rampas","Eixos cortina","Modelos genéricos","Escadas","Colunas","Linhas","Telhados","Pisos","Paredes"],"DisplayOrder":1},{"Key":"Mechanical","Name":"Mechanical","Categories":["Tirantes de fabricação MEP","Sistema de duto de fabricação MEP","Marcadores de posição de duto","Preferências de roteamento","Coberturas do duto","Isolamentos do duto","Zonas AVAC","Circuitos elétricos","Dutos flexíveis","Acessórios de duto","Sistemas de duto","Terminais de ar","Conexões de duto","Dutos","Espaços","Massa","Áreas","Informações do projeto","Folhas","Itens de detalhe","Equipamento mecânico","Imagens raster","Estilo de visualização da análise","Resultados da análise","Peças","Região de máscara","Região preenchida","Eixos cortina","Ambientes","Modelos genéricos","Linhas"],"DisplayOrder":4},{"Key":"Electrical","Name":"Electrical","Categories":["Contenções de fabricação MEP","Tirantes de fabricação MEP","Peças elétricas de reposição/Circuitos de reposição","Direções da bandeja de cabos","Direções do conduite","Conduites","Bandejas de cabos","Conexões do conduite","Conexões da bandeja de cabos","Preferências de roteamento","Alternar de sistema","Dispositivos de iluminação","Dispositivos de alarme de incêndio","Dispositivos de dados","Dispositivos de comunicação","Dispositivos de segurança","Dispositivos de chamada de enfermeira","Dispositivos de telefonia","Fiação","Circuitos elétricos","Espaços","Massa","Áreas","Informações do projeto","Folhas","Itens de detalhe","Luminárias","Iluminação elétrica","Equipamento elétrico","Imagens raster","Estilo de visualização da análise","Resultados da análise","Peças","Região de máscara","Região preenchida","Eixos cortina","Ambientes","Modelos genéricos","Linhas"],"DisplayOrder":2},{"Key":"Piping","Name":"Piping","Categories":["Tubulações de fabricação MEP","Tirantes de fabricação MEP","Sistema de duto de fabricação MEP","Segmentos de tubulação","Marcadores de posição de tubulação","Preferências de roteamento","Isolamentos da tubulação","Sprinklers","Acessórios do tubo","Tubulação flexível","Conexões de tubo","Tubulação","Sistemas de tubulação","Espaços","Massa","Áreas","Informações do projeto","Folhas","Itens de detalhe","Equipamentos hidráulicos","Equipamento mecânico","Imagens raster","Estilo de visualização da análise","Resultados da análise","Peças","Região de máscara","Região preenchida","Eixos cortina","Ambientes","Modelos genéricos","Linhas"],"DisplayOrder":3}]'),er=JSON.parse('[{"Key":"Architecture","Name":"Architecture","Categories":["Соединители несущей арматуры","Соединения несущих конструкций","Несущая арматура","Формы","Зоны","Сведения о проекте","Листы","Элементы узлов","Антураж","Озеленение","Ребра жесткости несущей конструкции","Специальное оборудование","Топография","Несущие колонны","Балочные системы","Каркас несущий","Фундамент несущей конструкции","Генплан","Дорожки","Парковка","Сантехнические приборы","Оборудование","Осветительные приборы","Комплекты мебели","Силовые электроприборы","Электрооборудование","Шкафы","Проемы для шахты","Растровые изображения","Витражные системы","Графический стиль расчета","Результаты расчета","Части","Область маскировки","Цветовая область","Пандус","Схемы разрезки витража","Импосты витража","Панели витража","Помещения","Обобщенные модели","Ограждение","Лестницы","Колонны","Мебель","Линии","Потолки","Крыши","Перекрытия","Двери","Окна","Стены"],"DisplayOrder":0},{"Key":"Structure","Name":"Structure","Categories":["Соединители несущей арматуры","Соединения несущих конструкций","Области раскладки арматурных сеток","Арматурная сетка несущей конструкции","Армирование по траектории несущей конструкции","Армирование по площади несущей конструкции","Несущая арматура","Формы","Сведения о проекте","Листы","Элементы узлов","Ребра жесткости несущей конструкции","Фермы","Несущие колонны","Балочные системы","Каркас несущий","Фундамент несущей конструкции","Проемы для шахты","Растровые изображения","Графический стиль расчета","Результаты расчета","Части","Область маскировки","Цветовая область","Пандус","Схемы разрезки витража","Обобщенные модели","Лестницы","Колонны","Линии","Крыши","Перекрытия","Стены"],"DisplayOrder":1},{"Key":"Mechanical","Name":"Mechanical","Categories":["Подвески из базы данных производителя MEP","Элементы воздуховодов из базы данных производителя MEP","Воздуховоды по осевой","Настройки трассировки","Материалы внутренней изоляции воздуховодов","Материалы изоляции воздуховодов","Зоны ОВК","Электрические цепи","Гибкие воздуховоды","Арматура воздуховодов","Системы воздуховодов","Воздухораспределители","Соединительные детали воздуховодов","Воздуховоды","Пространства","Формы","Зоны","Сведения о проекте","Листы","Элементы узлов","Оборудование","Растровые изображения","Графический стиль расчета","Результаты расчета","Части","Область маскировки","Цветовая область","Схемы разрезки витража","Помещения","Обобщенные модели","Линии"],"DisplayOrder":4},{"Key":"Electrical","Name":"Electrical","Categories":["Элементы герметизации из базы данных производителя MEP","Подвески из базы данных производителя MEP","Электрические резервные/пространственные цепи","Участки кабельного лотка","Участки короба","Короба","Кабельные лотки","Соединительные детали коробов","Соединительные детали кабельных лотков","Настройки трассировки","Система коммутации","Осветительная аппаратура","Системы пожарной сигнализации","Датчики","Устройства связи","Предохранительные устройства","Устройства вызова и оповещения","Телефонные устройства","Провода","Электрические цепи","Пространства","Формы","Зоны","Сведения о проекте","Листы","Элементы узлов","Осветительные приборы","Силовые электроприборы","Электрооборудование","Растровые изображения","Графический стиль расчета","Результаты расчета","Части","Область маскировки","Цветовая область","Схемы разрезки витража","Помещения","Обобщенные модели","Линии"],"DisplayOrder":2},{"Key":"Piping","Name":"Piping","Categories":["Трубы из базы данных производителя MEP","Подвески из базы данных производителя MEP","Элементы воздуховодов из базы данных производителя MEP","Сегменты труб","Трубопровод по осевой","Настройки трассировки","Материалы изоляции труб","Спринклеры","Арматура трубопроводов","Гибкие трубы","Соединительные детали трубопроводов","Трубы","Трубопроводные системы","Пространства","Формы","Зоны","Сведения о проекте","Листы","Элементы узлов","Сантехнические приборы","Оборудование","Растровые изображения","Графический стиль расчета","Результаты расчета","Части","Область маскировки","Цветовая область","Схемы разрезки витража","Помещения","Обобщенные модели","Линии"],"DisplayOrder":3}]'),tr=JSON.parse('[{"Key":"Architecture","Name":"Architecture","Categories":["结构钢筋接头","结构连接","结构钢筋","体量","面积","项目信息","图纸","详图项目","环境","植物","结构加强板","专用设备","地形","结构柱","结构梁系统","结构框架","结构基础","场地","道路","停车场","卫浴装置","机械设备","照明设备","家具系统","电气装置","电气设备","橱柜","竖井洞口","光栅图像","幕墙系统","分析显示样式","分析结果","组成部分","遮罩区域","填充区域","坡道","幕墙网格","幕墙竖梃","幕墙嵌板","房间","常规模型","栏杆扶手","楼梯","柱","家具","线","天花板","屋顶","楼板","门","窗","墙"],"DisplayOrder":0},{"Key":"Structure","Name":"Structure","Categories":["结构钢筋接头","结构连接","结构钢筋网区域","结构钢筋网","结构路径钢筋","结构区域钢筋","结构钢筋","体量","项目信息","图纸","详图项目","结构加强板","结构桁架","结构柱","结构梁系统","结构框架","结构基础","竖井洞口","光栅图像","分析显示样式","分析结果","组成部分","遮罩区域","填充区域","坡道","幕墙网格","常规模型","楼梯","柱","线","屋顶","楼板","墙"],"DisplayOrder":1},{"Key":"Mechanical","Name":"Mechanical","Categories":["MEP 预制支架","MEP 预制管网","风管占位符","布管系统配置","风管内衬","风管隔热层","HVAC 区","电路","软风管","风管附件","风管系统","风道末端","风管管件","风管","空间","体量","面积","项目信息","图纸","详图项目","机械设备","光栅图像","分析显示样式","分析结果","组成部分","遮罩区域","填充区域","幕墙网格","房间","常规模型","线"],"DisplayOrder":4},{"Key":"Electrical","Name":"Electrical","Categories":["MEP 预制保护层","MEP 预制支架","电气备件/空间电路","电缆桥架管路","线管管路","线管","电缆桥架","线管配件","电缆桥架配件","布管系统配置","开关系统","灯具","火警设备","数据设备","通讯设备","安全设备","护理呼叫设备","电话设备","导线","电路","空间","体量","面积","项目信息","图纸","详图项目","照明设备","电气装置","电气设备","光栅图像","分析显示样式","分析结果","组成部分","遮罩区域","填充区域","幕墙网格","房间","常规模型","线"],"DisplayOrder":2},{"Key":"Piping","Name":"Piping","Categories":[" MEP 预制管道","MEP 预制支架","MEP 预制管网","管段","管道占位符","布管系统配置","管道隔热层","喷头","管道附件","软管","管件","管道","管道系统","空间","体量","面积","项目信息","图纸","详图项目","卫浴装置","机械设备","光栅图像","分析显示样式","分析结果","组成部分","遮罩区域","填充区域","幕墙网格","房间","常规模型","线"],"DisplayOrder":3}]'),ir=JSON.parse('[{"Key":"Architecture","Name":"Architecture","Categories":["結構鋼筋續接器","結構接頭","結構鋼筋","量體","面積","專案資訊","圖紙","詳圖項目","點景","植栽","結構襯料","特製設備","地形","結構柱","結構樑系統","結構構架","結構基礎","敷地","道路","停車場","衛工裝置","機械設備","燈具","家具系統","電氣裝置","電氣設備","櫥櫃","豎井開口","點陣式影像","帷幕系統","分析顯示型式","分析結果","零件","遮罩面積","填滿面積","坡道","帷幕牆網格","帷幕牆豎框","帷幕板","房間","一般模型","欄杆扶手","樓梯","柱","家具","線","天花板","屋頂","樓板","門","窗","牆"],"DisplayOrder":0},{"Key":"Structure","Name":"Structure","Categories":["結構鋼筋續接器","結構接頭","結構鋼筋網面積","結構鋼筋網","結構路徑型配筋","結構面積鋼筋","結構鋼筋","量體","專案資訊","圖紙","詳圖項目","結構襯料","結構桁架","結構柱","結構樑系統","結構構架","結構基礎","豎井開口","點陣式影像","分析顯示型式","分析結果","零件","遮罩面積","填滿面積","坡道","帷幕牆網格","一般模型","樓梯","柱","線","屋頂","樓板","牆"],"DisplayOrder":1},{"Key":"Mechanical","Name":"Mechanical","Categories":["MEP 製造吊鉤","MEP 製造風管系統","風管定位","佈線偏好","風管襯層","風管隔熱層","HVAC 區域","回路","撓性風管","風管附件","風管系統","進回風口","風管配件","風管","空間","量體","面積","專案資訊","圖紙","詳圖項目","機械設備","點陣式影像","分析顯示型式","分析結果","零件","遮罩面積","填滿面積","帷幕牆網格","房間","一般模型","線"],"DisplayOrder":4},{"Key":"Electrical","Name":"Electrical","Categories":["MEP 製造封堵","MEP 製造吊鉤","電氣備件/空間電路","電纜架管路","電管管路","電管","電纜架","電管配件","電纜架配件","佈線偏好","開關系統","照明裝置","火警裝置","資料裝置","通信裝置","門禁裝置","急救裝置","電話裝置","電線","回路","空間","量體","面積","專案資訊","圖紙","詳圖項目","燈具","電氣裝置","電氣設備","點陣式影像","分析顯示型式","分析結果","零件","遮罩面積","填滿面積","帷幕牆網格","房間","一般模型","線"],"DisplayOrder":2},{"Key":"Piping","Name":"Piping","Categories":["MEP 製造管路系統","MEP 製造吊鉤","MEP 製造風管系統","管段","管定位","佈線偏好","管隔熱層","撒水頭","管附件","撓性管","管配件","管","配管系統","空間","量體","面積","專案資訊","圖紙","詳圖項目","衛工裝置","機械設備","點陣式影像","分析顯示型式","分析結果","零件","遮罩面積","填滿面積","帷幕牆網格","房間","一般模型","線"],"DisplayOrder":3}]'),rr=JSON.parse('[{"Key":"Architecture","Name":"Architecture","Categories":["Areas","Casework","Ceilings","Columns","Curtain Panels","Curtain Systems","Curtain Wall Mullions","Detail Items","Doors","Electrical Equipment","Electrical Fixtures","Entourage","Floors","Furniture","Furniture Systems","Generic Models","Lighting Fixtures","Lines","Mass","Mechanical Equipment","Parking","Parts","Planting","Plumbing Fixtures","Railings","Ramps","Raster Images","Roads","Roofs","Rooms","Shaft Openings","Site","Specialty Equipment","Stairs","Structural Beam Systems","Structural Columns","Structural Connections","Structural Foundations","Structural Framing","Structural Rebar","Structural Rebar Couplers","Structural Stiffeners","Topography","Walls","Windows"],"DisplayOrder":0},{"Key":"Structure","Name":"Structure","Categories":["Columns","Detail Items","Floors","Generic Models","Lines","Mass","Parts","Ramps","Raster Images","Roofs","Shaft Openings","Stairs","Structural Area Reinforcement","Structural Beam Systems","Structural Columns","Structural Connections","Structural Fabric Areas","Structural Fabric Reinforcement","Structural Foundations","Structural Framing","Structural Path Reinforcement","Structural Rebar","Structural Rebar Couplers","Structural Stiffeners","Structural Trusses","Walls"],"DisplayOrder":1},{"Key":"Mechanical","Name":"Mechanical","Categories":["Air Terminals","Areas","Detail Items","Duct Accessories","Duct Fittings","Duct Insulations","Duct Linings","Duct Placeholders","Ducts","Flex Ducts","Generic Models","HVAC Zones","Lines","Mass","Mechanical Equipment","MEP Fabrication Ductwork","MEP Fabrication Hangers","Parts","Raster Images","Rooms","Spaces"],"DisplayOrder":4},{"Key":"Electrical","Name":"Electrical","Categories":["Areas","Cable Tray Fittings","Cable Trays","Communication Devices","Conduit Fittings","Conduits","Data Devices","Detail Items","Electrical Equipment","Electrical Fixtures","Fire Alarm Devices","Generic Models","Lighting Devices","Lighting Fixtures","Lines","Mass","MEP Fabrication Containment","MEP Fabrication Hangers","Nurse Call Devices","Parts","Raster Images","Rooms","Security Devices","Spaces","Telephone Devices","Wires"],"DisplayOrder":2},{"Key":"Piping","Name":"Piping","Categories":["Areas","Detail Items","Flex Pipes","Generic Models","Lines","Mass","Mechanical Equipment","MEP Fabrication Ductwork","MEP Fabrication Hangers","MEP Fabrication Pipework","Parts","Pipe Accessories","Pipe Fittings","Pipe Insulations","Pipe Placeholders","Pipes","Plumbing Fixtures","Raster Images","Rooms","Spaces","Sprinklers"],"DisplayOrder":3}]'),or=Autodesk.Viewing,nr=AutodeskNamespace("Autodesk.AEC");function sr(){const e={cs:Wi.slice(0),de:Yi.slice(0),en:Hi.slice(0),es:qi.slice(0),fr:Ki.slice(0),it:Qi.slice(0),ja:Zi.slice(0),ko:Ji.slice(0),pl:Xi.slice(0),"pt-BR":$i.slice(0),ru:er.slice(0),"zh-Hans":tr.slice(0),"zh-Hant":ir.slice(0),"zh-HK":rr.slice(0)};return function(e){or.i18n.t("Architecture"),or.i18n.t("Structure"),or.i18n.t("Mechanical"),or.i18n.t("Electrical"),or.i18n.t("Piping");for(const t of Object.values(e))t.forEach((e=>{or.i18n.exists(e.Key)&&(e.Name=or.i18n.t(e.Key))}))}(e),e}class ar extends Autodesk.Viewing.Extension{constructor(e,t){super(e,(null==t?void 0:t.Disciplines)??t),this.baseDisciplines=sr()}async load(){return!0}unload(){return!0}getDisciplines(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const i=(0,Gi.cloneDeep)(this.baseDisciplines);if(t)for(const[e,t]of Object.entries(i)){const i={Key:"Miscellaneous",Name:or.i18n.t("Miscellaneous",{lng:e}),Categories:[],DisplayOrder:999,_MiscDiscipline:!0};t.push(i)}for(const e of Object.values(i))e.sort(((e,t)=>e.DisplayOrder-t.DisplayOrder));return e?e(i):i}getModelLanguage(e){const t=this.baseDisciplines;console.time("Discipline language check");const i=function(e,t,i){const r=e.getInstanceTree();return r&&function(e,t){const i=e.getData().fragments,r=e.getFragmentList();for(const e of i.fragId2dbId)if(!r.isNotLoaded(e)){const i=t(e);if(i)return i}}(e,(e=>{const o=function(e,t,i){if(null!=i&&i.getCategory){let r=i.getCategory(e,t);if(void 0!==r)return r}switch(null==i?void 0:i.mimeType){case"application/vnd.autodesk.f3d":case"application/vnd.autodesk.fusion360":t=e.getNodeParentId(t)||t,t=e.getNodeParentId(t)||t;break;default:for(;e.getNodeParentId(t)!=e.getRootId()&&(t=e.getNodeParentId(t)););}return t?e.getNodeName(t):"Unknown"}(r,e,i);return t(o)}))}(e,(e=>{for(const[i,r]of Object.entries(t))for(const t of Object.values(r))for(const r of t.Categories)if(e==r)return console.info(`Discipline language '${i}' detected (for category '${r}')`),i}));return console.timeEnd("Discipline language check"),i??"en"}}Object.assign(nr,{DisciplinesExtension:ar}),nr.DisciplinesExtension=ar,or.theExtensionManager.registerExtension("Autodesk.AEC.DisciplinesExtension",ar)})(),Autodesk.Extensions.AEC=__webpack_exports__})();
//# sourceMappingURL=AEC.min.js.map